<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Samba System troubleshooting</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="This article will essentially be a selection of ‚ÄúBest practie‚Äù for Samba system administrators. The basis of the article is the chapter Troubleshootin...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Samba System troubleshooting</h1><div class="post__text post__text-html js-mediator-article">  This article will essentially be a selection of ‚ÄúBest practie‚Äù for Samba system administrators.  The basis of the article is the chapter Troubleshooting Techniques from the book Sam's Teach Yourself Samba in 24 Hours.  We will try to address the most common mistakes when configuring Samba. <br><br>  Agree, it is terrible to change the engine in the car, and then find out that she did not go because of the lack of gasoline!  Maybe this is not the best metaphor, but many system administrators waste time in vain, without first checking the most obvious things.  Look at how the process of finding and solving problems with <i>Samba</i> should line up: <br><a name="habracut"></a><br><img src="https://habrastorage.org/storage2/053/fd6/66a/053fd666a0c27bcfc65569e4f43b25bd.png"><br><br>  The problems presented at the lower levels of this ‚Äúpyramid‚Äù are the ‚Äúfoundation‚Äù for higher levels.  Not surprisingly, the Windows client cannot access the file system on <i>Samba</i> if the server is disconnected from the network.  Of course, you should not take this picture literally as a guide to action (for example, log files can always be viewed), but you should start with the problems of the lower levels.  The higher we rise, the more we delve into the principles of <i>Samba</i> . <br>  In search of a solution to a problem with <i>Samba</i> , first of all, refer to the following resources: <br>  ‚Ä¢ HOWTO, published on the <a href="http://www.samba.org/">site</a> ; <br>  ‚Ä¢ thematic sites and forums, for example: <a href="http://samba-doc.ru/">http://samba-doc.ru/</a> , <a href="http://citforum.ru/operating_systems/linux/samba/">http://citforum.ru/operating_systems/linux/samba/</a> ; <br>  ‚Ä¢ <i>Samba</i> documentation sections for a distribution (for example, <a href="http://help.ubuntu.ru/wiki/samba">http://help.ubuntu.ru/wiki/samba</a> , <a href="http://www.centos.org/docs/5/html/Deployment_Guide-en-US/ch-samba.html">http://www.centos.org/docs/5/html/Deployment_Guide-en-US/ch -samba.html</a> or <a href="http://wiki.russianfedora.ru/index.php%3Ftitle%3DSamba">http://wiki.russianfedora.ru/index.php?title=Samba</a> ); <br>  ‚Ä¢ <a href="http://stackoverflow.com/">http://stackoverflow.com/</a> - do not forget about this site if you have a specific question or problem; <br>  ‚Ä¢ auxiliary utilities included in <i>Samba</i> , as well as various traffic analyzers (for example, <i>Wireshark</i> ). <br>  We will first of all consider an independent solution of emerging problems, but do not forget about the possible help of the community.  This can seriously save you time and energy. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      <b>Test environment description</b> <br>  First, a few words about the test environment.  The conditions are as follows: <br>  ‚Ä¢ The <i>Samba</i> server is called <i>TROUBLE</i> and has an IP address of 192.168.7.75 and a mask of 255.255.255.0. <br>  ‚Ä¢ <i>smbd</i> and <i>nmbd</i> run as daemons. <br>  ‚Ä¢ The Windows client is called <i>win-client</i> . <br>  ‚Ä¢ The Windows client uses 192.168.7.135 with a network mask of 255.255.255.0. <br>  ‚Ä¢ Both the <i>win-client</i> and <i>TROUBLE</i> are on the same subnet, so the broadcast request comes from one host to another. <br>  ‚Ä¢ Both <i>win-client</i> and <i>TROUBLE</i> are members of the LAB working group. <br>  ‚Ä¢ Samba server uses the following <b>smb.conf</b> : <br><pre><code class="bash hljs">[global] netbios name = TROUBLE workgroup = LAB security = user encrypt passwords = yes [public] path = /tmp <span class="hljs-built_in"><span class="hljs-built_in">read</span></span> only = no</code> </pre> <br><br><h5>  LEVEL 1 </h5><br><h6>  The health of the network connection and configuration file </h6><br><br>  The foundation of our ‚Äúpyramid‚Äù consists of three main problems: <br>  ‚Ä¢ correctly working TCP / IP connection; <br>  ‚Ä¢ matching mask and broadcast addresses on servers and clients; <br>  ‚Ä¢ <b>smb.conf</b> file operability. <br><br>  <b>TCP / IP</b> <br>  To verify TCP / IP, first use the <b>ping</b> command.  If the ICMP protocol is described in a very simplified way, the host sends a request to the server and asks, ‚ÄúAre you alive?‚Äù.  If the server does not respond, the host concludes that it is not connected to the network and therefore unavailable. <br><pre> <code class="bash hljs">$ ping win-client PING win-client (192.168.7.135) from 192.168.1.74 : 56(84) bytes of data. 64 bytes from win-client (192.168.7.135): icmp_seq=0 ttl=255 time=2.138 msec 64 bytes from win-client (192.168.7.135): icmp_seq=1 ttl=255 time=2.181 msec 64 bytes from win-client (192.168.7.135): icmp_seq=2 ttl=255 time=2.263 msec --- ping statistics --- 3 packets transmitted, 3 packets received, 0% packet loss round-trip min/avg/max/mdev = 2.138/2.194/2.263/0.051 ms</code> </pre><br>  Also very important is the proper functioning of the DNS.  If the name cannot be resolved, a message like this appears: <br><pre> <code class="bash hljs">$ ping win-client ping: unknown host win-client</code> </pre><br>  If this happens, the first thing to do is repeat the <b>ping</b> command, but using not the name, but the address: <br><pre> <code class="bash hljs">$ ping 192.168.7.135</code> </pre><br>  If the command succeeds, then you should pay attention to the DNS configuration.  The most common causes of error: <br>  ‚Ä¢ Incorrect content of the DNS configuration file <b>/etc/resolv.conf</b> ; <br>  ‚Ä¢ there is no <i>win-client</i> record on the DNS server; <br>  ‚Ä¢ DNS server is not available at the moment. <br>  If the <b>ping</b> by IP-address is not successfully performed, then it is worth checking the performance of network equipment on the server, the client and between them. <br><br>  <b>Broadcast address on server and client</b> <br>  It is possible that the <b>ping</b> will succeed, but the netmask and the broadcast address will not be configured correctly. <br>  In NetBIOS, it is extremely important to correctly resolve the name and search for machines in the network environment so that the server and the client are on the same subnet, i.e.  used the same subnet mask and broadcast address. <br>  In our case, the network mask should be 255.255.255.0, and the broadcast address should be 192.168.7.255. <br>  If you are using Linux, you can check which broadcast address and mask are used with the <b>ifconfig</b> command with the interface name as an argument: <br><pre> <code class="bash hljs">$ /sbin/ifconfig eth0 eth0 Link encap:Ethernet HWaddr 00:04:5A:0C:1C:19 inet addr:192.168.7.75 Bcast:192.168.255.255 Mask:255.255.255.0 inet6 addr: fe80::204:5aff:fe0c:1c19/10 Scope:Link UP BROADCAST RUNNING MULTICAST MTU:1500 Metric:1 RX packets:68006 errors:0 dropped:0 overruns:0 frame:0 TX packets:100783 errors:0 dropped:0 overruns:0 carrier:0 collisions:0 txqueuelen:100 RX bytes:12186135 (11.6 Mb) TX bytes:121642120 (116.0 Mb) Interrupt:3 Base address:0x100 1</code> </pre><br>  If you see in the output of this command that the broadcast address or netmask is set incorrectly, you should log in as root and set the correct values ‚Äã‚Äãusing the <b>ifconfig</b> command: <br><pre> <code class="bash hljs">root<span class="hljs-comment"><span class="hljs-comment"># ifconfig eth0 192.168.7.75 netmask 255.255.255.0 broadcast 192.168.7.255</span></span></code> </pre><br>  In Windows, similar information can be obtained by issuing the <b>ipconfig / all</b> command. <br><br>  <b>Verifying the smb.conf file</b> <br>  Since <i>Samba</i> uses a huge number of parameters from the <b>smb.conf</b> file, the developers have created a command line utility that checks the syntax of this file.  The utility is called <i>testparm</i> , it is very useful when searching for errors in the configuration file. <br>  You can use the <i>testparm</i> utility with the <b>-s option</b> to analyze a specific configuration file.  This option is very well suited for checking the configuration file before using it. <br><pre> <code class="bash hljs">$ testparm -s /usr/<span class="hljs-built_in"><span class="hljs-built_in">local</span></span>/samba/lib/smb.conf.new Load smb config files from /usr/<span class="hljs-built_in"><span class="hljs-built_in">local</span></span>/samba/lib/smb.conf.new Processing section ‚Äú[public]‚Äù Loaded services file OK. <span class="hljs-comment"><span class="hljs-comment"># Global parameters [global] coding system = client code page = 850 code page directory = /usr/local/samba/lib/codepages &lt;...  ...&gt;</span></span></code> </pre><br>  After analyzing the specified configuration file, <i>testparm</i> displays all values ‚Äã‚Äãof the <b>smb.conf</b> file, including default values.  This helps ensure that the expected values ‚Äã‚Äãfor the <i>smbd</i> and <i>nmbd</i> configuration parameters are used. <br>  It is worth noting that the default values ‚Äã‚Äãvary from version to version, so you need to use the <i>Samba</i> version corresponding to the <i>testparm</i> version. <br><br><h5>  LEVEL 2 </h5><br><h6>  Server and client software </h6><br><br>  The second level involves checking the configuration of client and server software.  Our goal is to make sure that both the client and server respond correctly to NetBIOS and CIFS requests.  While we are considering in isolation each of the hosts.  (At the third level, we will begin to consider their interaction.) <br><br>  <b>smbd</b> <br>  First of all, smbd must be running.  This can be checked using the ps command.  The arguments of this command may differ depending on the version of Linux. <br><pre> <code class="bash hljs">$ ps -ef | grep smbd root 28592 1 0 12:37 ? 00:00:00 /usr/<span class="hljs-built_in"><span class="hljs-built_in">local</span></span>/samba/bin/smbd -D</code> </pre><br>  After making sure that <i>smbd is</i> running (or, if necessary, running it), we use the <i>smbclient</i> utility to test the server‚Äôs health.  The <b>-L</b> parameter is used to list the server resources.  The <b>-N</b> switch is used to connect to the server anonymously, so as not to create unnecessary problems with authorization.  All these actions must be performed locally on a <i>Samba</i> server. <br><pre> <code class="bash hljs">smbclient -L TROUBLE -N added interface ip=192.168.7.75 bcast=192.168.1.255 nmask=255.255.255.0 Anonymous login successful Domain=[LAB] OS=[Unix] Server=[Samba 2.2.2] Sharename Type --------- ---- public Disk IPC$ IPC Comment ------- IPC Service (Samba 2.2.2) smbclient -L TROUBLE -N added interface ip=192.168.7.75 bcast=192.168.1.255 nmask=255.255.255.0 Anonymous login successful Domain=[LAB] OS=[Unix] Server=[Samba 2.2.2] Sharename Type --------- ---- public Disk IPC$ IPC Comment ------- IPC Service (Samba 2.2.2) ADMIN$ Server --------- TROUBLE Workgroup --------- LAB Disk IPC Service (Samba 2.2.2) Comment ------- Samba 2.2.2 Master ------- TROUBLE</code> </pre><br>  There are two common errors that may occur when performing this check. <br>  The first error is as follows: <br><pre> <code class="bash hljs">error connecting to 192.168.7.75:139 (Connection refused) Connection to &lt;server&gt; failed</code> </pre><br>  It occurs if <i>smbd is</i> not running or cannot connect to port 139. This may be caused by previously installed and incorrectly removed <i>Samba</i> components.  First of all, you should make sure that smbd starts as a daemon and does not end there with an error.  The peculiarity is that <i>nmbd</i> does not display errors in the console window, so you should look at the last few lines of the log file.  Later we will look at the log analysis in more detail. <br>  The second most common error looks like this: <br><pre> <code class="bash hljs">session request to &lt;server&gt; failed (Not listening <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> calling name)</code> </pre><br>  You might think that the cause of this error is an incorrect NetBIOS name, but it is not.  This error cannot be caused by a ‚Äúbat‚Äù installation of <i>nmbd</i> , <i>nmbd</i> in this case does not even have to be started. <br>  The reason for this error during a local connection is most often the incorrectly configured hosts allow or hosts deny parameters in the <b>smb.conf</b> file.  The server terminates the NetBIOS session that is being created. <br>  If we were able to see a list of shared resources, we can check the ability of <i>Samba to</i> authorize users.  In this test, an account with the username user1 and the password secret is connected to the [public] share. <br><pre> <code class="bash hljs">$ smbclient //TROUBLE/public -U user1%secret added interface ip=192.168.7.75 bcast=192.168.1.255 nmask=255.255.255.0 Domain=[LAB] OS=[Unix] Server=[Samba 2.2.2] smb: \&gt;</code> </pre><br>  If <i>Samba</i> cannot authorize the user, you will see an error message: <br><pre> <code class="bash hljs">session setup failed: ERRSRV - ERRbadpw (Bad password - name/password pair <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> a Tree Connect or Session Setup are invalid.)</code> </pre><br>  The reasons for this error can be many.  This could be an invalid username or password, or a missing smbpasswd entry for the user, if the encrypt password = yes parameter is set, or an invalid guest account, if access is allowed without authentication. <br>  If the user has logged in correctly, but was unable to access the requested service, <i>smbclient</i> will display the following message: <br><pre> <code class="bash hljs">tree connect failed: ERRDOS - ERRnosuchshare (You specified an invalid share name)</code> </pre><br>  This may be caused by an incorrectly written service name, access settings to a shared resource, or an incorrect path expression in the description of the shared resource in the <b>smb.conf</b> file. <br><br>  <b>nmbd</b> <br>  To check if <i>nmbd is</i> running, we use the ps command again. <br><pre> <code class="bash hljs">$ ps -ef | grep nmbd root 29054 1 0 15:53 ? 00:00:00 /usr/<span class="hljs-built_in"><span class="hljs-built_in">local</span></span>/samba/bin/bin/nmbd -D</code> </pre><br>  If ps shows that <i>nmbd is</i> not running, you should log in as root and run it ( <b>/ usr / local / samba / bin / nmbd -D</b> ). <br>  For the test, we will use the <i>Samba</i> utility - <i>nmblookup</i> .  Each <i>Samba</i> server has a special name, _Samba_, to which they always respond.  By sending a request by this name, we can check the operation of <i>nmbd</i> .  The <b>-U</b> switch is used to send a request to a specific address. <br><pre> <code class="bash hljs">$ ./nmblookup -U 127.0.0.1 __Samba__ querying __Samba__ on 127.0.0.1 192.168.7.75 __Samba__&lt;00&gt;</code> </pre><br>  If <i>nmbd</i> is not running, the result will be an error: <br><pre> <code class="bash hljs">name_query failed to find name __Samba__</code> </pre><br>  It can also be caused by the fact that the loopback interface is not included in <b>smb.conf</b> when the bind interfaces only = yes parameter is enabled. <br>  After that, we will check if nmbd can register the name TROUBLE. <br><pre> <code class="bash hljs">$ nmblookup -U 127.0.0.1 TROUBLE querying TROUBLE on 127.0.0.1 192.168.7.75 TROUBLE&lt;00&gt;</code> </pre><br>  Error messages, for example, ‚Äúname query failed‚Äù, are most likely caused by a failed request for the name _Samba_.  Another reason may be that the server cannot register the NetBIOS name.  In this case, it is worth finding the server that owns the given name by sending a broadcast request. <br><pre> <code class="bash hljs">$ nmblookup -B 192.168.1.255 TROUBLE querying TROUBLE on 192.168.1.255 192.168.1.98 TROUBLE&lt;00&gt; </code> </pre><br>  For example, in this case, this name belongs to a third-party machine, and not to our <i>Samba</i> server.  Obviously, the solution to this problem is to rename this machine or server. <br><br><h5>  Windows NetBIOS Interface </h5><br>  The utility used in Windows for NetBIOS requests ‚Äî <i>nbtstat.exe</i> ‚Äî has a few more options that are not found in <i>nmblookup</i> .  One of them ( <b>-n</b> ) allows you to "ask" the NetBIOS interface which names it has successfully registered: <br><pre> <code class="bash hljs">C:\WINDOWS&gt; nbtstat -n Node IpAddress: [192.168.7.135] Scope Id: [] NetBIOS Local Name Table Name Type Status --------------------------------------------- WIN-CLIENT LAB WIN-CLIENT &lt;00&gt; UNIQUE &lt;00&gt; GROUP &lt;03&gt; UNIQUE Registered Registered Registered</code> </pre><br>  If the ‚ÄúClient for Microsoft Networks‚Äù component has not been installed, <i>nbtstat.exe</i> will report the following: <br><pre> <code class="bash hljs">Failed to access NBT driver 1</code> </pre><br>  A more subtle error occurs when the Windows client reports that it has registered the name of the workgroup, although it must be the unique name of the workstation. <br><pre> <code class="bash hljs">Name Type Status --------------------------------------------- LAB &lt;00&gt; GROUP Registered</code> </pre><br>  Often the reason for this is the presence of a machine with the same NetBIOS name.  The Windows client needs a unique name to establish a NetBIOS session with the server.  Until the client can register the name of the workstation, he will be unable to, say, view the network environment or mount network drives. <br><br><h5>  LEVEL 3 </h5><br><h6>  Remote access to shared resources </h6><br>  So, we have already found out that both the client and the server have access to the network, and the software works on them locally.  At this level, we turn to the diagnosis of the health of their interaction. <br><br>  <b>Name resolution</b> <br>  We will again use the <i>nmblookup</i> and <i>nbstat.exe</i> utilities to find out if the client can resolve the server name and vice versa.  The test will consist of two phases.  In the first, we will use a broadcast request to test the server and client responses.  This is done by setting the broadcast address (-B 192.168.7.255) in the <i>nmblookup</i> utility when prompted, which involves networking between the server and the client. <br>  First we will try to resolve the server name: <br><pre> <code class="bash hljs">$ nmblookup -B 192.168.1.255 TROUBLE querying TROUBLE on 192.168.1.255 192.168.7.75 TROUBLE&lt;00&gt;</code> </pre><br>  After that, we will try to resolve the client name using the same broadcast address. <br><pre> <code class="bash hljs">$ nmblookup -B 192.168.1.255 win-client querying win-client on 192.168.1.255 192.168.7.135 win-client&lt;00&gt;</code> </pre><br>  If everything went well so far, this test will most likely work correctly.  If the result is an error, you should once again believe that the broadcast address on all machines matches. <br>  After that, we will perform a NetBIOS Node Status Lookup, check the node status.  In this step, a direct address is made to the IP address, which asks for a list of unique and group NeBIOS names registered by this host.  Let's start with a request to the <i>Samba</i> server from a Windows client. <br><pre> <code class="bash hljs">C:\WINDOWS\&gt; nbtstat -A 192.168.7.75 NetBIOS Remote Machine Name Table Name Type Status --------------------------------------------- TROUBLE &lt;00&gt; UNIQUE TROUBLE &lt;03&gt; UNIQUE TROUBLE &lt;20&gt; UNIQUE ..__MSBROWSE__.&lt;01&gt; GROUP Registered Registered Registered Registered Registered Registered Registered LAB LAB LAB &lt;00&gt; GROUP &lt;1D&gt; UNIQUE &lt;1E&gt; GROUP MAC Address = 00-00-00-00-00-00</code> </pre><br>  You can perform the same steps on a <i>Samba</i> server to collect customer information.  The options for querying through the <i>nmblookup</i> utility <i>are</i> generally the same as in <i>nbtstat.exe</i> . <br><pre> <code class="bash hljs">$ nmblookup -A 192.168.7.135 Looking up status of 192.168.7.135 WIN-CLIENT LAB WIN-CLIENT &lt;00&gt; - B &lt;ACTIVE&gt; &lt;00&gt; - &lt;GROUP&gt; B &lt;ACTIVE&gt; &lt;03&gt; - B &lt;ACTIVE&gt;</code> </pre><br>  If any of these requests fails, you should again check the network connection and NetBIOS interfaces that we considered earlier. <br><br>  <b>View shared resources from a Windows client</b> <br>  We have already used <i>smbclient</i> to view a list of shared resources.  Here we do the same thing, only remotely from a Windows client. <br>  The <i>net.exe</i> utility is a universal utility for working with CIFS.  This utility is equivalent to the Linux command <b>smbclient -L</b> .  The view option allows you to view the shared resources of the working group, or, if you specify a specific server name (for example, \\ TROUBLE), it will show a list of shared resources on it. <br><br>  <b>Remote connection to shared resources</b> <br>  In fact, this step is not so much a test as the goal of the whole process.  If we log into the console with the correct name and password, the following command will connect drive P: local client to the [public] <i>share</i> on the <i>TROUBLE</i> server. <br><pre> <code class="bash hljs">C:\WINDOWS\&gt; net use p: \\TROUBLE\public The <span class="hljs-built_in"><span class="hljs-built_in">command</span></span> completed successfully.</code> </pre><br>  To determine which name to connect to, you can use the option <pre> <code class="hljs pgsql"><code class="bash">/<span class="hljs-keyword"><span class="hljs-keyword">user</span></span>:: <br> C:\WINNT\&gt;net use \\TROUBLE\<span class="hljs-built_in"><span class="hljs-built_in">public</span></span> /<span class="hljs-keyword"><span class="hljs-keyword">user</span></span>:user1 The <span class="hljs-keyword"><span class="hljs-keyword">password</span></span> <span class="hljs-keyword"><span class="hljs-keyword">or</span></span> <span class="hljs-keyword"><span class="hljs-keyword">user</span></span> <span class="hljs-type"><span class="hljs-type">name</span></span> <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> invalid <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> \\TROUBLE\<span class="hljs-built_in"><span class="hljs-built_in">public</span></span>. <span class="hljs-keyword"><span class="hljs-keyword">Type</span></span> the <span class="hljs-keyword"><span class="hljs-keyword">password</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> \\TROUBLE\<span class="hljs-built_in"><span class="hljs-built_in">public</span></span>: The command completed successfully.</code> <br>    ,   .         -,    . <br> <br>  <span class="hljs-number"><span class="hljs-number">4</span></span> <br>   <br>        ‚Äî   .  ,      ,        ,          ,       :    . <br> <br>  <span class="hljs-number"><span class="hljs-number">5</span></span> <br> -    <br>           .     .     ¬´¬ª        Samba    .    ,    .       ,     . <br> <br> <b>- Samba</b> <br>   ,      . <br> <br> <img src="https://habrastorage.org/storage2/fbd/11b/b8a/fbd11bb8ada955a99b10f832b0edb4f8.png"> <br> <br>      <i>smbd</i> (,  pid <span class="hljs-number"><span class="hljs-number">1234</span></span>),    -   root: <br> <code class="bash">root# smbcontrol <span class="hljs-number"><span class="hljs-number">1234</span></span> debuglevel <span class="hljs-keyword"><span class="hljs-keyword">Current</span></span> <span class="hljs-keyword"><span class="hljs-keyword">debug</span></span> <span class="hljs-keyword"><span class="hljs-keyword">level</span></span> <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> PID <span class="hljs-number"><span class="hljs-number">1234</span></span> <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span></code> <br>        <span class="hljs-number"><span class="hljs-number">10</span></span>,     ,   : <br> <code class="bash">root# smbcontrol <span class="hljs-number"><span class="hljs-number">1234</span></span> <span class="hljs-keyword"><span class="hljs-keyword">debug</span></span> <span class="hljs-number"><span class="hljs-number">10</span></span> root# smbcontrol <span class="hljs-number"><span class="hljs-number">1234</span></span> debuglevel <span class="hljs-keyword"><span class="hljs-keyword">Current</span></span> <span class="hljs-keyword"><span class="hljs-keyword">debug</span></span> <span class="hljs-keyword"><span class="hljs-keyword">level</span></span> <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> PID <span class="hljs-number"><span class="hljs-number">1234</span></span> <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> <span class="hljs-number"><span class="hljs-number">10</span></span></code> <br>  : ¬´    ?¬ª <br>  ,      .     Windows-    .  <i>smbd</i>     .    <i>smbclient</i>  ,   : <br> <code class="bash">$ smbclient //TROUBLE/<span class="hljs-built_in"><span class="hljs-built_in">public</span></span> -U testuser%test <span class="hljs-keyword"><span class="hljs-keyword">session</span></span> setup failed: ERRSRV - ERRbadpw (Bad <span class="hljs-keyword"><span class="hljs-keyword">password</span></span> - <span class="hljs-type"><span class="hljs-type">name</span></span>/<span class="hljs-keyword"><span class="hljs-keyword">password</span></span> pair <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> a Tree <span class="hljs-keyword"><span class="hljs-keyword">Connect</span></span> <span class="hljs-keyword"><span class="hljs-keyword">or</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Session</span></span> Setup are invalid.)</code> <br>   ,   smbpasswd ,   ‚Äî test.    ,  <br> <code class="bash"><span class="hljs-keyword"><span class="hljs-keyword">log</span></span> <span class="hljs-keyword"><span class="hljs-keyword">level</span></span> = <span class="hljs-number"><span class="hljs-number">10</span></span> <span class="hljs-keyword"><span class="hljs-keyword">log</span></span> file = /usr/<span class="hljs-keyword"><span class="hljs-keyword">local</span></span>/samba/var/<span class="hljs-keyword"><span class="hljs-keyword">log</span></span>.%m</code> <br>   [<span class="hljs-keyword"><span class="hljs-keyword">global</span></span>]  <b>smb.conf</b> ,        <b><span class="hljs-keyword"><span class="hljs-keyword">log</span></span>.TROUBLE</b> : <br> <code class="bash">pdb_getsampwnam: <span class="hljs-keyword"><span class="hljs-keyword">search</span></span> <span class="hljs-keyword"><span class="hljs-keyword">by</span></span> <span class="hljs-type"><span class="hljs-type">name</span></span>: testuser startsmbfilepwent_internal: opening file /usr/<span class="hljs-keyword"><span class="hljs-keyword">local</span></span>/samba/private/smbpasswd getsmbfilepwent: <span class="hljs-keyword"><span class="hljs-keyword">returning</span></span> passwd entry <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> <span class="hljs-keyword"><span class="hljs-keyword">user</span></span> root, uid <span class="hljs-number"><span class="hljs-number">0</span></span> getsmbfilepwent: <span class="hljs-keyword"><span class="hljs-keyword">returning</span></span> passwd entry <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> <span class="hljs-keyword"><span class="hljs-keyword">user</span></span> jerry, uid <span class="hljs-number"><span class="hljs-number">786</span></span> getsmbfilepwent: <span class="hljs-keyword"><span class="hljs-keyword">returning</span></span> passwd entry <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> <span class="hljs-keyword"><span class="hljs-keyword">user</span></span> guest1, uid <span class="hljs-number"><span class="hljs-number">782</span></span> getsmbfilepwent: <span class="hljs-keyword"><span class="hljs-keyword">returning</span></span> passwd entry <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> <span class="hljs-keyword"><span class="hljs-keyword">user</span></span> testuser, uid <span class="hljs-number"><span class="hljs-number">791</span></span> endsmbfilepwent_internal: closed <span class="hljs-keyword"><span class="hljs-keyword">password</span></span> file. pdb_getsampwnam: <span class="hljs-built_in"><span class="hljs-built_in">found</span></span> <span class="hljs-keyword"><span class="hljs-keyword">by</span></span> <span class="hljs-type"><span class="hljs-type">name</span></span>: testuser build_sam_account: smbpasswd <span class="hljs-keyword"><span class="hljs-keyword">database</span></span> <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> corrupt! username testuser <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> unix passwd <span class="hljs-keyword"><span class="hljs-keyword">database</span></span>! Couldn<span class="hljs-string"><span class="hljs-string">'t find user '</span></span>testuser<span class="hljs-string"><span class="hljs-string">' in passdb.</span></span></code><span class="hljs-string"><span class="hljs-string"> </span></span><br><span class="hljs-string"><span class="hljs-string">        . </span></span><i><span class="hljs-string"><span class="hljs-string">Samba</span></span></i><span class="hljs-string"><span class="hljs-string">      testuser.   ,   -     </span></span><b><span class="hljs-string"><span class="hljs-string">/etc/passwd</span></span></b><span class="hljs-string"><span class="hljs-string"> : </span></span><br><span class="hljs-string"><span class="hljs-string"> </span></span><code class="bash"><span class="hljs-string"><span class="hljs-string">#testuser:x:791:100::/dev/null:/bin/false</span></span></code><span class="hljs-string"><span class="hljs-string"> </span></span><br><span class="hljs-string"><span class="hljs-string">  ,      (#)     ,   .     . </span></span><br><span class="hljs-string"><span class="hljs-string"> </span></span><code class="bash"><span class="hljs-string"><span class="hljs-string">$ smbclient //TROUBLE/public -U testuser%test Domain=[LAB] OS=[Unix] Server=[Samba 2.2.2] smb: \&gt;</span></span></code><span class="hljs-string"><span class="hljs-string"> </span></span><br><span class="hljs-string"><span class="hljs-string">     .      ,    </span></span><i><span class="hljs-string"><span class="hljs-string">grep</span></span></i><span class="hljs-string"><span class="hljs-string"> ,     : </span></span><br><span class="hljs-string"><span class="hljs-string"> ‚Ä¢ fail </span></span><br><span class="hljs-string"><span class="hljs-string"> ‚Ä¢ error </span></span><br><span class="hljs-string"><span class="hljs-string"> ‚Ä¢ unsuccessful </span></span><br><span class="hljs-string"><span class="hljs-string"> ‚Ä¢ corrupt </span></span><br><span class="hljs-string"><span class="hljs-string"> ‚Ä¢ unknown </span></span><br><span class="hljs-string"><span class="hljs-string"> </span></span><br><span class="hljs-string"><span class="hljs-string"> </span></span><b><span class="hljs-string"><span class="hljs-string">  </span></span></b><span class="hljs-string"><span class="hljs-string"> </span></span><br><span class="hljs-string"><span class="hljs-string">       ‚Äî    ,       .      -,  Wireshark.             . </span></span><br><span class="hljs-string"><span class="hljs-string"> </span></span><br><span class="hljs-string"><span class="hljs-string">  6 </span></span><br><span class="hljs-string"><span class="hljs-string">   Samba </span></span><br><span class="hljs-string"><span class="hljs-string">       ‚Äî ,    -  </span></span><i><span class="hljs-string"><span class="hljs-string">Samba</span></span></i><span class="hljs-string"><span class="hljs-string"> .       .         ,      </span></span><i><span class="hljs-string"><span class="hljs-string">Samba</span></span></i><span class="hljs-string"><span class="hljs-string"> ,      :     . </span></span><br><span class="hljs-string"><span class="hljs-string"> </span></span><br><span class="hljs-string"><span class="hljs-string">  </span></span><br><span class="hljs-string"><span class="hljs-string"> ,        </span></span><i><span class="hljs-string"><span class="hljs-string">Samba</span></span></i><span class="hljs-string"><span class="hljs-string"> .     ,          .     : </span></span><br><span class="hljs-string"><span class="hljs-string"> ‚Ä¢ 1.     </span></span><b><span class="hljs-string"><span class="hljs-string">smb.conf</span></span></b><span class="hljs-string"><span class="hljs-string"> . </span></span><br><span class="hljs-string"><span class="hljs-string"> ‚Ä¢ 2.    . </span></span><br><span class="hljs-string"><span class="hljs-string"> ‚Ä¢ 3.    . </span></span><br><span class="hljs-string"><span class="hljs-string"> ‚Ä¢ 4.  . </span></span><br><span class="hljs-string"><span class="hljs-string"> ‚Ä¢ 5.    . </span></span><br><span class="hljs-string"><span class="hljs-string"> ‚Ä¢ 6.   </span></span><i><span class="hljs-string"><span class="hljs-string">Samba</span></span></i><span class="hljs-string"><span class="hljs-string"> . </span></span><br><span class="hljs-string"><span class="hljs-string">   , , ,     - .              .         .        .         !</span></span></code> </pre> <code><code class="bash">/user:: <br> C:\WINNT\&gt;net use \\TROUBLE\public /user:user1 The password or user name is invalid for \\TROUBLE\public. Type the password for \\TROUBLE\public: The command completed successfully.</code> <br>    ,   .         -,    . <br> <br>  4 <br>   <br>        ‚Äî   .  ,      ,        ,          ,       :    . <br> <br>  5 <br> -    <br>           .     .     ¬´¬ª        Samba    .    ,    .       ,     . <br> <br> <b>- Samba</b> <br>   ,      . <br> <br> <img src="https://habrastorage.org/storage2/fbd/11b/b8a/fbd11bb8ada955a99b10f832b0edb4f8.png"> <br> <br>      <i>smbd</i> (,  pid 1234),    -   root: <br> <code class="bash">root# smbcontrol 1234 debuglevel Current debug level of PID 1234 is 0</code> <br>        10,     ,   : <br> <code class="bash">root# smbcontrol 1234 debug 10 root# smbcontrol 1234 debuglevel Current debug level of PID 1234 is 10</code> <br>  : ¬´    ?¬ª <br>  ,      .     Windows-    .  <i>smbd</i>     .    <i>smbclient</i>  ,   : <br> <code class="bash">$ smbclient //TROUBLE/public -U testuser%test session setup failed: ERRSRV - ERRbadpw (Bad password - name/password pair in a Tree Connect or Session Setup are invalid.)</code> <br>   ,   smbpasswd ,   ‚Äî test.    ,  <br> <code class="bash">log level = 10 log file = /usr/local/samba/var/log.%m</code> <br>   [global]  <b>smb.conf</b> ,        <b>log.TROUBLE</b> : <br> <code class="bash">pdb_getsampwnam: search by name: testuser startsmbfilepwent_internal: opening file /usr/local/samba/private/smbpasswd getsmbfilepwent: returning passwd entry for user root, uid 0 getsmbfilepwent: returning passwd entry for user jerry, uid 786 getsmbfilepwent: returning passwd entry for user guest1, uid 782 getsmbfilepwent: returning passwd entry for user testuser, uid 791 endsmbfilepwent_internal: closed password file. pdb_getsampwnam: found by name: testuser build_sam_account: smbpasswd database is corrupt! username testuser not in unix passwd database! Couldn't find user 'testuser' in passdb.</code> <br>        . <i>Samba</i>      testuser.   ,   -     <b>/etc/passwd</b> : <br> <code class="bash">#testuser:x:791:100::/dev/null:/bin/false</code> <br>  ,      (#)     ,   .     . <br> <code class="bash">$ smbclient //TROUBLE/public -U testuser%test Domain=[LAB] OS=[Unix] Server=[Samba 2.2.2] smb: \&gt;</code> <br>     .      ,    <i>grep</i> ,     : <br> ‚Ä¢ fail <br> ‚Ä¢ error <br> ‚Ä¢ unsuccessful <br> ‚Ä¢ corrupt <br> ‚Ä¢ unknown <br> <br> <b>  </b> <br>       ‚Äî    ,       .      -,  Wireshark.             . <br> <br>  6 <br>   Samba <br>       ‚Äî ,    -  <i>Samba</i> .       .         ,      <i>Samba</i> ,      :     . <br> <br>  <br> ,        <i>Samba</i> .     ,          .     : <br> ‚Ä¢ 1.     <b>smb.conf</b> . <br> ‚Ä¢ 2.    . <br> ‚Ä¢ 3.    . <br> ‚Ä¢ 4.  . <br> ‚Ä¢ 5.    . <br> ‚Ä¢ 6.   <i>Samba</i> . <br>   , , ,     - .              .         .        .         !</code> <h5> <code><code class="bash">/user:: <br> C:\WINNT\&gt;net use \\TROUBLE\public /user:user1 The password or user name is invalid for \\TROUBLE\public. Type the password for \\TROUBLE\public: The command completed successfully.</code> <br>    ,   .         -,    . <br> <br>  4 <br>   <br>        ‚Äî   .  ,      ,        ,          ,       :    . <br> <br>  5 <br> -    <br>           .     .     ¬´¬ª        Samba    .    ,    .       ,     . <br> <br> <b>- Samba</b> <br>   ,      . <br> <br> <img src="https://habrastorage.org/storage2/fbd/11b/b8a/fbd11bb8ada955a99b10f832b0edb4f8.png"> <br> <br>      <i>smbd</i> (,  pid 1234),    -   root: <br> <code class="bash">root# smbcontrol 1234 debuglevel Current debug level of PID 1234 is 0</code> <br>        10,     ,   : <br> <code class="bash">root# smbcontrol 1234 debug 10 root# smbcontrol 1234 debuglevel Current debug level of PID 1234 is 10</code> <br>  : ¬´    ?¬ª <br>  ,      .     Windows-    .  <i>smbd</i>     .    <i>smbclient</i>  ,   : <br> <code class="bash">$ smbclient //TROUBLE/public -U testuser%test session setup failed: ERRSRV - ERRbadpw (Bad password - name/password pair in a Tree Connect or Session Setup are invalid.)</code> <br>   ,   smbpasswd ,   ‚Äî test.    ,  <br> <code class="bash">log level = 10 log file = /usr/local/samba/var/log.%m</code> <br>   [global]  <b>smb.conf</b> ,        <b>log.TROUBLE</b> : <br> <code class="bash">pdb_getsampwnam: search by name: testuser startsmbfilepwent_internal: opening file /usr/local/samba/private/smbpasswd getsmbfilepwent: returning passwd entry for user root, uid 0 getsmbfilepwent: returning passwd entry for user jerry, uid 786 getsmbfilepwent: returning passwd entry for user guest1, uid 782 getsmbfilepwent: returning passwd entry for user testuser, uid 791 endsmbfilepwent_internal: closed password file. pdb_getsampwnam: found by name: testuser build_sam_account: smbpasswd database is corrupt! username testuser not in unix passwd database! Couldn't find user 'testuser' in passdb.</code> <br>        . <i>Samba</i>      testuser.   ,   -     <b>/etc/passwd</b> : <br> <code class="bash">#testuser:x:791:100::/dev/null:/bin/false</code> <br>  ,      (#)     ,   .     . <br> <code class="bash">$ smbclient //TROUBLE/public -U testuser%test Domain=[LAB] OS=[Unix] Server=[Samba 2.2.2] smb: \&gt;</code> <br>     .      ,    <i>grep</i> ,     : <br> ‚Ä¢ fail <br> ‚Ä¢ error <br> ‚Ä¢ unsuccessful <br> ‚Ä¢ corrupt <br> ‚Ä¢ unknown <br> <br> <b>  </b> <br>       ‚Äî    ,       .      -,  Wireshark.             . <br> <br>  6 <br>   Samba <br>       ‚Äî ,    -  <i>Samba</i> .       .         ,      <i>Samba</i> ,      :     . <br> <br>  <br> ,        <i>Samba</i> .     ,          .     : <br> ‚Ä¢ 1.     <b>smb.conf</b> . <br> ‚Ä¢ 2.    . <br> ‚Ä¢ 3.    . <br> ‚Ä¢ 4.  . <br> ‚Ä¢ 5.    . <br> ‚Ä¢ 6.   <i>Samba</i> . <br>   , , ,     - .              .         .        .         !</code> </h5> <code><code class="bash">/user:: <br> C:\WINNT\&gt;net use \\TROUBLE\public /user:user1 The password or user name is invalid for \\TROUBLE\public. Type the password for \\TROUBLE\public: The command completed successfully.</code> <br>    ,   .         -,    . <br> <br>  4 <br>   <br>        ‚Äî   .  ,      ,        ,          ,       :    . <br> <br>  5 <br> -    <br>           .     .     ¬´¬ª        Samba    .    ,    .       ,     . <br> <br> <b>- Samba</b> <br>   ,      . <br> <br> <img src="https://habrastorage.org/storage2/fbd/11b/b8a/fbd11bb8ada955a99b10f832b0edb4f8.png"> <br> <br>      <i>smbd</i> (,  pid 1234),    -   root: <br> <code class="bash">root# smbcontrol 1234 debuglevel Current debug level of PID 1234 is 0</code> <br>        10,     ,   : <br> <code class="bash">root# smbcontrol 1234 debug 10 root# smbcontrol 1234 debuglevel Current debug level of PID 1234 is 10</code> <br>  : ¬´    ?¬ª <br>  ,      .     Windows-    .  <i>smbd</i>     .    <i>smbclient</i>  ,   : <br> <code class="bash">$ smbclient //TROUBLE/public -U testuser%test session setup failed: ERRSRV - ERRbadpw (Bad password - name/password pair in a Tree Connect or Session Setup are invalid.)</code> <br>   ,   smbpasswd ,   ‚Äî test.    ,  <br> <code class="bash">log level = 10 log file = /usr/local/samba/var/log.%m</code> <br>   [global]  <b>smb.conf</b> ,        <b>log.TROUBLE</b> : <br> <code class="bash">pdb_getsampwnam: search by name: testuser startsmbfilepwent_internal: opening file /usr/local/samba/private/smbpasswd getsmbfilepwent: returning passwd entry for user root, uid 0 getsmbfilepwent: returning passwd entry for user jerry, uid 786 getsmbfilepwent: returning passwd entry for user guest1, uid 782 getsmbfilepwent: returning passwd entry for user testuser, uid 791 endsmbfilepwent_internal: closed password file. pdb_getsampwnam: found by name: testuser build_sam_account: smbpasswd database is corrupt! username testuser not in unix passwd database! Couldn't find user 'testuser' in passdb.</code> <br>        . <i>Samba</i>      testuser.   ,   -     <b>/etc/passwd</b> : <br> <code class="bash">#testuser:x:791:100::/dev/null:/bin/false</code> <br>  ,      (#)     ,   .     . <br> <code class="bash">$ smbclient //TROUBLE/public -U testuser%test Domain=[LAB] OS=[Unix] Server=[Samba 2.2.2] smb: \&gt;</code> <br>     .      ,    <i>grep</i> ,     : <br> ‚Ä¢ fail <br> ‚Ä¢ error <br> ‚Ä¢ unsuccessful <br> ‚Ä¢ corrupt <br> ‚Ä¢ unknown <br> <br> <b>  </b> <br>       ‚Äî    ,       .      -,  Wireshark.             . <br> <br>  6 <br>   Samba <br>       ‚Äî ,    -  <i>Samba</i> .       .         ,      <i>Samba</i> ,      :     . <br> <br>  <br> ,        <i>Samba</i> .     ,          .     : <br> ‚Ä¢ 1.     <b>smb.conf</b> . <br> ‚Ä¢ 2.    . <br> ‚Ä¢ 3.    . <br> ‚Ä¢ 4.  . <br> ‚Ä¢ 5.    . <br> ‚Ä¢ 6.   <i>Samba</i> . <br>   , , ,     - .              .         .        .         !</code> <h6> <code><code class="bash">/user:: <br> C:\WINNT\&gt;net use \\TROUBLE\public /user:user1 The password or user name is invalid for \\TROUBLE\public. Type the password for \\TROUBLE\public: The command completed successfully.</code> <br>    ,   .         -,    . <br> <br>  4 <br>   <br>        ‚Äî   .  ,      ,        ,          ,       :    . <br> <br>  5 <br> -    <br>           .     .     ¬´¬ª        Samba    .    ,    .       ,     . <br> <br> <b>- Samba</b> <br>   ,      . <br> <br> <img src="https://habrastorage.org/storage2/fbd/11b/b8a/fbd11bb8ada955a99b10f832b0edb4f8.png"> <br> <br>      <i>smbd</i> (,  pid 1234),    -   root: <br> <code class="bash">root# smbcontrol 1234 debuglevel Current debug level of PID 1234 is 0</code> <br>        10,     ,   : <br> <code class="bash">root# smbcontrol 1234 debug 10 root# smbcontrol 1234 debuglevel Current debug level of PID 1234 is 10</code> <br>  : ¬´    ?¬ª <br>  ,      .     Windows-    .  <i>smbd</i>     .    <i>smbclient</i>  ,   : <br> <code class="bash">$ smbclient //TROUBLE/public -U testuser%test session setup failed: ERRSRV - ERRbadpw (Bad password - name/password pair in a Tree Connect or Session Setup are invalid.)</code> <br>   ,   smbpasswd ,   ‚Äî test.    ,  <br> <code class="bash">log level = 10 log file = /usr/local/samba/var/log.%m</code> <br>   [global]  <b>smb.conf</b> ,        <b>log.TROUBLE</b> : <br> <code class="bash">pdb_getsampwnam: search by name: testuser startsmbfilepwent_internal: opening file /usr/local/samba/private/smbpasswd getsmbfilepwent: returning passwd entry for user root, uid 0 getsmbfilepwent: returning passwd entry for user jerry, uid 786 getsmbfilepwent: returning passwd entry for user guest1, uid 782 getsmbfilepwent: returning passwd entry for user testuser, uid 791 endsmbfilepwent_internal: closed password file. pdb_getsampwnam: found by name: testuser build_sam_account: smbpasswd database is corrupt! username testuser not in unix passwd database! Couldn't find user 'testuser' in passdb.</code> <br>        . <i>Samba</i>      testuser.   ,   -     <b>/etc/passwd</b> : <br> <code class="bash">#testuser:x:791:100::/dev/null:/bin/false</code> <br>  ,      (#)     ,   .     . <br> <code class="bash">$ smbclient //TROUBLE/public -U testuser%test Domain=[LAB] OS=[Unix] Server=[Samba 2.2.2] smb: \&gt;</code> <br>     .      ,    <i>grep</i> ,     : <br> ‚Ä¢ fail <br> ‚Ä¢ error <br> ‚Ä¢ unsuccessful <br> ‚Ä¢ corrupt <br> ‚Ä¢ unknown <br> <br> <b>  </b> <br>       ‚Äî    ,       .      -,  Wireshark.             . <br> <br>  6 <br>   Samba <br>       ‚Äî ,    -  <i>Samba</i> .       .         ,      <i>Samba</i> ,      :     . <br> <br>  <br> ,        <i>Samba</i> .     ,          .     : <br> ‚Ä¢ 1.     <b>smb.conf</b> . <br> ‚Ä¢ 2.    . <br> ‚Ä¢ 3.    . <br> ‚Ä¢ 4.  . <br> ‚Ä¢ 5.    . <br> ‚Ä¢ 6.   <i>Samba</i> . <br>   , , ,     - .              .         .        .         !</code> </h6> <code><code class="bash">/user:: <br> C:\WINNT\&gt;net use \\TROUBLE\public /user:user1 The password or user name is invalid for \\TROUBLE\public. Type the password for \\TROUBLE\public: The command completed successfully.</code> <br>    ,   .         -,    . <br> <br>  4 <br>   <br>        ‚Äî   .  ,      ,        ,          ,       :    . <br> <br>  5 <br> -    <br>           .     .     ¬´¬ª        Samba    .    ,    .       ,     . <br> <br> <b>- Samba</b> <br>   ,      . <br> <br> <img src="https://habrastorage.org/storage2/fbd/11b/b8a/fbd11bb8ada955a99b10f832b0edb4f8.png"> <br> <br>      <i>smbd</i> (,  pid 1234),    -   root: <br> <code class="bash">root# smbcontrol 1234 debuglevel Current debug level of PID 1234 is 0</code> <br>        10,     ,   : <br> <code class="bash">root# smbcontrol 1234 debug 10 root# smbcontrol 1234 debuglevel Current debug level of PID 1234 is 10</code> <br>  : ¬´    ?¬ª <br>  ,      .     Windows-    .  <i>smbd</i>     .    <i>smbclient</i>  ,   : <br> <code class="bash">$ smbclient //TROUBLE/public -U testuser%test session setup failed: ERRSRV - ERRbadpw (Bad password - name/password pair in a Tree Connect or Session Setup are invalid.)</code> <br>   ,   smbpasswd ,   ‚Äî test.    ,  <br> <code class="bash">log level = 10 log file = /usr/local/samba/var/log.%m</code> <br>   [global]  <b>smb.conf</b> ,        <b>log.TROUBLE</b> : <br> <code class="bash">pdb_getsampwnam: search by name: testuser startsmbfilepwent_internal: opening file /usr/local/samba/private/smbpasswd getsmbfilepwent: returning passwd entry for user root, uid 0 getsmbfilepwent: returning passwd entry for user jerry, uid 786 getsmbfilepwent: returning passwd entry for user guest1, uid 782 getsmbfilepwent: returning passwd entry for user testuser, uid 791 endsmbfilepwent_internal: closed password file. pdb_getsampwnam: found by name: testuser build_sam_account: smbpasswd database is corrupt! username testuser not in unix passwd database! Couldn't find user 'testuser' in passdb.</code> <br>        . <i>Samba</i>      testuser.   ,   -     <b>/etc/passwd</b> : <br> <code class="bash">#testuser:x:791:100::/dev/null:/bin/false</code> <br>  ,      (#)     ,   .     . <br> <code class="bash">$ smbclient //TROUBLE/public -U testuser%test Domain=[LAB] OS=[Unix] Server=[Samba 2.2.2] smb: \&gt;</code> <br>     .      ,    <i>grep</i> ,     : <br> ‚Ä¢ fail <br> ‚Ä¢ error <br> ‚Ä¢ unsuccessful <br> ‚Ä¢ corrupt <br> ‚Ä¢ unknown <br> <br> <b>  </b> <br>       ‚Äî    ,       .      -,  Wireshark.             . <br> <br>  6 <br>   Samba <br>       ‚Äî ,    -  <i>Samba</i> .       .         ,      <i>Samba</i> ,      :     . <br> <br>  <br> ,        <i>Samba</i> .     ,          .     : <br> ‚Ä¢ 1.     <b>smb.conf</b> . <br> ‚Ä¢ 2.    . <br> ‚Ä¢ 3.    . <br> ‚Ä¢ 4.  . <br> ‚Ä¢ 5.    . <br> ‚Ä¢ 6.   <i>Samba</i> . <br>   , , ,     - .              .         .        .         !</code> <h5> <code><code class="bash">/user:: <br> C:\WINNT\&gt;net use \\TROUBLE\public /user:user1 The password or user name is invalid for \\TROUBLE\public. Type the password for \\TROUBLE\public: The command completed successfully.</code> <br>    ,   .         -,    . <br> <br>  4 <br>   <br>        ‚Äî   .  ,      ,        ,          ,       :    . <br> <br>  5 <br> -    <br>           .     .     ¬´¬ª        Samba    .    ,    .       ,     . <br> <br> <b>- Samba</b> <br>   ,      . <br> <br> <img src="https://habrastorage.org/storage2/fbd/11b/b8a/fbd11bb8ada955a99b10f832b0edb4f8.png"> <br> <br>      <i>smbd</i> (,  pid 1234),    -   root: <br> <code class="bash">root# smbcontrol 1234 debuglevel Current debug level of PID 1234 is 0</code> <br>        10,     ,   : <br> <code class="bash">root# smbcontrol 1234 debug 10 root# smbcontrol 1234 debuglevel Current debug level of PID 1234 is 10</code> <br>  : ¬´    ?¬ª <br>  ,      .     Windows-    .  <i>smbd</i>     .    <i>smbclient</i>  ,   : <br> <code class="bash">$ smbclient //TROUBLE/public -U testuser%test session setup failed: ERRSRV - ERRbadpw (Bad password - name/password pair in a Tree Connect or Session Setup are invalid.)</code> <br>   ,   smbpasswd ,   ‚Äî test.    ,  <br> <code class="bash">log level = 10 log file = /usr/local/samba/var/log.%m</code> <br>   [global]  <b>smb.conf</b> ,        <b>log.TROUBLE</b> : <br> <code class="bash">pdb_getsampwnam: search by name: testuser startsmbfilepwent_internal: opening file /usr/local/samba/private/smbpasswd getsmbfilepwent: returning passwd entry for user root, uid 0 getsmbfilepwent: returning passwd entry for user jerry, uid 786 getsmbfilepwent: returning passwd entry for user guest1, uid 782 getsmbfilepwent: returning passwd entry for user testuser, uid 791 endsmbfilepwent_internal: closed password file. pdb_getsampwnam: found by name: testuser build_sam_account: smbpasswd database is corrupt! username testuser not in unix passwd database! Couldn't find user 'testuser' in passdb.</code> <br>        . <i>Samba</i>      testuser.   ,   -     <b>/etc/passwd</b> : <br> <code class="bash">#testuser:x:791:100::/dev/null:/bin/false</code> <br>  ,      (#)     ,   .     . <br> <code class="bash">$ smbclient //TROUBLE/public -U testuser%test Domain=[LAB] OS=[Unix] Server=[Samba 2.2.2] smb: \&gt;</code> <br>     .      ,    <i>grep</i> ,     : <br> ‚Ä¢ fail <br> ‚Ä¢ error <br> ‚Ä¢ unsuccessful <br> ‚Ä¢ corrupt <br> ‚Ä¢ unknown <br> <br> <b>  </b> <br>       ‚Äî    ,       .      -,  Wireshark.             . <br> <br>  6 <br>   Samba <br>       ‚Äî ,    -  <i>Samba</i> .       .         ,      <i>Samba</i> ,      :     . <br> <br>  <br> ,        <i>Samba</i> .     ,          .     : <br> ‚Ä¢ 1.     <b>smb.conf</b> . <br> ‚Ä¢ 2.    . <br> ‚Ä¢ 3.    . <br> ‚Ä¢ 4.  . <br> ‚Ä¢ 5.    . <br> ‚Ä¢ 6.   <i>Samba</i> . <br>   , , ,     - .              .         .        .         !</code> </h5> <code><code class="bash">/user:: <br> C:\WINNT\&gt;net use \\TROUBLE\public /user:user1 The password or user name is invalid for \\TROUBLE\public. Type the password for \\TROUBLE\public: The command completed successfully.</code> <br>    ,   .         -,    . <br> <br>  4 <br>   <br>        ‚Äî   .  ,      ,        ,          ,       :    . <br> <br>  5 <br> -    <br>           .     .     ¬´¬ª        Samba    .    ,    .       ,     . <br> <br> <b>- Samba</b> <br>   ,      . <br> <br> <img src="https://habrastorage.org/storage2/fbd/11b/b8a/fbd11bb8ada955a99b10f832b0edb4f8.png"> <br> <br>      <i>smbd</i> (,  pid 1234),    -   root: <br> <code class="bash">root# smbcontrol 1234 debuglevel Current debug level of PID 1234 is 0</code> <br>        10,     ,   : <br> <code class="bash">root# smbcontrol 1234 debug 10 root# smbcontrol 1234 debuglevel Current debug level of PID 1234 is 10</code> <br>  : ¬´    ?¬ª <br>  ,      .     Windows-    .  <i>smbd</i>     .    <i>smbclient</i>  ,   : <br> <code class="bash">$ smbclient //TROUBLE/public -U testuser%test session setup failed: ERRSRV - ERRbadpw (Bad password - name/password pair in a Tree Connect or Session Setup are invalid.)</code> <br>   ,   smbpasswd ,   ‚Äî test.    ,  <br> <code class="bash">log level = 10 log file = /usr/local/samba/var/log.%m</code> <br>   [global]  <b>smb.conf</b> ,        <b>log.TROUBLE</b> : <br> <code class="bash">pdb_getsampwnam: search by name: testuser startsmbfilepwent_internal: opening file /usr/local/samba/private/smbpasswd getsmbfilepwent: returning passwd entry for user root, uid 0 getsmbfilepwent: returning passwd entry for user jerry, uid 786 getsmbfilepwent: returning passwd entry for user guest1, uid 782 getsmbfilepwent: returning passwd entry for user testuser, uid 791 endsmbfilepwent_internal: closed password file. pdb_getsampwnam: found by name: testuser build_sam_account: smbpasswd database is corrupt! username testuser not in unix passwd database! Couldn't find user 'testuser' in passdb.</code> <br>        . <i>Samba</i>      testuser.   ,   -     <b>/etc/passwd</b> : <br> <code class="bash">#testuser:x:791:100::/dev/null:/bin/false</code> <br>  ,      (#)     ,   .     . <br> <code class="bash">$ smbclient //TROUBLE/public -U testuser%test Domain=[LAB] OS=[Unix] Server=[Samba 2.2.2] smb: \&gt;</code> <br>     .      ,    <i>grep</i> ,     : <br> ‚Ä¢ fail <br> ‚Ä¢ error <br> ‚Ä¢ unsuccessful <br> ‚Ä¢ corrupt <br> ‚Ä¢ unknown <br> <br> <b>  </b> <br>       ‚Äî    ,       .      -,  Wireshark.             . <br> <br>  6 <br>   Samba <br>       ‚Äî ,    -  <i>Samba</i> .       .         ,      <i>Samba</i> ,      :     . <br> <br>  <br> ,        <i>Samba</i> .     ,          .     : <br> ‚Ä¢ 1.     <b>smb.conf</b> . <br> ‚Ä¢ 2.    . <br> ‚Ä¢ 3.    . <br> ‚Ä¢ 4.  . <br> ‚Ä¢ 5.    . <br> ‚Ä¢ 6.   <i>Samba</i> . <br>   , , ,     - .              .         .        .         !</code> <h6> <code><code class="bash">/user:: <br> C:\WINNT\&gt;net use \\TROUBLE\public /user:user1 The password or user name is invalid for \\TROUBLE\public. Type the password for \\TROUBLE\public: The command completed successfully.</code> <br>    ,   .         -,    . <br> <br>  4 <br>   <br>        ‚Äî   .  ,      ,        ,          ,       :    . <br> <br>  5 <br> -    <br>           .     .     ¬´¬ª        Samba    .    ,    .       ,     . <br> <br> <b>- Samba</b> <br>   ,      . <br> <br> <img src="https://habrastorage.org/storage2/fbd/11b/b8a/fbd11bb8ada955a99b10f832b0edb4f8.png"> <br> <br>      <i>smbd</i> (,  pid 1234),    -   root: <br> <code class="bash">root# smbcontrol 1234 debuglevel Current debug level of PID 1234 is 0</code> <br>        10,     ,   : <br> <code class="bash">root# smbcontrol 1234 debug 10 root# smbcontrol 1234 debuglevel Current debug level of PID 1234 is 10</code> <br>  : ¬´    ?¬ª <br>  ,      .     Windows-    .  <i>smbd</i>     .    <i>smbclient</i>  ,   : <br> <code class="bash">$ smbclient //TROUBLE/public -U testuser%test session setup failed: ERRSRV - ERRbadpw (Bad password - name/password pair in a Tree Connect or Session Setup are invalid.)</code> <br>   ,   smbpasswd ,   ‚Äî test.    ,  <br> <code class="bash">log level = 10 log file = /usr/local/samba/var/log.%m</code> <br>   [global]  <b>smb.conf</b> ,        <b>log.TROUBLE</b> : <br> <code class="bash">pdb_getsampwnam: search by name: testuser startsmbfilepwent_internal: opening file /usr/local/samba/private/smbpasswd getsmbfilepwent: returning passwd entry for user root, uid 0 getsmbfilepwent: returning passwd entry for user jerry, uid 786 getsmbfilepwent: returning passwd entry for user guest1, uid 782 getsmbfilepwent: returning passwd entry for user testuser, uid 791 endsmbfilepwent_internal: closed password file. pdb_getsampwnam: found by name: testuser build_sam_account: smbpasswd database is corrupt! username testuser not in unix passwd database! Couldn't find user 'testuser' in passdb.</code> <br>        . <i>Samba</i>      testuser.   ,   -     <b>/etc/passwd</b> : <br> <code class="bash">#testuser:x:791:100::/dev/null:/bin/false</code> <br>  ,      (#)     ,   .     . <br> <code class="bash">$ smbclient //TROUBLE/public -U testuser%test Domain=[LAB] OS=[Unix] Server=[Samba 2.2.2] smb: \&gt;</code> <br>     .      ,    <i>grep</i> ,     : <br> ‚Ä¢ fail <br> ‚Ä¢ error <br> ‚Ä¢ unsuccessful <br> ‚Ä¢ corrupt <br> ‚Ä¢ unknown <br> <br> <b>  </b> <br>       ‚Äî    ,       .      -,  Wireshark.             . <br> <br>  6 <br>   Samba <br>       ‚Äî ,    -  <i>Samba</i> .       .         ,      <i>Samba</i> ,      :     . <br> <br>  <br> ,        <i>Samba</i> .     ,          .     : <br> ‚Ä¢ 1.     <b>smb.conf</b> . <br> ‚Ä¢ 2.    . <br> ‚Ä¢ 3.    . <br> ‚Ä¢ 4.  . <br> ‚Ä¢ 5.    . <br> ‚Ä¢ 6.   <i>Samba</i> . <br>   , , ,     - .              .         .        .         !</code> </h6> <code><code class="bash">/user:: <br> C:\WINNT\&gt;net use \\TROUBLE\public /user:user1 The password or user name is invalid for \\TROUBLE\public. Type the password for \\TROUBLE\public: The command completed successfully.</code> <br>    ,   .         -,    . <br> <br>  4 <br>   <br>        ‚Äî   .  ,      ,        ,          ,       :    . <br> <br>  5 <br> -    <br>           .     .     ¬´¬ª        Samba    .    ,    .       ,     . <br> <br> <b>- Samba</b> <br>   ,      . <br> <br> <img src="https://habrastorage.org/storage2/fbd/11b/b8a/fbd11bb8ada955a99b10f832b0edb4f8.png"> <br> <br>      <i>smbd</i> (,  pid 1234),    -   root: <br> <code class="bash">root# smbcontrol 1234 debuglevel Current debug level of PID 1234 is 0</code> <br>        10,     ,   : <br> <code class="bash">root# smbcontrol 1234 debug 10 root# smbcontrol 1234 debuglevel Current debug level of PID 1234 is 10</code> <br>  : ¬´    ?¬ª <br>  ,      .     Windows-    .  <i>smbd</i>     .    <i>smbclient</i>  ,   : <br> <code class="bash">$ smbclient //TROUBLE/public -U testuser%test session setup failed: ERRSRV - ERRbadpw (Bad password - name/password pair in a Tree Connect or Session Setup are invalid.)</code> <br>   ,   smbpasswd ,   ‚Äî test.    ,  <br> <code class="bash">log level = 10 log file = /usr/local/samba/var/log.%m</code> <br>   [global]  <b>smb.conf</b> ,        <b>log.TROUBLE</b> : <br> <code class="bash">pdb_getsampwnam: search by name: testuser startsmbfilepwent_internal: opening file /usr/local/samba/private/smbpasswd getsmbfilepwent: returning passwd entry for user root, uid 0 getsmbfilepwent: returning passwd entry for user jerry, uid 786 getsmbfilepwent: returning passwd entry for user guest1, uid 782 getsmbfilepwent: returning passwd entry for user testuser, uid 791 endsmbfilepwent_internal: closed password file. pdb_getsampwnam: found by name: testuser build_sam_account: smbpasswd database is corrupt! username testuser not in unix passwd database! Couldn't find user 'testuser' in passdb.</code> <br>        . <i>Samba</i>      testuser.   ,   -     <b>/etc/passwd</b> : <br> <code class="bash">#testuser:x:791:100::/dev/null:/bin/false</code> <br>  ,      (#)     ,   .     . <br> <code class="bash">$ smbclient //TROUBLE/public -U testuser%test Domain=[LAB] OS=[Unix] Server=[Samba 2.2.2] smb: \&gt;</code> <br>     .      ,    <i>grep</i> ,     : <br> ‚Ä¢ fail <br> ‚Ä¢ error <br> ‚Ä¢ unsuccessful <br> ‚Ä¢ corrupt <br> ‚Ä¢ unknown <br> <br> <b>  </b> <br>       ‚Äî    ,       .      -,  Wireshark.             . <br> <br>  6 <br>   Samba <br>       ‚Äî ,    -  <i>Samba</i> .       .         ,      <i>Samba</i> ,      :     . <br> <br>  <br> ,        <i>Samba</i> .     ,          .     : <br> ‚Ä¢ 1.     <b>smb.conf</b> . <br> ‚Ä¢ 2.    . <br> ‚Ä¢ 3.    . <br> ‚Ä¢ 4.  . <br> ‚Ä¢ 5.    . <br> ‚Ä¢ 6.   <i>Samba</i> . <br>   , , ,     - .              .         .        .         !</code> <pre> <code class="hljs pgsql"><code class="bash">/<span class="hljs-keyword"><span class="hljs-keyword">user</span></span>:: <br> C:\WINNT\&gt;net use \\TROUBLE\<span class="hljs-built_in"><span class="hljs-built_in">public</span></span> /<span class="hljs-keyword"><span class="hljs-keyword">user</span></span>:user1 The <span class="hljs-keyword"><span class="hljs-keyword">password</span></span> <span class="hljs-keyword"><span class="hljs-keyword">or</span></span> <span class="hljs-keyword"><span class="hljs-keyword">user</span></span> <span class="hljs-type"><span class="hljs-type">name</span></span> <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> invalid <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> \\TROUBLE\<span class="hljs-built_in"><span class="hljs-built_in">public</span></span>. <span class="hljs-keyword"><span class="hljs-keyword">Type</span></span> the <span class="hljs-keyword"><span class="hljs-keyword">password</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> \\TROUBLE\<span class="hljs-built_in"><span class="hljs-built_in">public</span></span>: The command completed successfully.</code> <br>    ,   .         -,    . <br> <br>  <span class="hljs-number"><span class="hljs-number">4</span></span> <br>   <br>        ‚Äî   .  ,      ,        ,          ,       :    . <br> <br>  <span class="hljs-number"><span class="hljs-number">5</span></span> <br> -    <br>           .     .     ¬´¬ª        Samba    .    ,    .       ,     . <br> <br> <b>- Samba</b> <br>   ,      . <br> <br> <img src="https://habrastorage.org/storage2/fbd/11b/b8a/fbd11bb8ada955a99b10f832b0edb4f8.png"> <br> <br>      <i>smbd</i> (,  pid <span class="hljs-number"><span class="hljs-number">1234</span></span>),    -   root: <br> <code class="bash">root# smbcontrol <span class="hljs-number"><span class="hljs-number">1234</span></span> debuglevel <span class="hljs-keyword"><span class="hljs-keyword">Current</span></span> <span class="hljs-keyword"><span class="hljs-keyword">debug</span></span> <span class="hljs-keyword"><span class="hljs-keyword">level</span></span> <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> PID <span class="hljs-number"><span class="hljs-number">1234</span></span> <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span></code> <br>        <span class="hljs-number"><span class="hljs-number">10</span></span>,     ,   : <br> <code class="bash">root# smbcontrol <span class="hljs-number"><span class="hljs-number">1234</span></span> <span class="hljs-keyword"><span class="hljs-keyword">debug</span></span> <span class="hljs-number"><span class="hljs-number">10</span></span> root# smbcontrol <span class="hljs-number"><span class="hljs-number">1234</span></span> debuglevel <span class="hljs-keyword"><span class="hljs-keyword">Current</span></span> <span class="hljs-keyword"><span class="hljs-keyword">debug</span></span> <span class="hljs-keyword"><span class="hljs-keyword">level</span></span> <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> PID <span class="hljs-number"><span class="hljs-number">1234</span></span> <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> <span class="hljs-number"><span class="hljs-number">10</span></span></code> <br>  : ¬´    ?¬ª <br>  ,      .     Windows-    .  <i>smbd</i>     .    <i>smbclient</i>  ,   : <br> <code class="bash">$ smbclient //TROUBLE/<span class="hljs-built_in"><span class="hljs-built_in">public</span></span> -U testuser%test <span class="hljs-keyword"><span class="hljs-keyword">session</span></span> setup failed: ERRSRV - ERRbadpw (Bad <span class="hljs-keyword"><span class="hljs-keyword">password</span></span> - <span class="hljs-type"><span class="hljs-type">name</span></span>/<span class="hljs-keyword"><span class="hljs-keyword">password</span></span> pair <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> a Tree <span class="hljs-keyword"><span class="hljs-keyword">Connect</span></span> <span class="hljs-keyword"><span class="hljs-keyword">or</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Session</span></span> Setup are invalid.)</code> <br>   ,   smbpasswd ,   ‚Äî test.    ,  <br> <code class="bash"><span class="hljs-keyword"><span class="hljs-keyword">log</span></span> <span class="hljs-keyword"><span class="hljs-keyword">level</span></span> = <span class="hljs-number"><span class="hljs-number">10</span></span> <span class="hljs-keyword"><span class="hljs-keyword">log</span></span> file = /usr/<span class="hljs-keyword"><span class="hljs-keyword">local</span></span>/samba/var/<span class="hljs-keyword"><span class="hljs-keyword">log</span></span>.%m</code> <br>   [<span class="hljs-keyword"><span class="hljs-keyword">global</span></span>]  <b>smb.conf</b> ,        <b><span class="hljs-keyword"><span class="hljs-keyword">log</span></span>.TROUBLE</b> : <br> <code class="bash">pdb_getsampwnam: <span class="hljs-keyword"><span class="hljs-keyword">search</span></span> <span class="hljs-keyword"><span class="hljs-keyword">by</span></span> <span class="hljs-type"><span class="hljs-type">name</span></span>: testuser startsmbfilepwent_internal: opening file /usr/<span class="hljs-keyword"><span class="hljs-keyword">local</span></span>/samba/private/smbpasswd getsmbfilepwent: <span class="hljs-keyword"><span class="hljs-keyword">returning</span></span> passwd entry <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> <span class="hljs-keyword"><span class="hljs-keyword">user</span></span> root, uid <span class="hljs-number"><span class="hljs-number">0</span></span> getsmbfilepwent: <span class="hljs-keyword"><span class="hljs-keyword">returning</span></span> passwd entry <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> <span class="hljs-keyword"><span class="hljs-keyword">user</span></span> jerry, uid <span class="hljs-number"><span class="hljs-number">786</span></span> getsmbfilepwent: <span class="hljs-keyword"><span class="hljs-keyword">returning</span></span> passwd entry <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> <span class="hljs-keyword"><span class="hljs-keyword">user</span></span> guest1, uid <span class="hljs-number"><span class="hljs-number">782</span></span> getsmbfilepwent: <span class="hljs-keyword"><span class="hljs-keyword">returning</span></span> passwd entry <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> <span class="hljs-keyword"><span class="hljs-keyword">user</span></span> testuser, uid <span class="hljs-number"><span class="hljs-number">791</span></span> endsmbfilepwent_internal: closed <span class="hljs-keyword"><span class="hljs-keyword">password</span></span> file. pdb_getsampwnam: <span class="hljs-built_in"><span class="hljs-built_in">found</span></span> <span class="hljs-keyword"><span class="hljs-keyword">by</span></span> <span class="hljs-type"><span class="hljs-type">name</span></span>: testuser build_sam_account: smbpasswd <span class="hljs-keyword"><span class="hljs-keyword">database</span></span> <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> corrupt! username testuser <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> unix passwd <span class="hljs-keyword"><span class="hljs-keyword">database</span></span>! Couldn<span class="hljs-string"><span class="hljs-string">'t find user '</span></span>testuser<span class="hljs-string"><span class="hljs-string">' in passdb.</span></span></code><span class="hljs-string"><span class="hljs-string"> </span></span><br><span class="hljs-string"><span class="hljs-string">        . </span></span><i><span class="hljs-string"><span class="hljs-string">Samba</span></span></i><span class="hljs-string"><span class="hljs-string">      testuser.   ,   -     </span></span><b><span class="hljs-string"><span class="hljs-string">/etc/passwd</span></span></b><span class="hljs-string"><span class="hljs-string"> : </span></span><br><span class="hljs-string"><span class="hljs-string"> </span></span><code class="bash"><span class="hljs-string"><span class="hljs-string">#testuser:x:791:100::/dev/null:/bin/false</span></span></code><span class="hljs-string"><span class="hljs-string"> </span></span><br><span class="hljs-string"><span class="hljs-string">  ,      (#)     ,   .     . </span></span><br><span class="hljs-string"><span class="hljs-string"> </span></span><code class="bash"><span class="hljs-string"><span class="hljs-string">$ smbclient //TROUBLE/public -U testuser%test Domain=[LAB] OS=[Unix] Server=[Samba 2.2.2] smb: \&gt;</span></span></code><span class="hljs-string"><span class="hljs-string"> </span></span><br><span class="hljs-string"><span class="hljs-string">     .      ,    </span></span><i><span class="hljs-string"><span class="hljs-string">grep</span></span></i><span class="hljs-string"><span class="hljs-string"> ,     : </span></span><br><span class="hljs-string"><span class="hljs-string"> ‚Ä¢ fail </span></span><br><span class="hljs-string"><span class="hljs-string"> ‚Ä¢ error </span></span><br><span class="hljs-string"><span class="hljs-string"> ‚Ä¢ unsuccessful </span></span><br><span class="hljs-string"><span class="hljs-string"> ‚Ä¢ corrupt </span></span><br><span class="hljs-string"><span class="hljs-string"> ‚Ä¢ unknown </span></span><br><span class="hljs-string"><span class="hljs-string"> </span></span><br><span class="hljs-string"><span class="hljs-string"> </span></span><b><span class="hljs-string"><span class="hljs-string">  </span></span></b><span class="hljs-string"><span class="hljs-string"> </span></span><br><span class="hljs-string"><span class="hljs-string">       ‚Äî    ,       .      -,  Wireshark.             . </span></span><br><span class="hljs-string"><span class="hljs-string"> </span></span><br><span class="hljs-string"><span class="hljs-string">  6 </span></span><br><span class="hljs-string"><span class="hljs-string">   Samba </span></span><br><span class="hljs-string"><span class="hljs-string">       ‚Äî ,    -  </span></span><i><span class="hljs-string"><span class="hljs-string">Samba</span></span></i><span class="hljs-string"><span class="hljs-string"> .       .         ,      </span></span><i><span class="hljs-string"><span class="hljs-string">Samba</span></span></i><span class="hljs-string"><span class="hljs-string"> ,      :     . </span></span><br><span class="hljs-string"><span class="hljs-string"> </span></span><br><span class="hljs-string"><span class="hljs-string">  </span></span><br><span class="hljs-string"><span class="hljs-string"> ,        </span></span><i><span class="hljs-string"><span class="hljs-string">Samba</span></span></i><span class="hljs-string"><span class="hljs-string"> .     ,          .     : </span></span><br><span class="hljs-string"><span class="hljs-string"> ‚Ä¢ 1.     </span></span><b><span class="hljs-string"><span class="hljs-string">smb.conf</span></span></b><span class="hljs-string"><span class="hljs-string"> . </span></span><br><span class="hljs-string"><span class="hljs-string"> ‚Ä¢ 2.    . </span></span><br><span class="hljs-string"><span class="hljs-string"> ‚Ä¢ 3.    . </span></span><br><span class="hljs-string"><span class="hljs-string"> ‚Ä¢ 4.  . </span></span><br><span class="hljs-string"><span class="hljs-string"> ‚Ä¢ 5.    . </span></span><br><span class="hljs-string"><span class="hljs-string"> ‚Ä¢ 6.   </span></span><i><span class="hljs-string"><span class="hljs-string">Samba</span></span></i><span class="hljs-string"><span class="hljs-string"> . </span></span><br><span class="hljs-string"><span class="hljs-string">   , , ,     - .              .         .        .         !</span></span></code> </pre> <code><code class="bash">/user:: <br> C:\WINNT\&gt;net use \\TROUBLE\public /user:user1 The password or user name is invalid for \\TROUBLE\public. Type the password for \\TROUBLE\public: The command completed successfully.</code> <br>    ,   .         -,    . <br> <br>  4 <br>   <br>        ‚Äî   .  ,      ,        ,          ,       :    . <br> <br>  5 <br> -    <br>           .     .     ¬´¬ª        Samba    .    ,    .       ,     . <br> <br> <b>- Samba</b> <br>   ,      . <br> <br> <img src="https://habrastorage.org/storage2/fbd/11b/b8a/fbd11bb8ada955a99b10f832b0edb4f8.png"> <br> <br>      <i>smbd</i> (,  pid 1234),    -   root: <br> <code class="bash">root# smbcontrol 1234 debuglevel Current debug level of PID 1234 is 0</code> <br>        10,     ,   : <br> <code class="bash">root# smbcontrol 1234 debug 10 root# smbcontrol 1234 debuglevel Current debug level of PID 1234 is 10</code> <br>  : ¬´    ?¬ª <br>  ,      .     Windows-    .  <i>smbd</i>     .    <i>smbclient</i>  ,   : <br> <code class="bash">$ smbclient //TROUBLE/public -U testuser%test session setup failed: ERRSRV - ERRbadpw (Bad password - name/password pair in a Tree Connect or Session Setup are invalid.)</code> <br>   ,   smbpasswd ,   ‚Äî test.    ,  <br> <code class="bash">log level = 10 log file = /usr/local/samba/var/log.%m</code> <br>   [global]  <b>smb.conf</b> ,        <b>log.TROUBLE</b> : <br> <code class="bash">pdb_getsampwnam: search by name: testuser startsmbfilepwent_internal: opening file /usr/local/samba/private/smbpasswd getsmbfilepwent: returning passwd entry for user root, uid 0 getsmbfilepwent: returning passwd entry for user jerry, uid 786 getsmbfilepwent: returning passwd entry for user guest1, uid 782 getsmbfilepwent: returning passwd entry for user testuser, uid 791 endsmbfilepwent_internal: closed password file. pdb_getsampwnam: found by name: testuser build_sam_account: smbpasswd database is corrupt! username testuser not in unix passwd database! Couldn't find user 'testuser' in passdb.</code> <br>        . <i>Samba</i>      testuser.   ,   -     <b>/etc/passwd</b> : <br> <code class="bash">#testuser:x:791:100::/dev/null:/bin/false</code> <br>  ,      (#)     ,   .     . <br> <code class="bash">$ smbclient //TROUBLE/public -U testuser%test Domain=[LAB] OS=[Unix] Server=[Samba 2.2.2] smb: \&gt;</code> <br>     .      ,    <i>grep</i> ,     : <br> ‚Ä¢ fail <br> ‚Ä¢ error <br> ‚Ä¢ unsuccessful <br> ‚Ä¢ corrupt <br> ‚Ä¢ unknown <br> <br> <b>  </b> <br>       ‚Äî    ,       .      -,  Wireshark.             . <br> <br>  6 <br>   Samba <br>       ‚Äî ,    -  <i>Samba</i> .       .         ,      <i>Samba</i> ,      :     . <br> <br>  <br> ,        <i>Samba</i> .     ,          .     : <br> ‚Ä¢ 1.     <b>smb.conf</b> . <br> ‚Ä¢ 2.    . <br> ‚Ä¢ 3.    . <br> ‚Ä¢ 4.  . <br> ‚Ä¢ 5.    . <br> ‚Ä¢ 6.   <i>Samba</i> . <br>   , , ,     - .              .         .        .         !</code> <pre> <code class="hljs pgsql"><code class="bash">/<span class="hljs-keyword"><span class="hljs-keyword">user</span></span>:: <br> C:\WINNT\&gt;net use \\TROUBLE\<span class="hljs-built_in"><span class="hljs-built_in">public</span></span> /<span class="hljs-keyword"><span class="hljs-keyword">user</span></span>:user1 The <span class="hljs-keyword"><span class="hljs-keyword">password</span></span> <span class="hljs-keyword"><span class="hljs-keyword">or</span></span> <span class="hljs-keyword"><span class="hljs-keyword">user</span></span> <span class="hljs-type"><span class="hljs-type">name</span></span> <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> invalid <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> \\TROUBLE\<span class="hljs-built_in"><span class="hljs-built_in">public</span></span>. <span class="hljs-keyword"><span class="hljs-keyword">Type</span></span> the <span class="hljs-keyword"><span class="hljs-keyword">password</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> \\TROUBLE\<span class="hljs-built_in"><span class="hljs-built_in">public</span></span>: The command completed successfully.</code> <br>    ,   .         -,    . <br> <br>  <span class="hljs-number"><span class="hljs-number">4</span></span> <br>   <br>        ‚Äî   .  ,      ,        ,          ,       :    . <br> <br>  <span class="hljs-number"><span class="hljs-number">5</span></span> <br> -    <br>           .     .     ¬´¬ª        Samba    .    ,    .       ,     . <br> <br> <b>- Samba</b> <br>   ,      . <br> <br> <img src="https://habrastorage.org/storage2/fbd/11b/b8a/fbd11bb8ada955a99b10f832b0edb4f8.png"> <br> <br>      <i>smbd</i> (,  pid <span class="hljs-number"><span class="hljs-number">1234</span></span>),    -   root: <br> <code class="bash">root# smbcontrol <span class="hljs-number"><span class="hljs-number">1234</span></span> debuglevel <span class="hljs-keyword"><span class="hljs-keyword">Current</span></span> <span class="hljs-keyword"><span class="hljs-keyword">debug</span></span> <span class="hljs-keyword"><span class="hljs-keyword">level</span></span> <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> PID <span class="hljs-number"><span class="hljs-number">1234</span></span> <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span></code> <br>        <span class="hljs-number"><span class="hljs-number">10</span></span>,     ,   : <br> <code class="bash">root# smbcontrol <span class="hljs-number"><span class="hljs-number">1234</span></span> <span class="hljs-keyword"><span class="hljs-keyword">debug</span></span> <span class="hljs-number"><span class="hljs-number">10</span></span> root# smbcontrol <span class="hljs-number"><span class="hljs-number">1234</span></span> debuglevel <span class="hljs-keyword"><span class="hljs-keyword">Current</span></span> <span class="hljs-keyword"><span class="hljs-keyword">debug</span></span> <span class="hljs-keyword"><span class="hljs-keyword">level</span></span> <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> PID <span class="hljs-number"><span class="hljs-number">1234</span></span> <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> <span class="hljs-number"><span class="hljs-number">10</span></span></code> <br>  : ¬´    ?¬ª <br>  ,      .     Windows-    .  <i>smbd</i>     .    <i>smbclient</i>  ,   : <br> <code class="bash">$ smbclient //TROUBLE/<span class="hljs-built_in"><span class="hljs-built_in">public</span></span> -U testuser%test <span class="hljs-keyword"><span class="hljs-keyword">session</span></span> setup failed: ERRSRV - ERRbadpw (Bad <span class="hljs-keyword"><span class="hljs-keyword">password</span></span> - <span class="hljs-type"><span class="hljs-type">name</span></span>/<span class="hljs-keyword"><span class="hljs-keyword">password</span></span> pair <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> a Tree <span class="hljs-keyword"><span class="hljs-keyword">Connect</span></span> <span class="hljs-keyword"><span class="hljs-keyword">or</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Session</span></span> Setup are invalid.)</code> <br>   ,   smbpasswd ,   ‚Äî test.    ,  <br> <code class="bash"><span class="hljs-keyword"><span class="hljs-keyword">log</span></span> <span class="hljs-keyword"><span class="hljs-keyword">level</span></span> = <span class="hljs-number"><span class="hljs-number">10</span></span> <span class="hljs-keyword"><span class="hljs-keyword">log</span></span> file = /usr/<span class="hljs-keyword"><span class="hljs-keyword">local</span></span>/samba/var/<span class="hljs-keyword"><span class="hljs-keyword">log</span></span>.%m</code> <br>   [<span class="hljs-keyword"><span class="hljs-keyword">global</span></span>]  <b>smb.conf</b> ,        <b><span class="hljs-keyword"><span class="hljs-keyword">log</span></span>.TROUBLE</b> : <br> <code class="bash">pdb_getsampwnam: <span class="hljs-keyword"><span class="hljs-keyword">search</span></span> <span class="hljs-keyword"><span class="hljs-keyword">by</span></span> <span class="hljs-type"><span class="hljs-type">name</span></span>: testuser startsmbfilepwent_internal: opening file /usr/<span class="hljs-keyword"><span class="hljs-keyword">local</span></span>/samba/private/smbpasswd getsmbfilepwent: <span class="hljs-keyword"><span class="hljs-keyword">returning</span></span> passwd entry <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> <span class="hljs-keyword"><span class="hljs-keyword">user</span></span> root, uid <span class="hljs-number"><span class="hljs-number">0</span></span> getsmbfilepwent: <span class="hljs-keyword"><span class="hljs-keyword">returning</span></span> passwd entry <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> <span class="hljs-keyword"><span class="hljs-keyword">user</span></span> jerry, uid <span class="hljs-number"><span class="hljs-number">786</span></span> getsmbfilepwent: <span class="hljs-keyword"><span class="hljs-keyword">returning</span></span> passwd entry <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> <span class="hljs-keyword"><span class="hljs-keyword">user</span></span> guest1, uid <span class="hljs-number"><span class="hljs-number">782</span></span> getsmbfilepwent: <span class="hljs-keyword"><span class="hljs-keyword">returning</span></span> passwd entry <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> <span class="hljs-keyword"><span class="hljs-keyword">user</span></span> testuser, uid <span class="hljs-number"><span class="hljs-number">791</span></span> endsmbfilepwent_internal: closed <span class="hljs-keyword"><span class="hljs-keyword">password</span></span> file. pdb_getsampwnam: <span class="hljs-built_in"><span class="hljs-built_in">found</span></span> <span class="hljs-keyword"><span class="hljs-keyword">by</span></span> <span class="hljs-type"><span class="hljs-type">name</span></span>: testuser build_sam_account: smbpasswd <span class="hljs-keyword"><span class="hljs-keyword">database</span></span> <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> corrupt! username testuser <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> unix passwd <span class="hljs-keyword"><span class="hljs-keyword">database</span></span>! Couldn<span class="hljs-string"><span class="hljs-string">'t find user '</span></span>testuser<span class="hljs-string"><span class="hljs-string">' in passdb.</span></span></code><span class="hljs-string"><span class="hljs-string"> </span></span><br><span class="hljs-string"><span class="hljs-string">        . </span></span><i><span class="hljs-string"><span class="hljs-string">Samba</span></span></i><span class="hljs-string"><span class="hljs-string">      testuser.   ,   -     </span></span><b><span class="hljs-string"><span class="hljs-string">/etc/passwd</span></span></b><span class="hljs-string"><span class="hljs-string"> : </span></span><br><span class="hljs-string"><span class="hljs-string"> </span></span><code class="bash"><span class="hljs-string"><span class="hljs-string">#testuser:x:791:100::/dev/null:/bin/false</span></span></code><span class="hljs-string"><span class="hljs-string"> </span></span><br><span class="hljs-string"><span class="hljs-string">  ,      (#)     ,   .     . </span></span><br><span class="hljs-string"><span class="hljs-string"> </span></span><code class="bash"><span class="hljs-string"><span class="hljs-string">$ smbclient //TROUBLE/public -U testuser%test Domain=[LAB] OS=[Unix] Server=[Samba 2.2.2] smb: \&gt;</span></span></code><span class="hljs-string"><span class="hljs-string"> </span></span><br><span class="hljs-string"><span class="hljs-string">     .      ,    </span></span><i><span class="hljs-string"><span class="hljs-string">grep</span></span></i><span class="hljs-string"><span class="hljs-string"> ,     : </span></span><br><span class="hljs-string"><span class="hljs-string"> ‚Ä¢ fail </span></span><br><span class="hljs-string"><span class="hljs-string"> ‚Ä¢ error </span></span><br><span class="hljs-string"><span class="hljs-string"> ‚Ä¢ unsuccessful </span></span><br><span class="hljs-string"><span class="hljs-string"> ‚Ä¢ corrupt </span></span><br><span class="hljs-string"><span class="hljs-string"> ‚Ä¢ unknown </span></span><br><span class="hljs-string"><span class="hljs-string"> </span></span><br><span class="hljs-string"><span class="hljs-string"> </span></span><b><span class="hljs-string"><span class="hljs-string">  </span></span></b><span class="hljs-string"><span class="hljs-string"> </span></span><br><span class="hljs-string"><span class="hljs-string">       ‚Äî    ,       .      -,  Wireshark.             . </span></span><br><span class="hljs-string"><span class="hljs-string"> </span></span><br><span class="hljs-string"><span class="hljs-string">  6 </span></span><br><span class="hljs-string"><span class="hljs-string">   Samba </span></span><br><span class="hljs-string"><span class="hljs-string">       ‚Äî ,    -  </span></span><i><span class="hljs-string"><span class="hljs-string">Samba</span></span></i><span class="hljs-string"><span class="hljs-string"> .       .         ,      </span></span><i><span class="hljs-string"><span class="hljs-string">Samba</span></span></i><span class="hljs-string"><span class="hljs-string"> ,      :     . </span></span><br><span class="hljs-string"><span class="hljs-string"> </span></span><br><span class="hljs-string"><span class="hljs-string">  </span></span><br><span class="hljs-string"><span class="hljs-string"> ,        </span></span><i><span class="hljs-string"><span class="hljs-string">Samba</span></span></i><span class="hljs-string"><span class="hljs-string"> .     ,          .     : </span></span><br><span class="hljs-string"><span class="hljs-string"> ‚Ä¢ 1.     </span></span><b><span class="hljs-string"><span class="hljs-string">smb.conf</span></span></b><span class="hljs-string"><span class="hljs-string"> . </span></span><br><span class="hljs-string"><span class="hljs-string"> ‚Ä¢ 2.    . </span></span><br><span class="hljs-string"><span class="hljs-string"> ‚Ä¢ 3.    . </span></span><br><span class="hljs-string"><span class="hljs-string"> ‚Ä¢ 4.  . </span></span><br><span class="hljs-string"><span class="hljs-string"> ‚Ä¢ 5.    . </span></span><br><span class="hljs-string"><span class="hljs-string"> ‚Ä¢ 6.   </span></span><i><span class="hljs-string"><span class="hljs-string">Samba</span></span></i><span class="hljs-string"><span class="hljs-string"> . </span></span><br><span class="hljs-string"><span class="hljs-string">   , , ,     - .              .         .        .         !</span></span></code> </pre> <code><code class="bash">/user:: <br> C:\WINNT\&gt;net use \\TROUBLE\public /user:user1 The password or user name is invalid for \\TROUBLE\public. Type the password for \\TROUBLE\public: The command completed successfully.</code> <br>    ,   .         -,    . <br> <br>  4 <br>   <br>        ‚Äî   .  ,      ,        ,          ,       :    . <br> <br>  5 <br> -    <br>           .     .     ¬´¬ª        Samba    .    ,    .       ,     . <br> <br> <b>- Samba</b> <br>   ,      . <br> <br> <img src="https://habrastorage.org/storage2/fbd/11b/b8a/fbd11bb8ada955a99b10f832b0edb4f8.png"> <br> <br>      <i>smbd</i> (,  pid 1234),    -   root: <br> <code class="bash">root# smbcontrol 1234 debuglevel Current debug level of PID 1234 is 0</code> <br>        10,     ,   : <br> <code class="bash">root# smbcontrol 1234 debug 10 root# smbcontrol 1234 debuglevel Current debug level of PID 1234 is 10</code> <br>  : ¬´    ?¬ª <br>  ,      .     Windows-    .  <i>smbd</i>     .    <i>smbclient</i>  ,   : <br> <code class="bash">$ smbclient //TROUBLE/public -U testuser%test session setup failed: ERRSRV - ERRbadpw (Bad password - name/password pair in a Tree Connect or Session Setup are invalid.)</code> <br>   ,   smbpasswd ,   ‚Äî test.    ,  <br> <code class="bash">log level = 10 log file = /usr/local/samba/var/log.%m</code> <br>   [global]  <b>smb.conf</b> ,        <b>log.TROUBLE</b> : <br> <code class="bash">pdb_getsampwnam: search by name: testuser startsmbfilepwent_internal: opening file /usr/local/samba/private/smbpasswd getsmbfilepwent: returning passwd entry for user root, uid 0 getsmbfilepwent: returning passwd entry for user jerry, uid 786 getsmbfilepwent: returning passwd entry for user guest1, uid 782 getsmbfilepwent: returning passwd entry for user testuser, uid 791 endsmbfilepwent_internal: closed password file. pdb_getsampwnam: found by name: testuser build_sam_account: smbpasswd database is corrupt! username testuser not in unix passwd database! Couldn't find user 'testuser' in passdb.</code> <br>        . <i>Samba</i>      testuser.   ,   -     <b>/etc/passwd</b> : <br> <code class="bash">#testuser:x:791:100::/dev/null:/bin/false</code> <br>  ,      (#)     ,   .     . <br> <code class="bash">$ smbclient //TROUBLE/public -U testuser%test Domain=[LAB] OS=[Unix] Server=[Samba 2.2.2] smb: \&gt;</code> <br>     .      ,    <i>grep</i> ,     : <br> ‚Ä¢ fail <br> ‚Ä¢ error <br> ‚Ä¢ unsuccessful <br> ‚Ä¢ corrupt <br> ‚Ä¢ unknown <br> <br> <b>  </b> <br>       ‚Äî    ,       .      -,  Wireshark.             . <br> <br>  6 <br>   Samba <br>       ‚Äî ,    -  <i>Samba</i> .       .         ,      <i>Samba</i> ,      :     . <br> <br>  <br> ,        <i>Samba</i> .     ,          .     : <br> ‚Ä¢ 1.     <b>smb.conf</b> . <br> ‚Ä¢ 2.    . <br> ‚Ä¢ 3.    . <br> ‚Ä¢ 4.  . <br> ‚Ä¢ 5.    . <br> ‚Ä¢ 6.   <i>Samba</i> . <br>   , , ,     - .              .         .        .         !</code> <pre> <code class="hljs pgsql"><code class="bash">/<span class="hljs-keyword"><span class="hljs-keyword">user</span></span>:: <br> C:\WINNT\&gt;net use \\TROUBLE\<span class="hljs-built_in"><span class="hljs-built_in">public</span></span> /<span class="hljs-keyword"><span class="hljs-keyword">user</span></span>:user1 The <span class="hljs-keyword"><span class="hljs-keyword">password</span></span> <span class="hljs-keyword"><span class="hljs-keyword">or</span></span> <span class="hljs-keyword"><span class="hljs-keyword">user</span></span> <span class="hljs-type"><span class="hljs-type">name</span></span> <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> invalid <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> \\TROUBLE\<span class="hljs-built_in"><span class="hljs-built_in">public</span></span>. <span class="hljs-keyword"><span class="hljs-keyword">Type</span></span> the <span class="hljs-keyword"><span class="hljs-keyword">password</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> \\TROUBLE\<span class="hljs-built_in"><span class="hljs-built_in">public</span></span>: The command completed successfully.</code> <br>    ,   .         -,    . <br> <br>  <span class="hljs-number"><span class="hljs-number">4</span></span> <br>   <br>        ‚Äî   .  ,      ,        ,          ,       :    . <br> <br>  <span class="hljs-number"><span class="hljs-number">5</span></span> <br> -    <br>           .     .     ¬´¬ª        Samba    .    ,    .       ,     . <br> <br> <b>- Samba</b> <br>   ,      . <br> <br> <img src="https://habrastorage.org/storage2/fbd/11b/b8a/fbd11bb8ada955a99b10f832b0edb4f8.png"> <br> <br>      <i>smbd</i> (,  pid <span class="hljs-number"><span class="hljs-number">1234</span></span>),    -   root: <br> <code class="bash">root# smbcontrol <span class="hljs-number"><span class="hljs-number">1234</span></span> debuglevel <span class="hljs-keyword"><span class="hljs-keyword">Current</span></span> <span class="hljs-keyword"><span class="hljs-keyword">debug</span></span> <span class="hljs-keyword"><span class="hljs-keyword">level</span></span> <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> PID <span class="hljs-number"><span class="hljs-number">1234</span></span> <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span></code> <br>        <span class="hljs-number"><span class="hljs-number">10</span></span>,     ,   : <br> <code class="bash">root# smbcontrol <span class="hljs-number"><span class="hljs-number">1234</span></span> <span class="hljs-keyword"><span class="hljs-keyword">debug</span></span> <span class="hljs-number"><span class="hljs-number">10</span></span> root# smbcontrol <span class="hljs-number"><span class="hljs-number">1234</span></span> debuglevel <span class="hljs-keyword"><span class="hljs-keyword">Current</span></span> <span class="hljs-keyword"><span class="hljs-keyword">debug</span></span> <span class="hljs-keyword"><span class="hljs-keyword">level</span></span> <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> PID <span class="hljs-number"><span class="hljs-number">1234</span></span> <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> <span class="hljs-number"><span class="hljs-number">10</span></span></code> <br>  : ¬´    ?¬ª <br>  ,      .     Windows-    .  <i>smbd</i>     .    <i>smbclient</i>  ,   : <br> <code class="bash">$ smbclient //TROUBLE/<span class="hljs-built_in"><span class="hljs-built_in">public</span></span> -U testuser%test <span class="hljs-keyword"><span class="hljs-keyword">session</span></span> setup failed: ERRSRV - ERRbadpw (Bad <span class="hljs-keyword"><span class="hljs-keyword">password</span></span> - <span class="hljs-type"><span class="hljs-type">name</span></span>/<span class="hljs-keyword"><span class="hljs-keyword">password</span></span> pair <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> a Tree <span class="hljs-keyword"><span class="hljs-keyword">Connect</span></span> <span class="hljs-keyword"><span class="hljs-keyword">or</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Session</span></span> Setup are invalid.)</code> <br>   ,   smbpasswd ,   ‚Äî test.    ,  <br> <code class="bash"><span class="hljs-keyword"><span class="hljs-keyword">log</span></span> <span class="hljs-keyword"><span class="hljs-keyword">level</span></span> = <span class="hljs-number"><span class="hljs-number">10</span></span> <span class="hljs-keyword"><span class="hljs-keyword">log</span></span> file = /usr/<span class="hljs-keyword"><span class="hljs-keyword">local</span></span>/samba/var/<span class="hljs-keyword"><span class="hljs-keyword">log</span></span>.%m</code> <br>   [<span class="hljs-keyword"><span class="hljs-keyword">global</span></span>]  <b>smb.conf</b> ,        <b><span class="hljs-keyword"><span class="hljs-keyword">log</span></span>.TROUBLE</b> : <br> <code class="bash">pdb_getsampwnam: <span class="hljs-keyword"><span class="hljs-keyword">search</span></span> <span class="hljs-keyword"><span class="hljs-keyword">by</span></span> <span class="hljs-type"><span class="hljs-type">name</span></span>: testuser startsmbfilepwent_internal: opening file /usr/<span class="hljs-keyword"><span class="hljs-keyword">local</span></span>/samba/private/smbpasswd getsmbfilepwent: <span class="hljs-keyword"><span class="hljs-keyword">returning</span></span> passwd entry <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> <span class="hljs-keyword"><span class="hljs-keyword">user</span></span> root, uid <span class="hljs-number"><span class="hljs-number">0</span></span> getsmbfilepwent: <span class="hljs-keyword"><span class="hljs-keyword">returning</span></span> passwd entry <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> <span class="hljs-keyword"><span class="hljs-keyword">user</span></span> jerry, uid <span class="hljs-number"><span class="hljs-number">786</span></span> getsmbfilepwent: <span class="hljs-keyword"><span class="hljs-keyword">returning</span></span> passwd entry <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> <span class="hljs-keyword"><span class="hljs-keyword">user</span></span> guest1, uid <span class="hljs-number"><span class="hljs-number">782</span></span> getsmbfilepwent: <span class="hljs-keyword"><span class="hljs-keyword">returning</span></span> passwd entry <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> <span class="hljs-keyword"><span class="hljs-keyword">user</span></span> testuser, uid <span class="hljs-number"><span class="hljs-number">791</span></span> endsmbfilepwent_internal: closed <span class="hljs-keyword"><span class="hljs-keyword">password</span></span> file. pdb_getsampwnam: <span class="hljs-built_in"><span class="hljs-built_in">found</span></span> <span class="hljs-keyword"><span class="hljs-keyword">by</span></span> <span class="hljs-type"><span class="hljs-type">name</span></span>: testuser build_sam_account: smbpasswd <span class="hljs-keyword"><span class="hljs-keyword">database</span></span> <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> corrupt! username testuser <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> unix passwd <span class="hljs-keyword"><span class="hljs-keyword">database</span></span>! Couldn<span class="hljs-string"><span class="hljs-string">'t find user '</span></span>testuser<span class="hljs-string"><span class="hljs-string">' in passdb.</span></span></code><span class="hljs-string"><span class="hljs-string"> </span></span><br><span class="hljs-string"><span class="hljs-string">        . </span></span><i><span class="hljs-string"><span class="hljs-string">Samba</span></span></i><span class="hljs-string"><span class="hljs-string">      testuser.   ,   -     </span></span><b><span class="hljs-string"><span class="hljs-string">/etc/passwd</span></span></b><span class="hljs-string"><span class="hljs-string"> : </span></span><br><span class="hljs-string"><span class="hljs-string"> </span></span><code class="bash"><span class="hljs-string"><span class="hljs-string">#testuser:x:791:100::/dev/null:/bin/false</span></span></code><span class="hljs-string"><span class="hljs-string"> </span></span><br><span class="hljs-string"><span class="hljs-string">  ,      (#)     ,   .     . </span></span><br><span class="hljs-string"><span class="hljs-string"> </span></span><code class="bash"><span class="hljs-string"><span class="hljs-string">$ smbclient //TROUBLE/public -U testuser%test Domain=[LAB] OS=[Unix] Server=[Samba 2.2.2] smb: \&gt;</span></span></code><span class="hljs-string"><span class="hljs-string"> </span></span><br><span class="hljs-string"><span class="hljs-string">     .      ,    </span></span><i><span class="hljs-string"><span class="hljs-string">grep</span></span></i><span class="hljs-string"><span class="hljs-string"> ,     : </span></span><br><span class="hljs-string"><span class="hljs-string"> ‚Ä¢ fail </span></span><br><span class="hljs-string"><span class="hljs-string"> ‚Ä¢ error </span></span><br><span class="hljs-string"><span class="hljs-string"> ‚Ä¢ unsuccessful </span></span><br><span class="hljs-string"><span class="hljs-string"> ‚Ä¢ corrupt </span></span><br><span class="hljs-string"><span class="hljs-string"> ‚Ä¢ unknown </span></span><br><span class="hljs-string"><span class="hljs-string"> </span></span><br><span class="hljs-string"><span class="hljs-string"> </span></span><b><span class="hljs-string"><span class="hljs-string">  </span></span></b><span class="hljs-string"><span class="hljs-string"> </span></span><br><span class="hljs-string"><span class="hljs-string">       ‚Äî    ,       .      -,  Wireshark.             . </span></span><br><span class="hljs-string"><span class="hljs-string"> </span></span><br><span class="hljs-string"><span class="hljs-string">  6 </span></span><br><span class="hljs-string"><span class="hljs-string">   Samba </span></span><br><span class="hljs-string"><span class="hljs-string">       ‚Äî ,    -  </span></span><i><span class="hljs-string"><span class="hljs-string">Samba</span></span></i><span class="hljs-string"><span class="hljs-string"> .       .         ,      </span></span><i><span class="hljs-string"><span class="hljs-string">Samba</span></span></i><span class="hljs-string"><span class="hljs-string"> ,      :     . </span></span><br><span class="hljs-string"><span class="hljs-string"> </span></span><br><span class="hljs-string"><span class="hljs-string">  </span></span><br><span class="hljs-string"><span class="hljs-string"> ,        </span></span><i><span class="hljs-string"><span class="hljs-string">Samba</span></span></i><span class="hljs-string"><span class="hljs-string"> .     ,          .     : </span></span><br><span class="hljs-string"><span class="hljs-string"> ‚Ä¢ 1.     </span></span><b><span class="hljs-string"><span class="hljs-string">smb.conf</span></span></b><span class="hljs-string"><span class="hljs-string"> . </span></span><br><span class="hljs-string"><span class="hljs-string"> ‚Ä¢ 2.    . </span></span><br><span class="hljs-string"><span class="hljs-string"> ‚Ä¢ 3.    . </span></span><br><span class="hljs-string"><span class="hljs-string"> ‚Ä¢ 4.  . </span></span><br><span class="hljs-string"><span class="hljs-string"> ‚Ä¢ 5.    . </span></span><br><span class="hljs-string"><span class="hljs-string"> ‚Ä¢ 6.   </span></span><i><span class="hljs-string"><span class="hljs-string">Samba</span></span></i><span class="hljs-string"><span class="hljs-string"> . </span></span><br><span class="hljs-string"><span class="hljs-string">   , , ,     - .              .         .        .         !</span></span></code> </pre> <code><code class="bash">/user:: <br> C:\WINNT\&gt;net use \\TROUBLE\public /user:user1 The password or user name is invalid for \\TROUBLE\public. Type the password for \\TROUBLE\public: The command completed successfully.</code> <br>    ,   .         -,    . <br> <br>  4 <br>   <br>        ‚Äî   .  ,      ,        ,          ,       :    . <br> <br>  5 <br> -    <br>           .     .     ¬´¬ª        Samba    .    ,    .       ,     . <br> <br> <b>- Samba</b> <br>   ,      . <br> <br> <img src="https://habrastorage.org/storage2/fbd/11b/b8a/fbd11bb8ada955a99b10f832b0edb4f8.png"> <br> <br>      <i>smbd</i> (,  pid 1234),    -   root: <br> <code class="bash">root# smbcontrol 1234 debuglevel Current debug level of PID 1234 is 0</code> <br>        10,     ,   : <br> <code class="bash">root# smbcontrol 1234 debug 10 root# smbcontrol 1234 debuglevel Current debug level of PID 1234 is 10</code> <br>  : ¬´    ?¬ª <br>  ,      .     Windows-    .  <i>smbd</i>     .    <i>smbclient</i>  ,   : <br> <code class="bash">$ smbclient //TROUBLE/public -U testuser%test session setup failed: ERRSRV - ERRbadpw (Bad password - name/password pair in a Tree Connect or Session Setup are invalid.)</code> <br>   ,   smbpasswd ,   ‚Äî test.    ,  <br> <code class="bash">log level = 10 log file = /usr/local/samba/var/log.%m</code> <br>   [global]  <b>smb.conf</b> ,        <b>log.TROUBLE</b> : <br> <code class="bash">pdb_getsampwnam: search by name: testuser startsmbfilepwent_internal: opening file /usr/local/samba/private/smbpasswd getsmbfilepwent: returning passwd entry for user root, uid 0 getsmbfilepwent: returning passwd entry for user jerry, uid 786 getsmbfilepwent: returning passwd entry for user guest1, uid 782 getsmbfilepwent: returning passwd entry for user testuser, uid 791 endsmbfilepwent_internal: closed password file. pdb_getsampwnam: found by name: testuser build_sam_account: smbpasswd database is corrupt! username testuser not in unix passwd database! Couldn't find user 'testuser' in passdb.</code> <br>        . <i>Samba</i>      testuser.   ,   -     <b>/etc/passwd</b> : <br> <code class="bash">#testuser:x:791:100::/dev/null:/bin/false</code> <br>  ,      (#)     ,   .     . <br> <code class="bash">$ smbclient //TROUBLE/public -U testuser%test Domain=[LAB] OS=[Unix] Server=[Samba 2.2.2] smb: \&gt;</code> <br>     .      ,    <i>grep</i> ,     : <br> ‚Ä¢ fail <br> ‚Ä¢ error <br> ‚Ä¢ unsuccessful <br> ‚Ä¢ corrupt <br> ‚Ä¢ unknown <br> <br> <b>  </b> <br>       ‚Äî    ,       .      -,  Wireshark.             . <br> <br>  6 <br>   Samba <br>       ‚Äî ,    -  <i>Samba</i> .       .         ,      <i>Samba</i> ,      :     . <br> <br>  <br> ,        <i>Samba</i> .     ,          .     : <br> ‚Ä¢ 1.     <b>smb.conf</b> . <br> ‚Ä¢ 2.    . <br> ‚Ä¢ 3.    . <br> ‚Ä¢ 4.  . <br> ‚Ä¢ 5.    . <br> ‚Ä¢ 6.   <i>Samba</i> . <br>   , , ,     - .              .         .        .         !</code> <pre> <code class="hljs pgsql"><code class="bash"><code class="bash">/<span class="hljs-keyword"><span class="hljs-keyword">user</span></span>:: <br> C:\WINNT\&gt;net use \\TROUBLE\<span class="hljs-built_in"><span class="hljs-built_in">public</span></span> /<span class="hljs-keyword"><span class="hljs-keyword">user</span></span>:user1 The <span class="hljs-keyword"><span class="hljs-keyword">password</span></span> <span class="hljs-keyword"><span class="hljs-keyword">or</span></span> <span class="hljs-keyword"><span class="hljs-keyword">user</span></span> <span class="hljs-type"><span class="hljs-type">name</span></span> <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> invalid <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> \\TROUBLE\<span class="hljs-built_in"><span class="hljs-built_in">public</span></span>. <span class="hljs-keyword"><span class="hljs-keyword">Type</span></span> the <span class="hljs-keyword"><span class="hljs-keyword">password</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> \\TROUBLE\<span class="hljs-built_in"><span class="hljs-built_in">public</span></span>: The command completed successfully.</code> <br>    ,   .         -,    . <br> <br>  <span class="hljs-number"><span class="hljs-number">4</span></span> <br>   <br>        ‚Äî   .  ,      ,        ,          ,       :    . <br> <br>  <span class="hljs-number"><span class="hljs-number">5</span></span> <br> -    <br>           .     .     ¬´¬ª        Samba    .    ,    .       ,     . <br> <br> <b>- Samba</b> <br>   ,      . <br> <br> <img src="https://habrastorage.org/storage2/fbd/11b/b8a/fbd11bb8ada955a99b10f832b0edb4f8.png"> <br> <br>      <i>smbd</i> (,  pid <span class="hljs-number"><span class="hljs-number">1234</span></span>),    -   root: <br> <code class="bash">root# smbcontrol <span class="hljs-number"><span class="hljs-number">1234</span></span> debuglevel <span class="hljs-keyword"><span class="hljs-keyword">Current</span></span> <span class="hljs-keyword"><span class="hljs-keyword">debug</span></span> <span class="hljs-keyword"><span class="hljs-keyword">level</span></span> <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> PID <span class="hljs-number"><span class="hljs-number">1234</span></span> <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span></code> <br>        <span class="hljs-number"><span class="hljs-number">10</span></span>,     ,   : <br> <code class="bash">root# smbcontrol <span class="hljs-number"><span class="hljs-number">1234</span></span> <span class="hljs-keyword"><span class="hljs-keyword">debug</span></span> <span class="hljs-number"><span class="hljs-number">10</span></span> root# smbcontrol <span class="hljs-number"><span class="hljs-number">1234</span></span> debuglevel <span class="hljs-keyword"><span class="hljs-keyword">Current</span></span> <span class="hljs-keyword"><span class="hljs-keyword">debug</span></span> <span class="hljs-keyword"><span class="hljs-keyword">level</span></span> <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> PID <span class="hljs-number"><span class="hljs-number">1234</span></span> <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> <span class="hljs-number"><span class="hljs-number">10</span></span></code> <br>  : ¬´    ?¬ª <br>  ,      .     Windows-    .  <i>smbd</i>     .    <i>smbclient</i>  ,   : <br> <code class="bash">$ smbclient //TROUBLE/<span class="hljs-built_in"><span class="hljs-built_in">public</span></span> -U testuser%test <span class="hljs-keyword"><span class="hljs-keyword">session</span></span> setup failed: ERRSRV - ERRbadpw (Bad <span class="hljs-keyword"><span class="hljs-keyword">password</span></span> - <span class="hljs-type"><span class="hljs-type">name</span></span>/<span class="hljs-keyword"><span class="hljs-keyword">password</span></span> pair <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> a Tree <span class="hljs-keyword"><span class="hljs-keyword">Connect</span></span> <span class="hljs-keyword"><span class="hljs-keyword">or</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Session</span></span> Setup are invalid.)</code> <br>   ,   smbpasswd ,   ‚Äî test.    ,  <br> <span class="hljs-keyword"><span class="hljs-keyword">log</span></span> <span class="hljs-keyword"><span class="hljs-keyword">level</span></span> = <span class="hljs-number"><span class="hljs-number">10</span></span> <span class="hljs-keyword"><span class="hljs-keyword">log</span></span> file = /usr/<span class="hljs-keyword"><span class="hljs-keyword">local</span></span>/samba/var/<span class="hljs-keyword"><span class="hljs-keyword">log</span></span>.%m <br>   [<span class="hljs-keyword"><span class="hljs-keyword">global</span></span>]  <b>smb.conf</b> ,        <b><span class="hljs-keyword"><span class="hljs-keyword">log</span></span>.TROUBLE</b> : <br> <code class="bash">pdb_getsampwnam: <span class="hljs-keyword"><span class="hljs-keyword">search</span></span> <span class="hljs-keyword"><span class="hljs-keyword">by</span></span> <span class="hljs-type"><span class="hljs-type">name</span></span>: testuser startsmbfilepwent_internal: opening file /usr/<span class="hljs-keyword"><span class="hljs-keyword">local</span></span>/samba/private/smbpasswd getsmbfilepwent: <span class="hljs-keyword"><span class="hljs-keyword">returning</span></span> passwd entry <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> <span class="hljs-keyword"><span class="hljs-keyword">user</span></span> root, uid <span class="hljs-number"><span class="hljs-number">0</span></span> getsmbfilepwent: <span class="hljs-keyword"><span class="hljs-keyword">returning</span></span> passwd entry <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> <span class="hljs-keyword"><span class="hljs-keyword">user</span></span> jerry, uid <span class="hljs-number"><span class="hljs-number">786</span></span> getsmbfilepwent: <span class="hljs-keyword"><span class="hljs-keyword">returning</span></span> passwd entry <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> <span class="hljs-keyword"><span class="hljs-keyword">user</span></span> guest1, uid <span class="hljs-number"><span class="hljs-number">782</span></span> getsmbfilepwent: <span class="hljs-keyword"><span class="hljs-keyword">returning</span></span> passwd entry <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> <span class="hljs-keyword"><span class="hljs-keyword">user</span></span> testuser, uid <span class="hljs-number"><span class="hljs-number">791</span></span> endsmbfilepwent_internal: closed <span class="hljs-keyword"><span class="hljs-keyword">password</span></span> file. pdb_getsampwnam: <span class="hljs-built_in"><span class="hljs-built_in">found</span></span> <span class="hljs-keyword"><span class="hljs-keyword">by</span></span> <span class="hljs-type"><span class="hljs-type">name</span></span>: testuser build_sam_account: smbpasswd <span class="hljs-keyword"><span class="hljs-keyword">database</span></span> <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> corrupt! username testuser <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> unix passwd <span class="hljs-keyword"><span class="hljs-keyword">database</span></span>! Couldn<span class="hljs-string"><span class="hljs-string">'t find user '</span></span>testuser<span class="hljs-string"><span class="hljs-string">' in passdb.</span></span></code><span class="hljs-string"><span class="hljs-string"> </span></span><br><span class="hljs-string"><span class="hljs-string">        . </span></span><i><span class="hljs-string"><span class="hljs-string">Samba</span></span></i><span class="hljs-string"><span class="hljs-string">      testuser.   ,   -     </span></span><b><span class="hljs-string"><span class="hljs-string">/etc/passwd</span></span></b><span class="hljs-string"><span class="hljs-string"> : </span></span><br><span class="hljs-string"><span class="hljs-string"> </span></span><code class="bash"><span class="hljs-string"><span class="hljs-string">#testuser:x:791:100::/dev/null:/bin/false</span></span></code><span class="hljs-string"><span class="hljs-string"> </span></span><br><span class="hljs-string"><span class="hljs-string">  ,      (#)     ,   .     . </span></span><br><span class="hljs-string"><span class="hljs-string"> </span></span><code class="bash"><span class="hljs-string"><span class="hljs-string">$ smbclient //TROUBLE/public -U testuser%test Domain=[LAB] OS=[Unix] Server=[Samba 2.2.2] smb: \&gt;</span></span></code><span class="hljs-string"><span class="hljs-string"> </span></span><br><span class="hljs-string"><span class="hljs-string">     .      ,    </span></span><i><span class="hljs-string"><span class="hljs-string">grep</span></span></i><span class="hljs-string"><span class="hljs-string"> ,     : </span></span><br><span class="hljs-string"><span class="hljs-string"> ‚Ä¢ fail </span></span><br><span class="hljs-string"><span class="hljs-string"> ‚Ä¢ error </span></span><br><span class="hljs-string"><span class="hljs-string"> ‚Ä¢ unsuccessful </span></span><br><span class="hljs-string"><span class="hljs-string"> ‚Ä¢ corrupt </span></span><br><span class="hljs-string"><span class="hljs-string"> ‚Ä¢ unknown </span></span><br><span class="hljs-string"><span class="hljs-string"> </span></span><br><span class="hljs-string"><span class="hljs-string"> </span></span><b><span class="hljs-string"><span class="hljs-string">  </span></span></b><span class="hljs-string"><span class="hljs-string"> </span></span><br><span class="hljs-string"><span class="hljs-string">       ‚Äî    ,       .      -,  Wireshark.             . </span></span><br><span class="hljs-string"><span class="hljs-string"> </span></span><br><span class="hljs-string"><span class="hljs-string">  6 </span></span><br><span class="hljs-string"><span class="hljs-string">   Samba </span></span><br><span class="hljs-string"><span class="hljs-string">       ‚Äî ,    -  </span></span><i><span class="hljs-string"><span class="hljs-string">Samba</span></span></i><span class="hljs-string"><span class="hljs-string"> .       .         ,      </span></span><i><span class="hljs-string"><span class="hljs-string">Samba</span></span></i><span class="hljs-string"><span class="hljs-string"> ,      :     . </span></span><br><span class="hljs-string"><span class="hljs-string"> </span></span><br><span class="hljs-string"><span class="hljs-string">  </span></span><br><span class="hljs-string"><span class="hljs-string"> ,        </span></span><i><span class="hljs-string"><span class="hljs-string">Samba</span></span></i><span class="hljs-string"><span class="hljs-string"> .     ,          .     : </span></span><br><span class="hljs-string"><span class="hljs-string"> ‚Ä¢ 1.     </span></span><b><span class="hljs-string"><span class="hljs-string">smb.conf</span></span></b><span class="hljs-string"><span class="hljs-string"> . </span></span><br><span class="hljs-string"><span class="hljs-string"> ‚Ä¢ 2.    . </span></span><br><span class="hljs-string"><span class="hljs-string"> ‚Ä¢ 3.    . </span></span><br><span class="hljs-string"><span class="hljs-string"> ‚Ä¢ 4.  . </span></span><br><span class="hljs-string"><span class="hljs-string"> ‚Ä¢ 5.    . </span></span><br><span class="hljs-string"><span class="hljs-string"> ‚Ä¢ 6.   </span></span><i><span class="hljs-string"><span class="hljs-string">Samba</span></span></i><span class="hljs-string"><span class="hljs-string"> . </span></span><br><span class="hljs-string"><span class="hljs-string">   , , ,     - .              .         .        .         !</span></span></code></code> </pre> <code><code class="bash">/user:: <br> C:\WINNT\&gt;net use \\TROUBLE\public /user:user1 The password or user name is invalid for \\TROUBLE\public. Type the password for \\TROUBLE\public: The command completed successfully.</code> <br>    ,   .         -,    . <br> <br>  4 <br>   <br>        ‚Äî   .  ,      ,        ,          ,       :    . <br> <br>  5 <br> -    <br>           .     .     ¬´¬ª        Samba    .    ,    .       ,     . <br> <br> <b>- Samba</b> <br>   ,      . <br> <br> <img src="https://habrastorage.org/storage2/fbd/11b/b8a/fbd11bb8ada955a99b10f832b0edb4f8.png"> <br> <br>      <i>smbd</i> (,  pid 1234),    -   root: <br> <code class="bash">root# smbcontrol 1234 debuglevel Current debug level of PID 1234 is 0</code> <br>        10,     ,   : <br> <code class="bash">root# smbcontrol 1234 debug 10 root# smbcontrol 1234 debuglevel Current debug level of PID 1234 is 10</code> <br>  : ¬´    ?¬ª <br>  ,      .     Windows-    .  <i>smbd</i>     .    <i>smbclient</i>  ,   : <br> <code class="bash">$ smbclient //TROUBLE/public -U testuser%test session setup failed: ERRSRV - ERRbadpw (Bad password - name/password pair in a Tree Connect or Session Setup are invalid.)</code> <br>   ,   smbpasswd ,   ‚Äî test.    ,  <br> <code class="bash">log level = 10 log file = /usr/local/samba/var/log.%m</code> <br>   [global]  <b>smb.conf</b> ,        <b>log.TROUBLE</b> : <br> <code class="bash">pdb_getsampwnam: search by name: testuser startsmbfilepwent_internal: opening file /usr/local/samba/private/smbpasswd getsmbfilepwent: returning passwd entry for user root, uid 0 getsmbfilepwent: returning passwd entry for user jerry, uid 786 getsmbfilepwent: returning passwd entry for user guest1, uid 782 getsmbfilepwent: returning passwd entry for user testuser, uid 791 endsmbfilepwent_internal: closed password file. pdb_getsampwnam: found by name: testuser build_sam_account: smbpasswd database is corrupt! username testuser not in unix passwd database! Couldn't find user 'testuser' in passdb.</code> <br>        . <i>Samba</i>      testuser.   ,   -     <b>/etc/passwd</b> : <br> <code class="bash">#testuser:x:791:100::/dev/null:/bin/false</code> <br>  ,      (#)     ,   .     . <br> <code class="bash">$ smbclient //TROUBLE/public -U testuser%test Domain=[LAB] OS=[Unix] Server=[Samba 2.2.2] smb: \&gt;</code> <br>     .      ,    <i>grep</i> ,     : <br> ‚Ä¢ fail <br> ‚Ä¢ error <br> ‚Ä¢ unsuccessful <br> ‚Ä¢ corrupt <br> ‚Ä¢ unknown <br> <br> <b>  </b> <br>       ‚Äî    ,       .      -,  Wireshark.             . <br> <br>  6 <br>   Samba <br>       ‚Äî ,    -  <i>Samba</i> .       .         ,      <i>Samba</i> ,      :     . <br> <br>  <br> ,        <i>Samba</i> .     ,          .     : <br> ‚Ä¢ 1.     <b>smb.conf</b> . <br> ‚Ä¢ 2.    . <br> ‚Ä¢ 3.    . <br> ‚Ä¢ 4.  . <br> ‚Ä¢ 5.    . <br> ‚Ä¢ 6.   <i>Samba</i> . <br>   , , ,     - .              .         .        .         !</code> <pre> <code class="hljs pgsql"><code class="bash">/<span class="hljs-keyword"><span class="hljs-keyword">user</span></span>:: <br> C:\WINNT\&gt;net use \\TROUBLE\<span class="hljs-built_in"><span class="hljs-built_in">public</span></span> /<span class="hljs-keyword"><span class="hljs-keyword">user</span></span>:user1 The <span class="hljs-keyword"><span class="hljs-keyword">password</span></span> <span class="hljs-keyword"><span class="hljs-keyword">or</span></span> <span class="hljs-keyword"><span class="hljs-keyword">user</span></span> <span class="hljs-type"><span class="hljs-type">name</span></span> <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> invalid <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> \\TROUBLE\<span class="hljs-built_in"><span class="hljs-built_in">public</span></span>. <span class="hljs-keyword"><span class="hljs-keyword">Type</span></span> the <span class="hljs-keyword"><span class="hljs-keyword">password</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> \\TROUBLE\<span class="hljs-built_in"><span class="hljs-built_in">public</span></span>: The command completed successfully.</code> <br>    ,   .         -,    . <br> <br>  <span class="hljs-number"><span class="hljs-number">4</span></span> <br>   <br>        ‚Äî   .  ,      ,        ,          ,       :    . <br> <br>  <span class="hljs-number"><span class="hljs-number">5</span></span> <br> -    <br>           .     .     ¬´¬ª        Samba    .    ,    .       ,     . <br> <br> <b>- Samba</b> <br>   ,      . <br> <br> <img src="https://habrastorage.org/storage2/fbd/11b/b8a/fbd11bb8ada955a99b10f832b0edb4f8.png"> <br> <br>      <i>smbd</i> (,  pid <span class="hljs-number"><span class="hljs-number">1234</span></span>),    -   root: <br> <code class="bash">root# smbcontrol <span class="hljs-number"><span class="hljs-number">1234</span></span> debuglevel <span class="hljs-keyword"><span class="hljs-keyword">Current</span></span> <span class="hljs-keyword"><span class="hljs-keyword">debug</span></span> <span class="hljs-keyword"><span class="hljs-keyword">level</span></span> <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> PID <span class="hljs-number"><span class="hljs-number">1234</span></span> <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span></code> <br>        <span class="hljs-number"><span class="hljs-number">10</span></span>,     ,   : <br> <code class="bash">root# smbcontrol <span class="hljs-number"><span class="hljs-number">1234</span></span> <span class="hljs-keyword"><span class="hljs-keyword">debug</span></span> <span class="hljs-number"><span class="hljs-number">10</span></span> root# smbcontrol <span class="hljs-number"><span class="hljs-number">1234</span></span> debuglevel <span class="hljs-keyword"><span class="hljs-keyword">Current</span></span> <span class="hljs-keyword"><span class="hljs-keyword">debug</span></span> <span class="hljs-keyword"><span class="hljs-keyword">level</span></span> <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> PID <span class="hljs-number"><span class="hljs-number">1234</span></span> <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> <span class="hljs-number"><span class="hljs-number">10</span></span></code> <br>  : ¬´    ?¬ª <br>  ,      .     Windows-    .  <i>smbd</i>     .    <i>smbclient</i>  ,   : <br> <code class="bash">$ smbclient //TROUBLE/<span class="hljs-built_in"><span class="hljs-built_in">public</span></span> -U testuser%test <span class="hljs-keyword"><span class="hljs-keyword">session</span></span> setup failed: ERRSRV - ERRbadpw (Bad <span class="hljs-keyword"><span class="hljs-keyword">password</span></span> - <span class="hljs-type"><span class="hljs-type">name</span></span>/<span class="hljs-keyword"><span class="hljs-keyword">password</span></span> pair <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> a Tree <span class="hljs-keyword"><span class="hljs-keyword">Connect</span></span> <span class="hljs-keyword"><span class="hljs-keyword">or</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Session</span></span> Setup are invalid.)</code> <br>   ,   smbpasswd ,   ‚Äî test.    ,  <br> <code class="bash"><span class="hljs-keyword"><span class="hljs-keyword">log</span></span> <span class="hljs-keyword"><span class="hljs-keyword">level</span></span> = <span class="hljs-number"><span class="hljs-number">10</span></span> <span class="hljs-keyword"><span class="hljs-keyword">log</span></span> file = /usr/<span class="hljs-keyword"><span class="hljs-keyword">local</span></span>/samba/var/<span class="hljs-keyword"><span class="hljs-keyword">log</span></span>.%m</code> <br>   [<span class="hljs-keyword"><span class="hljs-keyword">global</span></span>]  <b>smb.conf</b> ,        <b><span class="hljs-keyword"><span class="hljs-keyword">log</span></span>.TROUBLE</b> : <br> <code class="bash">pdb_getsampwnam: <span class="hljs-keyword"><span class="hljs-keyword">search</span></span> <span class="hljs-keyword"><span class="hljs-keyword">by</span></span> <span class="hljs-type"><span class="hljs-type">name</span></span>: testuser startsmbfilepwent_internal: opening file /usr/<span class="hljs-keyword"><span class="hljs-keyword">local</span></span>/samba/private/smbpasswd getsmbfilepwent: <span class="hljs-keyword"><span class="hljs-keyword">returning</span></span> passwd entry <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> <span class="hljs-keyword"><span class="hljs-keyword">user</span></span> root, uid <span class="hljs-number"><span class="hljs-number">0</span></span> getsmbfilepwent: <span class="hljs-keyword"><span class="hljs-keyword">returning</span></span> passwd entry <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> <span class="hljs-keyword"><span class="hljs-keyword">user</span></span> jerry, uid <span class="hljs-number"><span class="hljs-number">786</span></span> getsmbfilepwent: <span class="hljs-keyword"><span class="hljs-keyword">returning</span></span> passwd entry <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> <span class="hljs-keyword"><span class="hljs-keyword">user</span></span> guest1, uid <span class="hljs-number"><span class="hljs-number">782</span></span> getsmbfilepwent: <span class="hljs-keyword"><span class="hljs-keyword">returning</span></span> passwd entry <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> <span class="hljs-keyword"><span class="hljs-keyword">user</span></span> testuser, uid <span class="hljs-number"><span class="hljs-number">791</span></span> endsmbfilepwent_internal: closed <span class="hljs-keyword"><span class="hljs-keyword">password</span></span> file. pdb_getsampwnam: <span class="hljs-built_in"><span class="hljs-built_in">found</span></span> <span class="hljs-keyword"><span class="hljs-keyword">by</span></span> <span class="hljs-type"><span class="hljs-type">name</span></span>: testuser build_sam_account: smbpasswd <span class="hljs-keyword"><span class="hljs-keyword">database</span></span> <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> corrupt! username testuser <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> unix passwd <span class="hljs-keyword"><span class="hljs-keyword">database</span></span>! Couldn<span class="hljs-string"><span class="hljs-string">'t find user '</span></span>testuser<span class="hljs-string"><span class="hljs-string">' in passdb.</span></span></code><span class="hljs-string"><span class="hljs-string"> </span></span><br><span class="hljs-string"><span class="hljs-string">        . </span></span><i><span class="hljs-string"><span class="hljs-string">Samba</span></span></i><span class="hljs-string"><span class="hljs-string">      testuser.   ,   -     </span></span><b><span class="hljs-string"><span class="hljs-string">/etc/passwd</span></span></b><span class="hljs-string"><span class="hljs-string"> : </span></span><br><span class="hljs-string"><span class="hljs-string"> </span></span><code class="bash"><span class="hljs-string"><span class="hljs-string">#testuser:x:791:100::/dev/null:/bin/false</span></span></code><span class="hljs-string"><span class="hljs-string"> </span></span><br><span class="hljs-string"><span class="hljs-string">  ,      (#)     ,   .     . </span></span><br><span class="hljs-string"><span class="hljs-string"> </span></span><code class="bash"><span class="hljs-string"><span class="hljs-string">$ smbclient //TROUBLE/public -U testuser%test Domain=[LAB] OS=[Unix] Server=[Samba 2.2.2] smb: \&gt;</span></span></code><span class="hljs-string"><span class="hljs-string"> </span></span><br><span class="hljs-string"><span class="hljs-string">     .      ,    </span></span><i><span class="hljs-string"><span class="hljs-string">grep</span></span></i><span class="hljs-string"><span class="hljs-string"> ,     : </span></span><br><span class="hljs-string"><span class="hljs-string"> ‚Ä¢ fail </span></span><br><span class="hljs-string"><span class="hljs-string"> ‚Ä¢ error </span></span><br><span class="hljs-string"><span class="hljs-string"> ‚Ä¢ unsuccessful </span></span><br><span class="hljs-string"><span class="hljs-string"> ‚Ä¢ corrupt </span></span><br><span class="hljs-string"><span class="hljs-string"> ‚Ä¢ unknown </span></span><br><span class="hljs-string"><span class="hljs-string"> </span></span><br><span class="hljs-string"><span class="hljs-string"> </span></span><b><span class="hljs-string"><span class="hljs-string">  </span></span></b><span class="hljs-string"><span class="hljs-string"> </span></span><br><span class="hljs-string"><span class="hljs-string">       ‚Äî    ,       .      -,  Wireshark.             . </span></span><br><span class="hljs-string"><span class="hljs-string"> </span></span><br><span class="hljs-string"><span class="hljs-string">  6 </span></span><br><span class="hljs-string"><span class="hljs-string">   Samba </span></span><br><span class="hljs-string"><span class="hljs-string">       ‚Äî ,    -  </span></span><i><span class="hljs-string"><span class="hljs-string">Samba</span></span></i><span class="hljs-string"><span class="hljs-string"> .       .         ,      </span></span><i><span class="hljs-string"><span class="hljs-string">Samba</span></span></i><span class="hljs-string"><span class="hljs-string"> ,      :     . </span></span><br><span class="hljs-string"><span class="hljs-string"> </span></span><br><span class="hljs-string"><span class="hljs-string">  </span></span><br><span class="hljs-string"><span class="hljs-string"> ,        </span></span><i><span class="hljs-string"><span class="hljs-string">Samba</span></span></i><span class="hljs-string"><span class="hljs-string"> .     ,          .     : </span></span><br><span class="hljs-string"><span class="hljs-string"> ‚Ä¢ 1.     </span></span><b><span class="hljs-string"><span class="hljs-string">smb.conf</span></span></b><span class="hljs-string"><span class="hljs-string"> . </span></span><br><span class="hljs-string"><span class="hljs-string"> ‚Ä¢ 2.    . </span></span><br><span class="hljs-string"><span class="hljs-string"> ‚Ä¢ 3.    . </span></span><br><span class="hljs-string"><span class="hljs-string"> ‚Ä¢ 4.  . </span></span><br><span class="hljs-string"><span class="hljs-string"> ‚Ä¢ 5.    . </span></span><br><span class="hljs-string"><span class="hljs-string"> ‚Ä¢ 6.   </span></span><i><span class="hljs-string"><span class="hljs-string">Samba</span></span></i><span class="hljs-string"><span class="hljs-string"> . </span></span><br><span class="hljs-string"><span class="hljs-string">   , , ,     - .              .         .        .         !</span></span></code> </pre> <code><code class="bash">/user:: <br> C:\WINNT\&gt;net use \\TROUBLE\public /user:user1 The password or user name is invalid for \\TROUBLE\public. Type the password for \\TROUBLE\public: The command completed successfully.</code> <br>    ,   .         -,    . <br> <br>  4 <br>   <br>        ‚Äî   .  ,      ,        ,          ,       :    . <br> <br>  5 <br> -    <br>           .     .     ¬´¬ª        Samba    .    ,    .       ,     . <br> <br> <b>- Samba</b> <br>   ,      . <br> <br> <img src="https://habrastorage.org/storage2/fbd/11b/b8a/fbd11bb8ada955a99b10f832b0edb4f8.png"> <br> <br>      <i>smbd</i> (,  pid 1234),    -   root: <br> <code class="bash">root# smbcontrol 1234 debuglevel Current debug level of PID 1234 is 0</code> <br>        10,     ,   : <br> <code class="bash">root# smbcontrol 1234 debug 10 root# smbcontrol 1234 debuglevel Current debug level of PID 1234 is 10</code> <br>  : ¬´    ?¬ª <br>  ,      .     Windows-    .  <i>smbd</i>     .    <i>smbclient</i>  ,   : <br> <code class="bash">$ smbclient //TROUBLE/public -U testuser%test session setup failed: ERRSRV - ERRbadpw (Bad password - name/password pair in a Tree Connect or Session Setup are invalid.)</code> <br>   ,   smbpasswd ,   ‚Äî test.    ,  <br> <code class="bash">log level = 10 log file = /usr/local/samba/var/log.%m</code> <br>   [global]  <b>smb.conf</b> ,        <b>log.TROUBLE</b> : <br> <code class="bash">pdb_getsampwnam: search by name: testuser startsmbfilepwent_internal: opening file /usr/local/samba/private/smbpasswd getsmbfilepwent: returning passwd entry for user root, uid 0 getsmbfilepwent: returning passwd entry for user jerry, uid 786 getsmbfilepwent: returning passwd entry for user guest1, uid 782 getsmbfilepwent: returning passwd entry for user testuser, uid 791 endsmbfilepwent_internal: closed password file. pdb_getsampwnam: found by name: testuser build_sam_account: smbpasswd database is corrupt! username testuser not in unix passwd database! Couldn't find user 'testuser' in passdb.</code> <br>        . <i>Samba</i>      testuser.   ,   -     <b>/etc/passwd</b> : <br> <code class="bash">#testuser:x:791:100::/dev/null:/bin/false</code> <br>  ,      (#)     ,   .     . <br> <code class="bash">$ smbclient //TROUBLE/public -U testuser%test Domain=[LAB] OS=[Unix] Server=[Samba 2.2.2] smb: \&gt;</code> <br>     .      ,    <i>grep</i> ,     : <br> ‚Ä¢ fail <br> ‚Ä¢ error <br> ‚Ä¢ unsuccessful <br> ‚Ä¢ corrupt <br> ‚Ä¢ unknown <br> <br> <b>  </b> <br>       ‚Äî    ,       .      -,  Wireshark.             . <br> <br>  6 <br>   Samba <br>       ‚Äî ,    -  <i>Samba</i> .       .         ,      <i>Samba</i> ,      :     . <br> <br>  <br> ,        <i>Samba</i> .     ,          .     : <br> ‚Ä¢ 1.     <b>smb.conf</b> . <br> ‚Ä¢ 2.    . <br> ‚Ä¢ 3.    . <br> ‚Ä¢ 4.  . <br> ‚Ä¢ 5.    . <br> ‚Ä¢ 6.   <i>Samba</i> . <br>   , , ,     - .              .         .        .         !</code> <pre> <code class="hljs pgsql"><code class="bash"><code class="bash">/<span class="hljs-keyword"><span class="hljs-keyword">user</span></span>:: <br> C:\WINNT\&gt;net use \\TROUBLE\<span class="hljs-built_in"><span class="hljs-built_in">public</span></span> /<span class="hljs-keyword"><span class="hljs-keyword">user</span></span>:user1 The <span class="hljs-keyword"><span class="hljs-keyword">password</span></span> <span class="hljs-keyword"><span class="hljs-keyword">or</span></span> <span class="hljs-keyword"><span class="hljs-keyword">user</span></span> <span class="hljs-type"><span class="hljs-type">name</span></span> <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> invalid <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> \\TROUBLE\<span class="hljs-built_in"><span class="hljs-built_in">public</span></span>. <span class="hljs-keyword"><span class="hljs-keyword">Type</span></span> the <span class="hljs-keyword"><span class="hljs-keyword">password</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> \\TROUBLE\<span class="hljs-built_in"><span class="hljs-built_in">public</span></span>: The command completed successfully.</code> <br>    ,   .         -,    . <br> <br>  <span class="hljs-number"><span class="hljs-number">4</span></span> <br>   <br>        ‚Äî   .  ,      ,        ,          ,       :    . <br> <br>  <span class="hljs-number"><span class="hljs-number">5</span></span> <br> -    <br>           .     .     ¬´¬ª        Samba    .    ,    .       ,     . <br> <br> <b>- Samba</b> <br>   ,      . <br> <br> <img src="https://habrastorage.org/storage2/fbd/11b/b8a/fbd11bb8ada955a99b10f832b0edb4f8.png"> <br> <br>      <i>smbd</i> (,  pid <span class="hljs-number"><span class="hljs-number">1234</span></span>),    -   root: <br> <code class="bash">root# smbcontrol <span class="hljs-number"><span class="hljs-number">1234</span></span> debuglevel <span class="hljs-keyword"><span class="hljs-keyword">Current</span></span> <span class="hljs-keyword"><span class="hljs-keyword">debug</span></span> <span class="hljs-keyword"><span class="hljs-keyword">level</span></span> <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> PID <span class="hljs-number"><span class="hljs-number">1234</span></span> <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span></code> <br>        <span class="hljs-number"><span class="hljs-number">10</span></span>,     ,   : <br> <code class="bash">root# smbcontrol <span class="hljs-number"><span class="hljs-number">1234</span></span> <span class="hljs-keyword"><span class="hljs-keyword">debug</span></span> <span class="hljs-number"><span class="hljs-number">10</span></span> root# smbcontrol <span class="hljs-number"><span class="hljs-number">1234</span></span> debuglevel <span class="hljs-keyword"><span class="hljs-keyword">Current</span></span> <span class="hljs-keyword"><span class="hljs-keyword">debug</span></span> <span class="hljs-keyword"><span class="hljs-keyword">level</span></span> <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> PID <span class="hljs-number"><span class="hljs-number">1234</span></span> <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> <span class="hljs-number"><span class="hljs-number">10</span></span></code> <br>  : ¬´    ?¬ª <br>  ,      .     Windows-    .  <i>smbd</i>     .    <i>smbclient</i>  ,   : <br> <code class="bash">$ smbclient //TROUBLE/<span class="hljs-built_in"><span class="hljs-built_in">public</span></span> -U testuser%test <span class="hljs-keyword"><span class="hljs-keyword">session</span></span> setup failed: ERRSRV - ERRbadpw (Bad <span class="hljs-keyword"><span class="hljs-keyword">password</span></span> - <span class="hljs-type"><span class="hljs-type">name</span></span>/<span class="hljs-keyword"><span class="hljs-keyword">password</span></span> pair <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> a Tree <span class="hljs-keyword"><span class="hljs-keyword">Connect</span></span> <span class="hljs-keyword"><span class="hljs-keyword">or</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Session</span></span> Setup are invalid.)</code> <br>   ,   smbpasswd ,   ‚Äî test.    ,  <br> <code class="bash"><span class="hljs-keyword"><span class="hljs-keyword">log</span></span> <span class="hljs-keyword"><span class="hljs-keyword">level</span></span> = <span class="hljs-number"><span class="hljs-number">10</span></span> <span class="hljs-keyword"><span class="hljs-keyword">log</span></span> file = /usr/<span class="hljs-keyword"><span class="hljs-keyword">local</span></span>/samba/var/<span class="hljs-keyword"><span class="hljs-keyword">log</span></span>.%m</code> <br>   [<span class="hljs-keyword"><span class="hljs-keyword">global</span></span>]  <b>smb.conf</b> ,        <b><span class="hljs-keyword"><span class="hljs-keyword">log</span></span>.TROUBLE</b> : <br> <code class="bash">pdb_getsampwnam: <span class="hljs-keyword"><span class="hljs-keyword">search</span></span> <span class="hljs-keyword"><span class="hljs-keyword">by</span></span> <span class="hljs-type"><span class="hljs-type">name</span></span>: testuser startsmbfilepwent_internal: opening file /usr/<span class="hljs-keyword"><span class="hljs-keyword">local</span></span>/samba/private/smbpasswd getsmbfilepwent: <span class="hljs-keyword"><span class="hljs-keyword">returning</span></span> passwd entry <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> <span class="hljs-keyword"><span class="hljs-keyword">user</span></span> root, uid <span class="hljs-number"><span class="hljs-number">0</span></span> getsmbfilepwent: <span class="hljs-keyword"><span class="hljs-keyword">returning</span></span> passwd entry <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> <span class="hljs-keyword"><span class="hljs-keyword">user</span></span> jerry, uid <span class="hljs-number"><span class="hljs-number">786</span></span> getsmbfilepwent: <span class="hljs-keyword"><span class="hljs-keyword">returning</span></span> passwd entry <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> <span class="hljs-keyword"><span class="hljs-keyword">user</span></span> guest1, uid <span class="hljs-number"><span class="hljs-number">782</span></span> getsmbfilepwent: <span class="hljs-keyword"><span class="hljs-keyword">returning</span></span> passwd entry <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> <span class="hljs-keyword"><span class="hljs-keyword">user</span></span> testuser, uid <span class="hljs-number"><span class="hljs-number">791</span></span> endsmbfilepwent_internal: closed <span class="hljs-keyword"><span class="hljs-keyword">password</span></span> file. pdb_getsampwnam: <span class="hljs-built_in"><span class="hljs-built_in">found</span></span> <span class="hljs-keyword"><span class="hljs-keyword">by</span></span> <span class="hljs-type"><span class="hljs-type">name</span></span>: testuser build_sam_account: smbpasswd <span class="hljs-keyword"><span class="hljs-keyword">database</span></span> <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> corrupt! username testuser <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> unix passwd <span class="hljs-keyword"><span class="hljs-keyword">database</span></span>! Couldn<span class="hljs-string"><span class="hljs-string">'t find user '</span></span>testuser<span class="hljs-string"><span class="hljs-string">' in passdb.</span></span></code><span class="hljs-string"><span class="hljs-string"> </span></span><br><span class="hljs-string"><span class="hljs-string">        . </span></span><i><span class="hljs-string"><span class="hljs-string">Samba</span></span></i><span class="hljs-string"><span class="hljs-string">      testuser.   ,   -     </span></span><b><span class="hljs-string"><span class="hljs-string">/etc/passwd</span></span></b><span class="hljs-string"><span class="hljs-string"> : </span></span><br><span class="hljs-string"><span class="hljs-string"> #testuser:x:791:100::/dev/null:/bin/false </span></span><br><span class="hljs-string"><span class="hljs-string">  ,      (#)     ,   .     . </span></span><br><span class="hljs-string"><span class="hljs-string"> </span></span><code class="bash"><span class="hljs-string"><span class="hljs-string">$ smbclient //TROUBLE/public -U testuser%test Domain=[LAB] OS=[Unix] Server=[Samba 2.2.2] smb: \&gt;</span></span></code><span class="hljs-string"><span class="hljs-string"> </span></span><br><span class="hljs-string"><span class="hljs-string">     .      ,    </span></span><i><span class="hljs-string"><span class="hljs-string">grep</span></span></i><span class="hljs-string"><span class="hljs-string"> ,     : </span></span><br><span class="hljs-string"><span class="hljs-string"> ‚Ä¢ fail </span></span><br><span class="hljs-string"><span class="hljs-string"> ‚Ä¢ error </span></span><br><span class="hljs-string"><span class="hljs-string"> ‚Ä¢ unsuccessful </span></span><br><span class="hljs-string"><span class="hljs-string"> ‚Ä¢ corrupt </span></span><br><span class="hljs-string"><span class="hljs-string"> ‚Ä¢ unknown </span></span><br><span class="hljs-string"><span class="hljs-string"> </span></span><br><span class="hljs-string"><span class="hljs-string"> </span></span><b><span class="hljs-string"><span class="hljs-string">  </span></span></b><span class="hljs-string"><span class="hljs-string"> </span></span><br><span class="hljs-string"><span class="hljs-string">       ‚Äî    ,       .      -,  Wireshark.             . </span></span><br><span class="hljs-string"><span class="hljs-string"> </span></span><br><span class="hljs-string"><span class="hljs-string">  6 </span></span><br><span class="hljs-string"><span class="hljs-string">   Samba </span></span><br><span class="hljs-string"><span class="hljs-string">       ‚Äî ,    -  </span></span><i><span class="hljs-string"><span class="hljs-string">Samba</span></span></i><span class="hljs-string"><span class="hljs-string"> .       .         ,      </span></span><i><span class="hljs-string"><span class="hljs-string">Samba</span></span></i><span class="hljs-string"><span class="hljs-string"> ,      :     . </span></span><br><span class="hljs-string"><span class="hljs-string"> </span></span><br><span class="hljs-string"><span class="hljs-string">  </span></span><br><span class="hljs-string"><span class="hljs-string"> ,        </span></span><i><span class="hljs-string"><span class="hljs-string">Samba</span></span></i><span class="hljs-string"><span class="hljs-string"> .     ,          .     : </span></span><br><span class="hljs-string"><span class="hljs-string"> ‚Ä¢ 1.     </span></span><b><span class="hljs-string"><span class="hljs-string">smb.conf</span></span></b><span class="hljs-string"><span class="hljs-string"> . </span></span><br><span class="hljs-string"><span class="hljs-string"> ‚Ä¢ 2.    . </span></span><br><span class="hljs-string"><span class="hljs-string"> ‚Ä¢ 3.    . </span></span><br><span class="hljs-string"><span class="hljs-string"> ‚Ä¢ 4.  . </span></span><br><span class="hljs-string"><span class="hljs-string"> ‚Ä¢ 5.    . </span></span><br><span class="hljs-string"><span class="hljs-string"> ‚Ä¢ 6.   </span></span><i><span class="hljs-string"><span class="hljs-string">Samba</span></span></i><span class="hljs-string"><span class="hljs-string"> . </span></span><br><span class="hljs-string"><span class="hljs-string">   , , ,     - .              .         .        .         !</span></span></code></code> </pre> <code><code class="bash">/user:: <br> C:\WINNT\&gt;net use \\TROUBLE\public /user:user1 The password or user name is invalid for \\TROUBLE\public. Type the password for \\TROUBLE\public: The command completed successfully.</code> <br>    ,   .         -,    . <br> <br>  4 <br>   <br>        ‚Äî   .  ,      ,        ,          ,       :    . <br> <br>  5 <br> -    <br>           .     .     ¬´¬ª        Samba    .    ,    .       ,     . <br> <br> <b>- Samba</b> <br>   ,      . <br> <br> <img src="https://habrastorage.org/storage2/fbd/11b/b8a/fbd11bb8ada955a99b10f832b0edb4f8.png"> <br> <br>      <i>smbd</i> (,  pid 1234),    -   root: <br> <code class="bash">root# smbcontrol 1234 debuglevel Current debug level of PID 1234 is 0</code> <br>        10,     ,   : <br> <code class="bash">root# smbcontrol 1234 debug 10 root# smbcontrol 1234 debuglevel Current debug level of PID 1234 is 10</code> <br>  : ¬´    ?¬ª <br>  ,      .     Windows-    .  <i>smbd</i>     .    <i>smbclient</i>  ,   : <br> <code class="bash">$ smbclient //TROUBLE/public -U testuser%test session setup failed: ERRSRV - ERRbadpw (Bad password - name/password pair in a Tree Connect or Session Setup are invalid.)</code> <br>   ,   smbpasswd ,   ‚Äî test.    ,  <br> <code class="bash">log level = 10 log file = /usr/local/samba/var/log.%m</code> <br>   [global]  <b>smb.conf</b> ,        <b>log.TROUBLE</b> : <br> <code class="bash">pdb_getsampwnam: search by name: testuser startsmbfilepwent_internal: opening file /usr/local/samba/private/smbpasswd getsmbfilepwent: returning passwd entry for user root, uid 0 getsmbfilepwent: returning passwd entry for user jerry, uid 786 getsmbfilepwent: returning passwd entry for user guest1, uid 782 getsmbfilepwent: returning passwd entry for user testuser, uid 791 endsmbfilepwent_internal: closed password file. pdb_getsampwnam: found by name: testuser build_sam_account: smbpasswd database is corrupt! username testuser not in unix passwd database! Couldn't find user 'testuser' in passdb.</code> <br>        . <i>Samba</i>      testuser.   ,   -     <b>/etc/passwd</b> : <br> <code class="bash">#testuser:x:791:100::/dev/null:/bin/false</code> <br>  ,      (#)     ,   .     . <br> <code class="bash">$ smbclient //TROUBLE/public -U testuser%test Domain=[LAB] OS=[Unix] Server=[Samba 2.2.2] smb: \&gt;</code> <br>     .      ,    <i>grep</i> ,     : <br> ‚Ä¢ fail <br> ‚Ä¢ error <br> ‚Ä¢ unsuccessful <br> ‚Ä¢ corrupt <br> ‚Ä¢ unknown <br> <br> <b>  </b> <br>       ‚Äî    ,       .      -,  Wireshark.             . <br> <br>  6 <br>   Samba <br>       ‚Äî ,    -  <i>Samba</i> .       .         ,      <i>Samba</i> ,      :     . <br> <br>  <br> ,        <i>Samba</i> .     ,          .     : <br> ‚Ä¢ 1.     <b>smb.conf</b> . <br> ‚Ä¢ 2.    . <br> ‚Ä¢ 3.    . <br> ‚Ä¢ 4.  . <br> ‚Ä¢ 5.    . <br> ‚Ä¢ 6.   <i>Samba</i> . <br>   , , ,     - .              .         .        .         !</code> <pre> <code class="hljs pgsql"><code class="bash"><code class="bash">/<span class="hljs-keyword"><span class="hljs-keyword">user</span></span>:: <br> C:\WINNT\&gt;net use \\TROUBLE\<span class="hljs-built_in"><span class="hljs-built_in">public</span></span> /<span class="hljs-keyword"><span class="hljs-keyword">user</span></span>:user1 The <span class="hljs-keyword"><span class="hljs-keyword">password</span></span> <span class="hljs-keyword"><span class="hljs-keyword">or</span></span> <span class="hljs-keyword"><span class="hljs-keyword">user</span></span> <span class="hljs-type"><span class="hljs-type">name</span></span> <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> invalid <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> \\TROUBLE\<span class="hljs-built_in"><span class="hljs-built_in">public</span></span>. <span class="hljs-keyword"><span class="hljs-keyword">Type</span></span> the <span class="hljs-keyword"><span class="hljs-keyword">password</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> \\TROUBLE\<span class="hljs-built_in"><span class="hljs-built_in">public</span></span>: The command completed successfully.</code> <br>    ,   .         -,    . <br> <br>  <span class="hljs-number"><span class="hljs-number">4</span></span> <br>   <br>        ‚Äî   .  ,      ,        ,          ,       :    . <br> <br>  <span class="hljs-number"><span class="hljs-number">5</span></span> <br> -    <br>           .     .     ¬´¬ª        Samba    .    ,    .       ,     . <br> <br> <b>- Samba</b> <br>   ,      . <br> <br> <img src="https://habrastorage.org/storage2/fbd/11b/b8a/fbd11bb8ada955a99b10f832b0edb4f8.png"> <br> <br>      <i>smbd</i> (,  pid <span class="hljs-number"><span class="hljs-number">1234</span></span>),    -   root: <br> <code class="bash">root# smbcontrol <span class="hljs-number"><span class="hljs-number">1234</span></span> debuglevel <span class="hljs-keyword"><span class="hljs-keyword">Current</span></span> <span class="hljs-keyword"><span class="hljs-keyword">debug</span></span> <span class="hljs-keyword"><span class="hljs-keyword">level</span></span> <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> PID <span class="hljs-number"><span class="hljs-number">1234</span></span> <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span></code> <br>        <span class="hljs-number"><span class="hljs-number">10</span></span>,     ,   : <br> <code class="bash">root# smbcontrol <span class="hljs-number"><span class="hljs-number">1234</span></span> <span class="hljs-keyword"><span class="hljs-keyword">debug</span></span> <span class="hljs-number"><span class="hljs-number">10</span></span> root# smbcontrol <span class="hljs-number"><span class="hljs-number">1234</span></span> debuglevel <span class="hljs-keyword"><span class="hljs-keyword">Current</span></span> <span class="hljs-keyword"><span class="hljs-keyword">debug</span></span> <span class="hljs-keyword"><span class="hljs-keyword">level</span></span> <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> PID <span class="hljs-number"><span class="hljs-number">1234</span></span> <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> <span class="hljs-number"><span class="hljs-number">10</span></span></code> <br>  : ¬´    ?¬ª <br>  ,      .     Windows-    .  <i>smbd</i>     .    <i>smbclient</i>  ,   : <br> <code class="bash">$ smbclient //TROUBLE/<span class="hljs-built_in"><span class="hljs-built_in">public</span></span> -U testuser%test <span class="hljs-keyword"><span class="hljs-keyword">session</span></span> setup failed: ERRSRV - ERRbadpw (Bad <span class="hljs-keyword"><span class="hljs-keyword">password</span></span> - <span class="hljs-type"><span class="hljs-type">name</span></span>/<span class="hljs-keyword"><span class="hljs-keyword">password</span></span> pair <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> a Tree <span class="hljs-keyword"><span class="hljs-keyword">Connect</span></span> <span class="hljs-keyword"><span class="hljs-keyword">or</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Session</span></span> Setup are invalid.)</code> <br>   ,   smbpasswd ,   ‚Äî test.    ,  <br> <code class="bash"><span class="hljs-keyword"><span class="hljs-keyword">log</span></span> <span class="hljs-keyword"><span class="hljs-keyword">level</span></span> = <span class="hljs-number"><span class="hljs-number">10</span></span> <span class="hljs-keyword"><span class="hljs-keyword">log</span></span> file = /usr/<span class="hljs-keyword"><span class="hljs-keyword">local</span></span>/samba/var/<span class="hljs-keyword"><span class="hljs-keyword">log</span></span>.%m</code> <br>   [<span class="hljs-keyword"><span class="hljs-keyword">global</span></span>]  <b>smb.conf</b> ,        <b><span class="hljs-keyword"><span class="hljs-keyword">log</span></span>.TROUBLE</b> : <br> <code class="bash">pdb_getsampwnam: <span class="hljs-keyword"><span class="hljs-keyword">search</span></span> <span class="hljs-keyword"><span class="hljs-keyword">by</span></span> <span class="hljs-type"><span class="hljs-type">name</span></span>: testuser startsmbfilepwent_internal: opening file /usr/<span class="hljs-keyword"><span class="hljs-keyword">local</span></span>/samba/private/smbpasswd getsmbfilepwent: <span class="hljs-keyword"><span class="hljs-keyword">returning</span></span> passwd entry <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> <span class="hljs-keyword"><span class="hljs-keyword">user</span></span> root, uid <span class="hljs-number"><span class="hljs-number">0</span></span> getsmbfilepwent: <span class="hljs-keyword"><span class="hljs-keyword">returning</span></span> passwd entry <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> <span class="hljs-keyword"><span class="hljs-keyword">user</span></span> jerry, uid <span class="hljs-number"><span class="hljs-number">786</span></span> getsmbfilepwent: <span class="hljs-keyword"><span class="hljs-keyword">returning</span></span> passwd entry <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> <span class="hljs-keyword"><span class="hljs-keyword">user</span></span> guest1, uid <span class="hljs-number"><span class="hljs-number">782</span></span> getsmbfilepwent: <span class="hljs-keyword"><span class="hljs-keyword">returning</span></span> passwd entry <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> <span class="hljs-keyword"><span class="hljs-keyword">user</span></span> testuser, uid <span class="hljs-number"><span class="hljs-number">791</span></span> endsmbfilepwent_internal: closed <span class="hljs-keyword"><span class="hljs-keyword">password</span></span> file. pdb_getsampwnam: <span class="hljs-built_in"><span class="hljs-built_in">found</span></span> <span class="hljs-keyword"><span class="hljs-keyword">by</span></span> <span class="hljs-type"><span class="hljs-type">name</span></span>: testuser build_sam_account: smbpasswd <span class="hljs-keyword"><span class="hljs-keyword">database</span></span> <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> corrupt! username testuser <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> unix passwd <span class="hljs-keyword"><span class="hljs-keyword">database</span></span>! Couldn<span class="hljs-string"><span class="hljs-string">'t find user '</span></span>testuser<span class="hljs-string"><span class="hljs-string">' in passdb.</span></span></code><span class="hljs-string"><span class="hljs-string"> </span></span><br><span class="hljs-string"><span class="hljs-string">        . </span></span><i><span class="hljs-string"><span class="hljs-string">Samba</span></span></i><span class="hljs-string"><span class="hljs-string">      testuser.   ,   -     </span></span><b><span class="hljs-string"><span class="hljs-string">/etc/passwd</span></span></b><span class="hljs-string"><span class="hljs-string"> : </span></span><br><span class="hljs-string"><span class="hljs-string"> </span></span><code class="bash"><span class="hljs-string"><span class="hljs-string">#testuser:x:791:100::/dev/null:/bin/false</span></span></code><span class="hljs-string"><span class="hljs-string"> </span></span><br><span class="hljs-string"><span class="hljs-string">  ,      (#)     ,   .     . </span></span><br><span class="hljs-string"><span class="hljs-string"> $ smbclient //TROUBLE/public -U testuser%test Domain=[LAB] OS=[Unix] Server=[Samba 2.2.2] smb: \&gt; </span></span><br><span class="hljs-string"><span class="hljs-string">     .      ,    </span></span><i><span class="hljs-string"><span class="hljs-string">grep</span></span></i><span class="hljs-string"><span class="hljs-string"> ,     : </span></span><br><span class="hljs-string"><span class="hljs-string"> ‚Ä¢ fail </span></span><br><span class="hljs-string"><span class="hljs-string"> ‚Ä¢ error </span></span><br><span class="hljs-string"><span class="hljs-string"> ‚Ä¢ unsuccessful </span></span><br><span class="hljs-string"><span class="hljs-string"> ‚Ä¢ corrupt </span></span><br><span class="hljs-string"><span class="hljs-string"> ‚Ä¢ unknown </span></span><br><span class="hljs-string"><span class="hljs-string"> </span></span><br><span class="hljs-string"><span class="hljs-string"> </span></span><b><span class="hljs-string"><span class="hljs-string">  </span></span></b><span class="hljs-string"><span class="hljs-string"> </span></span><br><span class="hljs-string"><span class="hljs-string">       ‚Äî    ,       .      -,  Wireshark.             . </span></span><br><span class="hljs-string"><span class="hljs-string"> </span></span><br><span class="hljs-string"><span class="hljs-string">  6 </span></span><br><span class="hljs-string"><span class="hljs-string">   Samba </span></span><br><span class="hljs-string"><span class="hljs-string">       ‚Äî ,    -  </span></span><i><span class="hljs-string"><span class="hljs-string">Samba</span></span></i><span class="hljs-string"><span class="hljs-string"> .       .         ,      </span></span><i><span class="hljs-string"><span class="hljs-string">Samba</span></span></i><span class="hljs-string"><span class="hljs-string"> ,      :     . </span></span><br><span class="hljs-string"><span class="hljs-string"> </span></span><br><span class="hljs-string"><span class="hljs-string">  </span></span><br><span class="hljs-string"><span class="hljs-string"> ,        </span></span><i><span class="hljs-string"><span class="hljs-string">Samba</span></span></i><span class="hljs-string"><span class="hljs-string"> .     ,          .     : </span></span><br><span class="hljs-string"><span class="hljs-string"> ‚Ä¢ 1.     </span></span><b><span class="hljs-string"><span class="hljs-string">smb.conf</span></span></b><span class="hljs-string"><span class="hljs-string"> . </span></span><br><span class="hljs-string"><span class="hljs-string"> ‚Ä¢ 2.    . </span></span><br><span class="hljs-string"><span class="hljs-string"> ‚Ä¢ 3.    . </span></span><br><span class="hljs-string"><span class="hljs-string"> ‚Ä¢ 4.  . </span></span><br><span class="hljs-string"><span class="hljs-string"> ‚Ä¢ 5.    . </span></span><br><span class="hljs-string"><span class="hljs-string"> ‚Ä¢ 6.   </span></span><i><span class="hljs-string"><span class="hljs-string">Samba</span></span></i><span class="hljs-string"><span class="hljs-string"> . </span></span><br><span class="hljs-string"><span class="hljs-string">   , , ,     - .              .         .        .         !</span></span></code></code> </pre> <code><code class="bash">/user:: <br> C:\WINNT\&gt;net use \\TROUBLE\public /user:user1 The password or user name is invalid for \\TROUBLE\public. Type the password for \\TROUBLE\public: The command completed successfully.</code> <br>    ,   .         -,    . <br> <br>  4 <br>   <br>        ‚Äî   .  ,      ,        ,          ,       :    . <br> <br>  5 <br> -    <br>           .     .     ¬´¬ª        Samba    .    ,    .       ,     . <br> <br> <b>- Samba</b> <br>   ,      . <br> <br> <img src="https://habrastorage.org/storage2/fbd/11b/b8a/fbd11bb8ada955a99b10f832b0edb4f8.png"> <br> <br>      <i>smbd</i> (,  pid 1234),    -   root: <br> <code class="bash">root# smbcontrol 1234 debuglevel Current debug level of PID 1234 is 0</code> <br>        10,     ,   : <br> <code class="bash">root# smbcontrol 1234 debug 10 root# smbcontrol 1234 debuglevel Current debug level of PID 1234 is 10</code> <br>  : ¬´    ?¬ª <br>  ,      .     Windows-    .  <i>smbd</i>     .    <i>smbclient</i>  ,   : <br> <code class="bash">$ smbclient //TROUBLE/public -U testuser%test session setup failed: ERRSRV - ERRbadpw (Bad password - name/password pair in a Tree Connect or Session Setup are invalid.)</code> <br>   ,   smbpasswd ,   ‚Äî test.    ,  <br> <code class="bash">log level = 10 log file = /usr/local/samba/var/log.%m</code> <br>   [global]  <b>smb.conf</b> ,        <b>log.TROUBLE</b> : <br> <code class="bash">pdb_getsampwnam: search by name: testuser startsmbfilepwent_internal: opening file /usr/local/samba/private/smbpasswd getsmbfilepwent: returning passwd entry for user root, uid 0 getsmbfilepwent: returning passwd entry for user jerry, uid 786 getsmbfilepwent: returning passwd entry for user guest1, uid 782 getsmbfilepwent: returning passwd entry for user testuser, uid 791 endsmbfilepwent_internal: closed password file. pdb_getsampwnam: found by name: testuser build_sam_account: smbpasswd database is corrupt! username testuser not in unix passwd database! Couldn't find user 'testuser' in passdb.</code> <br>        . <i>Samba</i>      testuser.   ,   -     <b>/etc/passwd</b> : <br> <code class="bash">#testuser:x:791:100::/dev/null:/bin/false</code> <br>  ,      (#)     ,   .     . <br> <code class="bash">$ smbclient //TROUBLE/public -U testuser%test Domain=[LAB] OS=[Unix] Server=[Samba 2.2.2] smb: \&gt;</code> <br>     .      ,    <i>grep</i> ,     : <br> ‚Ä¢ fail <br> ‚Ä¢ error <br> ‚Ä¢ unsuccessful <br> ‚Ä¢ corrupt <br> ‚Ä¢ unknown <br> <br> <b>  </b> <br>       ‚Äî    ,       .      -,  Wireshark.             . <br> <br>  6 <br>   Samba <br>       ‚Äî ,    -  <i>Samba</i> .       .         ,      <i>Samba</i> ,      :     . <br> <br>  <br> ,        <i>Samba</i> .     ,          .     : <br> ‚Ä¢ 1.     <b>smb.conf</b> . <br> ‚Ä¢ 2.    . <br> ‚Ä¢ 3.    . <br> ‚Ä¢ 4.  . <br> ‚Ä¢ 5.    . <br> ‚Ä¢ 6.   <i>Samba</i> . <br>   , , ,     - .              .         .        .         !</code> <h5> <code><code class="bash">/user:: <br> C:\WINNT\&gt;net use \\TROUBLE\public /user:user1 The password or user name is invalid for \\TROUBLE\public. Type the password for \\TROUBLE\public: The command completed successfully.</code> <br>    ,   .         -,    . <br> <br>  4 <br>   <br>        ‚Äî   .  ,      ,        ,          ,       :    . <br> <br>  5 <br> -    <br>           .     .     ¬´¬ª        Samba    .    ,    .       ,     . <br> <br> <b>- Samba</b> <br>   ,      . <br> <br> <img src="https://habrastorage.org/storage2/fbd/11b/b8a/fbd11bb8ada955a99b10f832b0edb4f8.png"> <br> <br>      <i>smbd</i> (,  pid 1234),    -   root: <br> <code class="bash">root# smbcontrol 1234 debuglevel Current debug level of PID 1234 is 0</code> <br>        10,     ,   : <br> <code class="bash">root# smbcontrol 1234 debug 10 root# smbcontrol 1234 debuglevel Current debug level of PID 1234 is 10</code> <br>  : ¬´    ?¬ª <br>  ,      .     Windows-    .  <i>smbd</i>     .    <i>smbclient</i>  ,   : <br> <code class="bash">$ smbclient //TROUBLE/public -U testuser%test session setup failed: ERRSRV - ERRbadpw (Bad password - name/password pair in a Tree Connect or Session Setup are invalid.)</code> <br>   ,   smbpasswd ,   ‚Äî test.    ,  <br> <code class="bash">log level = 10 log file = /usr/local/samba/var/log.%m</code> <br>   [global]  <b>smb.conf</b> ,        <b>log.TROUBLE</b> : <br> <code class="bash">pdb_getsampwnam: search by name: testuser startsmbfilepwent_internal: opening file /usr/local/samba/private/smbpasswd getsmbfilepwent: returning passwd entry for user root, uid 0 getsmbfilepwent: returning passwd entry for user jerry, uid 786 getsmbfilepwent: returning passwd entry for user guest1, uid 782 getsmbfilepwent: returning passwd entry for user testuser, uid 791 endsmbfilepwent_internal: closed password file. pdb_getsampwnam: found by name: testuser build_sam_account: smbpasswd database is corrupt! username testuser not in unix passwd database! Couldn't find user 'testuser' in passdb.</code> <br>        . <i>Samba</i>      testuser.   ,   -     <b>/etc/passwd</b> : <br> <code class="bash">#testuser:x:791:100::/dev/null:/bin/false</code> <br>  ,      (#)     ,   .     . <br> <code class="bash">$ smbclient //TROUBLE/public -U testuser%test Domain=[LAB] OS=[Unix] Server=[Samba 2.2.2] smb: \&gt;</code> <br>     .      ,    <i>grep</i> ,     : <br> ‚Ä¢ fail <br> ‚Ä¢ error <br> ‚Ä¢ unsuccessful <br> ‚Ä¢ corrupt <br> ‚Ä¢ unknown <br> <br> <b>  </b> <br>       ‚Äî    ,       .      -,  Wireshark.             . <br> <br>  6 <br>   Samba <br>       ‚Äî ,    -  <i>Samba</i> .       .         ,      <i>Samba</i> ,      :     . <br> <br>  <br> ,        <i>Samba</i> .     ,          .     : <br> ‚Ä¢ 1.     <b>smb.conf</b> . <br> ‚Ä¢ 2.    . <br> ‚Ä¢ 3.    . <br> ‚Ä¢ 4.  . <br> ‚Ä¢ 5.    . <br> ‚Ä¢ 6.   <i>Samba</i> . <br>   , , ,     - .              .         .        .         !</code> </h5> <code><code class="bash">/user:: <br> C:\WINNT\&gt;net use \\TROUBLE\public /user:user1 The password or user name is invalid for \\TROUBLE\public. Type the password for \\TROUBLE\public: The command completed successfully.</code> <br>    ,   .         -,    . <br> <br>  4 <br>   <br>        ‚Äî   .  ,      ,        ,          ,       :    . <br> <br>  5 <br> -    <br>           .     .     ¬´¬ª        Samba    .    ,    .       ,     . <br> <br> <b>- Samba</b> <br>   ,      . <br> <br> <img src="https://habrastorage.org/storage2/fbd/11b/b8a/fbd11bb8ada955a99b10f832b0edb4f8.png"> <br> <br>      <i>smbd</i> (,  pid 1234),    -   root: <br> <code class="bash">root# smbcontrol 1234 debuglevel Current debug level of PID 1234 is 0</code> <br>        10,     ,   : <br> <code class="bash">root# smbcontrol 1234 debug 10 root# smbcontrol 1234 debuglevel Current debug level of PID 1234 is 10</code> <br>  : ¬´    ?¬ª <br>  ,      .     Windows-    .  <i>smbd</i>     .    <i>smbclient</i>  ,   : <br> <code class="bash">$ smbclient //TROUBLE/public -U testuser%test session setup failed: ERRSRV - ERRbadpw (Bad password - name/password pair in a Tree Connect or Session Setup are invalid.)</code> <br>   ,   smbpasswd ,   ‚Äî test.    ,  <br> <code class="bash">log level = 10 log file = /usr/local/samba/var/log.%m</code> <br>   [global]  <b>smb.conf</b> ,        <b>log.TROUBLE</b> : <br> <code class="bash">pdb_getsampwnam: search by name: testuser startsmbfilepwent_internal: opening file /usr/local/samba/private/smbpasswd getsmbfilepwent: returning passwd entry for user root, uid 0 getsmbfilepwent: returning passwd entry for user jerry, uid 786 getsmbfilepwent: returning passwd entry for user guest1, uid 782 getsmbfilepwent: returning passwd entry for user testuser, uid 791 endsmbfilepwent_internal: closed password file. pdb_getsampwnam: found by name: testuser build_sam_account: smbpasswd database is corrupt! username testuser not in unix passwd database! Couldn't find user 'testuser' in passdb.</code> <br>        . <i>Samba</i>      testuser.   ,   -     <b>/etc/passwd</b> : <br> <code class="bash">#testuser:x:791:100::/dev/null:/bin/false</code> <br>  ,      (#)     ,   .     . <br> <code class="bash">$ smbclient //TROUBLE/public -U testuser%test Domain=[LAB] OS=[Unix] Server=[Samba 2.2.2] smb: \&gt;</code> <br>     .      ,    <i>grep</i> ,     : <br> ‚Ä¢ fail <br> ‚Ä¢ error <br> ‚Ä¢ unsuccessful <br> ‚Ä¢ corrupt <br> ‚Ä¢ unknown <br> <br> <b>  </b> <br>       ‚Äî    ,       .      -,  Wireshark.             . <br> <br>  6 <br>   Samba <br>       ‚Äî ,    -  <i>Samba</i> .       .         ,      <i>Samba</i> ,      :     . <br> <br>  <br> ,        <i>Samba</i> .     ,          .     : <br> ‚Ä¢ 1.     <b>smb.conf</b> . <br> ‚Ä¢ 2.    . <br> ‚Ä¢ 3.    . <br> ‚Ä¢ 4.  . <br> ‚Ä¢ 5.    . <br> ‚Ä¢ 6.   <i>Samba</i> . <br>   , , ,     - .              .         .        .         !</code> <h5> <code><code class="bash">/user:: <br> C:\WINNT\&gt;net use \\TROUBLE\public /user:user1 The password or user name is invalid for \\TROUBLE\public. Type the password for \\TROUBLE\public: The command completed successfully.</code> <br>    ,   .         -,    . <br> <br>  4 <br>   <br>        ‚Äî   .  ,      ,        ,          ,       :    . <br> <br>  5 <br> -    <br>           .     .     ¬´¬ª        Samba    .    ,    .       ,     . <br> <br> <b>- Samba</b> <br>   ,      . <br> <br> <img src="https://habrastorage.org/storage2/fbd/11b/b8a/fbd11bb8ada955a99b10f832b0edb4f8.png"> <br> <br>      <i>smbd</i> (,  pid 1234),    -   root: <br> <code class="bash">root# smbcontrol 1234 debuglevel Current debug level of PID 1234 is 0</code> <br>        10,     ,   : <br> <code class="bash">root# smbcontrol 1234 debug 10 root# smbcontrol 1234 debuglevel Current debug level of PID 1234 is 10</code> <br>  : ¬´    ?¬ª <br>  ,      .     Windows-    .  <i>smbd</i>     .    <i>smbclient</i>  ,   : <br> <code class="bash">$ smbclient //TROUBLE/public -U testuser%test session setup failed: ERRSRV - ERRbadpw (Bad password - name/password pair in a Tree Connect or Session Setup are invalid.)</code> <br>   ,   smbpasswd ,   ‚Äî test.    ,  <br> <code class="bash">log level = 10 log file = /usr/local/samba/var/log.%m</code> <br>   [global]  <b>smb.conf</b> ,        <b>log.TROUBLE</b> : <br> <code class="bash">pdb_getsampwnam: search by name: testuser startsmbfilepwent_internal: opening file /usr/local/samba/private/smbpasswd getsmbfilepwent: returning passwd entry for user root, uid 0 getsmbfilepwent: returning passwd entry for user jerry, uid 786 getsmbfilepwent: returning passwd entry for user guest1, uid 782 getsmbfilepwent: returning passwd entry for user testuser, uid 791 endsmbfilepwent_internal: closed password file. pdb_getsampwnam: found by name: testuser build_sam_account: smbpasswd database is corrupt! username testuser not in unix passwd database! Couldn't find user 'testuser' in passdb.</code> <br>        . <i>Samba</i>      testuser.   ,   -     <b>/etc/passwd</b> : <br> <code class="bash">#testuser:x:791:100::/dev/null:/bin/false</code> <br>  ,      (#)     ,   .     . <br> <code class="bash">$ smbclient //TROUBLE/public -U testuser%test Domain=[LAB] OS=[Unix] Server=[Samba 2.2.2] smb: \&gt;</code> <br>     .      ,    <i>grep</i> ,     : <br> ‚Ä¢ fail <br> ‚Ä¢ error <br> ‚Ä¢ unsuccessful <br> ‚Ä¢ corrupt <br> ‚Ä¢ unknown <br> <br> <b>  </b> <br>       ‚Äî    ,       .      -,  Wireshark.             . <br> <br>  6 <br>   Samba <br>       ‚Äî ,    -  <i>Samba</i> .       .         ,      <i>Samba</i> ,      :     . <br> <br>  <br> ,        <i>Samba</i> .     ,          .     : <br> ‚Ä¢ 1.     <b>smb.conf</b> . <br> ‚Ä¢ 2.    . <br> ‚Ä¢ 3.    . <br> ‚Ä¢ 4.  . <br> ‚Ä¢ 5.    . <br> ‚Ä¢ 6.   <i>Samba</i> . <br>   , , ,     - .              .         .        .         !</code> </h5> <code><code class="bash">/user:: <br> C:\WINNT\&gt;net use \\TROUBLE\public /user:user1 The password or user name is invalid for \\TROUBLE\public. Type the password for \\TROUBLE\public: The command completed successfully.</code> <br>    ,   .         -,    . <br> <br>  4 <br>   <br>        ‚Äî   .  ,      ,        ,          ,       :    . <br> <br>  5 <br> -    <br>           .     .     ¬´¬ª        Samba    .    ,    .       ,     . <br> <br> <b>- Samba</b> <br>   ,      . <br> <br> <img src="https://habrastorage.org/storage2/fbd/11b/b8a/fbd11bb8ada955a99b10f832b0edb4f8.png"> <br> <br>      <i>smbd</i> (,  pid 1234),    -   root: <br> <code class="bash">root# smbcontrol 1234 debuglevel Current debug level of PID 1234 is 0</code> <br>        10,     ,   : <br> <code class="bash">root# smbcontrol 1234 debug 10 root# smbcontrol 1234 debuglevel Current debug level of PID 1234 is 10</code> <br>  : ¬´    ?¬ª <br>  ,      .     Windows-    .  <i>smbd</i>     .    <i>smbclient</i>  ,   : <br> <code class="bash">$ smbclient //TROUBLE/public -U testuser%test session setup failed: ERRSRV - ERRbadpw (Bad password - name/password pair in a Tree Connect or Session Setup are invalid.)</code> <br>   ,   smbpasswd ,   ‚Äî test.    ,  <br> <code class="bash">log level = 10 log file = /usr/local/samba/var/log.%m</code> <br>   [global]  <b>smb.conf</b> ,        <b>log.TROUBLE</b> : <br> <code class="bash">pdb_getsampwnam: search by name: testuser startsmbfilepwent_internal: opening file /usr/local/samba/private/smbpasswd getsmbfilepwent: returning passwd entry for user root, uid 0 getsmbfilepwent: returning passwd entry for user jerry, uid 786 getsmbfilepwent: returning passwd entry for user guest1, uid 782 getsmbfilepwent: returning passwd entry for user testuser, uid 791 endsmbfilepwent_internal: closed password file. pdb_getsampwnam: found by name: testuser build_sam_account: smbpasswd database is corrupt! username testuser not in unix passwd database! Couldn't find user 'testuser' in passdb.</code> <br>        . <i>Samba</i>      testuser.   ,   -     <b>/etc/passwd</b> : <br> <code class="bash">#testuser:x:791:100::/dev/null:/bin/false</code> <br>  ,      (#)     ,   .     . <br> <code class="bash">$ smbclient //TROUBLE/public -U testuser%test Domain=[LAB] OS=[Unix] Server=[Samba 2.2.2] smb: \&gt;</code> <br>     .      ,    <i>grep</i> ,     : <br> ‚Ä¢ fail <br> ‚Ä¢ error <br> ‚Ä¢ unsuccessful <br> ‚Ä¢ corrupt <br> ‚Ä¢ unknown <br> <br> <b>  </b> <br>       ‚Äî    ,       .      -,  Wireshark.             . <br> <br>  6 <br>   Samba <br>       ‚Äî ,    -  <i>Samba</i> .       .         ,      <i>Samba</i> ,      :     . <br> <br>  <br> ,        <i>Samba</i> .     ,          .     : <br> ‚Ä¢ 1.     <b>smb.conf</b> . <br> ‚Ä¢ 2.    . <br> ‚Ä¢ 3.    . <br> ‚Ä¢ 4.  . <br> ‚Ä¢ 5.    . <br> ‚Ä¢ 6.   <i>Samba</i> . <br>   , , ,     - .              .         .        .         !</code> <h5> <code><code class="bash">/user:: <br> C:\WINNT\&gt;net use \\TROUBLE\public /user:user1 The password or user name is invalid for \\TROUBLE\public. Type the password for \\TROUBLE\public: The command completed successfully.</code> <br>    ,   .         -,    . <br> <br>  4 <br>   <br>        ‚Äî   .  ,      ,        ,          ,       :    . <br> <br>  5 <br> -    <br>           .     .     ¬´¬ª        Samba    .    ,    .       ,     . <br> <br> <b>- Samba</b> <br>   ,      . <br> <br> <img src="https://habrastorage.org/storage2/fbd/11b/b8a/fbd11bb8ada955a99b10f832b0edb4f8.png"> <br> <br>      <i>smbd</i> (,  pid 1234),    -   root: <br> <code class="bash">root# smbcontrol 1234 debuglevel Current debug level of PID 1234 is 0</code> <br>        10,     ,   : <br> <code class="bash">root# smbcontrol 1234 debug 10 root# smbcontrol 1234 debuglevel Current debug level of PID 1234 is 10</code> <br>  : ¬´    ?¬ª <br>  ,      .     Windows-    .  <i>smbd</i>     .    <i>smbclient</i>  ,   : <br> <code class="bash">$ smbclient //TROUBLE/public -U testuser%test session setup failed: ERRSRV - ERRbadpw (Bad password - name/password pair in a Tree Connect or Session Setup are invalid.)</code> <br>   ,   smbpasswd ,   ‚Äî test.    ,  <br> <code class="bash">log level = 10 log file = /usr/local/samba/var/log.%m</code> <br>   [global]  <b>smb.conf</b> ,        <b>log.TROUBLE</b> : <br> <code class="bash">pdb_getsampwnam: search by name: testuser startsmbfilepwent_internal: opening file /usr/local/samba/private/smbpasswd getsmbfilepwent: returning passwd entry for user root, uid 0 getsmbfilepwent: returning passwd entry for user jerry, uid 786 getsmbfilepwent: returning passwd entry for user guest1, uid 782 getsmbfilepwent: returning passwd entry for user testuser, uid 791 endsmbfilepwent_internal: closed password file. pdb_getsampwnam: found by name: testuser build_sam_account: smbpasswd database is corrupt! username testuser not in unix passwd database! Couldn't find user 'testuser' in passdb.</code> <br>        . <i>Samba</i>      testuser.   ,   -     <b>/etc/passwd</b> : <br> <code class="bash">#testuser:x:791:100::/dev/null:/bin/false</code> <br>  ,      (#)     ,   .     . <br> <code class="bash">$ smbclient //TROUBLE/public -U testuser%test Domain=[LAB] OS=[Unix] Server=[Samba 2.2.2] smb: \&gt;</code> <br>     .      ,    <i>grep</i> ,     : <br> ‚Ä¢ fail <br> ‚Ä¢ error <br> ‚Ä¢ unsuccessful <br> ‚Ä¢ corrupt <br> ‚Ä¢ unknown <br> <br> <b>  </b> <br>       ‚Äî    ,       .      -,  Wireshark.             . <br> <br>  6 <br>   Samba <br>       ‚Äî ,    -  <i>Samba</i> .       .         ,      <i>Samba</i> ,      :     . <br> <br>  <br> ,        <i>Samba</i> .     ,          .     : <br> ‚Ä¢ 1.     <b>smb.conf</b> . <br> ‚Ä¢ 2.    . <br> ‚Ä¢ 3.    . <br> ‚Ä¢ 4.  . <br> ‚Ä¢ 5.    . <br> ‚Ä¢ 6.   <i>Samba</i> . <br>   , , ,     - .              .         .        .         !</code> </h5> <code><code class="bash">/user:: <br> C:\WINNT\&gt;net use \\TROUBLE\public /user:user1 The password or user name is invalid for \\TROUBLE\public. Type the password for \\TROUBLE\public: The command completed successfully.</code> <br>    ,   .         -,    . <br> <br>  4 <br>   <br>        ‚Äî   .  ,      ,        ,          ,       :    . <br> <br>  5 <br> -    <br>           .     .     ¬´¬ª        Samba    .    ,    .       ,     . <br> <br> <b>- Samba</b> <br>   ,      . <br> <br> <img src="https://habrastorage.org/storage2/fbd/11b/b8a/fbd11bb8ada955a99b10f832b0edb4f8.png"> <br> <br>      <i>smbd</i> (,  pid 1234),    -   root: <br> <code class="bash">root# smbcontrol 1234 debuglevel Current debug level of PID 1234 is 0</code> <br>        10,     ,   : <br> <code class="bash">root# smbcontrol 1234 debug 10 root# smbcontrol 1234 debuglevel Current debug level of PID 1234 is 10</code> <br>  : ¬´    ?¬ª <br>  ,      .     Windows-    .  <i>smbd</i>     .    <i>smbclient</i>  ,   : <br> <code class="bash">$ smbclient //TROUBLE/public -U testuser%test session setup failed: ERRSRV - ERRbadpw (Bad password - name/password pair in a Tree Connect or Session Setup are invalid.)</code> <br>   ,   smbpasswd ,   ‚Äî test.    ,  <br> <code class="bash">log level = 10 log file = /usr/local/samba/var/log.%m</code> <br>   [global]  <b>smb.conf</b> ,        <b>log.TROUBLE</b> : <br> <code class="bash">pdb_getsampwnam: search by name: testuser startsmbfilepwent_internal: opening file /usr/local/samba/private/smbpasswd getsmbfilepwent: returning passwd entry for user root, uid 0 getsmbfilepwent: returning passwd entry for user jerry, uid 786 getsmbfilepwent: returning passwd entry for user guest1, uid 782 getsmbfilepwent: returning passwd entry for user testuser, uid 791 endsmbfilepwent_internal: closed password file. pdb_getsampwnam: found by name: testuser build_sam_account: smbpasswd database is corrupt! username testuser not in unix passwd database! Couldn't find user 'testuser' in passdb.</code> <br>        . <i>Samba</i>      testuser.   ,   -     <b>/etc/passwd</b> : <br> <code class="bash">#testuser:x:791:100::/dev/null:/bin/false</code> <br>  ,      (#)     ,   .     . <br> <code class="bash">$ smbclient //TROUBLE/public -U testuser%test Domain=[LAB] OS=[Unix] Server=[Samba 2.2.2] smb: \&gt;</code> <br>     .      ,    <i>grep</i> ,     : <br> ‚Ä¢ fail <br> ‚Ä¢ error <br> ‚Ä¢ unsuccessful <br> ‚Ä¢ corrupt <br> ‚Ä¢ unknown <br> <br> <b>  </b> <br>       ‚Äî    ,       .      -,  Wireshark.             . <br> <br>  6 <br>   Samba <br>       ‚Äî ,    -  <i>Samba</i> .       .         ,      <i>Samba</i> ,      :     . <br> <br>  <br> ,        <i>Samba</i> .     ,          .     : <br> ‚Ä¢ 1.     <b>smb.conf</b> . <br> ‚Ä¢ 2.    . <br> ‚Ä¢ 3.    . <br> ‚Ä¢ 4.  . <br> ‚Ä¢ 5.    . <br> ‚Ä¢ 6.   <i>Samba</i> . <br>   , , ,     - .              .         .        .         !</code> </div><p>Source: <a href="https://habr.com/ru/post/173127/">https://habr.com/ru/post/173127/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../173109/index.html">Use the Hierarchy Viewer to optimize the Android application</a></li>
<li><a href="../173115/index.html">Slit Survey: Catching Birds with a Python</a></li>
<li><a href="../173117/index.html">Social-feed - jQuery social plugin</a></li>
<li><a href="../173123/index.html">CSS3 Flower Bouquet</a></li>
<li><a href="../173125/index.html">Preparing Nginx for PCI Compliance</a></li>
<li><a href="../173133/index.html">CeBIT 2013. Mobile devices. The final post about the exhibition</a></li>
<li><a href="../173135/index.html">Scoring, assessment of borrowers for the Webmoney system. Short review. Instruments</a></li>
<li><a href="../173137/index.html">NHibernate 3.3.3.GA released</a></li>
<li><a href="../173141/index.html">WebKit for developers</a></li>
<li><a href="../173143/index.html">.SITE i.ONLINE - Cyrillic domains for all</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>