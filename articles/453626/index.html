<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Adventures in a separate stream. Yandex report</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="How to work with images on the client, while maintaining smooth UI? Interface developer Pavel Smirnov talked about this based on his experience in dev...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Adventures in a separate stream. Yandex report</h1><div class="post__text post__text-html js-mediator-article"> How to work with images on the client, while maintaining smooth UI?  Interface developer Pavel Smirnov talked about this based on his experience in developing photo search on the Market.  From the report you can learn how to properly use Web Workers and OffscreenCanvas. <br><br> <a href="https://youtu.be/jPqNyF0hH3k%3Ft%3D15135"><img src="https://habrastorage.org/webt/t_/ku/-u/t_ku-uoatzm936x50sn7rzjab5w.jpeg"></a> <br><br>  - During this half an hour we will talk about adventures.  I will tell you about my adventure and I really hope that my report will inspire you and you will take and do the same with you. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <a name="habracut"></a>  First I wanted to talk about some new or not so new technologies that our browsers give us and which allow us to do cool things.  But it seems to me that it would not be very fun, because everyone can go to the MDN and read something.  Therefore, I will tell the story of one feature that I did with the Market team. <br><br>  Let's introduce myself first.  My name is Pasha, I am an interface developer for the Market team. <br><br><img src="https://habrastorage.org/webt/bc/vy/s_/bcvys_xxtyt4hekvl26k-9zdlga.jpeg"><br><br>  I mainly deal with mobile interfaces - search by map, offer card.  I also rewrite the code from the old stack to the new one, and then from the new one to an even newer stack.  And I try to make my interfaces good.  It is worth saying what a good interface is. <br><br>  Good interfaces have different characteristics.  Firstly, it is convenient, secondly, it is beautiful, thirdly, it is available.  But one of the characteristics that I want to talk about today is speed.  And the speed often manifests itself in the smoothness of his work.  Even small friezes can greatly change the user experience of our interfaces. <br><br><img src="https://habrastorage.org/webt/p-/ww/kw/p-wwkw03iuh5yrgyfc-fjvubma8.jpeg"><br><br>  Let us turn to the plan of my talk today.  First we will talk about the task I did: search for a picture on the Market.  Further I will tell you what problems I had to solve in order to implement this functionality.  Here we will remember a little how your script works in the browser, and look at the technologies that helped me.  A small spoiler: this is Web Workers and OffscreenCanvas. <br><br>  Let's return to the task.  A few months ago Luba, our product manager, approached me.  Lyuba deals with the problems of product selection on the Market.  Now we have several options for finding the goods.  One of them is to enter something into the search box. <br><br><img src="https://habrastorage.org/webt/ul/m6/tn/ulm6tnl0vt8kdewxzrr1ofgfch0.jpeg"><br><br>  For example, ‚Äúbuy a red iPhone X ¬≤ of Samara‚Äù.  And we will find something.  Or we can use the directory tree.  In this directory we have categories and subcategories. <br><br>  But what if I want to find something on the Market, not knowing what it is called, but either I have a photo of this thing, or I see it at someone‚Äôs place? <br><br><img src="https://habrastorage.org/webt/hz/0t/ne/hz0tnecdwmrqd4slxosbd4ghtgs.jpeg"><br><br>  I'll tell you the real case.  I once went with my friends to a cafe.  We ordered lemonade there, you know, in such a jug, and this jug had such a strange thing.  I even have a photo.  It was designed so that when you pour lemonade into a glass, ice does not get into it.  We thought - the thing is cool, but we disagreed on how this thing is called and, in general, what it was intended for.  Therefore, we found it on Yandex.Mapk ... <br><br>  But I thought it would be cool if I could not only search for this thing, but buy it right away or at least find out the price, read reviews, features, etc. At this point, our dreams coincided with Anyone, and we decided make this functionality on the Market. <br><br>  What does this functionality represent?  It allows the user to upload a photo or image, you can even immediately take a photo and send it to the Market.  We analyze this picture with the help of Yandex search technologies, find a product on it and show the user the issue with these products.  It sounds simple, but if it were so simple, I would not have made my report.  So that you can see what this feature is, let me show it. <br><br>  <i><a href="https://youtu.be/jPqNyF0hH3k%3Ft%3D15435">Watch the first demo</a></i> <br><br>  I will show on the production.  Let's first load the very thing we were looking for and see what happens. <br><br>  We found some goods and specifically this thing.  This thing is called a strainer.  In order to search for something else, yesterday, at a colleague on the table, I photographed one book, let's look for it.  Here is a book, perhaps someone read it.  Called "Perfect Code".  Also finds it somehow, and for some reason with a 18+ limit.  This is probably a little strange. <br><br>  Let's return to our report.  What problems have I encountered?  The first problem is that the user starts downloading anything, including huge pictures.  For example, my phone makes pictures of three to four megabytes, it is quite a lot.  Such pictures to send to the backend is inefficient.  This is a long time to analyze them, so you need to do something about it.  But everything is simple - we will cut, compress, somehow resize this picture on the client. <br><br><img src="https://habrastorage.org/webt/gs/qm/fo/gsqmfoelkfhdlcmhijbrpl1u3b8.jpeg"><br><br>  How are we going to do this?  We have a file.  And we will somehow read this file.  We will read using the FileReader API.  I will briefly tell you what it is. <br><br><img src="https://habrastorage.org/webt/ii/c0/ip/iic0ipw8vjdg5mpre0x6yw3ye_q.jpeg"><br><br>  This is such a browser API that allows us to read the downloaded file and do something with it.  You can read in different ways, we now look at it.  Here are its capabilities, and we have some object that came back from input on the change event.  Let's try to read it. <br><br><img src="https://habrastorage.org/webt/dd/t6/ya/ddt6yaay0twlpecj1rkwxhzob1w.jpeg"><br><br>  The code will look like this.  There is nothing complicated here.  We have a Reader object created from the FileReader constructor, to which we hang the developer of the load event.  Further we will read this file as DataURL.  DataURL - a string that represents the contents of the file, encoded via Base64.  Like we read, we must somehow cut it off.  First let's load it all into a picture.  We have a tag or img element, and we‚Äôll upload it right there. <br><br><img src="https://habrastorage.org/webt/38/fo/oe/38fooeukiuqzgzmprkjqvpelgfw.jpeg"><br><br>  The code will look something like this.  We create an img element, upon the load Reader event in the src attribute we load our string and we will execute everything further after loading our string into img. <br><br>  We will do what we wanted - to crop the image.  We will compress it, and here such a thing as Canvas will help us, a very powerful tool.  It allows you to do a lot.  But here we will simply draw our image on this Canvas, and if the size of the image exceeds the maximum allowed, we will fit them a little bit.  We will also be able to pick up this picture with the Canvas of the desired degree of compression. <br><br><img src="https://habrastorage.org/webt/if/zs/ny/ifzsnym6-fi7xyx8evc-_dvv4ni.jpeg"><br><br>  Like that.  Another small disclaimer: the code is very simplified here, I am not pointing out everything.  We have error handling and other things, but so that everything fits on the slide and is clear and understandable in the report, I omitted some of the details. <br><br>  We have the size of the picture, we just look at them.  There are some constants allowed to us.  If the sizes of the images exceed our constants, we simply equalize them and specify our Canvas to our Canvas. <br><br>  Next we draw our picture on this Canvas. <br><br><img src="https://habrastorage.org/webt/3n/c1/gr/3nc1gr71oyygkviglnhv9hwfzeg.jpeg"><br><br>  Take a 2d context, we need a 2d image, and try to draw using the drawImage method.  DrawImage is an interesting method that takes, if I'm not mistaken, nine parameters.  But they are not all required, we will use only five.  We will take Image and those two zeros, is the offset or indent of the image.  We need a left upper point.  Let's draw with the sizes necessary to us. <br><br>  Next, from this Canvas, we also take our BaseUR-encoded DataURL and turn it into a blob - a special object that is convenient for us to send to the server.  It seems to be all.  Everything is working.  The picture is cropped, the picture is sent, the picture is recognized. <br><br>  But then I began to notice something.  When I tested this solution, then when I loaded the image, especially on weak devices, my interface slowed down a bit.  That button was not pressed, the element is not so scrolled.  Did you get the feeling that your code works 99% of the time and works well, but sometimes a little bit does not work?  And you can give for testing, and probably no one will notice.  Yes, and users probably will not notice, especially on weak devices. <br><br>  I have never had such a thing, and I decided to fix it.  This turned out to be a problem.  If the image is large, then with the manipulation of trimming, compression, it took us some time, and in this small-small time, our interface was non-responsive. <br><br>  First, I figured out why this is happening.  Here it is worth a little bit to remember how JavaScript works in the browser.  I will not go into details, this is a topic for a large report.  Just remember some moments. <br><br><img src="https://habrastorage.org/webt/rx/bq/-n/rxbq-nzhacdcemzt89xme0h331w.jpeg"><br><br>  We have javascript running in one thread, let's call it the main one.  And we have such a thing in the browser as an event loop.  We will immediately say that this is a model.  In some browsers, the event loop is organized differently, but as the name implies, in general it is a cycle.  It processes certain tasks in the queue strictly in order. <br><br>  Unpleasant moment: until he handles one task, he will not go to the next.  I will show the demo that I‚Äôve written down, it demonstrates it.  She is classic. <br><br>  <i><a href="https://youtu.be/jPqNyF0hH3k%3Ft%3D15864">Watch the second demo</a></i> <br><br>  I have a GIF image and CSS animation made in different ways: one with translatex, the other with position: relative left, the third with JavaScript, namely requestAnimationFrame.  This is where the hedgehog is spinning.  What will i do? <br><br>  I'll block the main thread for five seconds.  You know, usually cool guys calculate a certain Fibonacci number, but I wrote an infinite loop with a break after five seconds. <br><br>  What will happen?  You immediately noticed that the hedgehog stopped spinning, and the lower cat, which is animated using translatex, also stopped driving.  But let's see the same demo in another browser, for example Safari.  The cat on the gif stopped running. <br><br>  Why am I showing all this?  First, browsers are different, you need to take this into account.  Secondly, when our flow is blocked by something, some things will stop working.  For example - JavaScript animation.  Or let's show that the text will no longer stand out from us, the buttons will no longer be pressed. <br><br>  This is a very abstract example.  Let's not block the stream for five seconds, but take our task, load the photo, cut it off, compress it and draw it here.  We will not send it anywhere, it will not be very revealing. <br><br>  <i><a href="https://youtu.be/jPqNyF0hH3k%3Ft%3D15970">Watch the third demo</a></i> <br><br>  I have a powerful enough MacBook here, and so that everything looks more convincing, we will slow down the processor six times.  This allows you to do DevTools.  Download our photo.  ‚ÄúPerfect Code‚Äù will help us again.  As we can see, the same thing happens as when blocking the main thread. <br><br>  Let us then return to our task and think about how we will deal with it. <br><br><img src="https://habrastorage.org/webt/us/bk/y1/usbky1tcsqcmijlpm7yvhzqejxu.jpeg"><br><br>  By the way, if you look at the profiler, we will see this.  In the red frame - our microtask, which blocks the main thread.  We see that he is blocking him for almost five seconds.  This is on a fairly powerful computer, and on weaker devices it will be even more noticeable. <br><br>  We turn to the solution.  I will immediately say what I used and what I did, and then we will sort all these things out.  First, I used Web Workers.  They allow us to bring some tasks to a separate thread.  And secondly, in the context of Web Workers, the DOM is not available to us.  To deal with this situation, we will use other tools.  Image will not be available to us, the classic Canvas will be available, and therefore we use Canvas and some other tricks. <br><br><img src="https://habrastorage.org/webt/fy/vw/f1/fyvwf1psmu5-m4szo28ffv7qykm.jpeg"><br><br>  Let's quickly recall what Workers are and what they are for.  They allow you to run JavaScript in a separate thread, not mostly.  And the Workers thread does not interfere in any way with the rendering stream of the main interface.  Therefore, we can perform some complex computational tasks without slowing down our interface. <br><br>  We have a tool that allows you to transfer something to Workers and return something from Workers.  Let's see an example. <br><br><img src="https://habrastorage.org/webt/tl/3n/gt/tl3ngt03saazi4u4c-jrw2qpsjs.jpeg"><br><br>  So we create our Worker with the help of a constructor.  There you need to pass the path to the file.  We can even pass on a blob.  And we have a Message event handler.  In this case, it will simply display something on the screen.  Next we can send some data to our Worker. <br><br><img src="https://habrastorage.org/webt/dz/d4/zq/dzd4zq9kr9xsjub1pznwor1m0cy.jpeg"><br><br>  What with support?  Everything is good here.  Workers is a well-known tool, not new, but many of my friends think that they are not supported everywhere.  This is not true. <br><br><img src="https://habrastorage.org/webt/qq/0p/iq/qq0piq8knelh8flsttmdu3nvmxc.jpeg"><br><br>  Now look at the OffscreenCanvas.  As we have already seen, Canvas is a very powerful tool, but, unfortunately, in the context of Web Workers it is not available to us, so we will use the alternative.  This is already a fairly new thing called OffscreenCanvas.  It allows you to do about the same things as Canvas, only now off-screen, that is, in the context of Web Workers.  Of course, we can do this in the context of a window, but for now we will not. <br><br><img src="https://habrastorage.org/webt/g4/26/zz/g426zzs7plg7015gze3pivfyedc.jpeg"><br><br>  What is there with support?  As you can see, there is a lot of red here.  OffscreenCanvas is normally supported in Chrome only.  There is also an option with Firefox, but there is still under the flag, and the Canvas works only with the WebGL context.  Here you can ask - why am I talking about such a cool thing like OffscreenCanvas, which does not work anywhere? <br><br><img src="https://habrastorage.org/webt/ut/pg/po/utpgpozecg0ufn847t-jpfuleqe.jpeg"><br><br>  A small digression.  We have some levels of browser support in the Market.  And we have two quantities.  One value characterizes a browser that we don‚Äôt support at all.  This is about half a percentage point of browser popularity. <br><br>  And there is a second value.  It includes those browsers that we support, but only critical functionality.  Here, without Workers, all the search functionality works, but with a few friezes.  I think it's okay, and our team thinks it's okay.  Let's see how we will implement it. <br><br><img src="https://habrastorage.org/webt/eo/p7/0l/eop70llp8tzton82fokyhi9c17e.jpeg"><br><br>  Here is a diagram of what we will do.  We even will have files that we will read through FileReader.  But in the main thread, we will send it to Web Workers, where it will be cut off, shrink and return to us, and we will send it to the server. <br><br><img src="https://habrastorage.org/webt/uq/zx/x_/uqzxx_ifbctkux0m1o1ogw5pauu.jpeg"><br><br>  Let's see the code of our Worker.  First, we create an OffscreenCanvas instance with the width and height we need. <br><br>  Further, as I said, the Image element is not available to us in the context of Workers, so here we use the createImageBitmap method, which will make us the data structure that characterizes our image. <br><br>  From the interesting: we see self here.  Whoever is not familiar with Web Workers, this thing points to the execution context.  We don't care here, window or this, use self.  This method is asynchronous, I used await here for both compactness and convenience, why not? <br><br>  Next we get the same image and do the same thing we did before.  Draw on the canvas and return. <br><br>  From simple.  Previously, we took DataURL and converted everything into a blob.  But here we immediately available method convertToBlob.  Why haven't I used it before?  Because support was worse.  But since we‚Äôve gone all bad, we‚Äôll use OffscreenCanvas, what prevents us from using convertToBlob? <br><br><img src="https://habrastorage.org/webt/a2/c-/bs/a2c-bssaaa8knh26p10fdta__zc.jpeg"><br><br>  This blob we will return in the main stream, from where we send it to the server.  Or, as in the demos, draw it. <br><br>  So we create the Worker in the main thread, listen to some messages from it and draw or send to the server.  There is nothing important here.  Worker will accept our files. <br><br>  Let's go back to our demo. <br><br>  <i><a href="https://youtu.be/jPqNyF0hH3k%3Ft%3D16368">Watch the fourth demo</a></i> <br><br>  All the same demo, all the same three cats and a hedgehog.  I'll turn on throttling again, slowing the processor six times.  Upload all the same picture.  As we see, at the moment when the photo was drawn, the animation did not stop, the hedgehog kept spinning, the interface remained, and we achieved what we wanted. <br><br>  But can this solution be improved? <br><br><img src="https://habrastorage.org/webt/sc/jo/x0/scjox0apap-ojlx03_gfvauava8.jpeg"><br><br>  Here, by the way, profiler.  We do not see here the huge Microtasks for the five seconds that we saw before. <br><br>  Improve - can be.  Using Transferable objects.  Here it is worth going back again.  When we passed our DataURL or blob through the postMessage mechanism, we copied this data.  This is probably not very effective.  It would be cool to avoid this.  Therefore, we have a mechanism that allows you to transfer data to Web Workers as if in a package. <br><br>  Why do I say "as if"?  When we transfer this data to Workers, we lose control over them in the main thread ‚Äî we cannot interact with them in any way.  Here is the second limitation.  We are not all types of data ... can transfer to Web Workers.  With a string this will not work, we will do otherwise. <br><br><img src="https://habrastorage.org/webt/7s/ai/ml/7saimltvcz1_i2iwgxbfeoyqaxq.jpeg"><br><br>  Let's look at the code.  First, we transfer data in a slightly different way.  Here is our postMessage.  See, there is such an array with loadEvent.target.result.  Such an interface allows us to transfer our data as Transferable objects, losing control over them. <br><br>  By the way, whoever writes on Rust will probably hear something familiar.  And we will read our file no longer as a string, but as an ArrayBuffer.  This is a stream of lidar binary data that is not directly accessible.  So we have to do something else with them. <br><br><img src="https://habrastorage.org/webt/5j/o6/t8/5jo6t8mnnnnlquvzvnsnluqs__4.jpeg"><br><br>  Let's go back to our imageworks.  It has become much more interesting.  First, we take our buffer and do such a terrible thing as Uint8ClampedArray.  This is a typed array.  As the name implies, the data in it are numbers of the sign, that is, numbers from zero to 255, which will represent the pixel of our image. <br><br>  With the third argument we pass on such a strange thing as width multiplied by height multiplied by four.  Why exactly four?  Right, RGBA.  We have three values ‚Äã‚Äãper color and one per alpha channel. <br><br>  Next, we will make ImageData from this array, a special data type that can be easily drawn on the canvas.  There is nothing interesting here.  We just take an array and pass it to the constructor.  Next, we draw our image on the canvas in the same way, but using a different method, under ImageData.  Then everything is the same as before. <br><br>  We turn to the conclusions.  I told you today about a task that I did not long ago.  What did I notice in her? <br><br><img src="https://habrastorage.org/webt/0l/ay/mp/0laympqckrdgl8mbdfc7zozrgfa.jpeg"><br><br>  The smoothness of the interface is very important.  When a user lays a little bit, frisks a little, the button is not pressed, this can lead to a severe deterioration of the UX.  Browsers work differently.  We looked at a spherical example with Safari and with Yandex Browser.  We see that if you checked your interface for smoothness in one browser, you should look at the others. <br><br>  Something needs to be done with blocking scripts if they continue for a long time.  In my case, I brought it to Web Workers.  But there are probably other approaches, you can somehow divide them into smaller ones, then you have to think.            ,  Web Workers,        . <br><br>  What next?        .   .     .    ,      200     ,       . <br><br>     Web Workers  .   ,   ,         . <br><br>    : <br><br><ul><li> <a href="https://www.html5rocks.com/en/tutorials/internals/howbrowserswork/">How Browsers Work: Behind the scenes of modern web browsers</a> </li><li> <a href="https://habr.com/ru/post/446682/"> WebGL/Three.js   OffscreenCanvas  -</a> </li><li> <a href="https://developers.google.com/web/updates/2018/08/offscreen-canvas">OffscreenCanvas ‚Äî Speed up Your Canvas Operations with a Web Worker</a> </li></ul><br>  Thank you very much. </div><p>Source: <a href="https://habr.com/ru/post/453626/">https://habr.com/ru/post/453626/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../453608/index.html">Pythonhosted.org is mistakenly blocked by Roskomnadzor</a></li>
<li><a href="../45361/index.html">jsForms</a></li>
<li><a href="../453610/index.html">How to sell SD-WAN business</a></li>
<li><a href="../453614/index.html">Local (offline) npm repository</a></li>
<li><a href="../453622/index.html">G-Shield chip programmer: writing digital certificates to chips during production</a></li>
<li><a href="../453634/index.html">School of Systems Analysis Alfa-Bank</a></li>
<li><a href="../453642/index.html">Smart parser of the number written in words</a></li>
<li><a href="../453644/index.html">Interview - 10 questions about Swift. Part 3</a></li>
<li><a href="../453652/index.html">LogRock: Testing through logging</a></li>
<li><a href="../453656/index.html">Static web: back to basics?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>