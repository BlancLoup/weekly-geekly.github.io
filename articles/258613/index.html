<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Wing IDE Protection Study</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Good health! I would not be surprised that you have not even heard about this program before. Like me, until the day when the Python Debugger came in ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Wing IDE Protection Study</h1><div class="post__text post__text-html js-mediator-article"><div style="text-align:center;"><img src="https://habrastorage.org/files/619/553/135/6195531358aa46a7b1caeebfb96de3af.png"></div><br><br>  Good health!  I would not be surprised that you have not even heard about this program before.  Like me, until the day when the <b>Python Debugger</b> came in handy.  Yes, I know, there is <b>pdb</b> , but its functionality and the way it is presented, I didn‚Äôt like at all.  After a brief search, I stumbled upon this wonderful product.  There is everything that can be useful in debugging your <b>Python</b> applications (I‚Äôll say right away that I haven‚Äôt studied this language, so if any inaccuracies come up, please don't swear). <br><a name="habracut"></a><br><h5>  <b><u>Caution: repeating actions from the article, you act at your own risk!</u></b> </h5><br><h4>  <b>So, we start ...</b> </h4><br>  The patient, I must say, is unusual.  First of all: it comes with source code (!!!), even in bytecode;  secondly, as sometimes happens ... well, see. <br><br>  First of all, download the program ( <a href=""><b>Wing IDE Professional v 5.1.4</b></a> ).  Install, inspect the folder.  The main executable file is located at <b>./bin/wing.exe</b> .  Run it.  Swears at the lack of <b>Python</b> , so install it.  Version <b>2</b> is <b>required</b> (at the moment it is version <b>2.7.9</b> ).  Run the program again.  This time offers to install patches, and restart.  So do. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Now a window pops up asking for a license (because we have a pro version).  Let's introduce some nonsense: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/da3/303/d88/da3303d88e1a43658c86622e2ea4f5e0.png"></div><br><br>  We get the following answer: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/5f5/fa1/ac1/5f5fa1ac1c7e407d9fac017de7ae3954.png"></div><br><br>  What is funny: the program itself tells us the length of the key (20, not including the hyphens), and the characters with which it should start.  In principle, it is already possible to start exploring protection from this - we will find this line in the program files. <br>  Further - more interesting.  The search result was found in the file <b>./bin/2.7/src.zip</b> ! <br><br>  Yes Yes.  Everything is really like this: the program comes with source.  In them we also should dig. <br><br><h4>  <b>Stage Two: Digging the Source</b> </h4><br>  Let's include in Archive search in <b>Total Commander</b> , and we will find that line again.  The line is in the file: <b>./bin/2.7/src.zip/process/wingctl.pyo</b> .  <i>PYO</i> files are binary with <i>optimized</i> <b>Python</b> bytecode. <br><br>  Fortunately for Python, there are a couple of bytecode decompilers.  In order not to bother you with searches, I will give links to those that came in handy to me: <br><br><ol><li>  <a href="http://sourceforge.net/projects/easypythondecompiler/"><b>Easy Python Decompiler</b> ( <i>EPD</i> )</a> - a shell in which two decompilers are <b>wired</b> ( <b>Uncompyle2</b> and <b>Decompyle ++</b> ); </li><li>  <a href="https://github.com/wibiti/uncompyle2"><b>Fork Uncompyle2</b></a> - sometimes unpacks what others can not unpack. </li></ol><br>  So, we will unpack the entire src.zip archive into the <b>src</b> folder (next to it there is the <b>src</b> folder, let them unpack and everything else) and add <b>EPD</b> to it: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/76e/30d/cde/76e30dcded374775b3e5163315eda182.png"></div><br><br>  We wait until the end of the process, and we go to inspect what happened.  And it turned out decompiled files with the end of <b>_dis</b> .  We will rename them to <b>.py</b> .  Everything would be fine, but it turns out that there are also files with the end of <b>_dis_failed</b> , which means that the decompiler has not mastered these files.  Fortunately, there is only one file: <b>edit / editor.pyo_dis_failed</b> <br><br>  Let's try to incite <b>Decompyle ++</b> on it ... The same trouble.  No wonder I gave a link to a spare decompiler, because  it was he who did what others failed.  Now, remove all <b>pyo</b> / <b>pyc</b> files from the src folder, and rename the <b>.py * _dis file</b> to <b>.py</b> . <br><br>  Next, repeat all of the above for the archive <b>opensource.zip</b> , unpacking it in the next folder of the same name.  Archive <b>external.zip</b> I decided not to touch, because, having examined it, you can see that there are libraries that can be installed separately for our Python.  So do: <br><br><ol><li><pre><code class="dos hljs">pip install docutils</code> </pre> </li><li>  <a href=""><b>py2pdf</b></a> - put it in the <b>external</b> folder; </li><li>  <a href=""><b>Imaging-1.1.7</b></a> - run and install.  From the <b>external</b> folder can be deleted; </li><li>  <a href=""><b>pygtk</b></a> is the same as previous files. </li></ol><br>  The remaining libraries ( <b>pyscintilla2</b> and <b>pysqlite</b> ) are simply extracted from <b>external.zip</b> , and decompiled as before. <br><br><h4>  <b>Stages three and four: the source code itself.</b>  <b>Debugging</b> </h4><br>  Having rummaged through Python scripts, I came across the wing.py <b>file</b> in the root of the program folder.  And the first comment tells us: <br><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment"># Top level script for invoking Wing IDE. If --use-src is specified # as an arg, then the files in WINGHOME/src, WINGHOME/external, # WINGHOME/opensource will be used; otherwise, the files in the version # specific bin directory will be used if it exists.</span></span></code> </pre><br><br>  In a nutshell: if the script is given the <b>--use-src</b> parameter, then the source will be used from the <b>src</b> , <b>external</b> , <b>opensource</b> directories of the root directory with the <b>Wing IDE</b> (and not with the script). <br><br>  Looking into the root folder, I found another <b>src</b> folder, and <b>.py</b> files in it.  Throw them in our <b>src</b> folder, with overwriting (here all the same originals, not decompiled files). <br><br>  Now all three folders (indicated just above), copy to the root directory of the program.  Let's try it ... <br><br>  Run the <b>Wing IDE</b> , and open the <b>wing.py</b> file from the <b>bin</b> directory in it.  Next in the menu <b>Debug -&gt; Debug Environment ...</b> in the parameter field specify - <b>use-src</b> .  Now start the debugger ( <b>F5</b> key).  If all frauds with copying folders were successful, we will get a second copy of the running <b>Wing IDE</b> .  Perfectly! <br><br>  Next: open the file in the parent <b>Wing IDE</b> , in which we found the line on the bad <b>license id</b> ( <b>wingctl.py</b> ) <b>earlier</b> , and set the bryak to this message: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/bf4/80b/ccf/bf480bccf5c84ed4ade694958c24f0bb.png"></div><br><br>  In the debugging <b>Wing IDE,</b> go to the menu <b>Help -&gt; Enter License ...</b> , and enter the key according to the rules (remember ?: <b>20</b> characters, with the first one from the set <b>['T', 'N', 'E', 'C' , '1', '3', '6']</b> ): <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/b04/f6f/e38/b04f6fe38550468db48d2a1cb33eee24.png"></div><br><br>  We press <b>Continue</b> and we get on grandma bryaku.  The first interesting function: <b>abstract.ValidateAndNormalizeLicenseID (id)</b> .  Go to it for <b>F7</b> .  There's one more: <b>__ValidateAndNormalize (id)</b> .  Head over to her. <br><br>  First validation check: <br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">for</span></span> c <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> code: <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> c <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> (<span class="hljs-string"><span class="hljs-string">'-'</span></span>, <span class="hljs-string"><span class="hljs-string">' '</span></span>, <span class="hljs-string"><span class="hljs-string">'\t'</span></span>): <span class="hljs-keyword"><span class="hljs-keyword">pass</span></span> <span class="hljs-keyword"><span class="hljs-keyword">elif</span></span> c <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> textutils.BASE30: code2 += c badchars.add(c) <span class="hljs-keyword"><span class="hljs-keyword">else</span></span>: code2 += c</code> </pre><br>  We see that we are required to have the characters of the <b>License ID</b> belong to the <b>textutils.BASE30</b> set: <br><pre> <code class="python hljs">BASE30 = <span class="hljs-string"><span class="hljs-string">'123456789ABCDEFGHJKLMNPQRTVWXY'</span></span></code> </pre><br>  There seems to be no other checks in <b>__ValidateAndNormalize (id)</b> .  We correct the identifier entered by us and we repeat again.  We have already checked the first character: <br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span> len(id2) &gt; <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> id2[<span class="hljs-number"><span class="hljs-number">0</span></span>] <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> kLicenseUseCodes: errs.append(_(<span class="hljs-string"><span class="hljs-string">'Invalid first character: Should be one of %s'</span></span>) % str(kLicenseUseCodes))</code> </pre><br>  And here is the second character: <br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span> len(id2) &gt; <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> id2[<span class="hljs-number"><span class="hljs-number">1</span></span>] != kLicenseProdCode:</code> </pre><br><pre> <code class="python hljs">kLicenseProdCodes = {config.kProd101: <span class="hljs-string"><span class="hljs-string">'1'</span></span>, config.kProdPersonal: <span class="hljs-string"><span class="hljs-string">'L'</span></span>, config.kProdProfessional: <span class="hljs-string"><span class="hljs-string">'N'</span></span>, config.kProdEnterprise: <span class="hljs-string"><span class="hljs-string">'E'</span></span>} kLicenseProdCode = kLicenseProdCodes[config.kProductCode]</code> </pre><br>  Since  we have the <b>Professional</b> version, then the second character must be <b>N</b> - correct, and come back.  <b>abstract.ValidateAndNormalizeLicenseID (id)</b> passed without errors.  Perfectly.  Oops: <br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span> len(errs) == <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> id[<span class="hljs-number"><span class="hljs-number">0</span></span>] == <span class="hljs-string"><span class="hljs-string">'T'</span></span>: errs.append(_(<span class="hljs-string"><span class="hljs-string">'You cannot enter a trial license id here'</span></span>))</code> </pre><br>  Fix (I chose <b>E</b> ), and continue.  Having run through the eyes below the code, I did not find anything in addition to the previous checks, so I boldly released debugging further along <b>F5</b> .  New window: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/80b/18a/c8b/80b18ac8bf6e4624bdee30433cb13f9c.png"></div><br><br>  We enter a random text, we get an error message (again <b>20</b> characters, and the activation code must start with <b>AXX</b> ), we find it in the files, set the breakpoint: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/9c8/2ce/c3b/9c82cec3b3184bd5b56320c4414cc576.png"></div><br><br>  The first verification function is <b>abstract.ValidateAndNormalizeActivation (act)</b> .  It again checks on the ownership of <b>BASE30</b> .  Check for the prefix, which we have already passed: <br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span> id2[:<span class="hljs-number"><span class="hljs-number">3</span></span>] != kActivationPrefix: errs.append(_(<span class="hljs-string"><span class="hljs-string">"Invalid prefix: Should be '%s'"</span></span>) % kActivationPrefix)</code> </pre><br>  The following interesting place: <br><pre> <code class="python hljs">err, info = self.fLicMgr._ValidateLicenseDict(lic2, <span class="hljs-keyword"><span class="hljs-keyword">None</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> err == abstract.kLicenseOK:</code> </pre><br>  Go to <b>self.fLicMgr._ValidateLicenseDict</b> .  A license hash is formed here: <br><pre> <code class="python hljs">lichash = CreateActivationRequest(lic) act30 = lic[<span class="hljs-string"><span class="hljs-string">'activation'</span></span>] <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> lichash[<span class="hljs-number"><span class="hljs-number">2</span></span>] <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> <span class="hljs-string"><span class="hljs-string">'X34'</span></span>: hasher = sha.new() hasher.update(lichash) hasher.update(lic[<span class="hljs-string"><span class="hljs-string">'license'</span></span>]) digest = hasher.hexdigest().upper() lichash = lichash[:<span class="hljs-number"><span class="hljs-number">3</span></span>] + textutils.SHAToBase30(digest) errs, lichash = ValidateAndNormalizeRequest(lichash)</code> </pre><br>  If you look at the contents of <b>lichash</b> after executing this block, you will notice that its text is similar to the <b>request code</b> displayed in the activation code entry box, although a few numbers are different.  Okay, we will think that there are some random parts that do not affect activation (which, by the way, will be further confirmed!). <br><br>  Then, the first three characters are cut off from the activation code, hyphens are removed, converted to <b>BASE16</b> , and padded with zeros if necessary: <br><pre> <code class="python hljs">act = act30.replace(<span class="hljs-string"><span class="hljs-string">'-'</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span>)[<span class="hljs-number"><span class="hljs-number">3</span></span>:] hexact = textutils.BaseConvert(act, textutils.BASE30, textutils.BASE16) <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> len(hexact) &lt; <span class="hljs-number"><span class="hljs-number">20</span></span>: hexact = <span class="hljs-string"><span class="hljs-string">'0'</span></span> + hexact</code> </pre><br>  And here it is, the most interesting: <br><pre> <code class="python hljs">valid = control.validate(lichash, lic[<span class="hljs-string"><span class="hljs-string">'os'</span></span>], lic[<span class="hljs-string"><span class="hljs-string">'version'</span></span>][:lic[<span class="hljs-string"><span class="hljs-string">'version'</span></span>].find(<span class="hljs-string"><span class="hljs-string">'.'</span></span>)], hexact)</code> </pre><br>  Some <b>control</b> calls the <b>validate</b> function, passing it the <b>lichash</b> ( <b>request code</b> ), the name of the operating system for which the key is being made, the version of the program, and the converted activation code.  Why did I stop attention at this place?  The fact is that this <b>control</b> is a <b>pyd</b> file (as can be seen by adding the object name to <b>watch</b> , and looking at the <b>__file__</b> field), which are ordinary <b>DLLs</b> with one exported function (not <b>validate</b> ), which gives Python information about what she can do.  Well, let's look at it from the <b>Hex Rays</b> decompiler ... <br><br><h4>  <b>Stage Five: This Is Not Python</b> </h4><br>  Drag in our <b><i>control</i></b> in <b>IDA Pro</b> ( <b>ctlutil.pyd</b> ) and look at the exported <b>initctlutil</b> function: <br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">int</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">initctlutil</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> Py_InitModule4(aCtlutil, &amp;off_10003094, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1013</span></span>); }</code> </pre><br>  <b>off_10003094</b> is a structure in which the names and the address of the exported methods are indicated.  Here is our <b>validate</b> : <br><pre> <code class="cpp hljs">.data:<span class="hljs-number"><span class="hljs-number">100030</span></span>A4 dd offset aValidate ; <span class="hljs-string"><span class="hljs-string">"validate"</span></span> .data:<span class="hljs-number"><span class="hljs-number">100030</span></span>A8 dd offset sub_10001410</code> </pre><br>  Of all the code that contains the procedure <b>sub_10001410, the</b> most interesting is this: <br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ( sub_10001020(v6, &amp;v9) || <span class="hljs-built_in"><span class="hljs-built_in">strcmp</span></span>(&amp;v9, v7) ) { result = PyInt_FromLong(<span class="hljs-number"><span class="hljs-number">0</span></span>); }</code> </pre><br>  <b>Head over</b> to <b>sub_10001020</b> too.  It would be interesting not to give the names of variables by eye, but to give them a bad name and name them.  So do.  Configure the <b>IDA Pro</b> debugger: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/f03/a07/5d7/f03a075d7bbf4bfeb873e3227cb1b757.png"></div><br><br>  I think everything is clear from the screenshot: we have specified an application that will eventually load our <b>pyd</b> file. <br><br>  Now set the breakpoint at the beginning of <b>sub_10001020</b> , and start looking into the variables and input parameters.  After a short debugging process, we come to the following listing function: <br><div class="spoiler">  <b class="spoiler_title">Convert_reqest_key function code</b> <div class="spoiler_text"><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">int</span></span> __usercall convert_reqest_key@&lt;eax&gt;(<span class="hljs-keyword"><span class="hljs-keyword">char</span></span> *version@&lt;eax&gt;, <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-keyword"><span class="hljs-keyword">char</span></span> *platform@&lt;ecx&gt;, <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-keyword"><span class="hljs-keyword">char</span></span> *activation_key, <span class="hljs-keyword"><span class="hljs-keyword">char</span></span> *out_key) { <span class="hljs-keyword"><span class="hljs-keyword">unsigned</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> len_1; <span class="hljs-comment"><span class="hljs-comment">// edi@1 const char *platform_; // esi@1 char *version_; // ebx@1 int ver_; // eax@2 signed int mul1; // ecx@3 signed int mul2; // esi@3 signed int mul3; // ebp@3 bool v11; // zf@15 const char *act_key_ptr; // eax@31 char v13; // dl@32 const char *act_key_ptr_1; // eax@35 unsigned int len_2; // ecx@35 char v16; // dl@36 const char *act_key_ptr_2; // eax@39 unsigned int len_3; // ecx@39 char v19; // dl@40 int P3_; // ebx@42 const char *act_key_ptr_3; // eax@45 unsigned int len_4; // ecx@45 char v23; // dl@46 unsigned int P4; // ebp@47 signed int mul4; // [sp+10h] [bp-18h]@0 unsigned int P3; // [sp+14h] [bp-14h]@1 unsigned int P2; // [sp+18h] [bp-10h]@1 unsigned int P1; // [sp+1Ch] [bp-Ch]@1 len_1 = 0; platform_ = platform; version_ = version; P1 = 0; P2 = 0; P3 = 0; if ( !strcmp(platform, aWindows) ) { ver_ = (unsigned __int8)*version_; if ( *version_ == '2' ) { mul1 = 142; mul2 = 43; mul3 = 201; mul4 = 38; goto LABEL_31; } if ( (_BYTE)ver_ == '3' ) { mul1 = 23; mul2 = 163; mul3 = 2; mul4 = 115; goto LABEL_31; } if ( (_BYTE)ver_ == '4' ) { mul1 = 17; mul2 = 87; mul3 = 120; mul4 = 34; goto LABEL_31; } } else if ( !strcmp(platform_, aMacosx) ) { ver_ = (unsigned __int8)*version_; if ( *version_ == '2' ) { mul1 = 41; mul2 = 207; mul3 = 104; mul4 = 77; goto LABEL_31; } if ( (_BYTE)ver_ == '3' ) { mul1 = 128; mul2 = 178; mul3 = 104; mul4 = 95; goto LABEL_31; } if ( (_BYTE)ver_ == '4' ) { mul1 = 67; mul2 = 167; mul3 = 74; mul4 = 13; goto LABEL_31; } } else { v11 = strcmp(platform_, aLinux) == 0; LOBYTE(ver_) = *version_; if ( v11 ) { if ( (_BYTE)ver_ == '2' ) { mul1 = 48; mul2 = 104; mul3 = 234; mul4 = 247; goto LABEL_31; } if ( (_BYTE)ver_ == '3' ) { mul2 = 52; mul1 = 254; mul3 = 98; mul4 = 235; goto LABEL_31; } if ( (_BYTE)ver_ == '4' ) { mul1 = 207; mul2 = 45; mul3 = 198; mul4 = 189; goto LABEL_31; } } else { if ( (_BYTE)ver_ == '2' ) { mul1 = 123; mul2 = 202; mul3 = 97; mul4 = 211; goto LABEL_31; } if ( (_BYTE)ver_ == '3' ) { mul1 = 127; mul2 = 45; mul3 = 209; mul4 = 198; goto LABEL_31; } if ( (_BYTE)ver_ == '4' ) { mul2 = 4; mul1 = 240; mul3 = 47; mul4 = 98; goto LABEL_31; } } } if ( (_BYTE)ver_ == '5' ) { mul1 = 7; mul2 = 123; mul3 = 23; mul4 = 87; } else { mul1 = 0; mul2 = 0; mul3 = 0; } LABEL_31: act_key_ptr = activation_key; do v13 = *act_key_ptr++; while ( v13 ); if ( act_key_ptr != activation_key + 1 ) { do P1 = (P1 * mul1 + activation_key[len_1++]) &amp; 0xFFFFF; while ( len_1 &lt; strlen(activation_key) ); } act_key_ptr_1 = activation_key; len_2 = 0; do v16 = *act_key_ptr_1++; while ( v16 ); if ( act_key_ptr_1 != activation_key + 1 ) { do P2 = (P2 * mul2 + activation_key[len_2++]) &amp; 0xFFFFF; while ( len_2 &lt; strlen(activation_key) ); } act_key_ptr_2 = activation_key; len_3 = 0; do v19 = *act_key_ptr_2++; while ( v19 ); if ( act_key_ptr_2 != activation_key + 1 ) { P3_ = 0; do P3_ = (P3_ * mul3 + activation_key[len_3++]) &amp; 0xFFFFF; while ( len_3 &lt; strlen(activation_key) ); P3 = P3_; } act_key_ptr_3 = activation_key; len_4 = 0; do v23 = *act_key_ptr_3++; while ( v23 ); P4 = 0; if ( act_key_ptr_3 != activation_key + 1 ) { do P4 = (P4 * mul4 + activation_key[len_4++]) &amp; 0xFFFFF; while ( len_4 &lt; strlen(activation_key) ); } sprintf(out_key, a_5x_5x_5x_5x, P1, P2, P3, P4); return 0; }</span></span></code> </pre><br></div></div><br>  And the place to call this function takes the following form: <br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ( convert_reqest_key(version, platform, request_key, out_key) || <span class="hljs-built_in"><span class="hljs-built_in">strcmp</span></span>(out_key, act_key_hash) ) { result = PyInt_FromLong(<span class="hljs-number"><span class="hljs-number">0</span></span>); }</code> </pre><br>  From all this we can conclude that the <b>request code is</b> converted using the function <b>convert_reqest_key</b> and then compared with the converted activation code.  Remember that conversion? <br><blockquote>  Then, the first three characters are cut off from the activation code, hyphens are removed, converted to <b>BASE16</b> , and padded with zeros if necessary. </blockquote><br>  So, in order to get the correct activation code, we can now proceed as follows: <br><ol><li>  Let the <b>convert_reqest_key</b> conversion function <b>execute</b> ; </li><li>  <b>Look</b> at the contents of <b>out_key</b> at the place of execution of <b>strcmp</b> ; </li><li>  Remove extra zeros at the beginning of <b>out_key</b> ; </li><li>  Convert <b>out_key</b> back to <b>BASE30</b> ; </li><li>  Append three characters to the beginning of the resulting string ( <b>AXX</b> ); </li><li>  Navigate hyphens every five characters if desired. </li></ol><br>  I will not philosophize slyly, but I will squeeze <b>print</b> directly into <b>python</b> , the program code: <br><pre> <code class="python hljs">print(<span class="hljs-string"><span class="hljs-string">"AXX"</span></span> + textutils.BaseConvert(<span class="hljs-string"><span class="hljs-string">"FCBCFEFD2FF684FA6A4F"</span></span>, textutils.BASE16, textutils.BASE30))</code> </pre><br>  At the output I received a key: <br><blockquote>  wingide - 2015/05/24 04:03:47 - <b>AXX3Q6BQHKQ773D24P58</b> </blockquote><br><br>  Entering it in the input field of the activation key, I received the cherished <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/c9e/a43/d14/c9ea43d143a64214bff817049c29a6aa.png"></div><br><br><h4>  <b>RESULTS</b> </h4><br>  As you can see, the hacking process is not so difficult as it turned out to be interesting!  It‚Äôs fun to explore your sources in the compiled version ... <br><br>  I do not know why the authors attached to its program its source code (albeit for the most part, in the form of byte-code).  But I think you understand that you should not do this! <br><br>  Thanks to all. </div><p>Source: <a href="https://habr.com/ru/post/258613/">https://habr.com/ru/post/258613/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../258601/index.html">Unique TechTalk with Michael Monti Widenius</a></li>
<li><a href="../258603/index.html">We select the correct Microsoft Azure services</a></li>
<li><a href="../258605/index.html">Bash state machine</a></li>
<li><a href="../258607/index.html">Krovi: Big Data - as dream. 9th series: Why IBM was forced to buy "Alchemists" for $ 100 million</a></li>
<li><a href="../258611/index.html">An example of a vector implementation of a neural network using Python</a></li>
<li><a href="../258615/index.html">Pulse sensor device Part 2 - Sensors</a></li>
<li><a href="../258619/index.html">Homemade control unit for diesel engine</a></li>
<li><a href="../258621/index.html">DICOM Viewer from the inside. Functionality</a></li>
<li><a href="../258625/index.html">Top 10 non-cash countries of the world</a></li>
<li><a href="../258627/index.html">The digest of interesting materials for the mobile developer # 104 (on May 18-24)</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>