<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>The future of Internet protocols</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Written by Mark Nottingham, member of the Internet Architecture Board and co-chair of the IETF HTTP and QUIC working groups 


 When the Internet beca...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>The future of Internet protocols</h1><div class="post__text post__text-html js-mediator-article">  <i><font color="gray">Written by Mark Nottingham, member of the Internet Architecture Board and co-chair of the IETF HTTP and QUIC working groups</font></i> <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/740/ec8/e3a/740ec8e3a622be928b4d855a87c4192a.png"></div><br>  When the Internet became popular in the 1990s, only a few protocols were enough for basic traffic: IPv4 routed packets, TCP turned them into connections, SSL (later TLS) encrypted these connections, DNS named hosts for connections, and HTTP as an application protocol often used all of them. <br><br>  Over the years, these key Internet protocols have changed very little: several new headers and methods have been added to HTTP, TLS has slowly changed a couple of minor versions, TCP has adapted to congestion management, and functions like DNSSEC have appeared in DNS.  The protocols themselves have remained virtually unchanged for a very long time (except for IPv6, which already receives sufficient attention in the community of telecom operators). 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      As a result, telecom operators, vendors and government agencies that seek to understand (and sometimes control) the Internet have established some practices based on the functionality of these protocols - to debug, improve service quality, or comply with the law. <br><br>  Now the key Internet protocols will undergo major changes.  Although they should be generally compatible with the current Internet (otherwise they will not be distributed), this can have devastating consequences for those who dare to use the undocumented properties of the protocols or made the assumption that the protocols will not change in the future. <br><a name="habracut"></a><br><h1>  Why we need to change the Internet </h1><br>  There are a number of factors that determine these changes. <br><br>  First, the limitations of key protocols became apparent, especially in performance.  Due to the structural problems of the application and transport protocols, the network is not used with maximum efficiency, which affects the performance of end users (in particular, we are talking about latency). <br><br>  This is an important reason to redo or replace the protocols, because there is a <a href="https://www.smashingmagazine.com/2015/09/why-performance-matters-the-perception-of-time/">lot of evidence of how much the impact of even a small performance improvement is</a> . <br><br>  Secondly, over time, it has become more difficult to evolutionally improve the Internet protocols at any level, mainly because of the unintended use mentioned above.  For example, if an HTTP proxy attempts to compress responses, this complicates the deployment of new compression techniques;  Intermediate stage TCP optimizations make it difficult to implement improvements in TCP. <br><br>  Finally, <a href="https://static.googleusercontent.com/media/research.google.com/en//pubs/archive/46197.pdf">encryption is increasingly being used on the Internet</a> .  This process was spurred on by the revelations of Edward Snowden in 2015.  In fact, this is a separate topic, but it is important here that encryption is one of the best tools available to ensure the development of protocols. <br><br>  Let's see what happened in the past and what will happen in the future, how it can affect the network and how the network affects the architecture of the protocol. <br><br><h1>  HTTP / 2 </h1><br>  <a href="http2.github.io/">HTTP / 2</a> (based on Google SPDY) was the first noticeable change.  It was issued as a standard in 2015.  This protocol summarizes multiple requests over a single TCP connection without blocking each other, thereby eliminating the need for a client-side request queue.  Now it is widely distributed, supported by all major browsers and web servers. <br><br>  From a network perspective, HTTP / 2 represents a few notable changes.  First, it is a binary protocol, so that it cannot work with any device that takes it as HTTP / 1.1. <br><br>  This incompatibility has become one of the main reasons for another important innovation in HTTP / 2: it actually requires the use of encryption.  This helps to avoid the intervention of an outsider, who takes it for HTTP / 1.1 or undertakes more subtle intervention such as clearing headers or blocking new protocol extensions - both of these situations actually occur and cause problems of significant support problems for some engineers working on the protocol. <br><br>  <a href="httpwg.org/specs/rfc7540.html">HTTP / 2 encryption requires the use of TLS / 1.2</a> and <a href="httpwg.org/specs/rfc7540.html">prohibits</a> cipher suites that have proven insecure - while allowing only ephemeral keys.  For potential consequences, see the TLS 1.3 section. <br><br>  Finally, HTTP / 2 allows you to <a href="httpwg.org/specs/rfc7540.html">combine in the connection</a> requests from more than one host, improving performance by reducing the number of connections (and therefore the number of contexts to control congestion) required to load the page. <br><br>  For example, you can connect to <code>www.example.com</code> , but also use it to request <code>images.example.com</code> .  <a href="http2-additional-certs">Future protocol extensions may allow additional hosts to be added to the connection</a> , even if they are not specified in the original TLS certificate that is used for the connection.  As a result, one can never assume that the traffic in the connection will be limited to the destination for which it was originally intended. <br><br>  Despite these changes, it is important to note that HTTP / 2 does not seem to have significant compatibility issues or network interference. <br><br><h1>  TLS 1.3 </h1><br>  <a href="https://datatracker.ietf.org/doc/draft-ietf-tls-tls13/">TLS 1.3 is</a> now going through the last stages of standardization and is already supported in some implementations. <br><br>  Do not be misled by a minor number change;  This is a completely new version of TLS with a heavily modernized handshake that allows data exchange from the very beginning (often called 0RTT).  New architecture relies on the exchange of ephemeral keys, excluding static keys. <br><br>  This caused concern for some network operators and vendors - in particular, those who need visibility of what is happening inside these connections. <br><br>  For example, a data center for a bank whose visibility is a requirement of the regulator.  Listening to the traffic on the network and decrypting it with static keys, they can record legitimate traffic and detect malicious, be it foreign intruders or information leakage from the inside. <br><br>  TLS 1.3 does not specifically support this traffic interception technique, since it is one of the <a href="https://en.wikipedia.org/wiki/Forward_secrecy">types of attacks that ephemeral keys protect against</a> .  However, since the requirements of regulators for network operators simultaneously apply modern encryption protocols and track their networks, they are in an awkward position. <br><br>  There have been many debates about whether the rules require the use of static keys, whether alternative approaches can be just as effective and whether the deterioration of the security of the entire Internet is justified for a relatively small number of networks.  In the end, TLS 1.3 traffic can also be decrypted, you just need access to ephemeral keys, and they are valid for a limited time. <br><br>  At the moment, it is unlikely that TLS 1.3 will change to suit these networks, but there is a discussion about creating another protocol that will allow third parties to scan traffic - or even more - in such situations.  Let's see how the community will support this idea. <br><br><h1>  QUIC </h1><br>  While working on HTTP / 2, it became obvious that TCP suffers from similar inefficiency problems.  Since TCP is a packet delivery protocol in order, the loss of one packet may prevent the application from delivering subsequent packets from the buffer.  In a multiplexed protocol, this can lead to a large loss of performance. <br><br>  <a href="https://quicwg.github.io/">QUIC</a> is an attempt to solve this problem by effectively rebuilding TCP semantics (along with some aspects of the HTTP / 2 streaming model) over UDP.  Like HTTP / 2, the development of this protocol began with the efforts of Google, and has now come under the wing of the IETF.  Initially, the goal was to create the HTTP-over-UDP protocol and adopt the standard at the end of 2018.  But since Google has already implemented QUIC in Chrome and on its websites, this protocol already accounts for more than 7% of traffic on the Internet. <br><br>  <b>Read: <a href="https://blog.apnic.net/2016/08/30/questions-answered-quic/">QUIC Answers</a></b> <br><br>  In addition to the transition of such a significant amount of traffic from TCP to UDP (and all the corresponding network settings), both Google QUIC (gQUIC) and IETF QUIC (iQUIC) require mandatory encryption to work;  unencrypted quic does not exist at all. <br><br>  iQUIC uses TLS 1.3 to set session keys, and then encrypt each packet.  But since it is based on UDP, much of the session information and metadata opened in TCP is encrypted in QUIC. <br><br>  In fact, the current iQUIC <a href="https://quicwg.github.io/base-drafts/draft-ietf-quic-transport.html">‚Äúshort header‚Äù</a> ‚Äîwhich is used for all packets except handshaking ‚Äî gives you only the packet number, an optional connection identifier, and a status byte needed for processes like changing encryption keys and packet type (which can also be encrypted). <br><br>  Everything else is encrypted - including ACK packets, which significantly raises the bar for carrying out <a href="https://www.mjkranch.com/docs/CODASPY17_Kranch_Reed_IdentifyingHTTPSNetflix.pdf">attacks with traffic analysis</a> . <br><br>  But this means that it is no longer possible to passively evaluate RTT and packet loss by simply observing the connection;  there is not enough information for this.  The lack of observability has caused serious concern among some representatives of the communication operators community.  They say that such passive measurements are critical for debugging and analyzing their networks. <br><br>  One suggestion for solving this problem is the introduction of a <a href="https://tools.ietf.org/html/draft-trammell-quic-spin">spin bit</a> .  This is a bit in the header, which changes its value once on the way back and forth, so the observer can evaluate the RTT.  Since it is not tied to the state of the application, it should not provide any information about the end points, except for an approximate estimate of the network location. <br><br><h1>  Doh </h1><br>  The most recent change on the horizon is DOH, that is, <a href="https://datatracker.ietf.org/wg/doh/about/">DNS over HTTP</a> .  Many studies have shown that networks often use DNS as a means of imposing rules (whether in the interests of a network operator or higher level authorities). <br><br>  For some time <a href="https://datatracker.ietf.org/wg/dprive/about/">we have been discussing</a> bypassing this kind of control with encryption, but here there is one drawback (at least from a certain point of view) - such traffic can be distinguished from normal traffic and be processed separately;  for example, using the port number to block access. <br><br>  DOH solves the problem by combining DNS traffic with an existing HTTP connection, thereby eliminating any discriminators.  If a network wants to block access to a specific DNS resolver, then it will have to block access to the website itself. <br><br>  For example, if Google deploys its <a href="https://developers.google.com/speed/public-dns/">public DNS service</a> via the DOH protocol at <code>www.google.com</code> , and users configure their browsers accordingly, if the network wants (or is required to) block this service, then it will have to effectively block all of Google ( because so they place their services). <br><br>  The work on DOH has just begun, but quite a lot of interest is already showing to this protocol, there are also first attempts at implementation.  Let's see how networks (and governments) that use DNS to impose rules will react to this. <br><br>  <b>Read: <a href="http-doh/">IETF 100, Singapore: DNS over HTTP (DOH!)</a></b> <br><br><h1>  Ossification and lubrication </h1><br>  Returning to the motivation to develop new protocols, you need to pay attention to the question of how protocol developers are increasingly faced with problems due to the fact that network operators make their assumptions about network traffic. <br><br>  For example, at the last stage of the development of TLS 1.3, there were many problems with intermediate nodes that took it for the old version of the protocol.  gQUIC does not work on some networks that muffle UDP traffic because they consider it harmful or low priority. <br><br>  If the protocol cannot develop due to the fact that its expansion points ‚Äúfreeze‚Äù during implementation, we say that it is <i>ossified</i> .  TCP itself is an example of the most severe ossification;  so many intermediate nodes do such different things with TCP - from blocking TCP packets with unrecognized options to "optimizing" congestion control. <br><br>  It is necessary to prevent ossification in order to guarantee the development of protocols to meet the future needs of the Internet.  Otherwise, we will be confronted with the ‚Äútragedy of communities‚Äù, where the actions of individual networks - albeit well-intentioned - will affect the health of the entire Internet. <br><br>  There are many ways to prevent ossification.  If the data in the packets is encrypted, no one except the owner of the keys will get access to them, which prevents interference.  If the extension point is encrypted, but widely used in such a way that the visibility of the application (for example, HTTP headers) is violated, then the probability of interference decreases. <br><br>  If protocol developers cannot use encryption and the extension point is used infrequently, artificial extension of the extension point can help.  We call it greasing. <br><br>  For example, QUIC pushes endpoints to use a range of values ‚Äã‚Äãwhen <a href="https://quicwg.github.io/base-drafts/draft-ietf-quic-transport.html">negotiating a version</a> to avoid implementations that always assume the version number is the same (this is often found in TLS implementations, which leads to serious problems). <br><br><h1>  Network and user </h1><br>  In addition to wanting to avoid ossification, the new protocols also reflect the evolution of the relationship between networks and their users.  For a long time it was assumed that the network always remains a benevolent - or at least neutral - side.  But this is no longer the case, not only because of the omnipresent <a href="https://tools.ietf.org/html/rfc7258">total monitoring</a> , but also because of attacks like <a href="http://codebutler.com/firesheep">Firesheep</a> . <br><br>  As a result, contradictions between the needs of Internet users in general and the interests of networks that want access to a certain amount of data passing through them increase.  Particularly affected are networks that seek to impose certain rules on users, for example, corporate networks. <br><br>  In some cases, they can achieve their goals by installing special software (or certificate of certification authority, or browser extension) on users' computers.  But it is not easy in those cases where the operator does not have access to the computer.  For example, now employees often work on their own computers, and IoT devices rarely have corresponding control interfaces. <br><br>  As a result, many discussions in the development of protocols in the IETF are about the contradiction of the needs of corporate and other ‚Äúnested‚Äù networks - and benefits for the Internet as a whole. <br><br><h1>  Join the work </h1><br>  For the Internet to work well in the long run, it must have value for end users, avoid ossification and ensure the normal operation of networks.  The changes that are underway now satisfy all three goals, but we need more feedback from network operators. <br><br>  If these changes affect your network - or do not affect - please report it in the <a href="https://blog.apnic.net/2017/12/12/internet-protocols-changing/">comments to the article</a> , or better yet, join the <a href="https://www.ietf.org/">IETF</a> by visiting the working meeting, subscribing to the mailing list or leaving feedback to the draft standard. <br><br>  Thanks to Martin Thompson and Brian Trammel for editing the article. </div><p>Source: <a href="https://habr.com/ru/post/345472/">https://habr.com/ru/post/345472/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../345458/index.html">The story of the victory at the annual competition Russian AI Cup 2017</a></li>
<li><a href="../345460/index.html">We comprehend C deeper using assembler. Part 2 (conditions)</a></li>
<li><a href="../345462/index.html">PHP Digest number 122 (December 11 - 25, 2017)</a></li>
<li><a href="../345464/index.html">DevDay on functional. Record of reports</a></li>
<li><a href="../345468/index.html">PCI DSS: what it is and how to get certified for it + our experience</a></li>
<li><a href="../345474/index.html">Security in modern corporations</a></li>
<li><a href="../345476/index.html">Configuring VPN (PPTP) in Ubuntu 17.10 with authorization by JaCarta smart card</a></li>
<li><a href="../345478/index.html">All professions are important: why should a tester be valued as much as a programmer?</a></li>
<li><a href="../345480/index.html">How to save on spot EC2 instances with Scylla</a></li>
<li><a href="../345482/index.html">Key-value for storing metadata in storage. We test the selected databases</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>