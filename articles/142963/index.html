<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Experience using virtualization on VirtualBox</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Level: beginners 

 Experience using virtualization on VirtualBox 
 Introduction 
 A few years ago, I began to deal with the virus, and I got some sor...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Experience using virtualization on VirtualBox</h1><div class="post__text post__text-html js-mediator-article">  <i>Level: beginners</i> <br><br><h1>  Experience using virtualization on VirtualBox </h1><br><h2>  Introduction </h2><br>  A few years ago, I began to deal with the virus, and I got some sort of travel notes, which I have now designed and posted here.  No revelations will not be here, the article is addressed to novice admins.  The task that I solve here is to virtualize the existing non-virtual servers on Linux and FreeBSD. <br><br><img src="https://habrastorage.org/storage2/6c9/db9/241/6c9db9241859537cc8141290dbe43801.png">
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <a name="habracut"></a><br><h2>  The reasons why I chose VirtualBox </h2><br>  The reasons are presented below: <ul><li>  Ease of use </li><li>  Excellent guide detailing all aspects of VirtualBox </li><li>  Availability of excellent graphical, console and web-based interface </li><li>  The ability to provide access to the guest OS console about the RDP protocol </li><li>  The convenience of use </li></ul>  <a href="http://download.virtualbox.org/virtualbox/UserManual.pdf">The full</a> VirtualBox user <a href="http://download.virtualbox.org/virtualbox/UserManual.pdf">manual</a> is available on the manufacturer's website. <br><br><h2>  Reasons for which I would not choose it now </h2><ul><li>  The lack of good web-mord.  The existing web-interface, despite the fact that it allows you to perform most of the required actions with virtual machines (creation, snapshots, deletion, creation of virtual networks), and is implemented very well, has the following limitations: <ul><li>  Does not allow assigning rights to virtual machines (providing access by developers on the list only to their machines) </li><li>  Does not allow you to manage multiple physical servers from one control panel </li><li>  Does not display server load statistics </li><li>  Written by third-party developers who are not related to VirtualBox, in their free time, because of what causes the possibility of termination of its development. </li></ul></li><li>  <a href="http://www.ilsistemista.net/index.php/virtualization/12-kvm-vs-virtualbox-40-on-rhel-6.html%3Fstart%3D4">Slower work</a> with a large number of running virtual machines compared to KVM. </li><li>  License disclaimer </li></ul><h2>  OS preparation for working with virtual machines </h2><br>  VirtualBox can be installed on almost any OS, however, stable operation and all its features (for example, RDP connection to the guest console) are available only on Linux, so Debian Linux was chosen.  For the VirtualBox itself, no special OS configuration is required; it is enough to allocate a separate section for storing guest disk images and installation disk images for a clean installation of guest systems. <br><br>  However, managing VirtualBox through a Web interface (phpvirtualbox) requires a web server (selected Apache 2) and PHP 5. In Debian, the default configuration of PHP 5 and Apache 2 meets the requirements of phpvirtualbox, and you do not need to configure anything in a special way. <br><br>  Description of server configuration for virtualok: <br><ul><li>  The server is named virtbox.site and the address is 10.0.0.7 (by the way, look for why you shouldn't use .local) </li><li>  The partition for storing guest OS images is created on a separate hard disk and mounted in / srv / vdi </li><li>  Apache 2 and PHP 5 packages are installed: virtbox # apt-get install apache2 php5 </li></ul><br><h2>  Install phpvirtualbox </h2><br>  For Virtualbox, there is a free web-based interface implemented in PHP using the virtualbox remote control service integrated into virtualbox. <br><br>  Install phpvirtualbox: <br><br>  1. On <a href="http://code.google.com/p/phpvirtualbox/">the developer's site,</a> we look at the latest version and download it to the server: <br> <code><a href=""></a> virtbox# cd /var/www &amp;&amp; wget phpvirtualbox.googlecode.com/files/phpvirtualbox-4.1-7.zip</code> <br>  2. Unpack: <br> <code>virtbox# unzip phpvirtualbox-4.1-7.zip</code> <br>  3. Configure: <br> <code>virtbox# cd phpvirtualbox-4.1-7.zip &amp;&amp; cp config.php-example config.php &amp;&amp; vim config.php</code> <br>  4. Register the address of the server running VirtualBox for remote connections using the built-in VirtualBox RDP-plugin: <br> <code>var $consoleHost = '10.0.0.7';</code> <br> <br>  Attention!  For successful connections on the server, incoming ports must be open, by default starting at 3389 (TCP), one port per guest system. <br><br>  5. Configure the virtualbox web service, for which we create the /etc/vbox/vbox.cfg file with the following content: <br> <code>VBOXWEB_USER='vbox' <br> VBOXWEB_HOST=127.0.0.1 <br> VBOXWEB_LOGFILE=/srv/log/vboxwebservice</code> <br> <br>  6. Start the virtualbox web service, before you need to make sure that the file / srv / log / vboxwebservice is available for reading and writing to the user vbox: <br> <code>/etc/init.d/vboxweb-service start.</code> <br> <br>  phpvirtualbox is now available at <a href="http://virtbox.site/phpvirtualbox/">virtbox.site/phpvirtualbox</a> . <br><br><h2>  Creating virtual machines </h2><br>  Creating a virtual machine through a web interface is fairly obvious, you need to click the New button in phpvirtualbox and follow the wizard instructions.  Below is an empirically developed list of guest settings that is sufficient for the normal operation of the Linux and FreeBSD guest. <br><ol><li>  System <ol><li>  Base Memory: 512 MB </li><li>  Processor (s): 1 </li><li>  Enable PAE / NX: NO - emulation of support for working with more than 4 GB of memory for 32-bit systems is usually not needed </li><li>  Chipset: PIIX3 - the manual does not say anything about the dependence of speed on the type of emulated chipset, so we choose the default </li><li>  Extended features <ol><li>  Enable IO APIC - some cloned servers will not work without APIC emulation enabled </li><li>  Hardware clock in UTC time - as a rule, guest systems expect system time in UTC format, and this option is responsible for transmitting the guest OS time in UTC, and not in the local time of the server. </li><li>  Display: 2 MB - the minimum possible value, if you set this value to 1 MB, rdp connections will not work.  When creating new machines, you can leave the default value offered by phpvirtualbox. </li><li>  Storage: where you need to create a disk image </li></ol></li></ol></li><li>  Network <ol><li>  Debian: Virtio - Debian with the help of guest extensions can understand that it works in a virtual machine, and use a virtual network card, which gives a very big performance gain </li><li>  FreeBSD: Intep PRO / 1000 MT Server network card - there is no guest network card driver for FreeBSD, so we choose the emulation of the fastest card available.  In FreeBSD, the device is called em0. </li></ol></li><li>  Serial ports: Disabled </li><li>  USB: Disabled </li><li>  Shared Folders: None - the ability of VirtualBox to provide access to the guest system to the host system files is usually not needed, it is easier to use scp or sftp </li></ol>  To create a virtual machine through the console, follow the <a href="http://download.virtualbox.org/virtualbox/UserManual.pdf">guide</a> , section 8.6. <br><br><h2>  Virtual Machine Management </h2><br><h3>  Web Based Management </h3><br>  Managing virtual machines through the web interface is trivial, just select the desired machine in phpvirtualbox and select the desired action in the interface, such as Start, Stop (unconditional shutdown, sending a signal to press the power button, restart, save the state of the guest system with the ability to subsequently roll back its state and pausing the operation of the guest system, preserving its memory on the disk and the possibility of subsequently loading the memory from the disk and continuing to work). <br><br>  By clicking on the guest system with the right button of the machine, operations of its settings, deletion, viewing logs, etc. are available. <br><br>  Also worth noting is the ability to connect to the console of the guest system, which is similar to connecting a mouse and keyboard to a real machine.  To do this, select the desired guest system, select the Console tab in phpvirtualbox, set the screen size (for text-based guest OS, 800x600 is enough), click Connect and click the remote connection client (in which the contents of the guest console are displayed).  You can manage the guest system from the moment you turn it on. <br><br><h3>  Management through the console </h3><br>  To manage the guest system, VirtualBox uses the VBoxManage and VBoxHeadless utilities, a detailed description of which is available in the <a href="http://download.virtualbox.org/virtualbox/UserManual.pdf">manual</a> . <br><br>  You need to run the commands from the vbox user, under which VrtualBox itself runs, if launched from another user or root, VirtualBox will not be able to find the virtual machine configuration files that are stored in the home directory of the Vbox user, and will generate an error. <br><br>  To go under the user vbox need to say: <br> <code>su -s /bin/bash vbox</code> <br> <br>  The shell must be specified explicitly, because the default for the vbox user is the shell / bin / false. <br><br>  Below, for example, are commands for turning on, turning off, and working with disk images. <br><br>  1. Starting a group of guest systems (you can make it automatic when you turn on and restart the server): <br> <code>for M in test1 test2 test3 ; do VBoxManage startvm $M --type=headless ; sleep 30 ; done</code> <br> <br>  If you do not specify sleep 30, some machines may not start due to very intensive reading from the server's hard disk at startup and some guest systems will decide that they have an error reading from the hard disk. <br><br>  2. Turn off the guest group (you can make it automatic when the server is turned on and restarted): <br> <code>for M in test1 test2 test3 ; do VBoxManage controlvm $M acpipowerbutton ; sleep 30 ; done</code> <br> <br>  Almost all cars understand pressing the power button and can correctly complete. <br><br>  3. Creating a fixed-size disk for the guest system: <br> <code>VBoxManage createhd --variant Fixed --size 20000 --format vdi --filename test</code> <br> <br>  4. Converting a disk image from VirtualBox format to a format understandable to other virtual machines: <br> <code>VBoxManage internalcommands converttoraw test1.vdi test1.raw</code> <br> <br><h3>  Connection via RDP </h3><br>  You can connect to the virtual machine console through RDP.  In Windows, open Start-&gt; All Programs-&gt; Standard-&gt; Remote Desktop Connection and specify the address virtbox.test and the port associated with a specific guest system, which can be viewed in phpvirtualbox.  For ease of use in the connection settings, you can specify the screen resolution of 1024x768, then the connecting window will not occupy the entire screen and intercept system keyboard shortcuts, such as Alt + Tab. <br><br>  Important note: it is possible to simultaneously connect to the same guest system multiple users.  At the same time, everyone sees the same thing, and all actions performed by someone are visible to others who have connected.  To enable this setting, you need to set the Allow Multiple Connections checkbox in the Display section of the Remote Display tab in the virtual machine settings in phpvirtualbox. <br><br><h3>  Creating guest snapshots </h3><br>  Snapshots provide the ability to save the state of the guest systems and return to this state on demand.  What does this mean in practice? <br><ul><li>  You can try various database queries on the guest system with the ability to restore the initial system after each request. </li><li>  You can try various configurations of the interaction of services on the guest system without the need to manually roll back changes in many configuration files in case of receiving a non-working system </li><li>  And finally, it is sometimes a convenient backup tool that allows you to take a complete snapshot of the working machine and restore it completely in a minimal amount of administrative actions.  Attention!  Do not do this with production machines. </li></ul>  When you create a snapshot of a guest system, the disk space it occupies does not actually increase, the additional volume will be taken only by the data that has been changed compared to the existing disk of the guest machine.  For example, if the /etc/rc.conf file is modified, the modified copy will be written separately. <br><br>  To create a snapshot via phpvirtualbox you need: <ul><li>  Select the guest system with which to take a picture </li><li>  Go to the Snapshots tab </li><li>  Press the ‚ÄúTake Snapshot‚Äù button (with a camera image) </li><li>  Enter snapshot name and comment </li></ul>  To restore a snapshot via phpvirtualbox you need: <ul><li>  Select the guest system with which to take a picture </li><li>  Turn off the guest system by clicking ‚ÄúStop‚Äù&gt; ‚ÄúPower Off‚Äù </li><li>  Go to the Snapshots tab </li><li>  Select a snapshot to restore </li><li>  Click the ‚ÄúRestore Snapshot‚Äù button (with a computer with an up arrow) </li></ul><h3>  Create dump </h3><br><h4>  Debian linux </h4><br>  The cloning and recovery procedures are shown on the example of the test1 server on which Debian Linux is installed (any version starting from 5 Lenny exactly).  Suppose we have three partitions with three file systems: <code>/, /var, /usr</code> <br><br>  First you need to install the dump: <br> <code>aptitude install dump</code> <br> <br>  Further, to create a dump of a cloning server on Debian, you need to give the following commands from the superuser (root) or using sudo (how to avoid dumping, think for yourself): <br> <code>dump 0af test1.root / <br> dump 0af test1.var /var <br> dump 0af test1.usr /usr</code> <br> <br>  Here: <br> <code>0 --   0 <br> a --      ,     <br> L --     ,      , ,    ,     . Linux   . <br> f --       . <br></code> <br>  The resulting files need to transfer to the server with VirtualBox. <br><br><h4>  Freebsd </h4><br>  The cloning and recovery procedures are shown on the example of the test1 server on which FreeBSD is installed (any version starting with 6 exactly).  Suppose we have three partitions with three file systems: <code>/, /var, /usr</code> <br><br>  To create a dump of a cloned server on FreeBSD, you need to be from the superuser (root) or use the sudo command to give the following commands (again I remind you about dumping dumps): <br> <code>dump 0aLf test1.root / <br> dump 0aLf test1.var /var <br> dump 0aLf test1.usr /usr</code> <br> <br>  Here: <br> <code>0 --   0 <br> a --      ,     <br> f --       . <br></code> <br>  Anaglogino, the received files need to be transferred to the server with VirtualBox. <br><br><h3>  Deploy Dump </h3><br><h4>  Debian linux </h4><br>  1. You need to make a virtual machine, attach a disk and a bootable Debian LiveCD to it. <br><br>  2. Then you need to mount the resulting partition, conceive dumps on it, deploy them: <br> <code>cd /mnt1 &amp;&amp; restore -rf /mnt/test1.root &amp;&amp; cd usr &amp;&amp; restore -rf /mnt/test1.usr &amp;&amp; <br> cd ../var &amp;&amp; restore -rf /mnt/test1.var</code> <br> <br>  3. Install the bootloader: <br>  <code>grub-install /dev/sda1</code> . <br><br>  4. Amend UUID in <code>/etc/fstab</code> <br><br>  5. Verify that the / <code>/boot/grub/grub.cfg</code> correctly identifies the UUID of the partitions: <br> <code>search --no-floppy --fs-uuid --set df7f92ba-2877-4b39-8805-966cf9ab52f3 <br> linux /boot/vmlinuz-2.6.32-5-amd64 root=UUID=df7f92ba-2877-4b39-8805-966cf9ab52f3 ro quiet</code> <br> <br>  6. Check <code>/var/spool/cron/crontabs, /etc/crontab</code> and disable what is unnecessary. <br><br>  7. If a console was enabled on the server being restored, then remove a line similar to the following from <code>/etc/inittab</code> : <br>  <code>T0:23:respawn:/sbin/getty -L ttyS0 9600 vt100</code> , and from <code>/etc/default/grub</code> like this: <br>  <code>GRUB_TERMINAL=console</code> (just comment out). <br><br><h4>  Freebsd </h4><br>  Created dumps need to be deployed on a disk image allocated for the guest system.  Currently, support for the UFS file systems used in FreeBSD is limited, so a FreeBSD virtual machine is created for deploying the dumps, a section for storing the dumps is connected to it, to which dumps are sent from the cloned servers using scp.  Then a dedicated disk image is attached to this machine, the FreeBSD file system is created on this image, and the resulting dump is deployed. <br><br>  Further, it is assumed that the tmp partition is mounted on / mnt, the disk image for the guest OS is marked up under two slices, the first of which is mounted on mnt1, and the second is swaped and not mounted.  Then you can deploy the dump as follows: <br><br> <code>cd /mnt1 &amp;&amp; restore -rf /mnt/test1.root &amp;&amp; cd usr &amp;&amp; restore -rf /mnt/test1.usr &amp;&amp; <br> cd ../var &amp;&amp; restore -rf /mnt/test1.var</code> <br> <br>  Here &amp;&amp; is needed so that the next command will be executed only if the previous one is completed successfully, and thus situations are excluded where, for example, the var directory will not be created, the transition to it will not be realized and the dump will not be deployed there, because  The dump is expanded relative to the current directory. <br><br><h3>  Necessary changes in the configuration of the guest OS of the cloned server </h3><br>  Before loading, the guest OS needs to be reconfigured to work in a virtual machine.  The number of actions required is usually minimal and boils down to the following: <br><br>  1. Being in the mnt1 directory (see above), we delete bootloader configuration files.  This is especially true if we are virtualizing some kind of production server in order to prevent the COM port from being used as the default console, which causes the boot loader to freeze. <br> <code>rm /mnt1/boot.config <br> rm /mnt1/boot/device.hints <br></code> <br>  2. Replace the contents of the <code>/mnt1/etc/fstab</code> following: <br> <code>/dev/ad0s1b none swap sw 0 0 <br> /dev/ad0s1a / ufs rw 2 2 <br></code> <br>  It is assumed that the disk image of the guest OS is divided into 2 slices, the first of which is given for data storage and the second under the swap. <br><br>  3. If necessary, tell the cloned system about the need to load the kernel module to work with the emulated network card, for which you need to <code>/boot/loader.conf   if_em_load="YES"</code> in the <code>/boot/loader.conf   if_em_load="YES"</code> file <br><br>  4. Specify the assigned IP address for the cloned system, for which you need to comment out the current network adapter settings in <code>/etc/rc.conf</code> and add a new line of the following type: <br><br> <code>ifconfig_em0="inet 10.0.0.8/24"</code> <br> <br>  6. If the cloned server is allocated an outside-visible IP address, then you need to delete its settings that are responsible for its interaction with other servers.  Attention!  The cloned server has all the settings of the present, so it is theoretically possible that if the settings are not deleted, then the cloned server will interfere with the operation of the combat system.  The main place to check on FreeBSD-based servers is in <code>/var/cron/tabs/</code> . <br><br>  7. Shut down FreeBSD, which was used to deploy the dump, and load the guest system with a server clone.  In case of problems during the boot process, it is possible that the kernel on the system was rebuilt with the changed configuration, this can be fixed by telling the bootloader to load the default kernel, which I hope you saved in the system during the reassembly: <br> <code>unload <br> load boot/kernel.GENERIC/kernel <br> boot</code> <br> <br>  To return these commands, you need to turn on the guest system, connect to it via RDP and wait for the message to appear on the screen that you can press Enter to specify options for the loader. <br><br>  8. Add a user for ssh access by logging into the cloned server via RDP: <br> <code>pw user add username -g wheel &amp;&amp; passwd username</code> <br> <br>  Here, the <code>-g wheel</code> option adds a user to the wheel group, whose members in FreeBSD have the right to do sudo and su. <br><br><h2>  Creation of virtual networks </h2><br>  Inside VirtualBox, you can create completely isolated virtual networks.  What opportunities does it provide? <br><br>  Minimize the need to reconfigure cloned servers <br>  Creating a test environment for testing the interaction between servers <br><br><h3>  Creating a virtual network </h3><br>  To create a virtual network, in phpvirtualbox, go to the properties of the guest system, go to the Network section, select the Internal Network option in the ‚ÄúAttached to‚Äù field, and select the required virtual network in the ‚ÄúName‚Äù drop-down list.  What difficulties may arise? <br><br>  You need to create a new virtual network, and there is no such option in the interface.  There are two possible solutions: <br><br>  Try to write the name of the new virtual network directly in the drop-down list "Name".  However, in this case an error may occur. <br>  Then you need to bind the guest's network adapter to the virtual network via the CLI: <br><br> <code>sudo su -s /bin/bash vbox <br> VBoxManage modifyvm test1 --nic1 intnet</code> <br> <br>  Here <br>  nic1 is the network adapter of the guest system, where 1 is its sequence number.  The number of adapters in the guest system is unlimited. <br>  intnet is a virtual network, the name can be anything.  The feature of VirtualBox is that it is not necessary to specifically create virtual networks, it is enough to specify the same virtual network to several guest systems and they will be connected to the (emulated) physical layer automatically, which is similar to connecting several real computers to one switch (switch) . <br><br>  For more information, see section 8.7.2 Networking Setting User Guide. <br><br><h2>  Manage inaccessible outside machines in the virtual network </h2><br><h3>  RDP access </h3><br>  The RDP server runs on a physical server, so to connect to any virtual machine rightly written in the section Management via the web interface of this article. <br><br><h3>  Port forwarding </h3><br>  It is possible to create a virtual network card in the guest system with a connection through NAT (implemented automatically by VirtualBox) and forward (display) an arbitrary port of the guest system to the port of the VirtualBox server.  In order to do this via phpvirtualbox, you need to: <br><br>  1. Go to the properties of the guest system, go to the ‚ÄúNetwork‚Äù section, select the ‚ÄúNAT‚Äù option in the ‚ÄúAttached to‚Äù field <br><br>  2. Expand the options hidden in the ‚ÄúAdvanced‚Äù section of the same section and click the Port Forwarding button there. <br><br>  3. In the ‚ÄúPort Forwarding Rules‚Äù window that opens, specify the following parameters: <br><br>  4. The desired protocol by clicking the mouse on the naming "TCP" in the field "Protocol" <br><br>  5. Enter the free port on the VirtualBox server in the ‚ÄúHost Port‚Äù field <br><br>  6. Specify the guest port in the field ‚ÄúGuest Port‚Äù. <br><br>  Nothing more is needed.  After applying the settings, the guest port will be immediately (without rebooting) accessible via the corresponding port of the VirtualBox server.  As an example, in the case of forwarding the ssh port (22 TCP) of the guest system to the 2200 port of VirtualBox, you need to specify the following parameters: <br> <code>  <br> Name ssh ( ) <br> Protocol TCP <br> Host IP   <br> Host Port 2200 <br> Guest Port 22 <br> Guest IP   <br></code> <br>  The number of displayed ports is not limited, you can display as much as you need. <br><br><h3>  Virtual router </h3><br>  In the case of creating a group of interacting guests in VirtualBox without external addresses, it makes sense to install another guest system that will play the role of a router.  What goals are achieved with this? <br><br>  The configuration of network adapters cloned by the server can not be changed.  At the same time, the virtual router creates visibility for other guest systems that they are real and use their real host names and IP addresses. <br>  For guest systems that do not have any external addresses or the port forwarding capability described above, which only works if the VirtualBox NAT option is used, direct ssh access is possible. <br><br>  Creating a virtual router consists of the following steps: <br><ul><li>  Creating a guest system </li><li>  Installing any guest OS that can play the role of a router, for example, Debian Linux or FreeBSD </li><li>  Entering the guest system into the virtual network as described above. </li><li>  Configure the guest system to perform router functions </li><li>  Connection to the guest system of the second virtual network adapter in bridge mode with the VirtualBox server network adapter </li></ul><br>  After that, you can forward ports from the virtual router to the guest systems without external addresses.  In the case of Linux with iptables, for forwarding incoming connections from port 2200 of TCP protocol of virtual router to port 22 (TCP) of a guest system without an external address with internal address 192.168.0.2, the following rule is sufficient: <br> <code>iptables -t nat -A ROUTING -p tcp -i eth0 --dport 2200 -j DNAT --to-destination 192.168.0.2:22</code> <br> <br>  It is assumed that the virtual router is configured correctly and has a network adapter configured to work with the virtual subnet in which the guest system is located with the address 192.168.0.2 <br><br><h3>  SSH access </h3><br>         ssh         ssh-      2200.     scp      . </div><p>Source: <a href="https://habr.com/ru/post/142963/">https://habr.com/ru/post/142963/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../142958/index.html">Fuzzing Chrome browser: 6000 instances, 50 million options per day</a></li>
<li><a href="../142959/index.html">Lokata.ru - online catalog for purchases offline</a></li>
<li><a href="../142960/index.html">Contactless smartphone Sony Xperia Sola goes on sale</a></li>
<li><a href="../142961/index.html">What you need to pay attention when opening a small online store</a></li>
<li><a href="../142962/index.html">Android Future note</a></li>
<li><a href="../142964/index.html">Web server on D?</a></li>
<li><a href="../142965/index.html">As a sysadmin sysadmin - tips for beginners</a></li>
<li><a href="../142966/index.html">QML and QtQuick Webinars: User Interaction</a></li>
<li><a href="../142968/index.html">Half-support Cyrillic domains in 12 Firefox</a></li>
<li><a href="../142969/index.html">Intel inside: x86 smartphones in all pockets of the country?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>