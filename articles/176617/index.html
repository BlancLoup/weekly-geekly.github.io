<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Implement ToDoMVC on Jiant</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="I thank everyone who read, responded and appreciated the first post! 

 To demonstrate how the ideology of Jiant works, it implemented ToDoMVC, a proj...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Implement ToDoMVC on Jiant</h1><div class="post__text post__text-html js-mediator-article">  I thank everyone who read, responded and appreciated the first post! <br><br>  To demonstrate how the ideology of Jiant works, it implemented ToDoMVC, a project created for evaluating various MVC frameworks.  Jiant is not an MVC framework, but rather an approach to development with a set of supporting tools.  It took me about 8 hours to develop, taking into account the reading and understanding of the specification, the study of the reference implementation, localStorage, with which I had no business (a very simple thing) and everything else.  I do not know a lot or a little, but so much.  The results are at: <a href="https://github.com/vecnas/todomvc-jiant">github.com/vecnas/todomvc-jiant</a> .  In Chrome and Firefox, it works directly from the file system, and in IE from the server. <br><a name="habracut"></a><br><h4>  Specification </h4><br>  <a href="https://github.com/addyosmani/todomvc/wiki/App-Specification">github.com/addyosmani/todomvc/wiki/App-Specification</a> - specification in English.  Summarize the key points here. <br>  Need to develop a task management tool (ToDo), the following points should be implemented: <br><ol><li>  Storage.  All tasks and their status should be saved in the local storage (HTML5 localStorage) and restored when restarting the browser for example. </li><li>  Navigation.  The application must support browser hash navigation; see the original for more details.  The navigation format is set there, but Jiant has a slightly different format, this is due to the ability to set navigation nodes and then return to them.  Operated by buttons on the navigation bar.  There are three states: show all, show active and show completed </li><li>  New tasks.  These are entered by filling in the input field at the top of the page and pressing the Enter key. </li><li>  Mass manipulation.  A special button marks all tasks as completed or not completed.  The button state is also synchronized with the current state of all tasks.  That is, if we add a new one when everything is already completed, the indicator will stop showing that everything is done. </li><li>  Task.  Represents three interactive elements - the switch is done-not done, it works by clicking, the button for deleting a task, and by double-clicking on the name - it gives the opportunity to edit the text of the task </li><li>  Editing.  The input field opens, the rest of the elements are hidden, by pressing Enter or losing focus - saves the text, by pressing Escape - cancels all changes; if you save the text is empty - deletes the task </li><li>  Counter active tasks.  Shows the number of current active tasks, synchronized to any changes, the text should be literate ("1 task", but "2 tasks") </li><li>  Clear completed.  Shows the number of completed tasks, deletes them on click and is shown only if there is at least one completed task. </li><li>  The panel with counters and navigation buttons is shown only if there is at least one task. </li></ol><br><br>  At the entrance there is a project template, containing html code and some interactive scripts, as well as all styles. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h4>  Jiant project structure </h4><br>  At the moment, the ideal structure is as follows: <br><ol><li>  The application definition file is a json variable declaration describing the application API </li><li>  "Ignition" is a call to bindUi anywhere where the user is comfortable. </li><li>  A set of "plug-ins" - application logic, each of which is encapsulated in its sandbox and works through the application API </li></ol><br><br><h4>  Initial design </h4><br>  The first stage in the Jiant approach is the most abstract design.  The most important and possibly unusual (at least for myself) is to completely disengage from how everything will be realized.  I create the first version of the application description, looking at the description of the customer.  Here I present the first considerations, after reading the specification, and not the ideal reasoning prepared as a result of the project.  That is, everything is vital, as it happens. <br><br><h5>  States </h5><br>  If you need hash navigation, it means that the application will have states.  We list them, directly take a list from the specification, do not think: <br><pre><code class="javascript hljs">states: { <span class="hljs-string"><span class="hljs-string">""</span></span>: { <span class="hljs-attr"><span class="hljs-attr">go</span></span>: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{}, <span class="hljs-attr"><span class="hljs-attr">start</span></span>: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">cb</span></span></span><span class="hljs-function">) </span></span>{}, <span class="hljs-attr"><span class="hljs-attr">end</span></span>: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">cb</span></span></span><span class="hljs-function">) </span></span>{} }, <span class="hljs-attr"><span class="hljs-attr">active</span></span>: { <span class="hljs-attr"><span class="hljs-attr">go</span></span>: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{}, <span class="hljs-attr"><span class="hljs-attr">start</span></span>: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">cb</span></span></span><span class="hljs-function">) </span></span>{}, <span class="hljs-attr"><span class="hljs-attr">end</span></span>: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">cb</span></span></span><span class="hljs-function">) </span></span>{} }, <span class="hljs-attr"><span class="hljs-attr">completed</span></span>: { <span class="hljs-attr"><span class="hljs-attr">go</span></span>: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{}, <span class="hljs-attr"><span class="hljs-attr">start</span></span>: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">cb</span></span></span><span class="hljs-function">) </span></span>{}, <span class="hljs-attr"><span class="hljs-attr">end</span></span>: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">cb</span></span></span><span class="hljs-function">) </span></span>{} } }</code> </pre> <br><br>  Explanation: According to the format, if the application description variable contains the states section - Jiant loads the states listed in it and implements three methods for each: go, start, end.  go is used to go to the state, start and end to react to the beginning or end of the state.  The most concise entry looks like this: <br><pre> <code class="java hljs"> states: { <span class="hljs-string"><span class="hljs-string">""</span></span>: {}, active: {}, completed: {} }</code> </pre><br>  But in this case, we will not have auto-completion in the IDE, so for my own convenience and better documentation, I use the first notation.  An empty state corresponds to ‚Äúuncertain‚Äù situations - for example, when a browser window is simply loaded without any hashes. <br>  All that is all you need to work hash navigation.  All functionality will be added during application initialization by Jiant. <br><br>  To completely close the topic of state design - you can make one state with two parameters, for example: <br><pre> <code class="javascript hljs"> states: { <span class="hljs-string"><span class="hljs-string">""</span></span>: { <span class="hljs-attr"><span class="hljs-attr">go</span></span>: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">showActive, showCompleted</span></span></span><span class="hljs-function">) </span></span>{} } }</code> </pre><br>  And this will work too.  But, since we have on state control, then from purely utilitarian considerations it seems more convenient to start three states.  Again, this is the first intuitive solution.  By the way, these states remained in the final version. <br><br><h5>  Developments </h5><br>  Now we define application-level events, again in the abstract.  It seems intuitively that the following list is correct: <br><pre> <code class="javascript hljs"> events: { <span class="hljs-attr"><span class="hljs-attr">todoAdded</span></span>: { <span class="hljs-attr"><span class="hljs-attr">fire</span></span>: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">todo</span></span></span><span class="hljs-function">) </span></span>{}, <span class="hljs-attr"><span class="hljs-attr">on</span></span>: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">cb</span></span></span><span class="hljs-function">) </span></span>{} }, <span class="hljs-attr"><span class="hljs-attr">todoRemoved</span></span>: { <span class="hljs-attr"><span class="hljs-attr">fire</span></span>: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">todo</span></span></span><span class="hljs-function">) </span></span>{}, <span class="hljs-attr"><span class="hljs-attr">on</span></span>: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">cb</span></span></span><span class="hljs-function">) </span></span>{} }, <span class="hljs-attr"><span class="hljs-attr">todoStateChanged</span></span>: { <span class="hljs-attr"><span class="hljs-attr">fire</span></span>: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">todo</span></span></span><span class="hljs-function">) </span></span>{}, <span class="hljs-attr"><span class="hljs-attr">on</span></span>: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">cb</span></span></span><span class="hljs-function">) </span></span>{} } }</code> </pre><br><br>  The only thinking caused the last event - whether it is necessary to break it into two - to complete or re-activate todo.  Again, the entire event support code runs inside Jiant, the user only needs to define an abstract list of events and use it.  Each event has two methods - fairly obvious.  The cb (callback, on method parameter) function takes exactly the same arguments as the fire call. <br><br><h5>  Interface </h5><br>  Now you need to determine the visual part of the application.  The list of elements as usual is simply copied from the description of the customer, as convenient.  After writing so: <br><pre> <code class="javascript hljs"> views: { <span class="hljs-attr"><span class="hljs-attr">main</span></span>: { <span class="hljs-attr"><span class="hljs-attr">batchToggleStateCtl</span></span>: ctl, <span class="hljs-attr"><span class="hljs-attr">newTodoTitleInput</span></span>: input, <span class="hljs-attr"><span class="hljs-attr">todoList</span></span>: container }, <span class="hljs-attr"><span class="hljs-attr">controls</span></span>: { <span class="hljs-attr"><span class="hljs-attr">activeCountLabel</span></span>: label, <span class="hljs-attr"><span class="hljs-attr">clearCompletedCtl</span></span>: ctl, <span class="hljs-attr"><span class="hljs-attr">completedCountLabel</span></span>: label, <span class="hljs-attr"><span class="hljs-attr">showAllCtl</span></span>: ctl, <span class="hljs-attr"><span class="hljs-attr">showActiveCtl</span></span>: ctl, <span class="hljs-attr"><span class="hljs-attr">showCompletedCtl</span></span>: ctl } },</code> </pre><br>  - it is useful in html and found that the identifiers for the elements are already registered, the structure is set, so it would be more logical to just apply it.  Total: <br><pre> <code class="javascript hljs"> views: { <span class="hljs-attr"><span class="hljs-attr">header</span></span>: { <span class="hljs-attr"><span class="hljs-attr">newTodoTitleInput</span></span>: input }, <span class="hljs-attr"><span class="hljs-attr">main</span></span>: { <span class="hljs-attr"><span class="hljs-attr">batchToggleStateCtl</span></span>: ctl, <span class="hljs-attr"><span class="hljs-attr">todoList</span></span>: container }, <span class="hljs-attr"><span class="hljs-attr">footer</span></span>: { <span class="hljs-attr"><span class="hljs-attr">activeCountLabel</span></span>: label, <span class="hljs-attr"><span class="hljs-attr">clearCompletedCtl</span></span>: ctl, <span class="hljs-attr"><span class="hljs-attr">completedCountLabel</span></span>: label, <span class="hljs-attr"><span class="hljs-attr">showAllCtl</span></span>: ctl, <span class="hljs-attr"><span class="hljs-attr">showActiveCtl</span></span>: ctl, <span class="hljs-attr"><span class="hljs-attr">showCompletedCtl</span></span>: ctl } }</code> </pre><br>  and this structure, created in the 10th minute of design, has not changed until the end of the project. <br><br><h5>  Templates </h5><br>  Based on the specification, we see one extremely dynamic element - a visual representation of the task.  Their number is different, they are added and removed, so for this, according to the ideology of Jiant, you just need to use a template, we define it: <br><pre> <code class="javascript hljs"> templates: { <span class="hljs-attr"><span class="hljs-attr">tmTodo</span></span>: { <span class="hljs-attr"><span class="hljs-attr">deleteCtl</span></span>: ctl, <span class="hljs-attr"><span class="hljs-attr">editCtl</span></span>: ctl, <span class="hljs-attr"><span class="hljs-attr">stateMarker</span></span>: label, <span class="hljs-attr"><span class="hljs-attr">toggleStateCtl</span></span>: ctl, <span class="hljs-attr"><span class="hljs-attr">titleInput</span></span>: input, <span class="hljs-attr"><span class="hljs-attr">hiddenInEditMode</span></span>: collection, <span class="hljs-attr"><span class="hljs-attr">titleLabel</span></span>: label } }</code> </pre><br>  Again so as not to bother the brain once more - we simply transfer everything from the customer‚Äôs description, according to the principle ‚Äúdelete task button‚Äù - deleteCtl. <br>  Here it is necessary to say something about the patterns.  First, you can see that the fields are defined for the template - they are first checked for validity when the application is started, and secondly they are attached after creating an element from the template.  Each template has two methods: parseTemplate, parseTemplate2Text, which take parameters for substitution.  The template does not contain any logic, only the substitution of values, and this is intentionally the place of logic in javascript code.  Later, another application appeared in the application, introduced more to show how to substitute values: <br><pre> <code class="javascript hljs"> templates: { .... itemsLeft: {}, <span class="hljs-attr"><span class="hljs-attr">itemsLeft1</span></span>: {} }</code> </pre><br>  implementation: <br><pre> <code class="html hljs xml"> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"itemsLeft1"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">style</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"display: none;"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">strong</span></span></span><span class="hljs-tag">&gt;</span></span>!!count!!<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">strong</span></span></span><span class="hljs-tag">&gt;</span></span> item left <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"itemsLeft"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">style</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"display: none;"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">strong</span></span></span><span class="hljs-tag">&gt;</span></span>!!count!!<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">strong</span></span></span><span class="hljs-tag">&gt;</span></span> items left <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br>  and use: <br><pre> <code class="javascript hljs"> tm.parseTemplate2Text({<span class="hljs-attr"><span class="hljs-attr">count</span></span>: count})</code> </pre><br><br>  We do not design the data model yet, see below.  I want to quickly run and see that nothing breaks, for this you need a starter. <br><br><h4>  Starter </h4><br>  Based on the ideal structure, the application starter is placed in the app.js file (available in the ‚Äúcustomer‚Äù base template) and its code is as follows: <br><pre> <code class="javascript hljs"> jQuery(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ jiant.bindUi(<span class="hljs-string"><span class="hljs-string">""</span></span>, todomvcJiant, <span class="hljs-literal"><span class="hljs-literal">true</span></span>); });</code> </pre><br><br>  Since the html code is already set by the customer (and I don‚Äôt want to change, not to change css), the prefix here is empty (the first parameter), the variable todomvcJiant is defined in the application definition file (it contains views, templates, states, events) and we turn on development. <br><br><h4>  HTML implementation </h4><br>  That's all, we only have the definition file and the starter, no logic, but I really want to run the application.  I run html in Chrome and see: <br><ol><li>  Alert with a message from Jiant, in which it says ‚ÄúNo history plugin and states configured.  Don't use states or add $ .History plugin ¬ª </li><li>  Another alert with a message about unrealized interface elements </li><li>  And repeat the text of the second alert in the console: non-existing object </li></ol><br>  Adding history - is included.  It now remains to implement an abstract definition at the html level, for example: <br><pre> <code class="html hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">section</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"main"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">input</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"toggle-all"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"batchToggleStateCtl"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"checkbox"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">style</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"display: none;"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">label</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">for</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"toggle-all"</span></span></span><span class="hljs-tag">&gt;</span></span>Mark all as complete<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">label</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ul</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"todo-list"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"todoList"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ul</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">section</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br>  - identifiers are already placed, it remains to add classes to the desired elements.  Template implementation: <br><pre> <code class="html hljs xml"> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"tmTodo"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">style</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"display: none;"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">li</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"stateMarker"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"view hiddenInEditMode"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">input</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"toggle toggleStateCtl"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"checkbox"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">label</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"editCtl titleLabel"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">label</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">button</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"destroy deleteCtl"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">button</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">input</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"edit titleInput"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">value</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">""</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">li</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br>  It should be noted that, unlike common practice, to place templates in &lt;script type = "someUnreadableTypeToFoolBrowser"&gt;, Jiant uses the correct html structure, this is due to the fact that there is no DOM model inside the script tag and it is impossible to validate the template field binding to the implementation. <br><br>  Finally, Jiant stopped reporting unrelated elements, the abstract application model is tied to an implementation and ready to use. <br><br><h4>  Plugins </h4><br>  Following the ideology of Jiant - any logic is added by plugins.  If a new view or event state appears, we add it to the application description file and the implementation to the html.  That is, the process of expanding the application is always constant and controlled, which is extremely important for large-scale development, starting small. <br><br><h4>  Model </h4><br>  The question is whether this application needs a centralized data model?  Theoretically, each plugin can contain its own model and synchronize it based on events occurring in the application.  In practice, I wrote this version for comparison and, as expected, I got a lot of unnecessary and duplicate code.  Therefore, we will implement the model (it would practically be possible to place the implementation directly in the json application description file, but then it will become harder to read, therefore we will render a separate plugin, following the ideology), model.js: <br><pre> <code class="javascript hljs">todomvcJiant.model.todo = (<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">$, app</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> todos = []; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> { <span class="hljs-attr"><span class="hljs-attr">add</span></span>: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">title, completed</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> todo = {<span class="hljs-attr"><span class="hljs-attr">title</span></span>: title, <span class="hljs-attr"><span class="hljs-attr">completed</span></span>: completed ? <span class="hljs-literal"><span class="hljs-literal">true</span></span> : <span class="hljs-literal"><span class="hljs-literal">false</span></span>}; todos.push(todo); app.events.todoAdded.fire(todo); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> todo; }, <span class="hljs-attr"><span class="hljs-attr">remove</span></span>: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">todo</span></span></span><span class="hljs-function">) </span></span>{ todos = $.grep(todos, <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">value</span></span></span><span class="hljs-function">) </span></span>{<span class="hljs-keyword"><span class="hljs-keyword">return</span></span> value != todo;}); app.events.todoRemoved.fire(todo); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> todo; }, <span class="hljs-attr"><span class="hljs-attr">getAll</span></span>: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> todos; }, <span class="hljs-attr"><span class="hljs-attr">getCompleted</span></span>: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> $.grep(todos, <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">value</span></span></span><span class="hljs-function">) </span></span>{<span class="hljs-keyword"><span class="hljs-keyword">return</span></span> value.completed}); }, <span class="hljs-attr"><span class="hljs-attr">getActive</span></span>: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> $.grep(todos, <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">value</span></span></span><span class="hljs-function">) </span></span>{<span class="hljs-keyword"><span class="hljs-keyword">return</span></span> !value.completed}); } } })($, todomvcJiant);</code> </pre><br>  Simplest array based implementation.  It is worth noting just here we run some application events.  In this case, adding a model to the json project description is cosmetic (for example, there is no getActive () method), Jiant is not involved in data models at all. <br><br><h4>  Plugin implementation </h4><br>  Further, for each element of logic from the specification, we write our own plugin and add it.  At any moment everything works for us, the functionality is increased, without affecting the rest.  Below are a couple of examples, a comment right in the code. <br><br><h5>  stateCtls.js </h5><br><pre> <code class="javascript hljs">jiant.onUiBound(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">$, app</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-comment"><span class="hljs-comment">//      API   var ctlsView = app.views.footer, ctls = { "showActiveCtl": app.states.active, //      "showCompletedCtl": app.states.completed, "showAllCtl": app.states[""] }; $.each(ctls, function(key, state) { ctlsView[key].click(function() { state.go(); }); state.start(function() { //             ctlsView[key].addClass("selected"); }); state.end(function() { ctlsView[key].removeClass("selected"); }); }); });</span></span></code> </pre><br><br><h5>  footerVisibility.js </h5><br><br><pre> <code class="javascript hljs">jiant.onUiBound(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">$, app</span></span></span><span class="hljs-function">) </span></span>{ app.events.todoAdded.on(updateView); <span class="hljs-comment"><span class="hljs-comment">//    app.events.todoRemoved.on(updateView); function updateView() { //   todo  ,         app.model.todo.getAll().length &gt; 0 ? app.views.footer.show() : app.views.footer.hide(); } });</span></span></code> </pre><br><br>  Similarly, other plugins are added using onUiBound.  When a plugin needs a new API functionality, we create an abstract declaration and implementation.  In this case, in most plugins, something like the global smthChanged event was created in response to which the plugins update their status, but this is a particular coincidence. <br>  It is worth noting that html is used only as html, no custom attributes or tags.  All the logic of working with UI is written in jQuery functions. <br>  Fun fact - it was not necessary to enter the object identifier.  All work is done through direct links to objects.  The UI reference to the implementation of the todo object is saved as a todo object field, inside todoRenderer.js and not used by anyone outside, the order is preserved inside the model. <br><br><h4>  PS </h4><br>  Already when I wrote everything on the last line I realized that after changing the text of the task, the new text is not saved in localStorage until any of the already existing events occurs.  To fix, added a new event todoTitleModified, throws in the editor after installing a new text (todoRenderer.js) and subscribing to an event in the persistence module (persistence.js). </div><p>Source: <a href="https://habr.com/ru/post/176617/">https://habr.com/ru/post/176617/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../176605/index.html">"Computing and its application" (November 1990)</a></li>
<li><a href="../176607/index.html">AppFog and Django. Where to begin?</a></li>
<li><a href="../176609/index.html">The operational headquarters of the Russian Post stops a post collapse</a></li>
<li><a href="../176611/index.html">Lagoa cloud platform for 3D rendering</a></li>
<li><a href="../176615/index.html">Copying business papers a hundred years ago</a></li>
<li><a href="../176619/index.html">Is there life in the world of PostPC? Part One: Moving</a></li>
<li><a href="../176621/index.html">How to learn English</a></li>
<li><a href="../176629/index.html">Periodic table of visualization methods</a></li>
<li><a href="../176631/index.html">Basics of security of the Android operating system. Native user space, part 2</a></li>
<li><a href="../176633/index.html">Mozilla JavaScript Web Chat</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>