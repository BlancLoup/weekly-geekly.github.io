<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Authentication in rails applications using facebook, vkontakte</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Authentication in rails applications via facebook, vkontakte 

 This article will explain how to do the simplest authentication in the rails applicati...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Authentication in rails applications using facebook, vkontakte</h1><div class="post__text post__text-html js-mediator-article"><h1>  Authentication in rails applications via facebook, vkontakte </h1><br><img src="https://habrastorage.org/storage2/5df/b81/0f9/5dfb810f9a247b65b11195d8b7abe1a9.png"><br>  This article will explain how to do the simplest authentication in the rails application through social networks vkontakte and facebook, help with this omniauth, omniauth-facebook, omniauth-vkontakte.  The material is designed for a beginner.  Although this will be an educational application, we use bootstrap using the twitter-bootstrap-rails gem to make it more complete. <br><a name="habracut"></a><br><br><h2>  Frame </h2><br>  Create a new application (I will omit the bundle exec before the commands): <br><pre><code class="ruby hljs">rails new authproviders</code> </pre> <br>  We write the necessary gems in the Gemfile <br><pre> <code class="ruby hljs">source <span class="hljs-string"><span class="hljs-string">'https://rubygems.org'</span></span> gem <span class="hljs-string"><span class="hljs-string">'rails'</span></span>, <span class="hljs-string"><span class="hljs-string">'3.2.3'</span></span> gem <span class="hljs-string"><span class="hljs-string">'sqlite3'</span></span>, <span class="hljs-symbol"><span class="hljs-symbol">:group</span></span> =&gt; <span class="hljs-symbol"><span class="hljs-symbol">:development</span></span> gem <span class="hljs-string"><span class="hljs-string">'pg'</span></span>, <span class="hljs-symbol"><span class="hljs-symbol">:group</span></span> =&gt; <span class="hljs-symbol"><span class="hljs-symbol">:production</span></span> group <span class="hljs-symbol"><span class="hljs-symbol">:assets</span></span> <span class="hljs-keyword"><span class="hljs-keyword">do</span></span> gem <span class="hljs-string"><span class="hljs-string">'sass-rails'</span></span>, <span class="hljs-string"><span class="hljs-string">'~&gt; 3.2.3'</span></span> gem <span class="hljs-string"><span class="hljs-string">'coffee-rails'</span></span>, <span class="hljs-string"><span class="hljs-string">'~&gt; 3.2.1'</span></span> gem <span class="hljs-string"><span class="hljs-string">'uglifier'</span></span>, <span class="hljs-string"><span class="hljs-string">'&gt;= 1.0.3'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">end</span></span> gem <span class="hljs-string"><span class="hljs-string">'jquery-rails'</span></span> gem <span class="hljs-string"><span class="hljs-string">'haml-rails'</span></span> gem <span class="hljs-string"><span class="hljs-string">'twitter-bootstrap-rails'</span></span> gem <span class="hljs-string"><span class="hljs-string">'devise'</span></span> gem <span class="hljs-string"><span class="hljs-string">'omniauth'</span></span> gem <span class="hljs-string"><span class="hljs-string">'omniauth-facebook'</span></span> gem <span class="hljs-string"><span class="hljs-string">'omniauth-vkontakte'</span></span></code> </pre> <br>  Perform installation: <br><pre> <code class="bash hljs">bundle install --without production</code> </pre><br>  Let's make the application a bit prettier, let's use bootstrap: <br><pre> <code class="bash hljs">rails g bootstrap:layout application fixed</code> </pre><br>  Do not forget to delete index.html from the public directory, <br>  if the application.html.erb file remains, then delete it too. <br>  Create a user model, where url is the address of the profile page: <br><pre> <code class="bash hljs">rails g scaffold User username:string nickname:string provider:string url:string</code> </pre><br>  Configure devise: <br><pre> <code class="bash hljs">rails generate devise:install rails generate devise User rake db:migrate</code> </pre><br>  Add the omniauthable module to the User model: <br><pre> <code class="ruby hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">User</span></span></span><span class="hljs-class"> &lt; ActiveRecord::Base </span><span class="hljs-comment"><span class="hljs-class"><span class="hljs-comment"># Include default devise modules. Others available are: # :token_authenticatable, :encryptable, :confirmable, :lockable, :timeoutable and :omniauthable devise :database_authenticatable, :registerable, :recoverable, :rememberable, :trackable, :validatable, :omniauthable # Setup accessible (or protected) attributes for your model attr_accessible :email, :password, :password_confirmation, :remember_me attr_accessible :nickname, :provider, :url, :username end</span></span></span></span></code> </pre><br><br>  Create a callback controller with actions for each provider <br><pre> <code class="bash hljs">rails g controller Users::OmniauthCallbacks facebook vkontakte</code> </pre><br>  We inherit it from Devise :: OmniauthCallbacksController <br><pre> <code class="ruby hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Users::OmniauthCallbacksControllerController</span></span></span><span class="hljs-class"> &lt; Devise::OmniauthCallbacksController </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">def</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">facebook</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">end</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">def</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">vkontakte</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">end</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">end</span></span></span></span></code> </pre><br>  We prescribe routing in routes.rb: <br><pre> <code class="ruby hljs">Authproviders::Application.routes.draw <span class="hljs-keyword"><span class="hljs-keyword">do</span></span> devise_for <span class="hljs-symbol"><span class="hljs-symbol">:users</span></span>, <span class="hljs-symbol"><span class="hljs-symbol">:controllers</span></span> =&gt; { <span class="hljs-symbol"><span class="hljs-symbol">:omniauth_callbacks</span></span> =&gt; <span class="hljs-string"><span class="hljs-string">"users/omniauth_callbacks"</span></span> } resources <span class="hljs-symbol"><span class="hljs-symbol">:users</span></span>, <span class="hljs-symbol"><span class="hljs-symbol">:only</span></span> =&gt; [<span class="hljs-symbol"><span class="hljs-symbol">:index</span></span>, <span class="hljs-symbol"><span class="hljs-symbol">:destroy</span></span>] root <span class="hljs-symbol"><span class="hljs-symbol">:to</span></span> =&gt; <span class="hljs-string"><span class="hljs-string">'users#index'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">end</span></span></code> </pre>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Add to the application.html.haml template links to the social network (user_omniauth_authorize_path (: facebook) and user_omniauth_authorize_path (: vkontakte)), the full template code: <br><pre> <code class="hljs mel">!!! <span class="hljs-number"><span class="hljs-number">5</span></span> %html(lang=<span class="hljs-string"><span class="hljs-string">"en"</span></span>) %head %meta(charset=<span class="hljs-string"><span class="hljs-string">"utf-8"</span></span>) %meta(name=<span class="hljs-string"><span class="hljs-string">"viewport"</span></span> content=<span class="hljs-string"><span class="hljs-string">"width=device-width, initial-scale=1.0"</span></span>) %title= content_for?(:title) ? yield(:title) : <span class="hljs-string"><span class="hljs-string">"Authproviders"</span></span> = csrf_meta_tags / Le HTML5 shim, <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> IE6<span class="hljs-number"><span class="hljs-number">-8</span></span> support of HTML elements /[<span class="hljs-keyword"><span class="hljs-keyword">if</span></span> lt IE <span class="hljs-number"><span class="hljs-number">9</span></span>] = javascript_include_tag <span class="hljs-string"><span class="hljs-string">"http://html5shim.googlecode.com/svn/trunk/html5.js"</span></span> = stylesheet_link_tag <span class="hljs-string"><span class="hljs-string">"application"</span></span>, :media =&gt; <span class="hljs-string"><span class="hljs-string">"all"</span></span> %link(href=<span class="hljs-string"><span class="hljs-string">"images/favicon.ico"</span></span> rel=<span class="hljs-string"><span class="hljs-string">"shortcut icon"</span></span>) %link(href=<span class="hljs-string"><span class="hljs-string">"images/apple-touch-icon.png"</span></span> rel=<span class="hljs-string"><span class="hljs-string">"apple-touch-icon"</span></span>) %link(href=<span class="hljs-string"><span class="hljs-string">"images/apple-touch-icon-72x72.png"</span></span> rel=<span class="hljs-string"><span class="hljs-string">"apple-touch-icon"</span></span> sizes=<span class="hljs-string"><span class="hljs-string">"72x72"</span></span>) %link(href=<span class="hljs-string"><span class="hljs-string">"images/apple-touch-icon-114x114.png"</span></span> rel=<span class="hljs-string"><span class="hljs-string">"apple-touch-icon"</span></span> sizes=<span class="hljs-string"><span class="hljs-string">"114x114"</span></span>) %body .navbar.navbar-fixed-top .navbar-inner .<span class="hljs-keyword"><span class="hljs-keyword">container</span></span> %a.btn.btn-navbar(data-target=<span class="hljs-string"><span class="hljs-string">".nav-collapse"</span></span> data-<span class="hljs-keyword"><span class="hljs-keyword">toggle</span></span>=<span class="hljs-string"><span class="hljs-string">"collapse"</span></span>) %span.icon-bar %span.icon-bar %span.icon-bar %a.brand(href=<span class="hljs-string"><span class="hljs-string">"#"</span></span>) Authproviders .<span class="hljs-keyword"><span class="hljs-keyword">container</span></span>.nav-collapse %ul.nav - <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> user_signed_in? %li= link_to <span class="hljs-string"><span class="hljs-string">"#{current_user.username} (#{current_user.provider})"</span></span>, current_user.url %li= link_to <span class="hljs-string"><span class="hljs-string">"Sign out"</span></span>, destroy_user_session_path, :method =&gt; :<span class="hljs-keyword"><span class="hljs-keyword">delete</span></span> .<span class="hljs-keyword"><span class="hljs-keyword">container</span></span> .content .row .span9 = yield .span3 .well.sidebar-nav %h3 Providers %ul.nav.nav-list - <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> !user_signed_in? %li= link_to <span class="hljs-string"><span class="hljs-string">"Sign in with Facebook"</span></span>, user_omniauth_authorize_path(:facebook) %li= link_to <span class="hljs-string"><span class="hljs-string">"Sign in with Vkontakte"</span></span>, user_omniauth_authorize_path(:vkontakte) %footer %p ¬© Company <span class="hljs-number"><span class="hljs-number">2012</span></span> = javascript_include_tag <span class="hljs-string"><span class="hljs-string">"application"</span></span></code> </pre><br>  Let's fix the users / index.html.haml template for displaying registered users. <br><pre> <code class="hljs mel">- model_class = User.new.class %h1=t <span class="hljs-string"><span class="hljs-string">'.title'</span></span>, :<span class="hljs-keyword"><span class="hljs-keyword">default</span></span> =&gt; model_class.model_name.human.pluralize %table.table.table-striped %thead %tr %th= model_class.human_attribute_name(:username) %th= model_class.human_attribute_name(:nickname) %th= model_class.human_attribute_name(:provider) %th= model_class.human_attribute_name(:sign_in_count) %th= model_class.human_attribute_name(:created_at) %th=t <span class="hljs-string"><span class="hljs-string">'.actions'</span></span>, :<span class="hljs-keyword"><span class="hljs-keyword">default</span></span> =&gt; t(<span class="hljs-string"><span class="hljs-string">"helpers.actions"</span></span>) %tbody - @users.each <span class="hljs-keyword"><span class="hljs-keyword">do</span></span> |user| %tr %td= link_to user.username, user.url %td= user.nickname %td= user.provider %td= user.sign_in_count %td= user.created_at %td = link_to t(<span class="hljs-string"><span class="hljs-string">'.destroy'</span></span>, :<span class="hljs-keyword"><span class="hljs-keyword">default</span></span> =&gt; t(<span class="hljs-string"><span class="hljs-string">"helpers.links.destroy"</span></span>)), user_path(user), :method =&gt; :<span class="hljs-keyword"><span class="hljs-keyword">delete</span></span>, :confirm =&gt; t(<span class="hljs-string"><span class="hljs-string">'.confirm'</span></span>, :<span class="hljs-keyword"><span class="hljs-keyword">default</span></span> =&gt; t(<span class="hljs-string"><span class="hljs-string">"helpers.links.confirm"</span></span>, :<span class="hljs-keyword"><span class="hljs-keyword">default</span></span> =&gt; <span class="hljs-string"><span class="hljs-string">'Are you sure?'</span></span>)), :class =&gt; <span class="hljs-string"><span class="hljs-string">'btn btn-mini btn-danger'</span></span></code> </pre><br>  Make sure everything works and get down to the most interesting: <br><pre> <code class="bash hljs">rails s</code> </pre><br><br><h2>  Facebook </h2><br>  Go to the page <a href="https://developers.facebook.com/apps">https://developers.facebook.com/apps</a> and create a new application. <br><img src="http://habrastorage.org/storage2/7de/a52/d01/7dea52d01ab12f3555dae5a3373fe22f.png"><br>  (for debugging on <a href="http://localhost/">localhost,</a> you can write <a href="http://localhost/">localhost</a> : 3000 in the site url) <br>  In the initialization file devise.rb we add the line: <br><pre> <code class="ruby hljs">config.omniauth <span class="hljs-symbol"><span class="hljs-symbol">:facebook</span></span>, <span class="hljs-string"><span class="hljs-string">'APP_ID'</span></span>, <span class="hljs-string"><span class="hljs-string">'APP_SECRET'</span></span></code> </pre><br>  'APP_ID', 'APP_SECRET' change to the values ‚Äã‚Äãgiven when creating a new application. <br><br>  In the User model, we will add the facebook method, which will search for the user at the address of his page, if there is none, then create a new one (not the best solution from a security point of view, but this is just an example): <br><pre> <code class="ruby hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">self</span></span></span><span class="hljs-function">.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">find_for_facebook_oauth</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">access_token</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">if</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">user</span></span></span><span class="hljs-function"> = </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">User</span></span></span><span class="hljs-function">.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">where</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-symbol"><span class="hljs-function"><span class="hljs-params"><span class="hljs-symbol">:url</span></span></span></span><span class="hljs-function"><span class="hljs-params"> =&gt; access_token.info.urls.Facebook)</span></span></span></span>.first user <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> User.create!(<span class="hljs-symbol"><span class="hljs-symbol">:provider</span></span> =&gt; access_token.provider, <span class="hljs-symbol"><span class="hljs-symbol">:url</span></span> =&gt; access_token.info.urls.Facebook, <span class="hljs-symbol"><span class="hljs-symbol">:username</span></span> =&gt; access_token.extra.raw_info.name, <span class="hljs-symbol"><span class="hljs-symbol">:nickname</span></span> =&gt; access_token.extra.raw_info.username, <span class="hljs-symbol"><span class="hljs-symbol">:email</span></span> =&gt; access_token.extra.raw_info.email, <span class="hljs-symbol"><span class="hljs-symbol">:password</span></span> =&gt; Devise.friendly_token[<span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">20</span></span>]) <span class="hljs-keyword"><span class="hljs-keyword">end</span></span> <span class="hljs-keyword"><span class="hljs-keyword">end</span></span></code> </pre><br><br>  Add the facebook method to the Users :: OmniauthCallbacksController controller: <br><pre> <code class="ruby hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">facebook</span></span></span><span class="hljs-function"> @</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">user</span></span></span><span class="hljs-function"> = </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">User</span></span></span><span class="hljs-function">.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">find_for_facebook_oauth</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">request</span></span></span><span class="hljs-function">.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">env</span></span></span><span class="hljs-function">["</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">omniauth</span></span></span><span class="hljs-function">.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">auth</span></span></span><span class="hljs-function">"] </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">if</span></span></span><span class="hljs-function"> @</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">user</span></span></span><span class="hljs-function">.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">persisted?</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">flash</span></span></span><span class="hljs-function">[:</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">notice</span></span></span><span class="hljs-function">] = </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">I18n</span></span></span><span class="hljs-function">.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">t</span></span></span><span class="hljs-function"> "</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">devise</span></span></span><span class="hljs-function">.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">omniauth_callbacks</span></span></span><span class="hljs-function">.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">success</span></span></span><span class="hljs-function">", :</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">kind</span></span></span><span class="hljs-function"> =</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">&gt;</span></span></span><span class="hljs-function"> "</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Facebook</span></span></span><span class="hljs-function">" </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">sign_in_and_redirect</span></span></span><span class="hljs-function"> @</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">user</span></span></span><span class="hljs-function">, :</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">event</span></span></span><span class="hljs-function"> =</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">&gt;</span></span></span><span class="hljs-function"> :</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">authentication</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">else</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">flash</span></span></span><span class="hljs-function">[:</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">notice</span></span></span><span class="hljs-function">] = "</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">authentication</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">error</span></span></span><span class="hljs-function">" </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">redirect_to</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">root_path</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">end</span></span></span></span></code> </pre><br><br><h2>  Vkontakte </h2><br>  For contact, the procedure is similar: <a href="http://vk.com/developers.php">http://vk.com/developers.php</a> <br>  create an application: <br><img src="http://habrastorage.org/storage2/a02/fae/684/a02fae6846bbc427e82abbdcba7a7d64.png"><br>  In the initialization file devise.rb, do not forget to append a line: <br><pre> <code class="ruby hljs">config.omniauth <span class="hljs-symbol"><span class="hljs-symbol">:vkontakte</span></span>, <span class="hljs-string"><span class="hljs-string">'APP_ID'</span></span>, <span class="hljs-string"><span class="hljs-string">'APP_SECRET'</span></span></code> </pre><br>  It was more difficult to test work with a contact on a local host; you can use such a thing: <a href="https://github.com/progrium/localtunnel">https://github.com/progrium/localtunnel</a> <br>  After installing through the bundle, when you first start, load the key: <br><pre> <code class="bash hljs">localtunnel -k ~/.ssh/id_rsa.pub 3000</code> </pre><br>  Then we start the tunnel, it will give us the address at which the application will be available (we will hammer it into contact), followed by the rails <br><pre> <code class="bash hljs">localtunnel 3000 This localtunnel service is brought to you by Twilio. Port 3000 is now publicly accessible from http://4v9p.localtunnel.com ... rails s</code> </pre><br>  We add using the vkontakte method to the model and controller, similar to facebook (I note that according to the information security policy of the contact, email addresses are not given, so in order to not conflict with validation, I create surrogate addresses like this when creating a user: domain + @ vk.com) : <br><pre> <code class="ruby hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">User</span></span></span><span class="hljs-class"> &lt; ActiveRecord::Base </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">devise</span></span></span><span class="hljs-class"> :</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">database_authenticatable</span></span></span><span class="hljs-class">, :</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">registerable</span></span></span><span class="hljs-class">, :</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">recoverable</span></span></span><span class="hljs-class">, :</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">rememberable</span></span></span><span class="hljs-class">, :</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">trackable</span></span></span><span class="hljs-class">, :</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">validatable</span></span></span><span class="hljs-class">, :</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">omniauthable</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">attr_accessible</span></span></span><span class="hljs-class"> :</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">email</span></span></span><span class="hljs-class">, :</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">password</span></span></span><span class="hljs-class">, :</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">password_confirmation</span></span></span><span class="hljs-class">, :</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">remember_me</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">attr_accessible</span></span></span><span class="hljs-class"> :</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">nickname</span></span></span><span class="hljs-class">, :</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">provider</span></span></span><span class="hljs-class">, :</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">url</span></span></span><span class="hljs-class">, :</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">username</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">def</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">self</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">find_for_facebook_oauth</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">access_token</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">if</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">user</span></span></span><span class="hljs-class"> = </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">User</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">where</span></span></span><span class="hljs-class">(:</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">url</span></span></span><span class="hljs-class"> =&gt; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">access_token</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">info</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">urls</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Facebook</span></span></span><span class="hljs-class">).</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">first</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">user</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">else</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">User</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">create!</span></span></span><span class="hljs-class">(:</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">provider</span></span></span><span class="hljs-class"> =&gt; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">access_token</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">provider</span></span></span><span class="hljs-class">, :</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">url</span></span></span><span class="hljs-class"> =&gt; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">access_token</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">info</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">urls</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Facebook</span></span></span><span class="hljs-class">, :</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">username</span></span></span><span class="hljs-class"> =&gt; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">access_token</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">extra</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">raw_info</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">name</span></span></span><span class="hljs-class">, :</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">nickname</span></span></span><span class="hljs-class"> =&gt; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">access_token</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">extra</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">raw_info</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">username</span></span></span><span class="hljs-class">, :</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">email</span></span></span><span class="hljs-class"> =&gt; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">access_token</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">extra</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">raw_info</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">email</span></span></span><span class="hljs-class">, :</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">password</span></span></span><span class="hljs-class"> =&gt; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Devise</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">friendly_token</span></span></span><span class="hljs-class">[0,20]) </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">end</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">end</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">def</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">self</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">find_for_vkontakte_oauth</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">access_token</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">if</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">user</span></span></span><span class="hljs-class"> = </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">User</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">where</span></span></span><span class="hljs-class">(:</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">url</span></span></span><span class="hljs-class"> =&gt; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">access_token</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">info</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">urls</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Vkontakte</span></span></span><span class="hljs-class">).</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">first</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">user</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">else</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">User</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">create!</span></span></span><span class="hljs-class">(:</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">provider</span></span></span><span class="hljs-class"> =&gt; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">access_token</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">provider</span></span></span><span class="hljs-class">, :</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">url</span></span></span><span class="hljs-class"> =&gt; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">access_token</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">info</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">urls</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Vkontakte</span></span></span><span class="hljs-class">, :</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">username</span></span></span><span class="hljs-class"> =&gt; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">access_token</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">info</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">name</span></span></span><span class="hljs-class">, :</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">nickname</span></span></span><span class="hljs-class"> =&gt; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">access_token</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">extra</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">raw_info</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">domain</span></span></span><span class="hljs-class">, :</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">email</span></span></span><span class="hljs-class"> =&gt; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">access_token</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">extra</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">raw_info</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">domain</span></span></span><span class="hljs-class">+'@</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">vk</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">com</span></span></span><span class="hljs-class">', :</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">password</span></span></span><span class="hljs-class"> =&gt; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Devise</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">friendly_token</span></span></span><span class="hljs-class">[0,20]) </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">end</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">end</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">end</span></span></span></span></code> </pre><br>  Controller Code: <br><pre> <code class="ruby hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Users::OmniauthCallbacksController</span></span></span><span class="hljs-class"> &lt; ApplicationController </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">def</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">facebook</span></span></span><span class="hljs-class"> @</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">user</span></span></span><span class="hljs-class"> = </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">User</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">find_for_facebook_oauth</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">request</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">env</span></span></span><span class="hljs-class">["</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">omniauth</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">auth</span></span></span><span class="hljs-class">"] </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">if</span></span></span><span class="hljs-class"> @</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">user</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">persisted?</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">flash</span></span></span><span class="hljs-class">[:</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">notice</span></span></span><span class="hljs-class">] = </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">I18n</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">t</span></span></span><span class="hljs-class"> "</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">devise</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">omniauth_callbacks</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">success</span></span></span><span class="hljs-class">", :</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">kind</span></span></span><span class="hljs-class"> =&gt; "</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Facebook</span></span></span><span class="hljs-class">" </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">sign_in_and_redirect</span></span></span><span class="hljs-class"> @</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">user</span></span></span><span class="hljs-class">, :</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">event</span></span></span><span class="hljs-class"> =&gt; :</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">authentication</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">else</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">flash</span></span></span><span class="hljs-class">[:</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">notice</span></span></span><span class="hljs-class">] = "</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">authentication</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">error</span></span></span><span class="hljs-class">" </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">redirect_to</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">root_path</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">end</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">end</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">def</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">vkontakte</span></span></span><span class="hljs-class"> @</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">user</span></span></span><span class="hljs-class"> = </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">User</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">find_for_vkontakte_oauth</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">request</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">env</span></span></span><span class="hljs-class">["</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">omniauth</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">auth</span></span></span><span class="hljs-class">"] </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">if</span></span></span><span class="hljs-class"> @</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">user</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">persisted?</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">flash</span></span></span><span class="hljs-class">[:</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">notice</span></span></span><span class="hljs-class">] = </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">I18n</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">t</span></span></span><span class="hljs-class"> "</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">devise</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">omniauth_callbacks</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">success</span></span></span><span class="hljs-class">", :</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">kind</span></span></span><span class="hljs-class"> =&gt; "</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Vkontakte</span></span></span><span class="hljs-class">" </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">sign_in_and_redirect</span></span></span><span class="hljs-class"> @</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">user</span></span></span><span class="hljs-class">, :</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">event</span></span></span><span class="hljs-class"> =&gt; :</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">authentication</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">else</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">flash</span></span></span><span class="hljs-class">[:</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">notice</span></span></span><span class="hljs-class">] = "</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">authentication</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">error</span></span></span><span class="hljs-class">" </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">redirect_to</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">root_path</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">end</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">end</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">end</span></span></span></span></code> </pre><br>  Of course, using DRY, you can and should summarize this code. <br>  Application itself: <br><img src="http://habrastorage.org/storage2/1b2/cc0/94b/1b2cc094bc3ee97ed155ebc15d2c746f.png"><br><hr><br><br><h2>  Conclusion </h2><br>  As we have seen, creating an application on rails with facebook and contact authentication is very simple. <br>  A working demo is here: <a href="http://authproviders.herokuapp.com/">http://authproviders.herokuapp.com/</a> <br>  Example code: <a href="https://github.com/mystdeim/Authproviders">https://github.com/mystdeim/Authproviders</a> <br>  I will give some useful links: <br><ul><li>  <a href="http://railsapps.github.com/rails-examples-tutorials.html">http://railsapps.github.com/rails-examples-tutorials.html</a> - demo applications using mainly devise and omniauth </li><li>  <a href="http://www.communityguides.eu/articles/11">http://www.communityguides.eu/articles/11 is a</a> good solution for combining several accounts of the same person using different providers (it is required that the mail be the same, unfortunately, the trick will not work with the contact) </li></ul><br>  PS This is my first article, first attempt at writing. <br><br>  <b>UP:</b> Kei's secret and application IDs are best kept apart so they don't accidentally get into the repository <a href="http://habrahabr.ru/post/142128/">http://habrahabr.ru/post/142128/#comment_4757653</a> </div><p>Source: <a href="https://habr.com/ru/post/142128/">https://habr.com/ru/post/142128/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../142120/index.html">62 useful tools for responsive design (Responsive web design)</a></li>
<li><a href="../142122/index.html">Simplified User Agreement (ToS)</a></li>
<li><a href="../142124/index.html">Release SBShop 1.0 - online store for MODX Evolution</a></li>
<li><a href="../142126/index.html">Nostalgia: digging near the ‚ÄúTanchiki‚Äù under the hood</a></li>
<li><a href="../142127/index.html">Creating Attached Property for BusyIndicator step by step</a></li>
<li><a href="../142130/index.html">Epic Fail with VMWare Newsletters</a></li>
<li><a href="../142131/index.html">VolgaCTF as a member</a></li>
<li><a href="../142134/index.html">15 largest transactions on the Internet</a></li>
<li><a href="../142135/index.html">Epic Fail with Evernote Newsletters</a></li>
<li><a href="../142137/index.html">Create a parallax scrolling effect using jQuery and CSS</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>