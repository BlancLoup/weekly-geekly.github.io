<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>How I became vulnerable: we scan IT infrastructure with Qualys</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hello! 

 Today I want to tell you about the cloud solution for searching and analyzing vulnerabilities in Qualys Vulnerability Management, on which o...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>How I became vulnerable: we scan IT infrastructure with Qualys</h1><div class="post__text post__text-html js-mediator-article">  Hello! <br><br>  Today I want to tell you about the cloud solution for searching and analyzing vulnerabilities in Qualys Vulnerability Management, on which one of our <a href="https://www.dtln.ru/uslugi/security/securityscan%3Futm_source%3Dhabr%26utm_medium%3Dmedia%26utm_campaign%3Dqualys_1">services is built</a> . <br><br>  Below I will show how the scan itself is organized and what information on vulnerabilities can be found on the basis of the results. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <img src="https://habrastorage.org/webt/fb/pz/lw/fbpzlwm7ttwr9-pmzkzgcaceh4y.png"><br><a name="habracut"></a><br><h3>  What can be scanned </h3><br>  <b>External services.</b>  To scan services that have access to the Internet, the client provides us with their IP addresses and credentials (if you need a scan with authentication).  We scan services using the Qualys cloud and send a report on the results. <br><br><img src="https://habrastorage.org/webt/4q/_p/dt/4q_pdtozlq_tx0uus4tqrrznwuk.png"><br><br>  <b>Internal services.</b>  In this case, the scanner looks for vulnerabilities on the internal servers and network infrastructure.  With this scan, you can make an inventory of versions of operating systems, applications, open ports and services behind them. <br><br>  For scanning within the client's infrastructure, a Qualys scanner is installed.  The Qualys cloud here serves as the command center for this scanner. <br><br>  In addition to the internal server from Qualys, agents can be installed on the scanned objects (Cloud Agent).  They collect information about the system locally, practically do not create a load on the network and on the hosts on which they work.  The resulting information is sent to the cloud. <br><br><img src="https://habrastorage.org/webt/4l/z6/tv/4lz6tvuyvx2vfg1r8tvmxdarqhy.png"><br><br>  There are three important points: authentication and selection of objects for scanning. <br><br><ol><li>  <b>Use authentication</b> .  Some customers ask to scan the blackbox, especially for external services: they give us a range of IP addresses without specifying the system and say ‚Äúbe like a hacker‚Äù.  But hackers rarely act blindly.  When it comes to attack (not intelligence), then they know they are breaking into. <br><br>  Blindly, Qualys may stumble upon bogus banners and scan them instead of the target system.  And without understanding what exactly will be scanned, it is easy to miss with the scanner settings and ‚Äúattach‚Äù the service being checked. <br><br>  Scanning will bring more benefits if you carry out authentication checks before scanning systems (whitebox).  So the scanner will understand where it has come, and you will receive complete data on the vulnerabilities of the target system. <br><br><img src="https://habrastorage.org/webt/by/ec/4e/byec4exfbmr0n-iq_jdtztj3kie.png"><br>  <i>Qualys has many authentication options.</i> </li><li>  <b>Group assets</b> .  If you run a scan around at once and without analysis, it will be long and will create an extra load on the system.  Hosts, services are best grouped by importance, location, OS version, infrastructure criticality and other features (in Qualys they are called Asset Groups and Asset Tags) and select a specific group when scanning. </li><li>  <b>Select technical window for scanning.</b>  Even if you have all been prepared and prepared, the scan creates an additional load on the system.  It does not necessarily cause the degradation of the service, but it is better for him to choose a specific time, as for backup or roll forward of updates. </li></ol><br><h3>  What can you learn from the reports? </h3><br>  Following the results of the scan, the client receives a report that includes not only a list of all the vulnerabilities found, but also basic recommendations for eliminating them: updates, patches, etc. Qualys has many reports: there are default templates and you can create your own.  In order not to get confused in all its diversity, it is better to first decide for yourself on the following points: <br><br><ul><li>  Who will watch this report: manager or technician? </li><li>  What information do you want to get from the scan results?  For example, if you want to find out if all the necessary patches are installed and how the removal of previously found vulnerabilities is being done, then this is one report.  If you just need to inventory all the hosts, then the other. </li></ul><br>  If you have a task to show a brief, but clear, picture to the management, then you can form the <b>Executive Report</b> .  All vulnerabilities will be decomposed into shelves, severity levels, graphs and diagrams.  For example, the top 10 most critical vulnerabilities or the most common vulnerabilities. <br><br><img src="https://habrastorage.org/webt/we/bd/tj/webdtjbamkb_p6bded-vgwh5o7g.png"><br><br><img src="https://habrastorage.org/webt/vj/ea/ga/vjeagab5rz9uuuj5xpfajk74ngq.png"><br><br>  For a technical specialist there is a <b>Technical Report</b> with all the details and details.  You can generate the following reports: <br><br>  <b>Host report</b> .  The useful thing is when you need to take an inventory of the infrastructure and get a complete picture of the vulnerabilities of the hosts. <br><br>  Here is the list of analyzed hosts with the indication of the operating systems. <br><br><img src="https://habrastorage.org/webt/la/rh/jl/larhjlubiccpu54rvxhwelxj9qq.png"><br><br>  Open the host of interest and see a list of 219 vulnerabilities found, starting from the most critical, fifth level: <br><br><img src="https://habrastorage.org/webt/ep/yn/hg/epynhgfslmfopvvzrjclilazh9a.png"><br><br>  Then you can see the details of each vulnerability.  Here we see: <br><br><ul><li>  when the vulnerability was fixed for the first and last time </li><li>  industrial vulnerability numbers, </li><li>  patch to fix the vulnerability </li><li>  Are there any problems with compliance with the standard PCI DSS, NIST, etc., </li><li>  Is there an exploit and malware for this vulnerability? </li><li>  Is the vulnerability detected when scanning with or without authentication in the system, etc. </li></ul><br><img src="https://habrastorage.org/webt/8o/zf/87/8ozf87pilgfrq1spfpqoukgt6ni.png"><br><br>  If this is not the first scan - yes, you need to be scanned regularly :) - then with the help of <b>Trend Report</b> you can track the dynamics of working with vulnerabilities.  The status of vulnerabilities will be shown in comparison with the previous scan: vulnerabilities that were previously found and closed will be marked as fixed, unclosed - active, new - new. <br><br>  <b>Vulnerability report.</b>  In this report, Qualys will build a list of vulnerabilities, starting with the most critical ones, with an indication on which host to catch this vulnerability.  The report is useful if you decide to understand the moment, for example, with all the fifth level vulnerabilities. <br><br>  You can also make a separate report only on vulnerabilities of the fourth and fifth levels. <br><br><img src="https://habrastorage.org/webt/w8/rt/su/w8rtsuokbifzspyvpwsgmvsubd8.png"><br><br>  <b>Patch report</b>  Here is a complete list of patches that need to be put to eliminate the found vulnerabilities.  For each patch, there is an explanation of what vulnerabilities it treats, on which host / system you need to install, and a direct link to download. <br><br><img src="https://habrastorage.org/webt/zm/qy/47/zmqy47a5ade69vba4jltxtebkxq.png"><br><br><img src="https://habrastorage.org/webt/vj/y3/ec/vjy3ecsv9askw9v4wvfrbreyq_u.png"><br><br>  <b>Report for compliance with PCI DSS standards</b> .  The PCI DSS standard requires scanning information systems and applications available from the Internet every 90 days.  After the scan, you can generate a report that shows that the infrastructure does not meet the requirements of the standard. <br><br><img src="https://habrastorage.org/webt/mw/be/pd/mwbepdvsfc1jg0x79jmxjwghs-w.png"><br><br><img src="https://habrastorage.org/webt/ve/ng/uh/venguhfu9pqayswtyphpqdhsimi.png"><br><br>  <b>Vulnerability reports</b> .  Qualys can be integrated with the service desk, and then all found vulnerabilities will automatically be translated into tickets.  With the help of this report, it will be possible to track the progress on tickets executed and vulnerabilities fixed. <br><br>  <b>Reports on open ports</b> .  Here you can get information on open ports and services running on them: <br><br><img src="https://habrastorage.org/webt/lm/j4/y2/lmj4y22smuoqidzsekqwal0flqg.png"><br><br>  or generate a report on vulnerabilities on each port: <br><br><img src="https://habrastorage.org/webt/_4/ck/uf/_4ckufbam19cx3masrvy1i0fwqk.png"><br><br>  These are just standard report templates.  You can create your own under specific tasks, for example, show only vulnerabilities not lower than the fifth level of criticality.  All reports are available.  Report format: CSV, XML, HTML, PDF and docx. <br><br><img src="https://habrastorage.org/webt/nu/qn/65/nuqn65czctjcrjfxjzsgj1nk__y.png"><br><br>  <b>And remember:</b> safety is not a result, but a process.  A one-time scan helps to see problems in the moment, but this is not about a full-fledged process of managing vulnerabilities. <br>  To make it easier for you to decide on this regular work, we have made a service based on Qualys Vulnerability Management. <br><br>  <b>For all Habr readers, there is a special offer:</b> when ordering a scanning service for a year, two months of scans are free.  Applications can be left <a href="https://www.dtln.ru/uslugi/security/securityscan%3Futm_source%3Dhabr%26utm_medium%3Dmedia%26utm_campaign%3Dqualys_2">here</a> in the field "Comment" write Habr. </div><p>Source: <a href="https://habr.com/ru/post/457768/">https://habr.com/ru/post/457768/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../457756/index.html">The book "Kafka Streams in action. Real-time applications and microservices</a></li>
<li><a href="../45776/index.html">What do independent experts think about the USE?</a></li>
<li><a href="../457760/index.html">How to make containers even more isolated: an overview of container sandbox technologies</a></li>
<li><a href="../457764/index.html">10 mistakes of the young PO (part II)</a></li>
<li><a href="../457766/index.html">Generate tile levels and hide squares from the player.</a></li>
<li><a href="../457770/index.html">Writing custom transformer AST on TypeScript</a></li>
<li><a href="../457774/index.html">Studying a private pilot in Middle-earth: moving and living in a New Zealand village</a></li>
<li><a href="../45778/index.html">The new version of Ruby is faster up to 5 times</a></li>
<li><a href="../457784/index.html">Custom'a Eye-tracker calibration</a></li>
<li><a href="../457786/index.html">Updated Anet A8 Plus. Large and made of metal</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>