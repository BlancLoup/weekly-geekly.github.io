<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>What does not hide LastPass?</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="I think everyone knows what Lastpass is . Many have entrusted him with the storage of all their usernames and passwords. And how not to trust, after a...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>What does not hide LastPass?</h1><div class="post__text post__text-html js-mediator-article"> I think everyone knows what <a href="https://lastpass.com/">Lastpass is</a> .  Many have entrusted him with the storage of all their usernames and passwords.  And how not to trust, after all, the developers declare that all information is protected and encrypted on the client side.  Mindful of recent <a href="http://habrahabr.ru/blogs/infosecurity/118788/">history,</a> I decided to disassemble the LastPass plugin into pieces and understand what is really protected and what is not and continue my cycle of articles about small problems in large projects. <br><a name="habracut"></a><br>  At first I really liked everything.  LastPass creates a hash of your login and password, it is the key to the AES algorithm: <br><br>  KEY = SHA256 (EMAIL + PASSWORD) <br><br>  For authorization, the service uses a double hash, that is, it is sent to the server and is the verification key for authorization: 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      AUTH_HASH = SHA256 (KEY + PASSWORD) <br><br>  Indeed, the names of groups, accounts and data are transmitted in encrypted form, HTTPS is used everywhere.  But as it turned out, there are things that are sent to the server without encryption with the user's key.  For example, this is the full current URL of the site where you enter the password in LastPass for the first time. <br><br>  Here is the request that the plugin sends to the server (some field values ‚Äã‚Äãhave been changed): <br><br> <code>POST /deliver_and_add.php HTTP/1.1 <br> Host: lastpass.com <br> User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:5.0) Gecko/20100101 Firefox/5.0 <br> Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8 <br> Accept-Language: ru-ru,ru;q=0.8,en-us;q=0.5,en;q=0.3 <br> Accept-Encoding: gzip, deflate <br> Accept-Charset: windows-1251,utf-8;q=0.7,*;q=0.7 <br> Connection: keep-alive <br> Content-Type: application/x-www-form-urlencoded; charset=UTF-8 <br> Content-Length: 5045 <br> Cookie: lang=en_US; sessonly=0; PHPSESSID=#; <br> X-LastPass: 1.74.0 <br> X-wxsessid: # <br> Pragma: no-cache <br> Cache-Control: no-cache <br> <br> sentms=#&amp;data=#&amp;ref=68747470733a2f2f7777772e676f6f676c652e636f6d2f6163636f756e74732f536572766963654c6f67696e3f736572766963653d6d61696c26706173736976653d7472756526726d3d66616c736526636f6e74696e75653d68747470732533412532462532466d61696c2e676f6f676c652e636f6d2532466d61696c253246253346756925334468746d6c2532367a792533446c266273763d23367a2673733d31267363633d31266c746d706c3d64656661756c74266c746d706c63616368653d3226686c3d656e2666726f6d3d6c6f676f7574&amp;charset=UTF-8&amp;iid=&amp;data=#&amp;name=#&amp;localupdate=1&amp;extjs=1&amp;iid=&amp;requid=#&amp;wxsessid=#&amp;sessonly=0&amp;requesthash=#&amp;requestsrc=ff&amp;hasplugin=1.74.0 <br></code> <br>  As we can see, the ref field contains the line: <br><br> <code><b>https</b> ://www.google.com/accounts/ServiceLogin?service=mail&amp;passive=true&amp;rm=false&amp;continue=https%3A%2F%2Fmail.google.com%2Fmail%2F%3Fui%3Dhtml%26zy%3Dl&amp;bsv=#6z&amp;ss=1&amp;scc=1&lt;mpl=default&lt;mplcache=2&amp;hl=en&amp;from=logout <br></code> <br>  Thus, quite by chance, the information on which sites you are registered is transmitted to the LastPass server in open form.  And, sometimes, in these lines there are logins, passwords and other sensitive information (on some, not very correct resources). <br><br>  Also, the plugin does not encrypt the entire block with the form data when sending, but encrypts only the fields, leaving the field names open, and, when encrypting, it does not add salt to the field values.  Thus, by simple calculations on the server, it will be possible to understand on which sites you have the same logins and passwords.  By the way, the action form is also transmitted to the LastPass server in open form: <br><br> <code>sentms=#&amp;data=#REMOVED#&amp;ref=687474703a2f2f6861627261686162722e72752f6c6f67696e2f&amp;charset=UTF-8 <br></code> <br>  This is how the information in the data field looks like, for the login on habrahabr.ru and it is in this form that everything is transmitted to the LastPass server: <br><br> <code>0 undefined fieldset <br> 0 act SuQP2miDnWPHD202CxqCLQ%3D%3D hidden <br> 0 redirect_url 5RXHPEEbEv6DlWMaKxOdQZAnmxFM8k9gLCeYz10sh5I%3D hidden <br> 0 login DEJ#REMOVED#D%3D text <br> 0 password vT5yo#REMOVED#tkg%3D%3D password <br> 0 captcha text <br> 0 %D0%92%D0%BE%D0%B9%D1%82%D0%B8 submit <br> 0 action http%3A%2F%2Fhabrahabr.ru%2Fajax%2Fauth%2F action <br> 0 method post method <br></code> <br>  So, what will the attacker know if he has access to encrypted data, but does not know your password? <ol><li>  Your email address in LastPass </li><li>  List of all sites where you have registration </li><li>  A list of all sites where you have the same logins and / or passwords. </li><li>  Full links to forms on all sites </li><li>  Full links from the action attribute of forms on all sites </li></ol>  Therefore, be careful when adding the next password to Lastpass.  Be sure to look at the address line to see if you really want to send this information to someone else‚Äôs server in clear text. <br><br>  PS I kept thinking why the service had this information, because it cost nothing to encrypt the URL and all the fields, but I read the Privacy Statement on the site the other day, and it all became clear to me at once: <br><br>  <i>There are no statistics on this site.</i>  <i>For instance, LastPass site.</i>  <i>LastPass may display this information publicly or provide it to others.</i>  <i>In addition, you can provide your personal information.</i>  <i>Our services free.</i>  <i>However, LastPass does not disclose information other than as described below.</i> <i><br></i> <br>  As I understand it, information on which sites you are registered on can be used to compile your advertising profile.  And this LastPass also does not hide. </div><p>Source: <a href="https://habr.com/ru/post/123567/">https://habr.com/ru/post/123567/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../123561/index.html">The method of calculating the coefficient reflecting the quality of the released software product</a></li>
<li><a href="../123562/index.html">Beginners shareware and all those who decided to conduct their business on the Internet</a></li>
<li><a href="../123564/index.html">ICQ Mobile for iOS version 2.6 and Push Notifications</a></li>
<li><a href="../123565/index.html">Console cucumber and capybara with Selenium and Hudson</a></li>
<li><a href="../123566/index.html">Skype to SIP Gateway do it yourself</a></li>
<li><a href="../123568/index.html">Behind the wheel of a vacuum cleaner or smart Firefox</a></li>
<li><a href="../123569/index.html">Asynchronous Replication with Oracle Streams</a></li>
<li><a href="../123571/index.html">Amazon Kindle warranty replacement instructions</a></li>
<li><a href="../123573/index.html">MS SQL 2011 - Modification of the returned data set</a></li>
<li><a href="../123574/index.html">Facebook Video Calls - Based on Skype Technology</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>