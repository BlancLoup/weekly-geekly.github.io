<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Reading old articles Habra with pictures</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Some time ago I decided to refresh my knowledge and read something about graphs. ‚ÄúWell, of course, there should be good articles on Habr√©!‚Äù I thought,...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Reading old articles Habra with pictures</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/files/4f9/1d9/79e/4f91d979e8354ba496dd7ab0f925e557.png" align="right">  Some time ago I decided to refresh my knowledge and read something about graphs.  ‚ÄúWell, of course, there should be good articles on Habr√©!‚Äù I thought, and I was right.  There are lots of articles.  But they mostly look like this: <a href="http://habrahabr.ru/post/61884/">one</a> , <a href="http://habrahabr.ru/post/65617/">two</a> , <a href="http://habrahabr.ru/post/63982/">three</a> .  Open and guess from one attempt why it is absolutely impossible to understand something from these articles, although it is written in quite understandable language.  No pictures!  Well, how to study graphs without pictures?  No <br><br>  A newbie on Habr√© puzzled to ask: ‚ÄúHow so - no pictures?  There is habrastorage.org!  Yes there is.  But it was not always, but the images automatically became perezalivatsya and did become <a href="http://habrahabr.ru/post/188436/">only in July 2013</a> .  And before that, the pictures were hosted anywhere ‚Äî on all sorts of radicals, imagejakah, even on dropbox, people used to naively try to upload something.  As a result, we have on Habr√© a bunch of articles from 2006-2013 with missing pictures. <br><br>  Let's fix this! <br><a name="habracut"></a>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h4>  Plan </h4><br>  At the first stage we face the following tasks: <br><ul><li>  Download all articles from the emergence of Habr and to the above post 188436, roughly indicating the beginning of the forced reloading of images on habrastorage.org </li><li>  Find in the text of articles links to all the pictures posted not on Habr√©, Hiktayms, Megamind or Habrastoraj </li><li>  Check the availability of these pictures (GET is not necessary, just a HEAD request with verification of the return code and content type) </li><li>  Export list of unavailable images to file </li></ul><br><br><h4>  Implementation </h4><br>  In general, only the lazy Habr has not yet paris, well, we are not lazy.  Moreover, what is there to write in Python + requests: <br><br><ul><li>  <a href="https://github.com/ezhikus/HabraImagesFixer/blob/master/parse_habr.py">Parsing Habra</a> </li><li>  <a href="https://github.com/ezhikus/HabraImagesFixer/blob/master/check_images.py">Checking the validity of pictures</a> </li></ul><br><br>  Fill the code on the virtual machine in the cloud, run it, come back after 2 days (you could, of course, parse in several streams - but I remember somewhere in the FAQ Habr asked not to pull it with bots more than 2 times per second). <br><br><h4>  results </h4><br>  In total, the articles "Before the Advent of Habrastoraj" found <a href="https://github.com/ezhikus/HabraImagesFixer/blob/master/img_info/all_images.txt">157601 pictures</a> placed on the "left" image hosting.  Of these, <a href="https://github.com/ezhikus/HabraImagesFixer/blob/master/img_info/good_images.txt">92549 links are</a> still valid, and <a href="https://github.com/ezhikus/HabraImagesFixer/blob/master/img_info/bad_images.txt">65052 links</a> are no longer. <br><br><img src="https://habrastorage.org/files/d0d/69d/197/d0d69d19772e4a50993cd06c52de6687.png"><br><br>  Well, ok, we have links to 65052 inaccessible pictures in articles on Habr√©.  What to do with it?  Get them from the <a href="http://archive.org/">archive.org</a> cache, of course!  He in order and invented! <br><br>  You can check the availability of pictures in the web archive with a simple query: <br><pre><code class="bash hljs">http://archive.org/wayback/available?url=%image_url%</code> </pre> <br><br>  For example, the link to the image <a href="">img513.imageshack.us/img513/3580/pic1e.jpg,</a> which is absent in the <a href="http://habrahabr.ru/post/63982/">habrahabr.ru/post/63982</a> article, is fully accessible at <a href="http://web.archive.org/web/20131103061340/">http://web.archive.org/web/20131103061340/http:// img513.imageshack.us/img513/3580/pic1e.jpg</a> <br><br>  There is, however, one problem.  Sometimes the Internet archive claims that it has a link to the cached image, but in fact it does not.  Lying in general.  Those.  we will have to check every link to the cached image.  Well, nothing, <a href="https://github.com/ezhikus/HabraImagesFixer/blob/master/check_webarchive.py">check it out</a> . <br><br>  Fill, run, wait half a day. <br><br><h4>  results </h4><br>  The web archive turned out to be available <a href="https://github.com/ezhikus/HabraImagesFixer/blob/master/img_info/fixable_images.txt">13863 pictures</a> of those that are no longer available on the original links in articles on Habr√©. <br><br><img src="https://habrastorage.org/files/2a8/759/1c7/2a87591c71b54d6b8371bec219994133.png"><br><br>  This whole experiment gave us a good ‚Äúaverage temperature in the hospital‚Äù: we now know that the picture filled in for random hosting has a chance to survive about 58% over the next 2-9 years.  We also know that <a href="https://archive.org/">archive.org is</a> useful and sometimes helps, but the chances of recovering a broken link to a picture on Habr√© with it are 21.3%. <br><br><h4>  Conclusions to the first part of the article </h4><br>  So, now we have an <a href="https://github.com/ezhikus/HabraImagesFixer/blob/master/img_info/good_images.txt">array with more valid links</a> to the pictures and the <a href="https://github.com/ezhikus/HabraImagesFixer/blob/master/img_info/fixable_images.txt">second array</a> , with broken links and corresponding links to the available pictures in the web archive.  In this place, you could ask the administration of Habr to take this data and write 4 lines of code to reload it all on habrastorage.org and update the links in the existing articles, but I do not know if they will be doing this.  And I want to read articles in a normal way!  And so we will go our own way.  You can, of course, say ‚ÄúRead articles directly from the web archive!‚Äù, But this is somehow not particularly instructive and what would all this data collection be like. <br><br>  The second impulse may be the desire to write an extension for Chrome, substituting bad references for good ones, but I don‚Äôt want to do this for a number of reasons: <br><ul><li>  This is not very interesting, on Habr√© there were already hundreds of articles about writing extensions to Chrome </li><li>  Extensions now seem to be necessarily placed in the market </li><li>  For Firefox, you have to write a separate extension, but with IE it‚Äôs not at all clear what to do (write BHO? Br-rr-r!).  Well, plus all sorts of Operas, Vivaldi, Safari, Yandex. Browsers and the rest of the zoo. </li><li>  It is completely incomprehensible how this will help in reading from a mobile phone or tablet. </li></ul><br><br>  Therefore, we will go the other way and write something that solves all the above problems.  What exactly?  And you will learn about this in the <a href="http://habrahabr.ru/company/infopulse/blog/251363/">next article</a> . <br><br>  <b>PS A</b> logical division into two articles is added for readability, since the method used in the second article has nothing to do with the pictures on Habr√©, and vice versa. <br><br>  <b>UPD.</b>  As correctly suggested in the comments - you need to check and redirects.  The script is fixed (thanks to the <b>encyclopedist</b> ) and re-run.  As a result, another 10683 valid links to pictures were received.  Files with new data are uploaded to GitHub (see links in the article). </div><p>Source: <a href="https://habr.com/ru/post/251259/">https://habr.com/ru/post/251259/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../251245/index.html">Show version and haiku, but not only: we are looking for all the hidden Junos commands</a></li>
<li><a href="../251247/index.html">The digest of interesting materials for the mobile developer # 91 (February 16-23)</a></li>
<li><a href="../251251/index.html">Today a free webinar will take place - Training of managers, managers and auditors for certification in the field of information security</a></li>
<li><a href="../251255/index.html">The digest of interesting materials from the world of Drupal # 5</a></li>
<li><a href="../251257/index.html">Disadvantages of Wordpress - the technical side</a></li>
<li><a href="../251261/index.html">Weekly assembly Vivaldi 1.0.111.2</a></li>
<li><a href="../251263/index.html">About some aspects of repairing a hard drive electronics board</a></li>
<li><a href="../251267/index.html">Lock-free data structures. Concurrent maps: trees</a></li>
<li><a href="../251269/index.html">(Video) HP Helion Presentation</a></li>
<li><a href="../251271/index.html">Reduced overhead for utilities on golang</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>