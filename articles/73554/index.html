<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>International lambs</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Despite the fact that world culture in the face of Wikipedia and Paul McCartney assures us that Mary had a little lamb , on the territory of one-eight...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>International lambs</h1><div class="post__text post__text-html js-mediator-article">  Despite the fact that world culture in the face of Wikipedia and Paul McCartney assures us that <a href="http://en.wikipedia.org/wiki/Mary_Had_a_Little_Lamb">Mary had a little lamb</a> , on the territory of one-eighth of the land, they still believe that in fact ‚ÄúMary had a lamb‚Äù.  Who really was with Mary, and how to write it in different languages ‚Äã‚Äãof the world?  Let's try to figure it out (and also understand what the Japanese think about it) along with our favorite Python and the gettext multilingual translation support module built into it. <br><br><a name="habracut"></a><h4>  Let's get started </h4><br>  To begin with, recall that the gettext library is used to translate not only Python programs, but in many different languages.  It allows you to use phrase patterns in our program that can be translated using separate and independent translation files.  In the program itself, we, as before, output the text immediately to the screen, to disk, to logs, or somewhere else, just by marking the translated strings in a special way;  the gettext library, on the other hand, allows you to take these translatable strings, sets of translation files, and, if there is a suitable translation file for the current language, substitute the desired string. <br><br>  In Python, access to the gettext library mechanisms is achieved using the gettext module that comes with the Python module.  So let's not confuse the gettext system as such (external to Python, and an entity that is completely unnecessary for its work; nevertheless, the package includes convenient utilities for working with gettext files) and the built-in Python module gettext. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      First, we write a basic program (let's call it mary.py), which we will try to translate into various languages: <br> <code>#!/usr/bin/python <br> <br> name = _("Mary") <br> animal = _("lamb") <br> <br> print _("%s had a little %s") % (name, animal)</code> <br> <br>  When using the gettext module, it is customary to mark translatable strings with a call to the <code>_()</code> function.  While this function is not defined (however, no one prevents us from temporarily determining something like <code>_ = lambda x: x</code> ), so the program will probably not even be able to start ... but we don‚Äôt need it yet. <br><br>  You probably already thought that now we will create a new text file with associations, in which you will need to remember to specify all the translated strings from the program?  In our case there are only 3 such lines, but in a serious program there may be a lot more ... <br><br><h4>  Translation template: .pot </h4><br>  ... you almost guessed it.  We will create the file.  But at the same time, we will use the pleasant opportunity of the gettext system - the analysis of source files for translatable strings.  Since we wisely flagged them with a call to the _ () function before this call began to use gettext seriously, the parser can now quickly assemble them. <br><br>  Since the gettext system is oriented for use in any programming languages, it includes the xgettext program that can generate a template file for translation from source codes to a sufficiently large number of languages ‚Äã‚Äã- C, C ++, ObjectiveC, C #, Java, Perl, Python, PHP, Lisp ... But this is if you are not too lazy to install the gettext software package itself (‚Äúaptitude install gettext‚Äù, or whatever it is in your distribution).  But we are writing a program in Python, which is self-sufficient for translating programs;  therefore, we will use the pygettext.py script (or pygettext under Unix) that is part of Python. <br><br>  Run the pygettext: <code>pygettext mary.py</code>  In the same directory with our program, a file called messages.pot, containing the following: <br> <code># SOME DESCRIPTIVE TITLE. <br> # Copyright (C) YEAR ORGANIZATION <br> # FIRST AUTHOR &lt;EMAIL@ADDRESS&gt;, YEAR. <br> # <br> msgid "" <br> msgstr "" <br> "Project-Id-Version: PACKAGE VERSION\n" <br> "POT-Creation-Date: 2009-10-28 01:12+MSK\n" <br> "PO-Revision-Date: YEAR-MO-DA HO:MI+ZONE\n" <br> "Last-Translator: FULL NAME &lt;EMAIL@ADDRESS&gt;\n" <br> "Language-Team: LANGUAGE &lt;LL@li.org&gt;\n" <br> "MIME-Version: 1.0\n" <br> "Content-Type: text/plain; charset=CHARSET\n" <br> "Content-Transfer-Encoding: ENCODING\n" <br> "Generated-By: pygettext.py 1.5\n" <br> <br> #: mary.py:6 <br> msgid "Mary" <br> msgstr "" <br> <br> #: mary.py:7 <br> msgid "lamb" <br> msgstr "" <br> <br> #: mary.py:10 <br> msgid "%s had a little %s" <br> msgstr "" <br></code> <br><br>  What it is?  This is a template for translating our entire program.  If we have a large translation team, we can give this template to each translator for each target language, and he should return the completed template for his language.  Typically, templates have the .pot extension, and filled files have the .po extension. <br><br>  The syntax of the file is fairly transparent.  Comments, translation copyright notes, pairs of original strings and translations.  Let's remove from the file everything superfluous, except for the line with ‚ÄúContent-Type:‚Äù and necessary for translating strings, specify the UTF-8 encoding and write translations: <br><br><h4>  Translation file: .po </h4><br> <code>msgid "" <br> msgstr "" <br> "Content-Type: text/plain; charset=UTF-8\n" <br> <br> msgid "Mary" <br> msgstr "" <br> <br> msgid "lamb" <br> msgstr "" <br> <br> msgid "%s had a little %s" <br> msgstr " %s   %s"</code> <br> <br>  In our case, the file is quite small and simple;  If it were more complicated, it would be more convenient to use specialized editors for .po files, like <a href="http://en.wikipedia.org/wiki/Poedit">Poedit</a> , or the ‚Äúspecialized editor of the whole‚Äù <a href="http://en.wikipedia.org/wiki/Emacs">Emacs</a> . <br><br><h4>  Compiled translation file: .mo </h4><br>  So, we translated the lines in our program.  In vain, by the way.  gettext is aimed solely at translating finished finished sentences, and the translation of individual words and sentence patterns in it is dangerous ... (for example, gettext does not support cases and genus at all, and somehow supports only the singular and plural distinction; so that instead Mary "Tanya" or "Light" will have to take into account the case for each possible use of the original name.) Well, okay - in our case it does not matter.  Now we have another task: to prepare the translation file for use. <br><br>  It would be inconvenient to use the source text file for performance reasons (for programs with a lot of translatable text), so the gettext system uses files compiled into a special format.  For compilation, we can use either the msgfmt tool from the gettext bundle, or the msgfmt.py from the Python bundle (in debian-like distributions it is included in the python2.5-examples package).  We use the second: <br><br> <code>msgfmt.py mary.po</code> <br> <br>  Yeah, we see the file mary.mo.  Unlike mary.po, it is clearly not intended for manual editing. <br><br><h4>  Directory structure and program launch </h4><br>  If we prepared the program for installation in service directories, then we would create something like this hierarchy (in the case of Debian linux): system directory / usr / share / locale, in it subdirectories for different languages ‚Äã‚Äã- ru, en, etc .;  in them - according to the LC_MESSAGES catalog, and there already - a file like mary.mo (with the most unique name so as not to intersect with other programs).  But in our case study, we simply make a locale subdirectory in our directory, create ru / LC_MESSAGES subdirectories in it, and in the latter we will set mary.mo. <br><br>  Now finally add support for gettext to our program: <br><br> <code>#!/usr/bin/python <br> import gettext <br> <br> gettext.install('mary', './locale', unicode=True) <br> <br> name = _("Mary") <br> animal = _("lamb") <br> <br> print _("%s had a little %s") % (name, animal)</code> <br> <br>  What changed?  We imported the gettext module (well, that‚Äôs obvious).  We also installed the _ () function in the global program space, which for translation of strings in the ./locale subdirectory (second argument) will find the directory with our current locale (the same ru directory), and in its subdirectory LC_MESSAGES will look for Unicode (third argument ) mary.mo translation file for mary (first argument). <br><br>  What is meant by the word "installed"?  And the fact that, after this action, we can import other modules of our program, and the function _ () in them will be already defined. <br><br>  Launch our program ... <br><br> <code>1:/tmp/mary&gt; ./mary.py <br>     </code> <br> <br>  Yeah.  Something like this. <br><br><h4>  Bonus </h4><br>  According to Google Translate, the .po file for Japanese will look something like this: <br> <code>msgid "" <br> msgstr "" <br> "Content-Type: text/plain; charset=UTF-8\n" <br> <br> msgid "Mary" <br> msgstr "„É°„Ç¢„É™„Éº" <br> <br> msgid "lamb" <br> msgstr "Â≠êÁæä" <br> <br> msgid "%s had a little %s" <br> msgstr "%s„ÅÆ%s„ÅÑ„Åü"</code> <br> <br>  And for normal support of the Japanese language (besides Russian) we will have to change the last line of code to <br> <code>print (_("%s had a little %s") % (name, animal)).encode('UTF-8')</code> <br> <br>  Check in the work: <br> <code>1:/tmp/mary&gt; LANG=ja_JP.UTF-8 ./mary.py <br>„É°„Ç¢„É™„Éº„ÅÆÂ≠êÁæä„ÅÑ„Åü</code> </div><p>Source: <a href="https://habr.com/ru/post/73554/">https://habr.com/ru/post/73554/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../73546/index.html">VMware Workstation 7 is released.</a></li>
<li><a href="../73547/index.html">Mario is not for the faint of heart.</a></li>
<li><a href="../73548/index.html">More interesting features to improve comments on Habr√©</a></li>
<li><a href="../73551/index.html">Silent Mouse Click</a></li>
<li><a href="../73553/index.html">Watch NASA TV on Sybabas set-top boxes (Popcorn, BBK, eGreat, etc.)</a></li>
<li><a href="../73556/index.html">Habrastil for karmagolika</a></li>
<li><a href="../73558/index.html">Has Delphi died?</a></li>
<li><a href="../73560/index.html">Google introduced Android 2.0 (Eclair) - SDK</a></li>
<li><a href="../73562/index.html">Emulation Dandy. Nestopia with support for new ZNS extension (Zipped NES)</a></li>
<li><a href="../73564/index.html">Who is who in the clouds, part 1</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>