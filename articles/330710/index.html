<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Copier RFID tags standard EM-Marin</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="As is known, many access systems use EM-Marin RFID cards with a frequency of 125 kHz. The intercom of my house was no exception. One problem - it woul...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Copier RFID tags standard EM-Marin</h1><div class="post__text post__text-html js-mediator-article">  As is known, many access systems use EM-Marin RFID cards with a frequency of 125 kHz.  The intercom of my house was no exception.  One problem - it would be nice to learn how to copy such cards, because the price tags for copying them are not encouraging.  In the network, of course, there are quite a few copyist schemes (and the Chinese also sell their copyists for pennies - though they often put their password on the discs when copying), but why not put together your own copyist?  This is the article below. <br><a name="habracut"></a><br>  It is worth starting the development of a copyist with a clarification, and on what can such tags be copied?  After reading the forums, you can find out that the most common blanks for copying are T5577, T5557, EM4305. <br><br>  Now we need a scheme.  Take the analog part of such a copyist from <a href="http://kazus.ru/forums/showthread.php%3Ft%3D67407">RECTO</a> and connect it to the <a href="http://kazus.ru/forums/showthread.php%3Ft%3D67407">atmega8</a> microcontroller.  Let's add a level converter to connect to a COM port based on max232 (those who wish can use ST232 or something else to connect via USB, but I have a COM port on my computer, as is the USB-COM adapter, so I have this task did not stand). <br><br>  It turns out this scheme: 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <img src="https://habrastorage.org/web/4ae/4b2/bdb/4ae4b2bdbe974fe2b53d19474c31d2ab.PNG"><br><br>  What is she like?  Dual emitter follower, oscillating circuit, detector and RC-filters.  Due to the fact that RC-filters have different time constants, comparing the voltage levels between the stages with each other, it is possible to isolate the change in the signal of the RFID tag.  This task will be dealt with a comparator built into atmega8.  The 125 kHz signal generation will be provided by the PWM controller built into the atmega8. <br><br>  The combination of RFID tag - reader form a transformer, where the tag is a secondary winding.  Information transfer tag is produced by changing the load of the secondary winding.  As a result, the current in the reader coil (primary) changes.  The selection of these current pulses and is engaged in the above analog part of the circuit.  The oscillatory circuit must be set to the maximum voltage at the control point, for example, winding / winding the turns of the coil.  True, it is said that the voltage is still better a little less than the maximum - it works more stable.  I have a checkpoint of about 40 V. <br><br>  The copied label uses <a href="https://ru.wikipedia.org/wiki/%25D0%259C%25D0%25B0%25D0%25BD%25D1%2587%25D0%25B5%25D1%2581%25D1%2582%25D0%25B5%25D1%2580%25D1%2581%25D0%25BA%25D0%25BE%25D0%25B5_%25D0%25BA%25D0%25BE%25D0%25B4%25D0%25B8%25D1%2580%25D0%25BE%25D0%25B2%25D0%25B0%25D0%25BD%25D0%25B8%25D0%25B5">Manchester</a> type coding.  In order to decipher this code, it is enough to skip three-quarters of the bit slot period for any change in the signal's front and, following the signal difference following it, fix the bit value that will correspond to the signal value after the differential.  When decoding, it is necessary to specify a window into which a signal drop should occur - no more than half the bit slot period. <br><br><img src="https://habrastorage.org/web/744/0d3/f74/7440d3f7427f4b0d8522daabe28e4f6f.PNG"><br><br>  The Manchester coding decoding method and the code for this I took from <a href="http://forum.easyelectronics.ru/viewtopic.php%3Fp%3D352328%26sid%3Da54f9682d1ce9e21588582306c74395b">Shads</a> .  You could, of course, write your own, but I was in a hurry to launch the copyist - I wanted to make sure that the circuit was working and the tags were being received.  So this fragment remained in the code of the copier.  It also turned out that my comparator is configured inversely than the decoding code needs.  Changed in the code.  So, we received sequences of zero and units.  How to get a card code from them? <br><br>  A very simple.  Assume that the card number by nibbl√°m has the form <b>AB CD EF GH IJ</b> .  The card gives this: <br><br>  1) Nine units at the start; <br>  2) Nibble A; <br>  3) Nibbl parity A (1 bit); <br>  4) Nibble B; <br>  5) Nibbl parity B (1 bit); <br>  ... <br>  16) Nibble I; <br>  17) Nibbl I parity (1 bit); <br>  18) J Nibble; <br>  19) Nibbl parity J (1 bit); <br>  20) Nibble parity columns for nibbles ABCDEFGHIJ; <br>  21) Bit 0. <br><br>  Read all 64 bits, decrypt and get 40 bits of card code.  It is logical that if you give yourself this code, closing the coil of the card attached to the reader, we will get a card emulator.  But now we are not interested in him. <br><br>  We learned to read the map, but how to transfer the data to the map?  To do this, simply turn on or off the frequency of 125 kHz in accordance with the protocol of exchange with the card.  For the time of ‚Äúsilence‚Äù of the reader, the card is powered by stored energy. <br><br>  The T5557 / T5577 blanks are fully compatible with each other according to the recording protocols, however, they have slightly different minimum and maximum pulse times (fortunately, the T5557 times overlap with T5577).  The EM4305 has a different recording protocol. <br><br>  To write T5557 I used the <a href="http://kazus.ru/forums/showthread.php%3Ft%3D101565">BolshoyK</a> code.  The table below shows the signal parameters for the T5557 key fob. <br><br><img src="https://habrastorage.org/web/4c1/217/2c0/4c12172c052241d3bfceb41c2ce8b1ab.PNG"><br><br>  Recording starts with the StartGape signal ‚Äî you need to turn off the 125 KHz signal for about 300 ¬µs.  This is a signal to the card that now it will begin to transmit data.  Further information should be transferred to the disc.  The coding of the transmitted data is the same Manchester. <br><br>  The T5557 / T5577 and EM4305 blanks are multifunctional and can handle various types of modulations, support passwords and much more.  Each blank on board has a set of blocks of 32 bits.  The purpose of these blocks is different.  In some, the key code that is issued (it takes up two blocks).  In others, the configuration.  Third - the manufacturer ID.  We will use limited functionality, so those who want to understand what all these bits mean can look into the documentation for the blanks (I attached it to the archive). <br><br>  Blocks are assembled in two pages (0 and 1). <br><img src="https://habrastorage.org/web/1de/523/ea6/1de523ea664f4e189a708f1457093821.PNG"><br><br>  In the zero page there is a configuration block with an index of 0. We will set it.  For T5557 / T5577 we will have the following configuration bytes: 0x00,0x14,0x80,0x40 in accordance with the table from the documentation (I marked in red with the modes selected with the unit bits): <br><br><img src="https://habrastorage.org/web/b23/d4d/d55/b23d4dd55b464d4f964ab41ef7bf56e8.PNG"><br><br>  Thus, we have chosen: data transmission frequency RF / 64 (125 KHz / 64), Manchester type coding, block output to the second (in blocks 1 and 2 we will have the code issued by the card).  Before recording, send the operation code (2 bits of opcode) and one bit of the latch (lockbit).  The operation codes 10b and 11b precede the writing of data for pages 0 and 1 (the low-order bit specifies the page number, the most significant one - the page recording code).  We have 10b for the opcode (all work goes with a zero page) and 0b for the bit of the latch.  After transferring all this data, it is necessary to transfer the three-bit address of the recorded page.  All data transmissions for the T5557 / T5577 are from the high bit to the low bit. <br><br><img src="https://habrastorage.org/web/a8d/e3b/bf7/a8de3bbf752d4421b299f30ec36a6227.PNG"><br><br>  By specifying the card code in blocks 1 and 2 and the configuration in block 0, you can get a duplicate RFID tag.  As you can see, everything is simple. <br><br>  The next type of disc is EM4305.  Here I had to deal with the recording of this disc myself.  It also consists of blocks of 32 bits each, but their purpose is different. <br><br><img src="https://habrastorage.org/web/757/df6/e80/757df6e802e54576bccba65fd999428c.PNG"><br><br>  Encoding of data transmitted to the card - by differences over the time interval.  If the differential over the time interval was, then it is zero, and if it was not, it is one.  The configuration word is stored in 4 bytes and for myself I defined it as: 0x5F, 0x80,0x01,0x00 (encoding Manchester, RF / 64, issuing the word 6).  In words 5 and 6, I write down the card code (the 64 bits that the card produces).  The EM4305 requires that the transmission be conducted from the low bit to the high bit.  The card understands that they begin to exchange with it after issuing a combination of pulses to it: <br><br><ol><li>  Turning off the field for 48 Œºs. </li><li>  We turn on the field for 96 Œºs. </li><li>  Turn off the field for 320 Œºs. </li><li>  Turn on the field for 136 Œºs. </li><li>  Disable the field to the next command. </li></ol><br>  The command to write a block to the card is transmitted as follows: <br><br><ol><li>  We send the above sequence of pulses. </li><li>  We send 0b. </li><li>  We transfer CC0-CC1 and their parity P. (0101b for the record, see the tables below). </li><li>  We pass the address of the block (see table), two complementary zeros and the parity of the address. </li><li>  We transfer the block data (32 bits). </li></ol><br><img src="https://habrastorage.org/web/fd4/ad0/5c1/fd4ad05c17364e27bb413362143937a9.PNG"><br>  <i>Command format</i> <br><br><img src="https://habrastorage.org/web/ba1/0bb/44d/ba10bb44d96345af96d9dcc03b3c6413.PNG"><br>  <i>Command codes</i> <br><br><img src="https://habrastorage.org/web/0d0/e11/e1a/0d0e11e1aa89461c9ee5064aa0a8ff9d.PNG"><br>  <i>Block address format</i> <br><br>  Thus, the configuration of the EM4305 blank and its code is specified. <br><br>  Actually, nothing more is needed to a simple copyist. <br><br>  I made several copier options with different displays.  For example, here is a copier with a 1602 display: <br><br><img src="https://habrastorage.org/web/4f1/db5/7ae/4f1db57ae40748a2a8d19f5b1b01ef83.jpg"><br><br>  But the video of the copyist on the display LPH9157-02: <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/ONqSsbdVCqM" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><br>  But the reason why I became interested in the copyists of such keys was to make many copies of the key of the intercom (it was too lazy to wait for a parcel from China), but this is the price tag: <br><br><img src="https://habrastorage.org/web/729/d58/861/729d58861b954c9a9fccad5486aaad34.jpg"><br><br>  In the <a href="https://yadi.sk/d/jM3yet6d3K3brC">archive</a> all schemes, signets, programs and documentation for blanks.  There is a version for Arduino Nano (it needs to be flashed separately through programs for uploading third-party firmware). <br><br>  Those interested can open the documentation for all these discs and implement support for passwords and other modes of operation of the cards.  I personally all this was unnecessary. <br><br>  Special thanks to RECTO, BolshoyK and Shads - without you I would have had fun with the development for quite some time! <br><br>  Thanks for attention. <br><br>  PS I am not a professional in copying keys and in blanks, so I could be mistaken about something.  However, the copyist works, and no one has yet found any errors in it. </div><p>Source: <a href="https://habr.com/ru/post/330710/">https://habr.com/ru/post/330710/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../330696/index.html">PHP Digest number 110 - the latest news, materials and tools (May 28 - June 11, 2017)</a></li>
<li><a href="../330702/index.html">SQL Server Integration Services (SSIS) for Beginners - Part 2</a></li>
<li><a href="../330704/index.html">Create your own custom Style plugin - Theming Views in Drupal 8</a></li>
<li><a href="../330706/index.html">Responsive Bar Charts with Bokeh, Flask and Python 3</a></li>
<li><a href="../330708/index.html">You are not google</a></li>
<li><a href="../330712/index.html">NNCP: online treatment and censorship of the store-and-forward method</a></li>
<li><a href="../330714/index.html">‚ÄúCloser to the people‚Äù: how to make IaaS more accessible</a></li>
<li><a href="../330716/index.html">‚ÄúThe biggest competitor is those who do everything themselves‚Äù - Petr Zaitsev about the creation and development of the Percona company</a></li>
<li><a href="../330720/index.html">Reform SQL-based approach in DAO</a></li>
<li><a href="../330722/index.html">Preparing git reset correctly</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>