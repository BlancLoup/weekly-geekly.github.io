<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>PDFsharp and MigraDoc Foundation (Basics)</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Since the article, because of which I received an invite has disappeared somewhere, I want to publish it again. 

 Due to the small number of free lib...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>PDFsharp and MigraDoc Foundation (Basics)</h1><div class="post__text post__text-html js-mediator-article">  Since the article, because of which I received an invite has disappeared somewhere, I want to publish it again. <br><br>  Due to the small number of free libraries for working with PDF in .Net as well as their insufficient coverage in Russian, I want to talk about working with such a wonderful library as <strong>PDFsharp and MigradDoc</strong> <br><a name="habracut"></a><br>  Perhaps we will start from the very beginning - the source can be downloaded <a href="http://pdfsharp.codeplex.com/releases">here</a> or <a href="http://sourceforge.net/projects/pdfsharp/files/">here.</a> <br>  Now add links to your project: <br><pre><code class="hljs cs"><span class="hljs-keyword"><span class="hljs-keyword">using</span></span> MigraDoc; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> PdfSharp; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> MigraDoc.DocumentObjectModel; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> MigraDoc.Rendering; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> PdfSharp.Pdf;</code> </pre> <br>  Create a new document <br><pre> <code class="hljs javascript">Document <span class="hljs-built_in"><span class="hljs-built_in">document</span></span> = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Document();</code> </pre><br>  Each MigraDoc document consists of independent sections that can have its own format. <br>  Creating a section: <pre> <code class="hljs nginx"><span class="hljs-attribute"><span class="hljs-attribute">Section</span></span> section = document.AddSection();</code> </pre>  after such initialization, working with <em>section</em> - we work with the document part. <br>  Sections have functions for working with information, such as <em>Add, AddParagraph (), AddImage (), AddTable ()</em> , etc., as well as a class for changing the format of the <em>PageSetup</em> section <em>itself</em> . <br>  Changing format: <br><pre> <code class="hljs ruby">section.PageSetup.PageFormat = PageFormat.<span class="hljs-number"><span class="hljs-number">5</span></span>;<span class="hljs-regexp"><span class="hljs-regexp">//</span></span>   section.PageSetup.Orientation = Orientation.Portrait;<span class="hljs-regexp"><span class="hljs-regexp">//</span></span> section.PageSetup.BottomMargin = <span class="hljs-number"><span class="hljs-number">10</span></span>;<span class="hljs-regexp"><span class="hljs-regexp">//</span></span>  section.PageSetup.TopMargin = <span class="hljs-number"><span class="hljs-number">10</span></span>;<span class="hljs-regexp"><span class="hljs-regexp">//</span></span> </code> </pre> <br>  Adding information occurs either using <em>Add (Param)</em> , where <em>Param</em> is a paragraph (Paragraph), picture (Image), table (Table), chart (Chart) or text frame (TextFrame) <br><pre> <code class="hljs pgsql">Paragraph paragraph =<span class="hljs-built_in"><span class="hljs-built_in">new</span></span> Paragraph(); section.<span class="hljs-keyword"><span class="hljs-keyword">Add</span></span>(paragraph);</code> </pre> <br>  or by the example of adding a section <br><pre> <code class="hljs nginx"><span class="hljs-attribute"><span class="hljs-attribute">Paragraph</span></span> paragraph = section.AddParagraph();</code> </pre> <br>  Moreover, for each paragraph it is also possible to set an individual format (Format class) and style (Style class): <br><pre> <code class="hljs dos">paragraph.<span class="hljs-built_in"><span class="hljs-built_in">Format</span></span>.Font.<span class="hljs-built_in"><span class="hljs-built_in">Color</span></span> = <span class="hljs-built_in"><span class="hljs-built_in">Color</span></span>.FromCmyk(<span class="hljs-number"><span class="hljs-number">100</span></span>, <span class="hljs-number"><span class="hljs-number">30</span></span>, <span class="hljs-number"><span class="hljs-number">20</span></span>, <span class="hljs-number"><span class="hljs-number">50</span></span>);</code> </pre> <br>  For each paragraph you can add information: <br><pre> <code class="hljs ruby">Text text = new Text(<span class="hljs-string"><span class="hljs-string">"text"</span></span>); paragraph.AddText(<span class="hljs-string"><span class="hljs-string">"text"</span></span>);<span class="hljs-regexp"><span class="hljs-regexp">//</span></span> paragraph.AddFormattedText(<span class="hljs-string"><span class="hljs-string">"formatted text"</span></span>, styleName);<span class="hljs-regexp"><span class="hljs-regexp">//</span></span>   paragraph.Add(text);<span class="hljs-regexp"><span class="hljs-regexp">//</span></span>     paragraph.AddBookmark(<span class="hljs-string"><span class="hljs-string">"Bookmark"</span></span>);<span class="hljs-regexp"><span class="hljs-regexp">//</span></span> paragraph.AddChar(<span class="hljs-string"><span class="hljs-string">'c'</span></span>);<span class="hljs-regexp"><span class="hljs-regexp">//</span></span> paragraph.AddDateField(<span class="hljs-string"><span class="hljs-string">"10.10.2010"</span></span>);<span class="hljs-regexp"><span class="hljs-regexp">//</span></span> paragraph.AddFootnote(<span class="hljs-string"><span class="hljs-string">"Footnote"</span></span>);<span class="hljs-regexp"><span class="hljs-regexp">//</span></span>  /<span class="hljs-regexp"><span class="hljs-regexp">/   </span></span></code> </pre> <br>  The basis we have collected, now it remains to turn it into a full PDF document, for which the PdfDocumentRenderer is used: <br><pre> <code class="hljs javascript">pdfRenderer = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> PdfDocumentRenderer(<span class="hljs-literal"><span class="hljs-literal">true</span></span>, PdfFontEmbedding.Always); pdfRenderer.Document = <span class="hljs-built_in"><span class="hljs-built_in">document</span></span>; pdfRenderer.RenderDocument(); pdfRenderer.PdfDocument.Save(filePath);<span class="hljs-comment"><span class="hljs-comment">// </span></span></code> </pre> <br>  You may need to use non-default fonts in the document, for example, <em>DejaVuSansMono.ttf</em> .  You can do this by first placing the file of the above font in the same folder where the executable file is: <br><pre> <code class="hljs pgsql">Uri uri = <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> Uri(@"file://" + <span class="hljs-keyword"><span class="hljs-keyword">System</span></span>.IO.Path.GetDirectoryName(<span class="hljs-keyword"><span class="hljs-keyword">System</span></span>.Reflection.Assembly.GetEntryAssembly().<span class="hljs-keyword"><span class="hljs-keyword">Location</span></span>) + @"\DejaVuSansMono.ttf"); XPrivateFontCollection pfc = XPrivateFontCollection.<span class="hljs-keyword"><span class="hljs-keyword">Global</span></span>; try { pfc.<span class="hljs-keyword"><span class="hljs-keyword">Add</span></span>(uri, "./#DejaVu Sans Mono"); } catch (<span class="hljs-keyword"><span class="hljs-keyword">Exception</span></span>) {} pdfRenderer.DocumentRenderer.PrivateFonts = pfc;</code> </pre> <br>  If you need to display the created document in your application, <em>MigraDoc.Rendering.Windows.DocumentPreview</em> will help us to display the documents <strong>created in MigraDoc</strong> .  First you need to put it on a form or a WPF window, then use the following code: <br><pre> <code class="hljs php">Document doc = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Document(); doc = oDocument.<span class="hljs-keyword"><span class="hljs-keyword">Clone</span></span>(); preview.Ddl = DdlWriter.WriteToString(doc);</code> </pre> <br>  The ability to display already created PDF-documents is unfortunately not available. <br>  I recommend to pay attention to the <em>Clone ()</em> function, which is important when assigning any MigraDoc objects (documents, sections, paragraphs, etc.), if you do not use it, then when you change the first object, the one that is assigned will be changed. <br>  To print MigraDoc documents you can use <em>MigraDocPrintDocument</em> : <br><pre> <code class="hljs lisp">MigraDocPrintDocument migraDocPrint = new MigraDocPrintDocument(<span class="hljs-name"><span class="hljs-name">preview</span></span>.Renderer)<span class="hljs-comment"><span class="hljs-comment">; migraDocPrint.Print();</span></span></code> </pre> <br>  But such a problem is noticed that this method does not work when printing through a server, printing through a local printer is normal. <br>  Therefore, as an option, you can use Foxit Reader for printing: <br><pre> <code class="hljs css"><span class="hljs-selector-tag"><span class="hljs-selector-tag">pdfDocumentRenderer</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.PdfDocument</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.Save</span></span>(@"<span class="hljs-keyword"><span class="hljs-keyword">temp</span></span>.<span class="hljs-keyword"><span class="hljs-keyword">pdf</span></span>"); <span class="hljs-selector-tag"><span class="hljs-selector-tag">Process</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.Start</span></span>(@"<span class="hljs-keyword"><span class="hljs-keyword">Resources</span></span>\<span class="hljs-keyword"><span class="hljs-keyword">Foxit</span></span> Reader.exe<span class="hljs-string"><span class="hljs-string">", @"</span></span>/p temp.pdf<span class="hljs-string"><span class="hljs-string">");</span></span></code> </pre><br>  In conclusion, I would like to say that after testing all the libraries from <a href="http://habrahabr.ru/post/112707/">this post,</a> I settled on this library as the most convenient and well-equipped. <br></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <p>Source: <a href="https://habr.com/ru/post/150059/">https://habr.com/ru/post/150059/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../150051/index.html">Configuring cisco ASA 5510 + security module ASA-SSM-CSC-10 + NAT</a></li>
<li><a href="../150053/index.html">Car safety systems and thinking about unrealized</a></li>
<li><a href="../150054/index.html">jQuery UI Datepicker: add custom navigation elements by year</a></li>
<li><a href="../150055/index.html">Nikon released the camera running Android</a></li>
<li><a href="../150056/index.html">"Unbiased" universal algorithmic intelligence</a></li>
<li><a href="../150060/index.html">Sell ‚Äã‚Äãyourself</a></li>
<li><a href="../150061/index.html">Printing Yandex.Maps under API 2.x with labels and clusters</a></li>
<li><a href="../150062/index.html">War and peace with the Office of "K"</a></li>
<li><a href="../150063/index.html">Grouping serial posts close in time</a></li>
<li><a href="../150064/index.html">The insides of the QML engine. Part 1: Downloading Files</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>