<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Representation of numbers by the sum of two squares and elliptic curves</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Let p be an odd prime number. It is widely known that p is representable as the sum of two squares of integers p = a 2 + b 2 if and only if p when div...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">🔎</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">📜</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">⬆️</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">⬇️</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Representation of numbers by the sum of two squares and elliptic curves</h1><div class="post__text post__text-html js-mediator-article">  Let <i>p</i> be an odd prime number.  It is widely known that <i>p</i> is representable as the sum of two squares of integers <i>p = a <sup>2</sup> + b <sup>2</sup></i> if and only if <i>p</i> when divided by 4 gives the remainder 1: 5 = 1 <sup>2</sup> + <sup>2 2</sup> , 13 = 3 <sup>2</sup> + 2 <sup>2</sup> , 17 = 1 <sup>2</sup> + 4 <sup>2</sup> , ...;  3, 7, 11, ... not representable.  Far less well known is that <i>a</i> and <i>b</i> can be written with a beautiful formula that is directly related to a single elliptic curve.  About this <a href="http://www.digizeitschriften.de/dms/img/%3FPPN%3DGDZPPN002166402">result in 1907 for the authorship of a German by the name of Jacobsthal</a> and related things, we will talk today. <br><br>  It is quite easy to understand why 3, 7, 11 and other numbers that give a remainder of 3 when divided by 4 are not representable as <i>a <sup>2</sup> + b <sup>2</sup></i> : a square of an even number is always divisible by 4, a square of an odd number always gives a remainder of 1 when divided by 4 , the sum of two squares when divided by 4 can give residues of 0, 1 or 2, but not 3. The primacy of primes like <i>4k + 1 is</i> not obvious (especially if you notice that simplicity is significant: the number 21 does have the necessary remainder, but the sum of two squares are not represented). <br><br><a name="habracut"></a><h1>  Deductions </h1><br>  There are infinitely many natural numbers.  It can be useful to combine them into classes for some signs.  In particular, combining by the remainder of dividing by some number <i>n</i> leads to <i>deductions</i> modulo <i>n</i> : the deduction <i>x </i> is the class of all numbers that, when divided by <i>n,</i> give the same remainder as <i>x</i> .  That is equivalent, the residue <i>x̅</i> consists of all numbers of the form <i>x + n ∙ k</i> , where <i>k is</i> integer.  Within this post, all deductions will be modulo <i>p</i> (the same odd prime number from the introduction).  Naturally, there are as many different residues as there can be residues from division by <i>p</i> , that is, exactly <i>p</i> .  Compared to the infinity of natural numbers, the transition to deductions greatly reduces the number of options. <br>  Class operations do not always make sense.  For example, an attempt to add a class of prime numbers with a class of composite numbers is not very meaningful: we can only add numbers, while the sum of a prime number and a composite number does not show the properties common to the class.  Although members <a href="http://xkcd.com/703/">of the tautology club</a> can say that the addition of the class of prime numbers and the class of composite numbers gives a class of numbers that are decomposed into the sum of a prime number and a composite number. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      For deductions, however, addition, subtraction and multiplication, “inherited” from natural numbers, give other deductions.  For example, 2̅ + 3̅ = 5̅: take any number with a remainder of 2, any number with a remainder of 3, and their sum will necessarily give a remainder of 5. Generally speaking, the product of two nonzero residues over an arbitrary module may suddenly turn out to be zero, 2̅ 3̅ = 0̅ by module 6, which is unpleasant.  But in the case of a simple module, obviously, this does not happen, as they say, there are <i>no zero divisors</i> .  In addition, you can solve the equation <i>a̅ ∙ x̅ = b̅</i> (division operation) for any two residues, except for the case <i>a̅ = 0̅</i> , and the result will be uniquely determined.  Uniqueness follows from the fact that the product of nonzero residues is nonzero.  Since <i>a̅ ≠ 0̅</i> , the greatest common divisor of <i>a</i> and <i>p</i> is 1 (simplicity <i>p</i> is also needed here), the <a href="http://ru.wikipedia.org/wiki/%25D0%25A0%25D0%25B0%25D1%2581%25D1%2588%25D0%25B8%25D1%2580%25D0%25B5%25D0%25BD%25D0%25BD%25D1%258B%25D0%25B9_%25D0%25B0%25D0%25BB%25D0%25B3%25D0%25BE%25D1%2580%25D0%25B8%25D1%2582%25D0%25BC_%25D0%2595%25D0%25B2%25D0%25BA%25D0%25BB%25D0%25B8%25D0%25B4%25D0%25B0">advanced Euclidean algorithm</a> will find <i>x</i> and <i>y</i> such that <i>a ∙ x + p ∙ y = 1</i> , which implies <i>a̅ ∙ x̅ = 1̅</i> , so, <i>a̅ ∙ (b̅ ∙ x̅) = b̅</i> . <br><br>  An important consequence of the absence of zero divisors: a non-zero polynomial in one variable of degree <i>n</i> cannot have more than <i>n</i> roots.  (This is well known for ordinary integers, but when using operations on residues it requires additional justification: the equation 3̅ ∙ x̅ = 0̅ modulo 6 has three solutions 0̅, 2̅, 4̅.) Indeed, the usual “by column” division shows that any the <i>f (x)</i> polynomial can be represented as <i>f (x) = (x-) g (x) +</i> (some constant), where the <i>g (x)</i> polynomial has a degree less than one;  if <i>c</i> is the root of <i>f (x)</i> , then the constant is zero (we substitute <i>x = c</i> );  if <i>c '</i> is another <i>f (x)</i> , then it will be <i>g (x)</i> (the absence of zero divisors is important here), so the process can be continued.  If <i>n</i> roots have already been gathered, then the remaining <i>g (x)</i> will be constant, and non-zero (otherwise <i>f (x) = 0</i> ) and has no more roots. <br><br>  Deductions on a simple module can be added, subtracted, multiplied.  Non-zero deductions can be divided.  All these operations have the usual properties of the type <i>a̅ ∙ b̅ = b̅ ∙ a̅</i> .  Smart books say that deductions by a simple module form a <i>field</i> (and deductions by a composite module, where it is impossible to divide, and everything else is the same, a <i>commutative ring</i> ).  And you do not need to be a smart book to call this field <i>finite</i> .  The residue field is not the only finite field, but we will not need other finite fields. <br><br><h1>  A little bit about elliptic curves </h1><br>  An elliptic curve modulo <i>p</i> (that <b>odd</b> prime number) can be viewed as a set of solutions to the equation <i>y <sup>2</sup> = x <sup>3</sup> + a <sub>2</sub> x <sup>2</sup> + a <sub>4</sub> x + a <sub>6</sub></i> , where <i>x</i> , <i>y</i> and all <i>a</i> are residues (each solution is called one <i>point</i> ), plus one special point <i>O</i> , not having a pair of <i>x, y</i> .  The right side of the equation should not be divisible by a square, otherwise it will not be an elliptic curve: in an equation of the type <i>y <sup>2</sup> = (x-1̅) <sup>2</sup> (x + 2̅),</i> you can replace the variable <i>y</i> with <i>z = y / (x-1̅)</i> and get the dependence second degree, not third. <br>  If <i>p ≠ 3</i> , then instead of the variable <i>x</i> you can take <i>x + a <sub>2</sub> / 3̅</i> , getting rid of the term with <i>x <sup>2</sup></i> . <br><br>  It is clear that since <i>x, y</i> belong to a finite set, then the number of points on an elliptic curve is also finite.  How many of them?  This is a difficult question in general.  We restrict ourselves to curves of the form <i>y <sup>2</sup> = x <sup>3</sup> -k ∙ x</i> .  For such curves, the full proof can be put in one Habr's post (albeit rather long). <br><br><h1>  Quadratic deductions and non-deductions </h1><br>  Let us first ask a simpler question.  How many solutions does the equation <i>y <sup>2</sup> = c</i> , where <i>y, c</i> are residues?  Example for <i>p = 7</i> : <table><tbody><tr><td>  <i>y</i> </td><td>  0̅ </td><td>  one </td><td>  2̅ </td><td>  3̅ </td><td>  four </td><td>  five </td><td>  6̅ </td></tr><tr><td>  <i>y</i> <sup>2</sup> </td><td>  0̅ </td><td>  one </td><td>  four </td><td>  2̅ </td><td>  2̅ </td><td>  four </td><td>  one </td></tr></tbody></table> If <i>c = 0̅</i> , then the solution is one, <i>y = 0̅</i> .  The remaining values ​​of <i>y</i> are divided into two halves, from 1̅ before the deduction corresponding to <i>(p-1) / 2</i> , and from the deduction corresponding to <i>(p + 1) / 2</i> , to <i>-1 </i> .  Once <i>y <sup>2</sup> = (- y) <sup>2</sup></i> , the second half of the row of values ​​of <i>y <sup>2 is</sup></i> mirror-symmetric to the first half.  On the other hand, in each half there are no repetitions, since otherwise the equation would have at least 4 solutions, which is impossible for a polynomial of degree 2. Hence, there are <i>(p-1) / 2</i> <i>c</i> residues for which there are exactly 2 solutions, and the same <i>c</i> residues for which there are no solutions at all. <br><br>  Nonzero <i>c</i> residues for which there is a solution are called <i>quadratic residues</i> .  The residues <i>c</i> , for which there is no solution, are called <i>quadratic non-residues</i> .  It is worth noting that a quadratic non-derivation is a deduction, it’s just not lucky to be quadratic.  <i>Legendre Symbol</i> <img src="https://habrastorage.org/getpro/habr/post_images/5a4/0e2/63e/5a40e263e1c2b2c9662a8a98e975e431.gif" alt="\ left (\ frac cp \ right)">  shows the ratio of <i>c</i> to squares: 1, if relevant (that is, <i>c</i> is a quadratic residue), -1, if not applicable (that is, <i>c</i> is a quadratic non-residue), 0, if <i>c = 0</i> .  The number of solutions to the equation <i>y <sup>2</sup> = c</i> is equal to <img src="https://habrastorage.org/getpro/habr/post_images/4fd/2e3/9bf/4fd2e39bfddbe4aaed5b47961e0c543a.gif" alt="1+ \ left (\ frac cp \ right)">  . <br><br>  Let us return to the elliptic curves.  The number of options <i>y</i> for a fixed <i>x</i> we know, the total number of points on the curve <i>y <sup>2</sup> = x <sup>3</sup> -k ∙ x</i> can be written by summing over all <i>x</i> and not forgetting the special point: <img src="https://habrastorage.org/getpro/habr/post_images/3d3/8e6/df9/3d38e6df9813e7cc10a7274b18308a6a.gif" alt="p + 1 + \ sum_ {x \ in \ mathbb {F} _p} \ left (\ frac {x ^ 3-kx} p \ right)">  .  The symbol <i>F <sub>p</sub></i> , which has never appeared before, is usually denoted as a field of residues modulo <i>p</i> . <br><br>  Now we are ready to present the promised formulas for the components of the decomposition of <i>p</i> in the sum of two squares.  <b>Theorem</b> .  Let <i>g</i> be any quadratic non-counting.  If <i>p</i> when divided by 4 gives the remainder 1, then <br><img src="https://habrastorage.org/getpro/habr/post_images/5f1/d66/a87/5f1d66a878256d409e2965589be0f816.gif" alt="p = \ left (\ frac12 \ sum_ {x \ in \ mathbb {F} _p} \ left (\ frac {x ^ 3-x} {p} \ right) \ right) ^ 2 + \ left (\ frac12 \ sum_ {x \ in \ mathbb {F} _p} \ left (\ frac {x ^ 3-gx} {p} \ right) \ right) ^ 2"><br>  and the number in the first bracket is an odd integer, the number in the second bracket is an even integer.  If <i>p,</i> when divided by 4, gives the remainder of 3, then both sums in brackets are zero (and therefore, the number of points on elliptic curves is <i>p + 1</i> ). <br><br><h1>  Evidence </h1><br>  Since the post is already long, the evidence is removed under the spoiler.  You can safely skip it without affecting perception. <br><br><div class="spoiler">  <b class="spoiler_title">Part 1. The case of p = 4k + 3 and parity / oddness problems.</b> <div class="spoiler_text">  If we take a nonzero residue <i>c</i> and multiply it by all residues from <i>1̅</i> to <i>p̅-1̅</i> , all products will be non-zero and pairwise different (if <i>c ∙ x = c ∙ y</i> , then <i>c ∙ (xy) = 0̅</i> , which with non-zero <i>c</i> can be only if <i>x = y</i> ), which means that it will simply be some kind of permutation of all residues from <i>1̅</i> to <i>p̅-1̅</i> .  Therefore, <i>1̅ ∙ 2̅ ∙ ... ∙ (p̅-1̅) = (c ∙ 1̅) (c ∙ 2̅) ∙ ... ∙ (c ∙ (p̅-1̅)) = c <sup>p-1</sup> 1̅ ∙ 2̅ ∙ ... ∙ (p̅-1̅)</i> and <i>c <sup>p-1</sup> = 1̅</i> for any nonzero residue <i>c</i> .  (This was the proof <a href="http://ru.wikipedia.org/wiki/%25D0%259C%25D0%25B0%25D0%25BB%25D0%25B0%25D1%258F_%25D1%2582%25D0%25B5%25D0%25BE%25D1%2580%25D0%25B5%25D0%25BC%25D0%25B0_%25D0%25A4%25D0%25B5%25D1%2580%25D0%25BC%25D0%25B0">of Fermat's small theorem</a> .) <br><br>  Therefore, the polynomial <i>x <sup>p-1</sup> -1 = (x <sup>(p-1) / 2</sup> -1) (x <sup>(p-1) / 2</sup> +1)</i> has <i>p-1</i> roots.  This means that each bracket has <i>(p-1) / 2</i> roots (the maximum possible number for the degree of brackets).  Each quadratic residue is the root of the first bracket (if <i>x = c <sup>2</sup></i> , then <i>x <sup>(p-1) / 2</sup> = c <sup>p-1</sup> = 1̅</i> ), their <i>(p-1) / 2</i> , which means that all square non-counting remains the second bracket.  So, the Legendre symbol from <i>c</i> belongs to the same deduction as <i>c <sup>(p-1) / 2</sup></i> .  (This was proof of <a href="http://ru.wikipedia.org/wiki/%25D0%259A%25D1%2580%25D0%25B8%25D1%2582%25D0%25B5%25D1%2580%25D0%25B8%25D0%25B9_%25D0%25AD%25D0%25B9%25D0%25BB%25D0%25B5%25D1%2580%25D0%25B0">Euler's criterion</a> ). <br><br>  As a result, we get <img src="https://habrastorage.org/getpro/habr/post_images/bf5/56e/52f/bf556e52f8c9ab1a782ca5d40af565c1.gif" alt="\ left (\ frac {cd} p \ right) = \ left (\ frac cp \ right) \ left (\ frac dp \ right)">  . <br><br>  Is -1̅ a quadratic residue?  Depends on the sign <i>(-1) <sup>(p-1) / 2</sup></i> .  If <i>p</i> when divided by 4 gives the remainder 1, then <i>(p-1) / 2 is</i> even, <i>(-1) <sup>(p-1) / 2</sup> = 1</i> , -1 ̅ is a quadratic residue.  If <i>p</i> when divided by 4 gives the remainder of 3, then the opposite is true and -1̅ is a quadratic non-count. <br><br>  The simple part of the theorem: <i>p</i> gives the remainder of 3 when divided by 4. Then in each bracket the terms with <i>x</i> and <i>-x</i> differ from each other by multiplying by the Legendre symbol from –1̅, that is, they are opposite in sign and total to 0. Since all the terms, except <i>x = 0̅</i> , they are divided into pairs with a zero sum, and the term with <i>x = 0</i> , zero, the whole sum is 0. <br><br>  If <i>p</i> gives the remainder 1 when divided by 4, then the terms with <i>x</i> and <i>-x</i> are equal and their sum is even.  This means that the whole sum is also even and the numbers in brackets are really integers.  Parity / oddness after dividing in half is not much more complicated: in the first bracket of the theorem there are three zero terms, the other terms are divided into <i>(p-3) / 2</i> pairs with a sum of ± 2 in each pair;  for any sign when dividing by 4, the remainder is 2, the whole amount when dividing by 4 gives the remainder the same as <i>p-3</i> , that is 2. After dividing in half, we get an odd number.  In the second bracket of the theorem, there is only one zero summand and <i>(p-1) / 2</i> pairs with ± 2, the total remainder from dividing by 4 is 0, after dividing in half an even number remains. <br></div></div><br><div class="spoiler">  <b class="spoiler_title">Part 2. The case of p = 4k + 1.</b> <div class="spoiler_text">  Let <i>p,</i> when divided by 4, give the remainder 1. Denote the first bracket of the theorem by <i>a</i> , the second by <i>b</i> .  We already know that <i>a</i> and <i>b are</i> integers. <br><br>  For the proof, we calculate the following strange value <i>N in</i> two ways: the number of five residues ( <i>x <sub>1</sub> , y <sub>1</sub> , x <sub>2</sub> , y <sub>2</sub> , t</i> ) such that two equations are fulfilled at once: <i>y <sub>1</sub> <sup>2</sup> = x <sub>1</sub> <sup>3</sup> -t ∙ x <sub>1</sub></i> and <i>y <sub>2</sub> <sup>2</sup> = x <sub>2</sub> <sup>3</sup> -t ∙ x <sub>2</sub></i> . <br><br>  In the first method, first fix <i>t</i> and calculate the number of fours of <i>x, y</i> , then add the results for all <i>t</i> .  It is clear that for fixed <i>t the</i> pair ( <i>x <sub>1</sub> , y <sub>1</sub></i> ) can be any non-special point of the curve <i>y <sup>2</sup> = x <sup>3</sup> -t ∙ x</i> , the second couple ( <i>x <sub>1</sub> , y <sub>1</sub></i> ) - just as any non-special point of the same curve, and the total number of such pairs is equal to the square of the number of non-special points.  (Actually, therefore, we consider a strange value, it allows you to get to <i>a <sup>2</sup></i> and <i>b <sup>2.</sup></i> ) If <i>t = 0</i> , then the equation <i>y <sup>2</sup> = x <sup>3</sup></i> , as already mentioned, does not define an elliptic curve and has as many solutions as the equation <i>z <sup>2</sup> = x</i> (where <i>y = z ∙ x</i> ), that is, exactly <i>p</i> .  For <i>t = 1, we</i> get <i>p + 2a</i> solutions, and for <i>t = g</i> - <i>p + 2b</i> solutions.  What about the other <i>t</i> values? <br><br>  If <i>y <sup>2</sup> = x <sup>3</sup> -t ∙ x</i> and <i>c</i> is some non-zero residue, then <i>c <sup>6</sup> y <sup>2</sup> = c <sup>6</sup> x <sup>3</sup> -c <sup>6</sup> t ∙ x</i> , which is equivalent to <i>(c <sup>3</sup> y) <sup>2</sup> = (c <sup>2</sup> x) <sup>3</sup> -c <sup>4</sup> t ∙ (c <sup>2</sup> x)</i> .  In other words, if <i>(x, y)</i> is a solution of an equation with <i>t</i> , then <i>(c <sup>2</sup> x, c <sup>3</sup> y)</i> is a solution of an equation with <i>c <sup>4</sup> t</i> , so the number of solutions with <i>t</i> and <i>c <sup>4</sup> t</i> coincides.  How many different non-zero <i>c <sup>4</sup></i> cuts?  On the one hand, at least <i>(p-1) / 4</i> : <i>(p-1)</i> of <i>c</i> values ​​can “stick together” into groups of no more than 4. On the other hand, if <i>(p-1) / 4</i> is an integer, then all such residues are the roots of the polynomial <i>x <sup>(p-1) / 4</sup> -1</i> , so there cannot be more than <i>(p-1) / 4</i> .  This means that they are exactly <i>(p-1) / 4</i> . <br>  So, the <i>(p-1) / 4</i> curves have <i>p + 2a</i> nonspecial points, and the <i>(p-1) / 4</i> curves have <i>p + 2b</i> nonspecial points.  This is already half of what is needed. <br><br>  If <i>y <sup>2</sup> = x <sup>3</sup> -t ∙ x</i> , then <i>g <sup>3</sup> y <sup>2</sup> = (g ∙ x) <sup>3</sup> - (g <sup>2</sup> t) (g ∙ x)</i> .  For a fixed <i>x, the</i> number of solutions of the equation <i>g <sup>3</sup> y <sup>2</sup> = ...</i> is 2 - the number of solutions of the equation <i>y <sup>2</sup> = ....</i>  This means that the number of non-special points on a curve with <i>t = g <sup>2</sup></i> (and therefore, on <i>(p-1) / 4</i> similar curves) is <i>2p- (p + 2a) = p-2a</i> .  Similarly, the number of non- <i>special</i> points on a curve with <i>t = g <sup>3</sup></i> is <i>2p- (p + 2b) = p-2b</i> . <br><br>  So, the first method of calculation gives <br><img src="https://habrastorage.org/getpro/habr/post_images/b65/2d5/58f/b652d558ff5818491d4e6c3254838b89.gif" alt="N = p ^ 2 + \ frac {p-1} 4 \ cdot (p + 2a) ^ 2 + \ frac {p-1} 4 \ cdot (p + 2b) ^ 2 + \ frac {p-1} 4 \ cdot (p-2a) ^ 2 + \ frac {p-1} 4 \ cdot (p-2b) ^ 2 = p ^ 3 + 2 (p-1) (a ^ 2 + b ^ 2)"><br><br>  In the second method of calculating <i>N,</i> first fix <i>x <sub>1</sub></i> and <i>x <sub>2</sub></i> and count the number of triples <i>t</i> and <i>y</i> , then add the results for all pairs <i>x</i> .  For <i>x <sub>1</sub> = x <sub>2</sub> = 0̅,</i> there are exactly <i>p</i> options: both <i>y</i> must be zeros, <i>t</i> can be any.  When <i>x <sub>1</sub> = 0̅</i> and non-zero <i>x <sub>2</sub></i> should be <i>y <sub>1</sub> = 0</i> , <i>y <sub>2</sub></i> can be anything, <i>t is</i> calculated uniquely, it turns out again <i>p</i> options.  The situation with zero <i>x <sub>2</sub></i> and non-zero <i>x <sub>1 is</sub></i> symmetric.  Finally, let both <i>x be</i> nonzero.  Then <i>t = x <sub>1</sub> <sup>2</sup> - (y <sub>1</sub> <sup>2</sup> / x <sub>1</sub> )</i> and you need to count the number of pairs <i>y</i> with the condition <i>(x <sub>2</sub> / x <sub>1</sub> ) y <sub>1</sub> <sup>2</sup> = y <sub>2</sub> <sup>2</sup> + x <sub>2</sub> (x <sub>1</sub> <sup>2</sup> -x <sub>2</sub> <sup>2</sup> )</i> . <br><br>  If <i>x <sub>1</sub> = x <sub>2</sub></i> , then the equation turns into a condition of coincidence of squares <i>y</i> , and different pairs of <i>y</i> get <i>1 + 2 (p-1)</i> : zero and two options <i>y <sub>2</sub></i> for each non-zero <i>y <sub>1</sub></i> .  If <i>x <sub>1</sub> = -x <sub>2</sub></i> , the situation is similar, since <i>p</i> gives the remainder 1 when divided by 4 and -1 ̅ is a quadratic residue. <br><br>  If <i>x <sub>2</sub> / x <sub>1</sub></i> is a quadratic residue not equal to ± 1̅, then there exists some nonzero <i>c</i> such that <i>c <sup>2</sup> = x <sub>2</sub> / x <sub>1</sub></i> .  Then <i>(c <sup>2</sup> y <sub>1</sub> <sup>2</sup> -y <sub>2</sub> <sup>2</sup> ) = (c ∙ y <sub>1</sub> -y <sub>2</sub> ) (c ∙ y <sub>1</sub> + y <sub>2</sub> ) = x <sub>2</sub> (x <sub>1</sub> <sup>2</sup> -x <sub>2</sub> <sup>2</sup> )</i> , the expression <i>c ∙ y <sub>1</sub> - y <sub>2</sub></i> can be any nonzero residue, it is uniquely determined by <i>c ∙ y <sub>1</sub> + y <sub>2</sub></i> and, therefore, <i>y <sub>1</sub></i> and <i>y <sub>2</sub></i> .  Total <i>p-1</i> options. <br><br>  If <i>x <sub>2</sub> / x <sub>1</sub></i> is a quadratic non-counting, then, similarly to elliptic curves, the number of solutions is <i>2p</i> minus the number of solutions in the case of a quadratic residue, that is, <i>2p- (p-1) = p + 1</i> . <br><br>  Summing up.  There is one option with <i>x <sub>1</sub> = x <sub>2</sub> = 0</i> , giving <i>p</i> solutions.  There are <i>2 (p-1)</i> options, where one of <i>x is</i> zero and the other is non-zero, each of the options gives <i>p</i> solutions.  There are <i>2 (p-1)</i> variants with <i>x <sub>2</sub> = ± x <sub>1</sub></i> , each of which gives <i>2p-1</i> solutions.  There are <i>(p-1) ((p-1) / 2-2)</i> options, where <i>x <sub>1</sub></i> is an arbitrary non-zero residue, and <i>x <sub>2</sub> / x <sub>1</sub></i> is a quadratic residue that differs from ± 1̅, each of these options gives <i>p-1</i> making.  Finally, there are <i>(p-1) <sup>2/2</sup></i> options, where <i>x <sub>1</sub></i> is an arbitrary non-zero residue, and <i>x <sub>2</sub> / x <sub>1</sub></i> is a non-residual quadratic, in each of these options, <i>p + 1</i> solutions.  Total <img src="https://habrastorage.org/getpro/habr/post_images/f8e/3e2/0ae/f8e3e20ae030c37953ed95dfaf063872.gif" alt="N = p ^ 3 + 2p (p-1)">  . <br><br>  Comparison of two expressions for <i>N</i> completes the proof. <br></div></div><br><br><h1>  And here is cryptography? </h1><br>  It is impractical to calculate <i>a</i> and <i>b</i> , counting <i>p</i> times the Legendre symbols.  Much faster with this <a href="http://en.wikipedia.org/wiki/Cornacchia%27s_algorithm">Cornacchia algorithm</a> .  The practical benefit is to use the formula for <i>a, b</i> in the opposite direction: it is possible to prove that the decomposition <i>p = a <sup>2</sup> + b <sup>2 is</sup></i> unique up to a permutation of <i>a</i> and <i>b</i> and a change of signs, so finding <i>a</i> and <i>b</i> leads to knowing the number of points on the curves <i>y <sup>2</sup> = x <sup>3</sup> -t ∙ x</i> for any non-zero <i>t</i> , it will be <i>p + 1 ± 2a</i> and <i>p + 1 ± 2b</i> . <br><br>  Knowing the number of points on a curve is important for cryptography on this curve.  On an elliptic curve, you can enter the operation of adding points (about which, probably, everyone who knows at least something about cryptography) with a special point <i>O</i> in the role of zero.  On the basis of the addition operation, one can determine the multiplication by a natural number: <i>2P = P + P</i> , <i>3P = P + P + P,</i> and so on.  So, we can prove that if <i>n</i> is the order of a curve, then <i>nP = O</i> for any point <i>P.</i>  Knowing <i>n, c, d</i> , one can solve equations of the form <i>x ∙ (cP) = dP is</i> completely analogous to the division of residues: the advanced Euclidean algorithm finds <i>x, y</i> such that <i>c ∙ x + n ∙ y = 1</i> , whence <i>x ∙ (cP) + y ∙ (nP) = P</i> , that is, <i>x ∙ (cP) = P.</i>  Moreover, if <i>c, d are</i> unknown, and <i>cP</i> and <i>dP are</i> given by coordinates, then effective division methods are generally unknown. <br><br>  It is quite difficult to calculate the number of points on a given curve (a polynomial algorithm exists, but in practice it is rather slow).  To build a curve with some properties on the number of points, you can try to take random coefficients and calculate the number of points in the cycle until you get what you need, but you have to wait.  Fortunately, there is another way. <br><br>  If we are satisfied with a prime number of the form <i>4k + 1</i> and a special curve of the form <i>y <sup>2</sup> = x <sup>3</sup> -t ∙ x</i> (in some sense this is the same curve for any nonzero <i>t</i> ) with the number of points <i>p + 1 ± 2a</i> or <i>p + 1 ± 2b</i> , you can take it.  What about the other curves? <br><br>  A little later, in 1911, another author, <a href="http://www.digizeitschriften.de/dms/resolveppn/%3FPPN%3DGDZPPN002167476">von Schrutka, obtained a similar result</a> for curves of the form <i>y <sup>2</sup> = x <sup>3</sup> -t</i> , simple ones of the form <i>6k + 1</i> , and representations <i>p = a <sup>2</sup> + 3b <sup>2</sup></i> .  So, the Cornacchia algorithm allows to find the number of points on the curve <i>y <sup>2</sup> = x <sup>3</sup> -t</i> . <br><div class="spoiler">  <b class="spoiler_title">A couple of words about the evidence</b> <div class="spoiler_text">  The proof as a whole is similar to the above, only there are three numbers <i>a, b <sub>1</sub> , b <sub>2</sub></i> for <i>t = 1, g <sup>2</sup> , g <sup>4</sup></i> , where <i>g is</i> not a cube, their sum is zero, and the sum of squares is calculated.  After simple transformations get what you need. </div></div><br><br>  Later, as the theory of elliptic curves developed, it turned out that if there is some representation <i>4p = a ' <sup>2</sup> + d ∙ b' <sup>2</sup></i> , where <i>d is</i> natural, when divided by 4, it gives the remainder 0 or 3, mutually simple with <i>p</i> and not too large, it is possible to effectively (even if <i>p is</i> very large) to construct a curve that will have exactly <i>p + 1 ± a '</i> points.  The two smallest values <i>d</i> = 3 and <i>d</i> = 4 correspond to the curves <i>y <sup>2</sup> = x <sup>3</sup> -t</i> and <i>y <sup>2</sup> = x <sup>3</sup> -t x</i> .  Example for <i>d = 163</i> : <br><img src="https://habrastorage.org/getpro/habr/post_images/c65/22b/194/c6522b1948684edfba8ca732ace1dd73.gif" alt="y ^ 2 = x ^ 3- (2 ^ 4 \ cdot5 \ cdot23 \ cdot29 \ cdot163) x + (2 \ cdot7 \ cdot11 \ cdot19 \ cdot127 \ cdot163 ^ 2)"><br>  For odd <i>p ≠ 163,</i> this equation defines an elliptic curve.  If <i>4p can be</i> represented as <i>a ' <sup>2</sup> + 163b' <sup>2</sup></i> with integers <i>a ', b'</i> , then the number of points on an elliptic curve is <i>p + 1 ± a '</i> .  If not, then <i>p + 1</i> .  Unfortunately, the proof uses a "heavy" theory, so there will not even be hints here. <br>  Usually, however, radicals will be obtained.  For example, for <i>d = 15</i> : <img src="https://habrastorage.org/getpro/habr/post_images/cb7/3ae/42d/cb73ae42d5cbd345ee043a133cb20507.gif" alt="y ^ 2 = x ^ 3 + \ left (21 \ cdot \ frac {1+ \ sqrt5} {2} -3 \ right) x- \ left (28 \ cdot \ frac {1+ \ sqrt5} {2} + 42 \ right)">  .  If <i>4p</i> decomposes into a sum <i>a ' <sup>2</sup> + d ∙ b' <sup>2</sup></i> and <i>p is</i> mutually simple with <i>d</i> , then all radicals are necessarily extracted (for example, for <i>d = 15</i> there is necessarily a residue <i>c</i> , for which <i>c <sup>2</sup> = 5̅</i> ) and we get an elliptic curve with the required number of points. <br></div><p>Source: <a href="https://habr.com/ru/post/189618/">https://habr.com/ru/post/189618/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../189606/index.html">Control your website with the new monitoring service from REG.RU</a></li>
<li><a href="../189610/index.html">The phrase "perezalil on habrastorage" loses its meaning</a></li>
<li><a href="../189612/index.html">Like spawns like: what affects the rating on the Internet</a></li>
<li><a href="../189614/index.html">mySQLgame 2.0</a></li>
<li><a href="../189616/index.html">Another way to control the fan in Linux (for example, Acer S3-391)</a></li>
<li><a href="../189624/index.html">First impressions: Windows Server 2012 R2 Hyper-V in all its glory</a></li>
<li><a href="../189626/index.html">Expert evaluation methods</a></li>
<li><a href="../189628/index.html">Nokia HERE LivingCities</a></li>
<li><a href="../189630/index.html">Development methodology on 1C-Bitrix - the experience of a fool</a></li>
<li><a href="../189634/index.html">LSI Nytro MegaRAID NMR8100-4i in action</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>