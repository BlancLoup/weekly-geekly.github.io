<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>A small story about the study of a single botnet</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="For several years now, there has been a trigger on our website that triggers on a certain combination of words in queries, in particular, such as: uni...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>A small story about the study of a single botnet</h1><div class="post__text post__text-html js-mediator-article">  For several years now, there has been a trigger on our website that triggers on a certain combination of words in queries, in particular, such as: union, eval, passthru, alert, javascript, cookie, etc.  In the event of a trigger, soap is sent.  This allows you to see the majority of attempts to make SQL injection, use PHP include or XSS.  Hacking attempts are carried out quite often, but in the last month of reports about a hundred per day began to arrive.  All the same type.  We are looking for a vulnerability in some kind of standard contact module, in which, as I understand it, there is a pseudo tag [php] with all the consequences.  The exploit, using this pseudo-tag, is trying to upload a Perl script to the server of the victim and transfer control to it.  <a href="http://place.ifolder.ru/18535095">Here</a> you can find a list of links to bots (these are text files with Perl code), although some files are already worn out.  The exploits are different and try to download different bots, perhaps from different groups, antivirus is triggered on some of these bots and silently deletes.  The code is safer to download using rocking, and not through the browser.  Accordingly, if the code runs on the victim's server (basically, this is a regular web server on a cheap hosting with a million sites), the bot immediately connects to the IRC channel, where it is already waiting.  After downloading one of the bots at random, I decided to see <a name="habracut"></a>  as it is, everything is arranged there. <br><br><h1>  Bot </h1><br>  From a quick glance at the file, it is clear that in the settings of this bot, the admin who has the right to work with bots is the person with the login Conficker.  The bot immediately connects to the IRC server: irc.planetwork.tk:6667, on the #autorun channel.  The bots have several logins to choose from ( <a href="http://place.ifolder.ru/18535127">all women seem to be</a> ).  I decided not to think too long and logged in under the admin nickname.  But here with me a bad service was played by one little-known service for storing photos and instead of the correct nickname, I logged in as Conflicker.  But I noticed this not immediately and at first I tried to steer some of the bots with a quite expected result.  On the main channel, there were about 120 bots, some of them crawled websites for vulnerabilities and periodically wrote the results in a general chat.  From time to time they found different vulnerabilities, in particular SQL Injection, with which, apparently, people will already have to deal with manually.  Search for victims is standard, through search engines.  I tried to give commands to the bots via chat, but only the PING test worked, as this did not require any login.  And here I was very surprised by the channel administrator. <br><br><h1>  Some years ago </h1>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      A little way aside, I want to talk about how I ‚Äúresearched‚Äù one of the botnets a couple of years ago.  The story is quite short, I just went to the channel, the channel administrator opened the chat and the first thing I did was ls ‚Äìal.  Accordingly, having repeated the operation on one of our servers in a meaningless directory, I threw back the list of files (the real bot had to do the same, but somewhat quicker).  Thus, acting as a proxy, I downloaded the rest of the botnet files (unfortunately, the compiled httpd was the basis).  Realizing that I couldn‚Äôt squeeze more, I simply said ‚Äúhi‚Äù to one of the queries, asked how are you, got the answer that this was some kind of mistake, my interlocutor was by chance at all, was kicked out of the channel and banned. <br><br><h1>  Bot  Continuation </h1><br><br>  I expected something similar here, in case they consider me a person.  But the administrator, having seen the login Conflicker, said ‚Äúwow‚Äù and gave me an op.  Since I‚Äôm not particularly keen on IRC, I just thought that it‚Äôs a good time to just kick the admin from the channel and, changing my login, take his place, but so far I have decided not to do anything.  It took some time to research the possibility of changing the nickname so that the bots would perceive me as an admin.  And then a miracle happened - Conficker wrote that he needed to reboot and fell off.  By changing my login to Conficker, I got full access. <br><br><h1>  What managed to find out and some thoughts </h1><br><br>  There are two types of bots: <br>  - ‚Äúnewbie‚Äù, he submits to the administrator without question and, I think, serves mainly to download bots of the second type.  A team written in the chat of such a bot will be executed on the server as if it were typed in the terminal, the result will also be displayed in the terminal; <br>  - ‚ÄúWorker‚Äù; here the administrator needs to enter a password for more or less important operations.  However, the `` help 'command works for everyone in general. <br><br>  The body of the "worker" was able to download.  The main functions are to check other sites for vulnerabilities, DDoS, download exploits from the service, etc.  In this version of the login bot, there were already two: Conficker and ikhy (the second login really did not work for everyone).  Password dor.  After the command ‚Äú` auth dor ‚Äùin the chat with a specific bot (in the general channel it is better not to do this), extended help appears and access to all commands. <br><br>  If you select a login from the ‚Äúnewbie‚Äù bot predefined by the bot, add a random number to the end and then go to the IRC server, the channel #bajinganIRCD automatically opens.  How it all looks (I logged in as ‚ÄúSylvie-12‚Äú) can be seen in the screenshot. <br><br> <a title="IRC" href=""><img src="https://habrastorage.org/storage/habraeffect/c0/0f/c00f26ce9e538339167680d7ee25587a.jpg"></a> <br><br>  The body of the ‚Äúworker‚Äù lies in /temp/.logs. <br><br>  ‚ÄúWork‚Äù started with ‚Äúapache‚Äù rights. <br><br>  To steal such a botnet is not difficult.  Firstly, all the ‚Äúworkers‚Äù have the same password.  It is enough to get the body of one of them (you can sit and pens to emulate a "newbie" or use a honeypot), rewrite, putting a trigger on the administrator's output from the channel, change your nickname to the rest of the herd to the new server when you exit.  Secondly, in this particular case, just wait, as the administrator constantly falls off.  Another thing is why it is needed. <br><br>  Actually on this my curiosity dried up.  If someone is interested in picking up a botnet, then at the moment it works and the passwords, I think, no one has changed. </div><p>Source: <a href="https://habr.com/ru/post/99169/">https://habr.com/ru/post/99169/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../99163/index.html">openSUSE 11.3 "Teal"</a></li>
<li><a href="../99164/index.html">Linux fdisk and partition alignment on SDD and Advanced Format HDD</a></li>
<li><a href="../99165/index.html">Cement for castles in the ‚Äúclouds‚Äù: how we learned to sell SaaS</a></li>
<li><a href="../99167/index.html">Competition "System Administrator - 2010"</a></li>
<li><a href="../99168/index.html">Copper Wire Braided Characters</a></li>
<li><a href="../99170/index.html">Apple iOS 4.1 beta 1</a></li>
<li><a href="../99174/index.html">Quick steps to display data in PivotViewer and Silverlight</a></li>
<li><a href="../99178/index.html">What do I miss in Yandex.Direct?</a></li>
<li><a href="../99179/index.html">Video glasses from "Masterkita"</a></li>
<li><a href="../99182/index.html">Writing a desktop widget under Maemo5 on Qt. Part two and final</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>