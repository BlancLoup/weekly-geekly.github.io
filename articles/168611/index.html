<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Multi-armed bandits: introduction and algorithm of UCB1</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="This is the first post from the blog Surfingbird , which I bring to the general hubs of algorithms and artificial intelligence; To be honest, I simply...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Multi-armed bandits: introduction and algorithm of UCB1</h1><div class="post__text post__text-html js-mediator-article">  This is the first post from the <a href="http://habrahabr.ru/company/surfingbird/blog/">blog Surfingbird</a> , which I bring to the general hubs of algorithms and artificial intelligence;  To be honest, I simply did not guess before.  If you are interested, come to us to read the previous texts - I do not know what will happen if you simply add new hubs to posts several months old. <br><br>  Summary of previous series of recommender systems: <ul><li>  <a href="http://habrahabr.ru/company/surfingbird/blog/139022/">recommender systems: problem statement</a> ; </li><li>  <a href="http://habrahabr.ru/company/surfingbird/blog/139518/">user-based and item-based collaborative filtering</a> ; </li><li>  <a href="http://habrahabr.ru/company/surfingbird/blog/139863/">SVD, Part I</a> ; </li><li>  <a href="http://habrahabr.ru/company/surfingbird/blog/140555/">SVD and basic predictors</a> ; </li><li>  <a href="http://habrahabr.ru/company/surfingbird/blog/141959/">SVD on Perl</a> ; </li><li>  <a href="http://habrahabr.ru/company/surfingbird/blog/143455/">overfitting and regularization</a> ; </li><li>  <a href="http://habrahabr.ru/company/surfingbird/blog/150207/">Bayes theorem and naive Bayes</a> ; </li><li>  <a href="http://habrahabr.ru/company/surfingbird/blog/150607/">LDA (Latent Dirichlet allocation, thematic modeling)</a> . </li></ul><br><br>  This time we are starting a new topic - about multi-armed bandits.  Bandits are the simplest, but this only makes the task more important in the so-called <i>reinforcement training</i> ... 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <img src="https://habrastorage.org/getpro/habr/post_images/b90/918/593/b9091859369a5c9dba5c6ebae378e6cd.png"><br><a name="habracut"></a><br>  We always say that what we do is machine learning.  But think about it: how do you actually learn?  Do we build a regression of the movement of the fingers on the basis of observations of typists in order to learn the blind typing?  Does a child, in order to learn how to walk, first collects and summarizes a collection of examples of upright walking of parents?  In fact, of course, not: in such cases, we just try to do something, see if it worked out, and then try (usually unconsciously) to correct our behavior based on the result. <br><br>  Such a statement of the problem is called <i>learning with reinforcement</i> : there is an agent who acts in an environment;  the agent tries to do something, and the environment in response to his actions gives the agent buns or, conversely, beats him with current.  The agent is trying to get more buns, and a little less current.  In general, a typical mouse in the maze. <br><br>  Today, however, we will talk about a mouse that did not even get into the maze, but into the most common <a href="http://en.wikipedia.org/wiki/Operant_conditioning_chamber">skinner box</a> - let's assume that the state of the environment / agent does not change from action to action.  In other words, the agent has a certain set of possible actions, the agent chooses one of them, gets some reward for it (which is a random variable), and then can again choose from the same actions.  In machine learning, such a task is called <i>multi-armed bandits</i> : you are sitting in a room in front of several slot machines and must try to win as much as possible. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/d34/a28/370/d34a283706fbbedafaadbef7d8ac0838.jpg"><br>  (picture from <a href="http://research.microsoft.com/en-us/projects/bandits/">Microsoft Research</a> ) <br><br>  Why is this needed in real life?  For example, imagine that you are a Yahoo!  or, say, mail.ru.  You have a homepage with millions of people every day.  You want to place links on it so that people click on them as often as possible.  How to choose those links that give the maximum CTR (click-through ratio)?  Here, each display of the link to the user corresponds to ‚Äúpull the handle‚Äù;  each click - success, positive reinforcement from the environment;  no-click is bad luck.  The task of the algorithm will be to understand as quickly as possible that this or that news is ‚Äúhot‚Äù, and start to show it (yes, this is a slightly modified task, in which gangsters from time to time die and are born again). <br><br>  Another example: imagine that you want to test a set of changes in the interface of your site.  This is usually done with the help of the so-called A / B testing - you must select a group for the experiment (for each change separately), a control group for which nothing will change, then collect statistics and assess whether the improvement is significant.  However, such a scheme in itself does not answer the main question - how long should statistics be collected?  Here, gangsters can also come to the rescue, the statement of the problem is exactly gangster: showing one option or another corresponds to jerking the handle, and the user's actions determine the response of the environment (see, for example, <a href="http://untyped.com/untyping/2011/02/11/stop-ab-testing-and-make-out-like-a-bandit/">this post</a> ). <br><br>  But back to the statement of the problem.  At first glance, it seems that the task of choosing the optimal handle is very simple: you need to pull each handle a thousand times, and then choose the handle with the highest average.  Indeed, such an algorithm will most likely make the right choice - but how much money it will lose on the suboptimal pens!  Many of these losses could have been avoided.  In general, the best metric for assessing the quality of the ‚Äúgangster‚Äù algorithm is its loss (regret) compared with the optimal algorithm, i.e.  the expectation of the difference in income from the "always pull the optimal handle" strategy and the strategy under consideration. <br><br>  As an example, I will immediately cite an algorithm with one of the best guarantees for this very measure of training losses.  This is the UCB1 algorithm;  the algorithm itself is very simple, the proof of its optimality, of course, is not so simple, but we will not go into this, and I‚Äôm referring to those interested in the article [ <a href="http://moodle.technion.ac.il/pluginfile.php/192340/mod_resource/content/0/UCB.pdf">Auer et al., 2002</a> ];  You can also find a more ‚Äúadvanced‚Äù version with improved constants. <br><br><ul><li>  Initialization: pull each handle once. </li><li>  While the work continues: <br><ul><li>  pull the handle j, for which the maximum value <br><img src="https://habrastorage.org/getpro/habr/post_images/979/478/120/979478120f7e7588c5dad40d61e97d04.png" alt="image">  , <br>  Where <img src="https://habrastorage.org/getpro/habr/post_images/118/9a4/2bc/1189a42bc85a58c787af60c167ffca02.png" alt="image">  - the average income from the handle j, n <sub>j</sub> - how many times we pulled the handle j, and n - how many times we pulled all the handles. </li></ul></li></ul><br><br>  Although the formal proof that there should be two natural logarithms here, and not something else, is beyond the scope of this article, it is intuitively clear what happens in this algorithm: we came up with heuristics, the priority estimate we choose, beyond which handle to pull.  It is logical that this priority is greater, the greater the average income, but not only: those pens, for which we pulled rarely (compared to other pens), also receive a bonus.  Since the numerator of a fraction grows much slower than the denominator, with <img src="https://habrastorage.org/getpro/habr/post_images/9f3/c67/09a/9f3c6709a46d7420c128ac57c3377be7.png" alt="image">  Heuristics are becoming more and more like a simple choice of a pen with an optimal average.  However, if one of the n is completely stops growing (we are completely disappointed in one of the pens), sooner or later even the logarithmic numerator will force us to double-check it. <br><br>  The implementation of this algorithm in your favorite language, of course, presents no difficulties - you just need to memorize how many times you pull each pen.  The main pathos here is that such a simple heuristic works well: you can simply choose the handle with the highest priority and not pay attention to anything else.  This is related to the so- <a href="http://www.mit.edu/~jnt/Papers/J048-94-jnt-gittins.pdf">called Gittins theorem</a> : it turns out that, under fairly general assumptions, the choice of the optimal strategy in the problem of multi-armed thugs boils down to counting independent priorities for each handle separately.  True, the Gittins theorem in itself gives only an extremely complex and slow algorithm for calculating these priorities (the so-called <i>Gittins indices</i> ), and the UCB algorithm is not just a special case of the general theorem, but a separate result. <br><br>  In the next series, we will continue to look at the ‚Äúgangster‚Äù tasks and summarize them to the tasks of following the trends, when the incomes of different ‚Äúpens‚Äù can change over time, and our task is to quickly understand what has changed. </div><p>Source: <a href="https://habr.com/ru/post/168611/">https://habr.com/ru/post/168611/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../168601/index.html">PostgreSQL 9.2 Start!</a></li>
<li><a href="../168603/index.html">Microsoft accuses Google of reading user letters</a></li>
<li><a href="../168605/index.html">Mini flowmaster overview</a></li>
<li><a href="../168607/index.html">Death Package for Intel Network Cards</a></li>
<li><a href="../168609/index.html">Solar System Roadmap</a></li>
<li><a href="../168613/index.html">Critical vulnerability in many routers of various vendors</a></li>
<li><a href="../168615/index.html">FasterN9 for Nokia N9 (MeeGo Harmattan): improving the responsiveness of the interface</a></li>
<li><a href="../168617/index.html">Ubuntu Phone will be available in October 2013</a></li>
<li><a href="../168621/index.html">Raspberry Pi + Siri = voice home control</a></li>
<li><a href="../168625/index.html">Survey on the October release of Ubuntu Phone</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>