<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>?.: when properties in C # can be null</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="The more I write in C # 6, the more convinced I am how much the operator is ?. ( null coalescing operator ) helps to write clean, simple and clear cod...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>?.: when properties in C # can be null</h1><div class="post__text post__text-html js-mediator-article"> The more I write in C # 6, the more convinced I am how much the operator is <code>?.</code>  ( <i>null coalescing operator</i> ) helps to write clean, simple and clear code.  Today I will show 4 situations in which he can be very useful. <br><br><h3>  Large nesting </h3>  Consider the following problem.  There is a supplier, the supplier has a contact person, the contact person has a home address, the home address has the first line, and we want to find this very first line.  Previously, I would have to write code with a high level of nesting, checking for <code>null</code> each value in the chain: <br><br><pre> <code class="hljs cs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> location = <span class="hljs-keyword"><span class="hljs-keyword">default</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">string</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vendor != <span class="hljs-literal"><span class="hljs-literal">null</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vendor.ContactPerson != <span class="hljs-literal"><span class="hljs-literal">null</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vendor.ContactPerson.HomeAddress != <span class="hljs-literal"><span class="hljs-literal">null</span></span>) { location = vendor.ContactPerson.HomeAddress.LineOne; } } }</code> </pre><br>  But now we have C # 6, with it the code can be given in a much more readable form: 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <pre> <code class="hljs swift"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> location = vendor?.<span class="hljs-type"><span class="hljs-type">ContactPerson?</span></span>.<span class="hljs-type"><span class="hljs-type">HomeAddress?</span></span>.<span class="hljs-type"><span class="hljs-type">LineOne</span></span>;</code> </pre><br>  Operator <code>?.</code>  makes it so that as soon as one of the properties of the chain is <code>null</code> , no further evaluation of the expression will be performed.  Let's see some more examples. <a name="habracut"></a><br><br><h3>  INotifyPropertyChanged and related APIs </h3>  We all have seen classes that implement the <code>INotifyPropertyChanged</code> interface.  In them you can find the following properties: <br><br><pre> <code class="hljs pgsql"><span class="hljs-built_in"><span class="hljs-built_in">public</span></span> string <span class="hljs-type"><span class="hljs-type">Name</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-type"><span class="hljs-type">name</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">set</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-type"><span class="hljs-type">name</span></span> != <span class="hljs-keyword"><span class="hljs-keyword">value</span></span>) { <span class="hljs-type"><span class="hljs-type">name</span></span> = <span class="hljs-keyword"><span class="hljs-keyword">value</span></span>; PropertyChanged(this, <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> PropertyChangedEventArgs("Name")); } } } private string <span class="hljs-type"><span class="hljs-type">name</span></span>;</code> </pre><br>  Noticed something was wrong?  The code will fail if the <code>INotifyPropertyChanged.PropertyChanged</code> event <code>INotifyPropertyChanged.PropertyChanged</code> no subscribers.  In this situation, many developers begin to write like this: <br><br><pre> <code class="hljs pgsql"><span class="hljs-built_in"><span class="hljs-built_in">public</span></span> string <span class="hljs-type"><span class="hljs-type">Name</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-type"><span class="hljs-type">name</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">set</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-type"><span class="hljs-type">name</span></span> != <span class="hljs-keyword"><span class="hljs-keyword">value</span></span>) { <span class="hljs-type"><span class="hljs-type">name</span></span> = <span class="hljs-keyword"><span class="hljs-keyword">value</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (PropertyChanged != <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>) PropertyChanged(this, <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> PropertyChangedEventArgs("Name")); } } } private string <span class="hljs-type"><span class="hljs-type">name</span></span>;</code> </pre><br>  Okay, it's a bit better.  It is possible that this code will work in most cases.  However, nobody canceled the race condition: if the subscriber unsubscribes from the event at the moment after we check <code>PropertyChanged != null</code> , but before <code>PropertyChanged</code> called, the program will still crash.  And it will happen at the most inopportune moment in a few months after installing the application on the client.  Let's fix this annoying problem: save the reference to <code>PropertyChnaged</code> in a local <code>handler</code> variable, check it for <code>null</code> , and then work with this local variable, and not with the <code>PropertyChnaged</code> public event: <br><br><pre> <code class="hljs pgsql"><span class="hljs-built_in"><span class="hljs-built_in">public</span></span> string <span class="hljs-type"><span class="hljs-type">Name</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-type"><span class="hljs-type">name</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">set</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-type"><span class="hljs-type">name</span></span> != <span class="hljs-keyword"><span class="hljs-keyword">value</span></span>) { <span class="hljs-type"><span class="hljs-type">name</span></span> = <span class="hljs-keyword"><span class="hljs-keyword">value</span></span>; var <span class="hljs-keyword"><span class="hljs-keyword">handler</span></span> = PropertyChanged; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">handler</span></span> != <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">handler</span></span>(this, <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> PropertyChangedEventArgs("Name")); } } } private string <span class="hljs-type"><span class="hljs-type">name</span></span>;</code> </pre><br>  Oh, the code has become a lot, it is difficult to remember all this and call <code>PropertyChanged</code> correctly every time.  In a large program, someone somewhere will surely forget to do all the checks.  What to do?  <b>C # 6 will save us!</b>  All our checks are easy to replace with the operator <code>?.</code>  and calling the invoke method: <br><br><pre> <code class="hljs pgsql"><span class="hljs-built_in"><span class="hljs-built_in">public</span></span> string <span class="hljs-type"><span class="hljs-type">Name</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-type"><span class="hljs-type">name</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">set</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-type"><span class="hljs-type">name</span></span> != <span class="hljs-keyword"><span class="hljs-keyword">value</span></span>) { <span class="hljs-type"><span class="hljs-type">name</span></span> = <span class="hljs-keyword"><span class="hljs-keyword">value</span></span>; PropertyChanged?.Invoke(this, <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> PropertyChangedEventArgs("Name")); } } } private string <span class="hljs-type"><span class="hljs-type">name</span></span>;</code> </pre><br>  The code is shorter, easier to read, all necessary checks are performed, there are no problems. <br><br><h3>  Resource management </h3>  And now this situation: there is an object of some type, the description of which we know.  It is necessary to understand that this object can implement interfaces about which the type is not known.  This is usually not a problem, but what if the object implements <code>IDisposable</code> .  Imagine the evil genius who decided to retire one of his minions.  The corresponding code will look like this: <br><br><pre> <code class="hljs cs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">RetireHenchman</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> disposableMinion = Minion <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> IDisposable; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (disposableMinion != <span class="hljs-literal"><span class="hljs-literal">null</span></span>) disposableMinion.Dispose(); Minion = <span class="hljs-literal"><span class="hljs-literal">null</span></span>; }</code> </pre><br>  Operator <code>?.</code>  again will help improve the quality of our code: <br><br><pre> <code class="hljs cs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">RetireHenchman</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { (Minion <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> IDisposable)?.Dispose(); Minion = <span class="hljs-literal"><span class="hljs-literal">null</span></span>; }</code> </pre><br><h3>  LINQ queries </h3>  I found two cases where the operator <code>?.</code>  may be useful in LINQ queries.  Case one: I want to create a query using the <code>SingleOrDefault()</code> method, and the resulting object (if it exists) access some property.  There is nothing easier: <br><br><pre> <code class="hljs javascript"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> created = members.SingleOrDefault(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">e</span></span></span><span class="hljs-function"> =&gt;</span></span> e.name == <span class="hljs-string"><span class="hljs-string">"dateCreated"</span></span>)?.content;</code> </pre><br>  Case two: I want to return <code>null</code> if the source sequence is <code>null</code> : <br><br><pre> <code class="hljs javascript">members?.Select(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">m</span></span></span><span class="hljs-function"> =&gt;</span></span> (XElement)XmlValue.MakeValue(m))</code> </pre><br><h3>  Conclusion </h3>  Adding the considered operator made me realize how often <code>null</code> checks are found and how shorter and more readable the code can be made using the new syntax.  Thanks <code>?.</code>  I began to write code differently.  I can‚Äôt wait for the final release of C # 6 to be released so that I can give my customers a new version of the source code. </div><p>Source: <a href="https://habr.com/ru/post/252099/">https://habr.com/ru/post/252099/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../252079/index.html">DuoCode: we translate C # in JavaScript</a></li>
<li><a href="../252083/index.html">GoogleFit API - start and see the result</a></li>
<li><a href="../252085/index.html">Course young fighter. Practical course on Cisco Packet Tracer</a></li>
<li><a href="../252091/index.html">Internet security: are users ready to counter cyber threats?</a></li>
<li><a href="../252095/index.html">The vulnerability of the "thumb": I hack your finger on the photo</a></li>
<li><a href="../252101/index.html">Documenting code efficiently with Doxygen</a></li>
<li><a href="../252103/index.html">Saga of E_RPC_DISCONNECT</a></li>
<li><a href="../252105/index.html">Different versions of JIT in .NET</a></li>
<li><a href="../252109/index.html">The announcement of the free game engine Source 2, as well as Steam Link, the release date of Steam Machines</a></li>
<li><a href="../252115/index.html">How we provided communication at the largest airports</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>