<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Critical 0day vulnerability detected in all versions of MS Word</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="McAfee and FireEye reported detecting a real attack on Microsoft Word users through a new 0day vulnerability, for which no patch has yet been released...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Critical 0day vulnerability detected in all versions of MS Word</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/files/a36/0b9/f4f/a360b9f4f2834a81ba08c9cb337fca7b.png" align="left">  McAfee and FireEye reported detecting a real attack on Microsoft Word users through a new 0day vulnerability, for which no patch has yet been released.  The vulnerability allows you to silently execute arbitrary code on the victim‚Äôs computer and install malicious software.  What is most unpleasant, all versions of MS Word on all versions of Windows are vulnerable, including the latest version of Office 2016 for Windows 10, even with macros disabled. <br><br>  Microsoft is notified of the vulnerability and should have time to prepare a patch for the security update Patch Tuesday, which will be held tomorrow, April 11.  However, as the story shows with a similar 0day vulnerability CVE-2014-4114 / 6352 (aka Sandworm), Microsoft is not always able to close 0day from the first patch. <br><a name="habracut"></a><br>  McAfee researchers <a href="https://securingtomorrow.mcafee.com/mcafee-labs/critical-office-zero-day-attacks-detected-wild/">write</a> that they discovered the first attacks using this 0day in January of this year.  Apparently, they only recently received samples of malicious code, so that they were able to analyze in detail the mechanism of infection. <br><br>  During the attack, Word files are used (specifically, RTF documents with the .doc extension). 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      If <a href="https://support.office.com/en-us/article/What-is-Protected-View-d6f09ac7-e6b9-4495-8e43-2bbcdbcb6653">Office Protected View is</a> disabled in Microsoft Word, then when you open the document, the exploit starts automatically.  After this, the winword.exe process makes an HTTP request to the remote server, from where it downloads the HTA file (HTML application), disguised as an RTF document.  The HTA file is automatically launched and executes a malicious script.  This script closes the original infected Word file, and instead it shows the user a fake text document.  The original winword.exe process closes to hide the window that OLE2Link displays from the user.  At the same time, the script downloads additional malicious code from a remote server for installation on a computer. <br><br>  Using the .hta version, the McAfee researchers write, the authors of the exploit effectively bypass all the memory protection measures implemented by Microsoft, as well as anti-virus protection and most other protection methods. <br><br>  Here is a fragment of communication with the server: <br><br><img src="https://habrastorage.org/getpro/geektimes/post_images/6ba/e75/912/6bae7591253b2782132d35acf8cbf30d.png"><br><br>  The HTA is masked as an RTF document to bypass antivirus programs, if they are installed on the victim‚Äôs computer.  At the bottom of this document are malicious Visual Basic scripts that do all the work. <br><br><img src="https://habrastorage.org/getpro/geektimes/post_images/bba/eca/bf1/bbaecabf1343bc2080f72b0ccab78200.png"><br><br>  McAfee experts write that this 0day vulnerability is related to the operation of Object Linking and Embedding (OLE), an important part of the Office functionality that actually allows you to embed some documents inside others.  This feature has been used repeatedly for various attacks.  For example, back in 2015, the same McAfee experts prepared a <a href="https://www.blackhat.com/docs/us-15/materials/us-15-Li-Attacking-Interoperability-An-OLE-Edition.pdf">presentation</a> for the hacker conference Black Hat USA, in which they talked about possible attack vectors through OLE. <br><br>  Employees of FireEye <a href="https://www.fireeye.com/blog/threat-research/2017/04/acknowledgement_ofa.html">claim</a> that they discovered this vulnerability before McAfee and were the first to send a message to Microsoft, but remained silent until the patch was released.  After publishing the post on the McAfee blog, it makes no sense to remain silent, so they also reported on what they managed to understand after analyzing this exploit. <br><br>  In FireEye products, malicious documents are defined as Malware.Binary.Rtf. <br><br>  Security Specialist Mikko Hipponen <a href="https://twitter.com/mikko/status/851454200747880448">has learned</a> that Microsoft will definitely release a patch for this vulnerability to the nearest Patch Tuesday, that is, tomorrow, April 11, 2017. <br><br><div class="oembed"><twitter-widget class="twitter-tweet twitter-tweet-rendered" id="twitter-widget-0" style="position: static; visibility: visible; display: block; transform: rotate(0deg); width: 500px; margin: 10px auto; max-width: 100%; min-width: 220px;" data-tweet-id="851454200747880448"></twitter-widget><script async="" src="//platform.twitter.com/widgets.js" charset="utf-8"></script></div><br>  Before installing the patch, you can block the RTF in the registry <a href="https://twitter.com/ryHanson/status/851159178416496640">in this way</a> : set the value in the registry <br>  <code>Software\Microsoft\Office\15.0\Word\Security\FileBlock\RtfFiles</code> to 2, and <code>OpenInProtectedView</code> to 0. In this case, when you try to open an RTF file, this message will appear: <br><br><img src="https://habrastorage.org/getpro/geektimes/post_images/662/356/6ed/6623566ed8142fc92547ed4c66ab268f.jpg"><br><br>  By the way, this is a recommendation from Ryan Hanson (Ryan Hanson), who <a href="https://twitter.com/ryHanson/status/851148431691096064">claims</a> that it was he who discovered this 0day in July, and reported it in October 2016.  And now it was announced by unauthorized persons.  If he is telling the truth, then Microsoft really closes critical vulnerabilities for a very long time. <br><br><div class="oembed"><twitter-widget class="twitter-tweet twitter-tweet-rendered" id="twitter-widget-1" style="position: static; visibility: visible; display: block; transform: rotate(0deg); width: 500px; margin: 10px auto; max-width: 100%; min-width: 220px;" data-tweet-id="851148431691096064"></twitter-widget><script async="" src="//platform.twitter.com/widgets.js" charset="utf-8"></script></div><br>  But tests showed that when an Office Protected View is opened in protected mode, the exploit cannot start for execution, so blocking the RTF is an extreme measure. <br><br>  In any case, all users of Microsoft Office in the near future are strongly recommended: <br><br><ul><li>  Do not open any Office documents from unreliable sources. </li><li>  Enable Office Protected View protection. </li></ul><br><img src="https://habrastorage.org/getpro/geektimes/post_images/b4b/de8/be9/b4bde8be90dacbeea6aba42bc1b417a0.jpg"><br><br>  Anti-virus companies do not say who was the victim of attacks.  But from past experience it is known that such 0day is often used in targeted attacks by state order.  It's strange that Microsoft has been working on the patch for so long. </div><p>Source: <a href="https://habr.com/ru/post/403085/">https://habr.com/ru/post/403085/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../403075/index.html">Thermal imager in the DI HALT workshop</a></li>
<li><a href="../403077/index.html">Rappers from Russia require Yandex 5.4 million rubles for copyright infringement</a></li>
<li><a href="../403079/index.html">FDA allowed 23andMe to show risks of ten diseases</a></li>
<li><a href="../403081/index.html">In Irkutsk, launched a non-cash payment of travel in public transport</a></li>
<li><a href="../403083/index.html">NASA has published pictures of auroras on Uranus</a></li>
<li><a href="../403087/index.html">How to open your bank in Europe: reporting and auditing</a></li>
<li><a href="../403091/index.html">What can be heard for 450 rubles?</a></li>
<li><a href="../403093/index.html">Tesla Inc. has become the most expensive car manufacturer in the USA</a></li>
<li><a href="../403097/index.html">Prospects for transport: cars that are no longer alike</a></li>
<li><a href="../403099/index.html">Microsoft has completed support for Windows Vista</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>