<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>How I tamed Windows Update and got an invite to reserve Windows 10</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Today I will tell one story, which, perhaps, will be the quintessence of all the useful material that I used throughout this thorny path. 

 Back in t...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>How I tamed Windows Update and got an invite to reserve Windows 10</h1><div class="post__text post__text-html js-mediator-article">  Today I will tell one story, which, perhaps, will be the quintessence of all the useful material that I used throughout this thorny path. <br><br>  Back in the distant 2014 year, in the cold-cold (by the way, not so cold) November, my laptop of the 2010 Mesozoic year of release after a sudden power outage during the installation of updates grabbed hard-switch.  Well, I think it happens, I turned it on, and as if nothing had happened, I continued the work.  But the next day, after the weekly update pack for the OS, I noticed a very strange thing: when the next ‚ÄúKBxxxxxx‚Äù system was restarted after the ‚ÄúCannot complete updates‚Äù system, it clearly tells us before the appearance of the logon screen. <br><a name="habracut"></a><br>  At first, I did not pay attention to it, because  the scheduler usually updates the axis at 3 am, therefore, registering an act of violating the update procedure is extremely difficult, but after a couple of months, as updates accumulate, the volume of unsuccessfully installed software grew steadily, and, as part of a six-month planned crawl of system settings, I went to the Update Center Windows, and I saw a terrible figure there - as many as 3 Gigabytes of new updates.  The spectacle, to put it mildly, is impressive.  When I tried to install at least one of them, the log was thrown at me by various errors, for example, ‚ÄúUnable to read the update manifest‚Äù, or, more difficult, that ‚ÄúWe failed to complete the updates.  Roll back changes.  After spending many days wandering across the Internet, I managed to solve all the problems associated with updates, and now I will tell you what to do when nothing is unclear, nothing works, I don‚Äôt have the strength to pick it up, but I want to update. <br><br><h4>  Step 1. Check for malware and unwanted software. </h4><br>  First of all, you need to make sure that we are trying to update a healthy computer.  To do this, there is a utility called <a href="http://www.microsoft.com/security/scanner/ru-ru/sysreq.aspx">"Microsoft Safety Scanner"</a> , which can be downloaded from their official website. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      This piece weighs about ~ 150MB, finds an infection, in my case it was 4 keygens, and, if necessary, removes it by order of the user. <br><br>  After we have verified that our patient is healthy, proceed to step 2. <br><br><h4>  Step 2. Restoring the integrity of system files using the DISM system </h4><br>  If we are tormented by an error with the code 0x80070490, then it's time to bring the command line with elevated privileges on the battlefield (cmd.exe on behalf of the Administrator).  What follows what is described in the article devoted to the solution of the problem numbered 80070490: <a href="https://support.microsoft.com/ru-ru/kb/958044%3Fwa%3Dwsignin1.0">"Error in Windows Update 0x80070490"</a> . <br><br>  Having completed the many hours (and, in my case, almost daily) scanning of the system with subsequent recovery, we go further. <br><br><h4>  Step 3. Access error </h4><br>  It often happens that the error code does not give reliable information about the solution of the problem caused by the error 0x80070005.  But, fortunately for you, my dear readers, I successfully coped with this annoying misunderstanding!  <a href="https://support.microsoft.com/ru-ru/kb/968003/ru">The solution to the problem is 0x80070005</a> . <br><br><h4>  Step 4. Check the status of the Administrator account (optional) </h4><br>  For those who, for whatever reason, once deactivated the Super Administrator account (after its activation with the command ‚Äúnet user Administrator / active: yes‚Äù), there is a solution to the inconvenience associated with the permanent and unwanted viewing of the account icon on the welcome screen which is to hide selected accounts from logon-screen.  If the above command is unfamiliar to you, and there are no icons with the name Administrator on the welcome screen, you can skip to step 5. <br><br>  On the command line on behalf of the Administrator, execute the command: <br><pre><code class="hljs dos"><span class="hljs-built_in"><span class="hljs-built_in">net</span></span> users</code> </pre> <br>  Get a list with the names of all existing accounts.  We are looking for an Administrator account in this list (in English, respectively, Administrator). <br>  Enter the command: <br><pre> <code class="hljs pgsql">net <span class="hljs-keyword"><span class="hljs-keyword">user</span></span> </code> </pre><br>  The seventh line must correspond to the value Yes, otherwise the account must be activated with the command: <br><pre> <code class="hljs nginx"><span class="hljs-attribute"><span class="hljs-attribute">net</span></span> user  /active:<span class="hljs-literal"><span class="hljs-literal">yes</span></span></code> </pre><br>  After successfully completing the command, open Registry Editor (regedit.exe). <br><br>  In section: <br><pre> <code class="hljs tex">HKEY_LOCAL_MACHINE<span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">SOFTWARE</span></span></span></span><span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Microsoft</span></span></span></span><span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Windows</span></span></span></span> NT<span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">CurrentVersion</span></span></span></span><span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Winlogon</span></span></span></span></code> </pre><br>  You need to create a subkey with the name SpecialAccounts, in which you create a subkey with the name UserList.  The result should be a way: <br><pre> <code class="hljs tex">HKEY_LOCAL_MACHINE<span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">SOFTWARE</span></span></span></span><span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Microsoft</span></span></span></span><span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Windows</span></span></span></span> NT<span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">CurrentVersion</span></span></span></span><span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Winlogon</span></span></span></span><span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">SpecialAccounts</span></span></span></span><span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">UserList</span></span></span></span></code> </pre><br>  In this section, you need to create a parameter with the name "Administrator" of type REG_DWORD.  The parameter value does not need to be changed, since  0 - hide the entry, 1 - show.  After the reboot, the hidden account will not be displayed in the list of accounts on the user selection screen. <br><br><h4>  Step 5. Not all manifest. </h4><br>  Of the six machines running Windows of different versions (7, 8, 8.1), this problem was identified only on two of them: on a laptop with a W7HP on board and on a similar one, but with a W8Pro. <br><br>  Without going into details, in brief: <br>  Antiviruses like to keep track of changes to the registry, and when registering such an event, they immediately notify the user about the incident, asking for permission to make these changes.  During the installation of the entire set following Update 1, I have watched this dialog box more than three hundred times. <br>  Going to the registry on the way: <br><pre> <code class="hljs tex">HKEY_LOCAL_MACHINE<span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">SYSTEM</span></span></span></span><span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">CurrentControlSet</span></span></span></span><span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Services</span></span></span></span><span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">EventLog</span></span></span></span><span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Application</span></span></span></span></code> </pre><br>  and finding there is utter chaos in the permissions of this section, I turned everything back, focusing on the registry of a healthy computer. <br>  The same manipulations must be made in the section. <br><pre> <code class="hljs tex">HKEY_LOCAL_MACHINE<span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">SYSTEM</span></span></span></span><span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">CurrentControlSet</span></span></span></span><span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Services</span></span></span></span><span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">EventLog</span></span></span></span><span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">System</span></span></span></span></code> </pre><br>  Having brained, after fixing the permissions, it was decided to remove the antivirus (in my case it was ESET Nod32 Antivirus 8), after which updates that cursed the error from step 3 were successfully installed. <br><br><h4>  Step 6. In case the GetWindows10 icon does not appear in the tray after installing the KB3035583 update </h4><br>  It is possible that for some reason the stars in the sky were not located in the way that the WX developers wanted, and as a result, not everyone has the opportunity to reserve the ‚ÄúTen‚Äù for themselves.  Two days of research, megabytes of read information, hundreds of reboots - and the long-awaited icon with the Windows logo has appeared!  To repeat this famous trick of David Copperfield, you need to do just three simple things: <br><br>  Thing number 1: <br>  Check section: <br><pre> <code class="hljs tex">HKEY_LOCAL_MACHINE<span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">SOFTWARE</span></span></span></span><span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Microsoft</span></span></span></span><span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Windows</span></span></span></span> NT<span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">CurrentVersion</span></span></span></span><span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">AppCompatFlags</span></span></span></span><span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">UpgradeExperienceIndicators</span></span></span></span></code> </pre><br>  It should have a string parameter UpgEx with the value ‚ÄúOrange‚Äù (at the expense of something other than ‚ÄúOrange‚Äù - not sure, but with me everything worked out), if not, create it. <br><br>  Thing number 2: <br>  create in the root of any disk (in fact, no matter where, just the path to the file that is in the root, is minimal) the GWX.cmd file (the file name can also be thought up on its own) in which we place the following script: <br><pre> <code class="hljs vbscript">REG QUERY <span class="hljs-string"><span class="hljs-string">"HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\AppCompatFlags\UpgradeExperienceIndicators"</span></span> /v UpgEx | findstr UpgEx <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> <span class="hljs-string"><span class="hljs-string">"%errorlevel%"</span></span> == <span class="hljs-string"><span class="hljs-string">"0"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">GOTO</span></span> RunGWX reg add <span class="hljs-string"><span class="hljs-string">"HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\AppCompatFlags\Appraiser"</span></span> /v UtcOnetimeSend /t REG_DWORD /d <span class="hljs-number"><span class="hljs-number">1</span></span> /f schtasks /run /TN <span class="hljs-string"><span class="hljs-string">"\Microsoft\Windows\Application Experience\Microsoft Compatibility Appraiser"</span></span> :CompatCheckRunning schtasks /query /TN <span class="hljs-string"><span class="hljs-string">"\Microsoft\Windows\Application Experience\Microsoft Compatibility Appraiser"</span></span> schtasks /query /TN <span class="hljs-string"><span class="hljs-string">"\Microsoft\Windows\Application Experience\Microsoft Compatibility Appraiser"</span></span> | findstr Ready <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> <span class="hljs-keyword"><span class="hljs-keyword">NOT</span></span> <span class="hljs-string"><span class="hljs-string">"%errorlevel%"</span></span> == <span class="hljs-string"><span class="hljs-string">"1"</span></span> ping localhost &gt;nul &amp;<span class="hljs-keyword"><span class="hljs-keyword">goto</span></span> :CompatCheckRunning :RunGWX schtasks /run /TN <span class="hljs-string"><span class="hljs-string">"\Microsoft\Windows\Setup\gwx\refreshgwxconfig"</span></span></code> </pre><br>  Thing number 3: <br>  At the command line, execute this script: <br><pre> <code class="hljs ruby"><span class="hljs-symbol"><span class="hljs-symbol">:/GWX</span></span>.cmd</code> </pre><br>  In the console window should appear lines 10, not more, and the tray should get a new icon with a pop-up text "Get Windows 10". <br><br>  The goal is achieved. <br><br>  Hint list: <br>  - during long operations, it is desirable to minimize the load on the hard drive, since checking a million or other files is not a trivial task, and it requires full access to the drives; <br>  - Install updates in bulk - the idea is not the best.  The most optimal option is to achieve an error-free installation of one or two updates of several kilobytes, and then install updates, starting with the most difficult ones, adhering to approximately the same update volume per iteration.  Example: <br>  Update1 (500MB) <br>  Update2 (200MB) <br>  Update3 (150MB) <br>  Update4 (100MB) <br>  Update5 (40MB) <br>  Update6 (35MB) <br>  ... <br>  Update53 (24KB) <br>  Update55 (15KB) <br><br>  First of all, we will test the update of the operating system on updates 53 and 55. After that, we will start the installation with update 1. We will reboot.  Installing update 1, install updates 2 and 3 at the same time, and then restart again.  Next, we put the updates 4,5,6,7,8,9 and so on, until we get them to ~ 300-400MB, put them in big batches for a very long time, in case of any error they will be rolled back for a long time. <br><br>  - during any checks like DISM you can brew coffee; <br>  - during the check for unwanted and malicious software, you can leave the city altogether, return late in the evening and still catch the check, it will be about 90%, but it will be; <br>  - in the process of finding these solutions, my system has undergone: <br>  - two reinstallations; <br>  - six SFC checks; <br>  - Five DISM checks; <br>  - two hundred and seventeen reboots; <br>  - one sudden power failure; <br>  - one mechanical dust cleaning, including complete disassembly-assembly of the laptop. <br><br>  I hope the above instructions will help someone else besides me. </div><p>Source: <a href="https://habr.com/ru/post/355610/">https://habr.com/ru/post/355610/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../355600/index.html">About time transfer 2 / Do not forget to patch XP and 2003, otherwise there will be a surprise on the night of January 6-7</a></li>
<li><a href="../355602/index.html">Microsoft will bring "Cortana" in MS Office</a></li>
<li><a href="../355604/index.html">In the preview of Windows 10 appeared Spartan browser</a></li>
<li><a href="../355606/index.html">Windows 10 will ship on DVD and flash drives.</a></li>
<li><a href="../355608/index.html">The search engine "Satellite" will launch its own browser</a></li>
<li><a href="../355612/index.html">Microsoft officially released Windows 10</a></li>
<li><a href="../355614/index.html">Last chance to get a lifelong Windows 10 Pro without participating in the Insider program</a></li>
<li><a href="../355616/index.html">Subreddit collects a collection of photos of the "blue screen of death"</a></li>
<li><a href="../355618/index.html">Windows 10 Mobile became available</a></li>
<li><a href="../355620/index.html">All about versions of Windows 10. What is Threshold1, Threshold2 and Redstone</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>