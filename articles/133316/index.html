<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Training course. Creating the Entity Framework data model for an ASP.NET MVC application</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Using the example of a web application for Contoso University, we will demonstrate the creation of ASP.NET MVC applications using the Entity Framework...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Training course. Creating the Entity Framework data model for an ASP.NET MVC application</h1><div class="post__text post__text-html js-mediator-article">  Using the example of a web application for Contoso University, we will demonstrate the creation of ASP.NET MVC applications using the Entity Framework, the functionality of which will include such features as accepting students, creating courses and appointing teachers. <br><br>  These learning materials will be explained step by step through the process of creating a web application for Contoso University.  You can download the finished application or create it according to the given sequence of steps.  Examples are given in C #, code examples are available in C # and VB.  If you have questions that are indirectly related to training materials, you can ask them on the <a href="http://forums.asp.net/1227.aspx">ASP.NET Entity Framework forum</a> or the <a href="http://social.msdn.microsoft.com/forums/en-US/adodotnetentityframework/threads/">Entity Framework and LINQ to Entities forum</a> . <br><br>  Training implies having knowledge of working with ASP.NET MVC in Visual Studio, otherwise a good place to start learning <a href="http://www.asp.net/mvc/tutorials/getting-started-with-MVC3-part1-cs">ASP.NET MVC Tutorial</a> .  If you prefer to work with ASP.NET Web Forms, take a look at <a href="http://www.asp.net/entity-framework/tutorials">Getting Started with the Entity Framework</a> and <a href="http://www.asp.net/entity-framework/tutorials">Continuing with the Entity Framework</a> . 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <a name="habracut"></a>  Before you begin, make sure that you have the following software installed: <br><ul><li>  <a href="http://www.microsoft.com/web/gallery/install.aspx%3Fappsxml%3D%26amp%3Bappid%3DVS2010SP1Pack">Visual Studio 2010 SP1</a> or <a href="http://www.microsoft.com/web/gallery/install.aspx%3Fappsxml%3D%26amp%3Bappid%3DVWD2010SP1Pack">Visual Web Developer Express 2010 SP1</a> (if you use one of these links to install, the following software will be installed automatically) </li><li>  <a href="http://www.microsoft.com/web/gallery/install.aspx%3Fappid%3DMVC3">ASP.NET MVC 3 Tools Update</a> </li><li>  <a href="http://www.microsoft.com/web/gallery/install.aspx%3Fappid%3DSQLCE">Microsoft SQL Server Compact 4.0</a> </li><li>  <a href="http://www.microsoft.com/web/gallery/install.aspx%3Fappid%3DSQLCEVSTools">Microsoft Visual Studio 2010 SP1 Tools for SQL Server Compact 4.0</a> </li></ul><br><h4>  The contoso university </h4><br>  The application you develop is a simple university website. <br><br><img title="clip_image001" alt="clip_image001" src="https://habrastorage.org/getpro/habr/post_images/ec5/1c2/3d7/ec51c23d77f7fc6c2583d38c5d71e423.png" width="550" height="411"><br><br>  Users will be able to view and update data on students, courses and teachers.  A few screenshots of what happens below. <br><br><img title="clip_image002" alt="clip_image002" src="https://habrastorage.org/getpro/habr/post_images/af2/ab1/d13/af2ab1d130fa6b33053e07e66e828e9a.png" width="422" height="480"><br><br><img title="clip_image003" alt="clip_image003" src="https://habrastorage.org/getpro/habr/post_images/f89/290/6b7/f892906b73b816f618d501d0d29fadc5.png" width="391" height="480"><br><br><img title="clip_image004" alt="clip_image004" src="https://habrastorage.org/getpro/habr/post_images/cb8/990/b40/cb8990b40a88c7ea77c4debd7a102959.png" width="418" height="480"><br><br>  The UI is close in style to what is generated by default templates, so the focus will be on using the Entity Framework. <br><br><h4>  Development Approaches with the Entity Framework </h4><br>  Ishoy from the diagram, there are three approaches to working with data in the Entity Framework: <em>Database</em> <em>First</em> , <em>Model</em> <em>First</em> , and <em>Code</em> <em>First.</em> <br><br><img title="clip_image005" alt="clip_image005" src="https://habrastorage.org/getpro/habr/post_images/3f6/57a/0a4/3f657a0a49318a81cbed86d6c15ef1fd.png" width="451" height="480"><br><br><h5>  Database first </h5><br>  In the case of an existing database, the Entity Framework can automatically create a data model consisting of classes and properties that correspond to database objects (such as tables and columns).  Information about the database structure (store schema), data model ( <em>conceptual model</em> ) and mapping them onto each other is contained in XML in the <em>.edmx</em> file.  Visual Studio provides the graphic designer Entity Framework, with which you can view and edit <em>.edmx</em> .  The parts of <a href="http://www.asp.net/entity-framework/tutorials">Getting Started With the Entity Framework</a> and <a href="http://www.asp.net/entity-framework/tutorials">Continuing With the Entity Framework</a> in the Web Forms materials use the Database First approach. <br><br><h5>  Model first </h5><br>  If there is no base, you can start by creating a data model using the Visual Studio Entity Framework designer.  After completing work on the model, the designer will generate a DDL ( <em>data</em> <em>definition</em> <em>language</em> ) code for creating the database.  In this approach, <em>.edmx</em> is also used to store information about the model and <em>mappings</em> .  <a href="http://www.asp.net/entity-framework/tutorials/what-s-new-in-the-entity-framework-4">What's New in the Entity Framework 4</a> includes a small sample development using this approach. <br><br><h5>  Code first </h5><br>  Regardless of the presence of the database, you can manually write the code of classes and properties corresponding to the entities in the database and use this code with the Entity Framework without using a file <em>.</em>  <em>edmx</em>  That is why you can sometimes see how this approach is called <em>code</em> <em>only</em> , although the official name Code First.  Mapping between the store schema and the conceptual model in the mapping API.  If there is no base yet, the Entity Framework can create, delete or recreate it in case of changes in the model. <br><br>  The data access API developed for Code First is based on the <code>DbContext</code> class.  The API can also be used in the development process with Database First and Model First approaches.  For more information, see <a href="https://habr.com/b/adonet/archive/2011/03/07/when-is-code-first-not-code-first.aspx">When is Code First not code first?</a>  In the blog of the development team Entity Framework. <br><br><h4>  POCO (Plain Old CLR Objects) </h4><br>  By default, for the Database First and Model First approaches, the data model classes are inherited from <a href="http://msdn.microsoft.com/en-us/library/system.data.objects.dataclasses.entityobject.aspx">EntityObject</a> , which provides the Entity Framework functionality.  This means that these classes are not <a href="http://msdn.microsoft.com/en-us/magazine/dd882510.aspx">persistence ignorant</a> and, thus, do not fully meet one of the conditions of the <a href="http://msdn.microsoft.com/en-us/magazine/dd419654.aspx">domain-driven design</a> .  All approaches to development with the Entity Framework can also work with POCO ( <em>plain</em> <em>old</em> <em>CLR</em> <em>objects</em> ), which, in general, means that they are persistence-ignorant due to the lack of <code>EntityObject</code> inheritance. <br><br><h4>  Create MVC Web Application </h4><br>  Open Visual Studio and create a new "ContosoUniversity" project using the <strong>ASP.NET MVC 3 Web Application</strong> : <br><br><img title="clip_image006" alt="clip_image006" src="https://habrastorage.org/getpro/habr/post_images/9cf/5b1/b65/9cf5b1b65ed3ac067e65fdac56318ef3.png" width="550" height="423"><br><br>  In <strong>New</strong> <strong>ASP.</strong>  <strong>NET</strong> <strong>MVC 3</strong> <strong>Project,</strong> select the <strong>Internet</strong> <strong>Application</strong> template and the <strong>Razor</strong> view engine, uncheck the <strong>Create</strong> <strong>a</strong> <strong>unit</strong> <strong>test</strong> <strong>project</strong> and click <strong>OK</strong> . <br><br><img title="clip_image007" alt="clip_image007" src="https://habrastorage.org/getpro/habr/post_images/0da/36f/2b4/0da36f2b464a78dabe0bfea3b876841c.png" width="497" height="480"><br><br><h5>  Customize styles </h5><br>  A few small amendments will change the site menu, the layout of elements and the home page. <br><br>  To customize the Contoso University menu, in <em>Views \</em> <em>Shared \ _</em> <em>Layout.</em>  <em>cshtml</em> replace the text in <code>h</code> <code>1</code> and the links in the menu, as in the example: <br><br><pre> <code class="html hljs xml"><span class="hljs-meta"><span class="hljs-meta">&lt;!DOCTYPE html&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">html</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">head</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">title</span></span></span><span class="hljs-tag">&gt;</span></span>@ViewBag.Title<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">title</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">link</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">href</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"@Url.Content("</span></span></span><span class="hljs-tag">~/</span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Content</span></span></span><span class="hljs-tag">/</span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Site.css</span></span></span><span class="hljs-tag">")" </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">rel</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"stylesheet"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"text/css"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">src</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"@Url.Content("</span></span></span><span class="hljs-tag">~/</span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Scripts</span></span></span><span class="hljs-tag">/</span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">jquery-1.5.1.min.js</span></span></span><span class="hljs-tag">")" </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"text/javascript"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="undefined"></span><span class="hljs-tag"><span class="undefined"></span><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">head</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">body</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"page"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"header"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"title"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">h1</span></span></span><span class="hljs-tag">&gt;</span></span>Contoso University<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">h1</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"logindisplay"</span></span></span><span class="hljs-tag">&gt;</span></span> @Html.Partial("_LogOnPartial") <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"menucontainer"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ul</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"menu"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">li</span></span></span><span class="hljs-tag">&gt;</span></span>@Html.ActionLink("Home", "Index", "Home")<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">li</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">li</span></span></span><span class="hljs-tag">&gt;</span></span>@Html.ActionLink("About", "About", "Home")<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">li</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">li</span></span></span><span class="hljs-tag">&gt;</span></span>@Html.ActionLink("Students", "Index", "Student")<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">li</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">li</span></span></span><span class="hljs-tag">&gt;</span></span>@Html.ActionLink("Courses", "Index", "Course")<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">li</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">li</span></span></span><span class="hljs-tag">&gt;</span></span>@Html.ActionLink("Instructors", "Index", "Instructor")<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">li</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">li</span></span></span><span class="hljs-tag">&gt;</span></span>@Html.ActionLink("Departments", "Index", "Department")<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">li</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ul</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"main"</span></span></span><span class="hljs-tag">&gt;</span></span> @RenderBody() <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"footer"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">body</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">html</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br>  In <em>Views \ Home \ Index.cshtml</em> delete everything in the <code>h2</code> tag. <br><br>  In <em>Controllers \ HomeController.cs,</em> replace "Welcome to ASP.NET MVC!"  on "Welcome to Contoso University!" <br><br>  In <em>Content \</em> <em>Site.</em>  <em>css</em> to shift the menu to the left, make the following changes: <br><br><ul><li>  In the <code>#main</code> block add <code>clear: both</code> : </li></ul><pre> <code class="css hljs"><span class="hljs-selector-id"><span class="hljs-selector-id">#main</span></span> { <span class="hljs-attribute"><span class="hljs-attribute">clear</span></span>: both; <span class="hljs-attribute"><span class="hljs-attribute">padding</span></span>: <span class="hljs-number"><span class="hljs-number">30px</span></span> <span class="hljs-number"><span class="hljs-number">30px</span></span> <span class="hljs-number"><span class="hljs-number">15px</span></span> <span class="hljs-number"><span class="hljs-number">30px</span></span>; <span class="hljs-attribute"><span class="hljs-attribute">background-color</span></span>: <span class="hljs-number"><span class="hljs-number">#fff</span></span>; <span class="hljs-attribute"><span class="hljs-attribute">border-radius</span></span>: <span class="hljs-number"><span class="hljs-number">4px</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-attribute"><span class="hljs-attribute">-webkit-border-radius</span></span>: <span class="hljs-number"><span class="hljs-number">4px</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-attribute"><span class="hljs-attribute">-moz-border-radius</span></span>: <span class="hljs-number"><span class="hljs-number">4px</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span>; }</code> </pre><br><ul><li>  In the blocks <code>nav</code> and <code>#menucontainer</code> <code></code> <code>clear: both; float: left</code>  <code>clear: both; float: left</code> : </li></ul><pre> <code class="css hljs"><span class="hljs-selector-tag"><span class="hljs-selector-tag">nav</span></span>, <span class="hljs-selector-id"><span class="hljs-selector-id">#menucontainer</span></span> { <span class="hljs-attribute"><span class="hljs-attribute">margin-top</span></span>: <span class="hljs-number"><span class="hljs-number">40px</span></span>; <span class="hljs-attribute"><span class="hljs-attribute">clear</span></span>: both; <span class="hljs-attribute"><span class="hljs-attribute">float</span></span>: left; }</code> </pre><br>  Run the project. <br><br><img title="clip_image001 [1]" alt="clip_image001[1]" src="https://habrastorage.org/getpro/habr/post_images/ec5/1c2/3d7/ec51c23d77f7fc6c2583d38c5d71e423.png" width="550" height="411"><br><br><h4>  Creating a data model </h4><br>  Next, create the first entity classes for Contoso University.  We will start with the following three entities: <br><br><img title="clip_image008" alt="clip_image008" src="https://habrastorage.org/getpro/habr/post_images/dc1/ed5/8ce/dc1ed58ce379a1d7ae03f2c486186807.png" width="550" height="410"><br><br>  A one-to-many relationship is established between the entities <code>Student</code> and <code>Enrollment</code> , and a one-to-many relationship between <code>Course</code> and <code>Enrollment</code> .  In other words, a student can attend any number of courses, and a course can have any number of students attending it. <br><br>  In the future, you will create classes for each of these entities. <br><br>  Note: compiling a project without classes created for these entities will cause compiler errors. <br><br><h5>  Entity Student </h5><br><img title="clip_image009" alt="clip_image009" src="https://habrastorage.org/getpro/habr/post_images/a0c/584/2ec/a0c5842ecb9dbfa22c8c61c65c7f8afb.png" width="282" height="203"><br><br>  In the <em>Models</em> folder, create a <em>Student.</em>  <em>cs</em> and replace the generated code with: <br><br><pre> <code class="hljs cs"><span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System.Collections.Generic; <span class="hljs-keyword"><span class="hljs-keyword">namespace</span></span> <span class="hljs-title"><span class="hljs-title">ContosoUniversity.Models</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">Student</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> StudentID { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> LastName { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> FirstMidName { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> DateTime EnrollmentDate { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">virtual</span></span> ICollection&lt;Enrollment&gt; Enrollments { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } } }</code> </pre><br>  The <code>StudentID</code> property will be the primary key of the corresponding table.  By default, the Entity Framework treats a property with an <code>ID</code> or <em>classname</em> <code>ID</code> as the primary key. <br><br>  <code>Enrollments</code> - <em>navigation property</em> .  Navigation properties contain other entities related to the current.  In this case, the <code>Enrollments</code> property contains all the <code>Enrollment</code> entities associated with the current <code>Student</code> entity.  In other words, if a certain <code>Student</code> record in a database has a link to two <code>Enrollment</code> records (records containing primary key values ‚Äã‚Äãfor a student in the <code>StudentID</code> foreign key <code>StudentID</code> ), the property of this <code>Enrollments</code> record will contain two <code>Enrollment</code> entities. <br><br>  Navigation properties are usually marked with a <code>virtual</code> modifier to use the Entity Framework feature called <em>lazy</em> <em>loading</em> .  (the essence of Lazy loading will be explained later, in <a href="http://www.asp.net/entity-framework/tutorials/reading-related-data-with-the-entity-framework-in-an-asp-net-mvc-application">Reading Related Data</a> ) If the navigation property can contain several entities (in many-to-many and one-to-many relationships), its type should be an <code>ICollection</code> . <br><br><h5>  Entity Enrollment </h5><br><img title="clip_image010" alt="clip_image010" src="https://habrastorage.org/getpro/habr/post_images/578/712/72e/57871272ed1a2731ed1405e9c7fef8dc.png" width="284" height="223"><br><br>  In the <em>Models</em> folder, create an <em>Enrollment.</em>  <em>cs</em> with the following content: <br><br><pre> <code class="hljs cs"><span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System.Collections.Generic; <span class="hljs-keyword"><span class="hljs-keyword">namespace</span></span> <span class="hljs-title"><span class="hljs-title">ContosoUniversity.Models</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">Enrollment</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> EnrollmentID { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> CourseID { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> StudentID { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">decimal</span></span>? Grade { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">virtual</span></span> Course Course { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">virtual</span></span> Student Student { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } } }</code> </pre><br>  The question mark after specifying the <code>decimal</code> type indicates that the <code>Grade</code> property is nullable.  A rating set to null is different from a zero rating ‚Äî null means that the rating has not been set yet, whereas 0 is already a value. <br><br>  The <code>StudentID</code> property is a foreign key, and the corresponding navigation property <code>Student</code> .  The entity <code>Enrollment</code> associated with one <code>Student</code> entity, therefore a property can contain only one entity of the specified type (as opposed to <code>Student</code> <code>.</code> <code>Enrollments</code> ). <br><br>  The <code>CourseID</code> property is a foreign key, and the corresponding navigation property <code>Course</code> .  Entity <code>Enrollment</code> associated with one Entity <code>Course</code> . <br><br><h5>  Essence Course </h5><br><img title="clip_image011" alt="clip_image011" src="https://habrastorage.org/getpro/habr/post_images/5d3/849/b7e/5d3849b7eca7b4fc62656e8431caebd3.png" width="282" height="188"><br><br>  In the <em>Models</em> folder, create a <em>Course.</em>  <em>cs</em> with the following content: <br><br><pre> <code class="hljs cs"><span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System.Collections.Generic; <span class="hljs-keyword"><span class="hljs-keyword">namespace</span></span> <span class="hljs-title"><span class="hljs-title">ContosoUniversity.Models</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">Course</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> CourseID { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> Title { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> Credits { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">virtual</span></span> ICollection&lt;Enrollment&gt; Enrollments { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } } }</code> </pre><br>  <code>Enrollments</code> - navigation property.  Entity <code>Course</code> can be associated with an infinite set of <code>Enrollment</code> entities. <br><br><h4>  Creating Database Context </h4><br>  The main class coordinating the Entity Framework functionality for the current data model is called the <em>database</em> <em>context</em> .  This class is inherited from <code>System</code> <code>.</code>  <code>Data</code> <code>.</code>  <code>Entity</code> <code>.</code>  <code>DbContext</code> .  In the code, you define which entities to include in the data model, and you can also define the behavior of the Entity Framework itself.  In our code, this class is called <code>SchoolContext</code> . <br><br>  Create a folder <em>DAL</em> and in it a new class <em>SchoolContext.</em>  <em>cs</em> : <br><br><pre> <code class="hljs cs"><span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System.Collections.Generic; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System.Data.Entity; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> ContosoUniversity.Models; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System.Data.Entity.ModelConfiguration.Conventions; <span class="hljs-keyword"><span class="hljs-keyword">namespace</span></span> <span class="hljs-title"><span class="hljs-title">ContosoUniversity.Models</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">SchoolContext</span></span> : <span class="hljs-title"><span class="hljs-title">DbContext</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> DbSet&lt;Student&gt; Students { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> DbSet&lt;Enrollment&gt; Enrollments { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> DbSet&lt;Course&gt; Courses { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">protected</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">override</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">OnModelCreating</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">DbModelBuilder modelBuilder</span></span></span><span class="hljs-function">)</span></span> { modelBuilder.Conventions.Remove&lt;PluralizingTableNameConvention&gt;(); } } }</code> </pre><br>  The code creates a <code>DbSet</code> property for each set of entities.  In Entity Framework terminology, an <em>entity</em> <em>set refers to a database table, and an entity refers to an entry in a table.</em> <br><br>  <code> </code> <code>OnModelCreating</code> <code> </code> protects table names from pluralization, and if you don‚Äôt do this, you get table names such as <code>Students</code> , <code>Courses</code> , <code>Enrollments</code> .  Otherwise, the table names will be <code>Student</code> , <code>Course</code> , <code>Enrollment</code> .  Developers are arguing about whether the names of tables should be pluralized or not.  We use a single form, but the important thing is that you can choose whether to include this line in the code or not. <br><br>  (This class is in Models namespace because in some situations the Code First approach implies finding the entity classes and context in the same namespace.) <br><br><h4>  Definition of a Connection String </h4><br>  You do not need to define a connection string.  If you have not defined this line, the Entity Framework will automatically create a SQL Server Express database.  However, we will work with SQL Server Compact, and you will need to create a connection string indicating this. <br><br>  Open the <em>web.</em>  <em>config</em> and add a new connection string to the connectionStrings collection.  (Make sure you update the <em>Web.</em> <em>Config</em> in the root of the project, as there is another <em>Web.</em> <em>Config</em> in the <em>Views</em> folder <em>that you don‚Äôt need to touch</em> .) <br><br><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">add</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"SchoolContext"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">connectionString</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Data Source=|DataDirectory|School.sdf"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">providerName</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"System.Data.SqlServerCe.4.0"</span></span></span><span class="hljs-tag">/&gt;</span></span></code> </pre> <br>  By default, the Entity Framework looks for a connection string, also called an object context class.  The connection string that you added defines the School.sdf database, located in the App_data folder and in SQL Server Compact. <br><br><h4>  Database initialization with test data </h4><br>  Entity Framework can automatically create a database when you start the application.  You can specify that this should occur every time the application is launched or only when the model is out of sync with the existing database.  You can also write a class with a method that the Entity Framework will automatically call before creating a base for use with test data.  We will indicate that the base should be deleted and re-created when the model changes. <br><br>  In the DAL folder, create a new <em>SchoolInitializer</em> class <em>.</em>  <em>cs</em> with the code with which the database will be created, if necessary, and filled with test data. <br><br><pre> <code class="hljs pgsql"><span class="hljs-keyword"><span class="hljs-keyword">using</span></span> <span class="hljs-keyword"><span class="hljs-keyword">System</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> <span class="hljs-keyword"><span class="hljs-keyword">System</span></span>.Collections.Generic; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> <span class="hljs-keyword"><span class="hljs-keyword">System</span></span>.Linq; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> <span class="hljs-keyword"><span class="hljs-keyword">System</span></span>.Web; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> <span class="hljs-keyword"><span class="hljs-keyword">System</span></span>.Data.Entity; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> ContosoUniversity.Models; namespace ContosoUniversity.DAL { <span class="hljs-built_in"><span class="hljs-built_in">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> SchoolInitializer : DropCreateDatabaseIfModelChanges&lt;SchoolContext&gt; { protected override <span class="hljs-type"><span class="hljs-type">void</span></span> Seed(SchoolContext context) { var students = <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> List&lt;Student&gt; { <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> Student { FirstMidName = "Carson", LastName = "Alexander", EnrollmentDate = DateTime.Parse("2005-09-01") }, <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> Student { FirstMidName = "Meredith", LastName = "Alonso", EnrollmentDate = DateTime.Parse("2002-09-01") }, <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> Student { FirstMidName = "Arturo", LastName = "Anand", EnrollmentDate = DateTime.Parse("2003-09-01") }, <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> Student { FirstMidName = "Gytis", LastName = "Barzdukas", EnrollmentDate = DateTime.Parse("2002-09-01") }, <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> Student { FirstMidName = "Yan", LastName = "Li", EnrollmentDate = DateTime.Parse("2002-09-01") }, <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> Student { FirstMidName = "Peggy", LastName = "Justice", EnrollmentDate = DateTime.Parse("2001-09-01") }, <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> Student { FirstMidName = "Laura", LastName = "Norman", EnrollmentDate = DateTime.Parse("2003-09-01") }, <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> Student { FirstMidName = "Nino", LastName = "Olivetto", EnrollmentDate = DateTime.Parse("2005-09-01") } }; students.<span class="hljs-keyword"><span class="hljs-keyword">ForEach</span></span>(s =&gt; context.Students.<span class="hljs-keyword"><span class="hljs-keyword">Add</span></span>(s)); context.SaveChanges(); var courses = <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> List&lt;Course&gt; { <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> Course { Title = "Chemistry", Credits = <span class="hljs-number"><span class="hljs-number">3</span></span>, }, <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> Course { Title = "Microeconomics", Credits = <span class="hljs-number"><span class="hljs-number">3</span></span>, }, <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> Course { Title = "Macroeconomics", Credits = <span class="hljs-number"><span class="hljs-number">3</span></span>, }, <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> Course { Title = "Calculus", Credits = <span class="hljs-number"><span class="hljs-number">4</span></span>, }, <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> Course { Title = "Trigonometry", Credits = <span class="hljs-number"><span class="hljs-number">4</span></span>, }, <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> Course { Title = "Composition", Credits = <span class="hljs-number"><span class="hljs-number">3</span></span>, }, <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> Course { Title = "Literature", Credits = <span class="hljs-number"><span class="hljs-number">4</span></span>, } }; courses.<span class="hljs-keyword"><span class="hljs-keyword">ForEach</span></span>(s =&gt; context.Courses.<span class="hljs-keyword"><span class="hljs-keyword">Add</span></span>(s)); context.SaveChanges(); var enrollments = <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> List&lt;Enrollment&gt; { <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> Enrollment { StudentID = <span class="hljs-number"><span class="hljs-number">1</span></span>, CourseID = <span class="hljs-number"><span class="hljs-number">1</span></span>, Grade = <span class="hljs-number"><span class="hljs-number">1</span></span> }, <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> Enrollment { StudentID = <span class="hljs-number"><span class="hljs-number">1</span></span>, CourseID = <span class="hljs-number"><span class="hljs-number">2</span></span>, Grade = <span class="hljs-number"><span class="hljs-number">3</span></span> }, <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> Enrollment { StudentID = <span class="hljs-number"><span class="hljs-number">1</span></span>, CourseID = <span class="hljs-number"><span class="hljs-number">3</span></span>, Grade = <span class="hljs-number"><span class="hljs-number">1</span></span> }, <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> Enrollment { StudentID = <span class="hljs-number"><span class="hljs-number">2</span></span>, CourseID = <span class="hljs-number"><span class="hljs-number">4</span></span>, Grade = <span class="hljs-number"><span class="hljs-number">2</span></span> }, <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> Enrollment { StudentID = <span class="hljs-number"><span class="hljs-number">2</span></span>, CourseID = <span class="hljs-number"><span class="hljs-number">5</span></span>, Grade = <span class="hljs-number"><span class="hljs-number">4</span></span> }, <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> Enrollment { StudentID = <span class="hljs-number"><span class="hljs-number">2</span></span>, CourseID = <span class="hljs-number"><span class="hljs-number">6</span></span>, Grade = <span class="hljs-number"><span class="hljs-number">4</span></span> }, <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> Enrollment { StudentID = <span class="hljs-number"><span class="hljs-number">3</span></span>, CourseID = <span class="hljs-number"><span class="hljs-number">1</span></span> }, <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> Enrollment { StudentID = <span class="hljs-number"><span class="hljs-number">4</span></span>, CourseID = <span class="hljs-number"><span class="hljs-number">1</span></span>, }, <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> Enrollment { StudentID = <span class="hljs-number"><span class="hljs-number">4</span></span>, CourseID = <span class="hljs-number"><span class="hljs-number">2</span></span>, Grade = <span class="hljs-number"><span class="hljs-number">4</span></span> }, <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> Enrollment { StudentID = <span class="hljs-number"><span class="hljs-number">5</span></span>, CourseID = <span class="hljs-number"><span class="hljs-number">3</span></span>, Grade = <span class="hljs-number"><span class="hljs-number">3</span></span> }, <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> Enrollment { StudentID = <span class="hljs-number"><span class="hljs-number">6</span></span>, CourseID = <span class="hljs-number"><span class="hljs-number">4</span></span> }, <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> Enrollment { StudentID = <span class="hljs-number"><span class="hljs-number">7</span></span>, CourseID = <span class="hljs-number"><span class="hljs-number">5</span></span>, Grade = <span class="hljs-number"><span class="hljs-number">2</span></span> }, }; enrollments.<span class="hljs-keyword"><span class="hljs-keyword">ForEach</span></span>(s =&gt; context.Enrollments.<span class="hljs-keyword"><span class="hljs-keyword">Add</span></span>(s)); context.SaveChanges(); } } }</code> </pre><br>  The <code>Seed</code> method accepts a database context object as an input parameter and uses it to add new entities to the database.  For each type of entity, the code creates a collection of new entities, adding them to the corresponding DbSet property, and then saves the changes to the database.  There is no need to call <code>SaveChanges</code> after each group of entities, as we have done, but it helps to identify the problem in case of exceptions. <br><br>  Change <em>Global.</em>  <em>asax.</em>  <em>cs</em> so that our code is called every time the application is started: <br><br><ul><li>  Add <code>using</code> : </li></ul><pre> <code class="hljs pgsql"><span class="hljs-keyword"><span class="hljs-keyword">using</span></span> <span class="hljs-keyword"><span class="hljs-keyword">System</span></span>.Data.Entity; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> ContosoUniversity.Models; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> ContosoUniversity.DAL;</code> </pre><br><ul><li>  In the <code>Application_Start</code> method, call the Entity Framework method, which runs the base initialization code: </li></ul><pre> <code class="hljs pgsql"><span class="hljs-keyword"><span class="hljs-keyword">Database</span></span>.SetInitializer&lt;SchoolContext&gt;(<span class="hljs-built_in"><span class="hljs-built_in">new</span></span> SchoolInitializer());</code> </pre> <br>  The application is configured in such a way that each time the database is accessed after launching the application, the Entity Framework compares the base with the model ( <code>SchoolContext</code> class), and if it is out of sync, the application deletes and re-creates the base. <br><br>  <strong>Note</strong> when deploying an application to a production server, you must remove all code that initializes the database with test data. <br><br>  Next, you will create a web page to display the data, and the data query process automatically initiates the creation of the database.  You will start with a new controller, but before that, build the project so that the model and context classes are available for MVC controller scaffolding. <br><br><h4>  Creating a Student Controller </h4><br>  To create a <code>Student</code> controller, click on the <strong>Controllers</strong> folder in <strong>Solution Explorer</strong> , click <strong>Add</strong> , <strong>Controller</strong> .  In <strong>Add</strong> <strong>Controller,</strong> perform the following actions and changes and click <strong>Add</strong> : <br><br><ul><li>  Controller name: <strong>StudentController</strong> . </li><li>  Template: <strong>Controller with read / write actions and views, using Entity Framework</strong> .  (default.) </li><li>  Model class: <strong>Student (ContosoUniversity.Models)</strong> .  (if not, rebuild the project) </li><li>  Data context class: <strong>SchoolContext (ContosoUniversity.Models)</strong> . </li><li>  Views: <strong>Razor (CSHTML)</strong> .  (default) </li></ul><img title="clip_image012" alt="clip_image012" src="https://habrastorage.org/getpro/habr/post_images/3ea/a07/6ee/3eaa076ee1d3bf3973a762322cdd0361.png" width="550" height="384"><br><br>  Open <em>Controllers \</em> <em>StudentController.</em>  <em>cs</em> , you will see the created variable initializing the database context object: <br><br><pre>  private SchoolContext db = new SchoolContext (); </pre><br>  The <code>Index</code> action collects a list of students from the <code>Students</code> property from an instance of the database context: <br><br><pre> <code class="hljs pgsql"><span class="hljs-built_in"><span class="hljs-built_in">public</span></span> ViewResult <span class="hljs-keyword"><span class="hljs-keyword">Index</span></span>() { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">View</span></span>(db.Students.ToList()); }</code> </pre><br>  Automatic scaffolding was created for the <code>Student</code> set.  To customize the headings and column sequence, open <em>Views \</em> <em>Student \</em> <em>Index.</em>  <em>cshtml</em> and replace the code with: <br><br><pre> <code class="html hljs xml">@model IEnumerable<span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ContosoUniversity.Models.Student</span></span></span><span class="hljs-tag">&gt;</span></span> @{ ViewBag.Title = "Students"; } <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">h2</span></span></span><span class="hljs-tag">&gt;</span></span>Students<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">h2</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">p</span></span></span><span class="hljs-tag">&gt;</span></span> @Html.ActionLink("Create New", "Create") <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">p</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">table</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">tr</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">th</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">th</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">th</span></span></span><span class="hljs-tag">&gt;</span></span>Last Name<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">th</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">th</span></span></span><span class="hljs-tag">&gt;</span></span>First Name<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">th</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">th</span></span></span><span class="hljs-tag">&gt;</span></span>Enrollment Date<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">th</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">tr</span></span></span><span class="hljs-tag">&gt;</span></span> @foreach (var item in Model) { <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">tr</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">td</span></span></span><span class="hljs-tag">&gt;</span></span> @Html.ActionLink("Edit", "Edit", new { id=item.StudentID }) | @Html.ActionLink("Details", "Details", new { id=item.StudentID }) | @Html.ActionLink("Delete", "Delete", new { id=item.StudentID }) <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">td</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">td</span></span></span><span class="hljs-tag">&gt;</span></span> @Html.DisplayFor(modelItem =&gt; item.LastName) <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">td</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">td</span></span></span><span class="hljs-tag">&gt;</span></span> @Html.DisplayFor(modelItem =&gt; item.FirstMidName) <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">td</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">td</span></span></span><span class="hljs-tag">&gt;</span></span> @Html.DisplayFor(modelItem =&gt; item.EnrollmentDate) <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">td</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">tr</span></span></span><span class="hljs-tag">&gt;</span></span> } <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">table</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br>  Launch the site, click on the <strong>Students</strong> tab. <br><br><img title="clip_image002 [1]" alt="clip_image002[1]" src="https://habrastorage.org/getpro/habr/post_images/af2/ab1/d13/af2ab1d130fa6b33053e07e66e828e9a.png" width="422" height="480"><br><br>  Close the browser.  In <strong>Solution Explorer,</strong> <strong>select</strong> <strong>the</strong> <strong>ContosoUniversity</strong> <strong>project</strong> .  Click <strong>Show all Files</strong> , <strong>Refresh</strong> and then expand the <em>App_Data</em> folder. <br><br><img title="clip_image013" alt="clip_image013" src="https://habrastorage.org/getpro/habr/post_images/457/20c/955/45720c955e931c074ca58e592f581723.png" width="303" height="414"><br><br>  Double-click on <em>School.</em>  <em>sdf</em> to open <strong>Server</strong> <strong>Explorer</strong> , and <strong>Tables</strong> . <br><br>  <strong>Note</strong> If you get an error after you double-click on School.sdf, make sure you have installed <strong>Visual</strong> <strong>Studio 2010</strong> <strong>SP1</strong> <strong>Tools</strong> <strong>for</strong> <strong>SQL</strong> <strong>Server</strong> <strong>Compact 4.0</strong> .  If everything is installed, restart Visual Studio. <br><br><img title="clip_image014" alt="clip_image014" src="https://habrastorage.org/getpro/habr/post_images/7ad/4b6/55b/7ad4b655b6418fd0cd10169a520de668.png" width="227" height="276"><br><br>  Each table has its own set of entities + one additional table.  <code>EdmMetadata</code> used to define the Entity Framework when model and base have become unsynchronized. <br><br>  Click on one of the tables and <strong>Show</strong> <strong>Table</strong> <strong>Data</strong> to see the data loaded by the <code>SchoolInitializer</code> class. <br><br><img title="clip_image015" alt="clip_image015" src="https://habrastorage.org/getpro/habr/post_images/e47/98a/912/e4798a9128e7d3337e86c2cd38862f2c.png" width="515" height="308"><br><br>  Close the connection, otherwise there may be a problem running the application. <br><br><img title="clip_image016" alt="clip_image016" src="https://habrastorage.org/getpro/habr/post_images/37e/b1e/564/37eb1e564dd2ea73a617b32cdb84c0d5.png" width="378" height="480"><br><br><h4>  Agreements </h4><br>  The amount of code needed to create the Entity Framework database is minimal due to the use of ( <em>conventions)</em> Entity Framework.  Some of them have already been mentioned: <br><br><ul><li>  The plural form of entity class names is used as table names. </li><li>  Entity property names are used as column names. </li><li>  Properties of entities with <code>ID</code> or <em>classname</em> <code>ID</code> recognized as primary keys. </li><li>  The Entity Framework connects to the database by finding the connection string with the same name as the context class (in this case, <code>SchoolContext</code> ). </li></ul>  You have seen that these agreements can be overridden (for example, you can turn off pluralization) and you can learn more about how to do this from <a href="http://www.asp.net/entity-framework/tutorials/creating-a-more-complex-data-model-for-an-asp-net-mvc-application">Creating a More Complex Data Model</a> . <br><br>  You created a simple application using the Entity Framework and SQL Server Compact to store and display data.  Next, we will learn how to perform simple CRUD (create, read, update, delete) operations. <br><br>  Thanks for the help in the translation of Alexander Belotserkovsky ( <a href="https://habrahabr.ru/users/ahriman/" class="user_link">ahriman</a> ). <br><br>  <a href="http://code.msdn.microsoft.com/ASPNET-MVC-Application-b01a9fe8">Download all app</a> |  <a href="http://archive.msdn.microsoft.com/Project/Download/FileDownload.aspx%3FProjectName%3Daspnetmsdnexamples%26DownloadId%3D15443">Download the manual in PDF format</a> </div><p>Source: <a href="https://habr.com/ru/post/133316/">https://habr.com/ru/post/133316/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../133309/index.html">Habrarebest in Kiev</a></li>
<li><a href="../133311/index.html">Planning poker in their own colors</a></li>
<li><a href="../133312/index.html">Database Migrations - Library Overview and Usage</a></li>
<li><a href="../133314/index.html">Thoughts after visiting a venture fair</a></li>
<li><a href="../133315/index.html">Automatic start of unit tests for C</a></li>
<li><a href="../133317/index.html">Conscience is the best controller</a></li>
<li><a href="../133318/index.html">Market packaging startups on their own experience</a></li>
<li><a href="../133319/index.html">Conference ADD-3 convenes speakers</a></li>
<li><a href="../133321/index.html">Arrangement of points over onmousewheel and a little about onion soup</a></li>
<li><a href="../133325/index.html">Synchronization of the view with the collection</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>