<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Julia: types, multimethods and arithmetic over polynomials</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In this publication, we will discuss the main, in my opinion, distinctive feature of the Julia language - the representation of functions in the form ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Julia: types, multimethods and arithmetic over polynomials</h1><div class="post__text post__text-html js-mediator-article">  In this publication, we will discuss the main, in my opinion, distinctive feature of the Julia language - the representation of functions in the form of methods with multiple dispatching.  This allows you to improve the performance of calculations without reducing the readability of the code and not spoiling the abstraction, on the one hand, and allows you to work with mathematical concepts in a more familiar notation, on the other.  For example, we consider the question of uniform (from the point of view of linear operations) work with polynomials in the representation of a list of coefficients and with interpolation polynomials. <br><a name="habracut"></a><br><h2>  Basic syntax </h2><br>  A brief introduction for those who do not know.  Julia is a scripting language, has a REPL (read-evaluate-print loop, i.e. interactive shell).  At first glance it looks quite similar to, for example, Python or MATLAB. <br><h4>  Arithmetic operations </h4><br>  The arithmetic is about the same as elsewhere: +, -, *, /, ^ for exponentiation, etc. <br>  Comparison:&gt;, &lt;,&gt; =, &lt;=, ==,! = Etc. <br>  Assignment: =. <br>  Features: division by <code>/</code> always returns a fractional number;  if you need an integer part from dividing two integers, you need to use the operation <code>div(m, n)</code> or the infix equivalent <code>m √∑ n</code> . <br><h4>  Types </h4><br>  Numeric types: <br><ul><li>  Integers ( <code>Int</code> ) - <code>2</code> , <code>3</code> , <code>-42</code> </li><li>  Unsigned <code>UInt</code> ( <code>UInt</code> ) - <code>0x12345</code> </li><li>  Floating point ( <code>Float32</code> , <code>Float64</code> ) - <code>1.0</code> , <code>3.1415</code> , <code>-Inf</code> , <code>NaN</code> </li><li>  Rational ( <code>Rational</code> ) - <code>3//3</code> , <code>7//2</code> </li><li>  Valid ( <code>Real</code> ) - All of the above </li><li>  Complex ( <code>Complex</code> ) - <code>3+4*im</code> , <code>2//3+2//3*im</code> , <code>3.0+0.0*im</code> ( <code>im</code> is an imaginary unit, only a number with an explicitly written imaginary part is considered complex) </li><li>  Number ( <code>Number</code> ) - all of the above </li></ul><br><br>  Lines and characters: <br><ul><li>  <code>'a'</code> - character ( <code>Char</code> ) </li><li>  <code>"a"</code> - string ( <code>String</code> ) </li></ul><br><br>  NB: strings, as they are now in many languages, are immutable. <br>  NB: strings (as well as variable names) support Unicode, including emoji. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Arrays: <br><ul><li>  <code>x = [1, 2, 3]</code> - set the array by direct enumeration of elements </li><li>  special constructors: <code>zeros(length)</code> for an array of zeros, <code>ones(length)</code> for an array of ones, <code>rand(length)</code> for an array of random numbers, etc. </li><li>  support for multidimensional arrays </li><li>  support of linear algebra operations (addition of arrays, multiplication by a scalar, multiplication of a matrix by a vector, and much more) in the standard library </li></ul><br><br>  NB: all collections are indexed starting from one. <br>  NB: because  The language is intended for computational tasks, arrays are one of the most important types, and we have to return to the principles of their work more than once. <br><br>  Tuples (ordered set of elements, immutable): <br><ul><li>  <code>(2, 5.3, "k")</code> - regular tuple </li><li>  <code>(a = 3, b = 4)</code> - the named tuple </li></ul><br><br>  NB: the fields of the named tuple can be accessed both by name through a dot, and by index through [] <br><pre> <code class="julia hljs">julia&gt; x = (a = <span class="hljs-number"><span class="hljs-number">5</span></span>, b = <span class="hljs-number"><span class="hljs-number">12</span></span>) (a = <span class="hljs-number"><span class="hljs-number">5</span></span>, b = <span class="hljs-number"><span class="hljs-number">12</span></span>) julia&gt; x[<span class="hljs-number"><span class="hljs-number">1</span></span>] <span class="hljs-number"><span class="hljs-number">5</span></span> julia&gt; sqrt(xa^<span class="hljs-number"><span class="hljs-number">2</span></span> + x[<span class="hljs-number"><span class="hljs-number">2</span></span>]^<span class="hljs-number"><span class="hljs-number">2</span></span>) <span class="hljs-number"><span class="hljs-number">13.0</span></span></code> </pre><br><br>  Dictionaries: <br><pre> <code class="julia hljs">julia&gt; x = <span class="hljs-built_in"><span class="hljs-built_in">Dict</span></span>(<span class="hljs-string"><span class="hljs-string">'a'</span></span> =&gt; <span class="hljs-number"><span class="hljs-number">5</span></span>, <span class="hljs-string"><span class="hljs-string">'b'</span></span> =&gt; <span class="hljs-number"><span class="hljs-number">12</span></span>) <span class="hljs-built_in"><span class="hljs-built_in">Dict</span></span>{<span class="hljs-built_in"><span class="hljs-built_in">Char</span></span>,<span class="hljs-built_in"><span class="hljs-built_in">Int64</span></span>} with <span class="hljs-number"><span class="hljs-number">2</span></span> entries: <span class="hljs-string"><span class="hljs-string">'a'</span></span> =&gt; <span class="hljs-number"><span class="hljs-number">5</span></span> <span class="hljs-string"><span class="hljs-string">'b'</span></span> =&gt; <span class="hljs-number"><span class="hljs-number">12</span></span> julia&gt; x[<span class="hljs-string"><span class="hljs-string">'c'</span></span>] = <span class="hljs-number"><span class="hljs-number">13</span></span> <span class="hljs-number"><span class="hljs-number">13</span></span> julia&gt; x <span class="hljs-built_in"><span class="hljs-built_in">Dict</span></span>{<span class="hljs-built_in"><span class="hljs-built_in">Char</span></span>,<span class="hljs-built_in"><span class="hljs-built_in">Int64</span></span>} with <span class="hljs-number"><span class="hljs-number">3</span></span> entries: <span class="hljs-string"><span class="hljs-string">'a'</span></span> =&gt; <span class="hljs-number"><span class="hljs-number">5</span></span> <span class="hljs-string"><span class="hljs-string">'c'</span></span> =&gt; <span class="hljs-number"><span class="hljs-number">13</span></span> <span class="hljs-string"><span class="hljs-string">'b'</span></span> =&gt; <span class="hljs-number"><span class="hljs-number">12</span></span></code> </pre><br><br><h4>  Basic language control structures </h4><br>  1. Variables are automatically created upon assignment.  Type is optional. <br><pre> <code class="julia hljs">julia&gt; x = <span class="hljs-number"><span class="hljs-number">7</span></span>; x + <span class="hljs-number"><span class="hljs-number">2</span></span> <span class="hljs-number"><span class="hljs-number">9</span></span> julia&gt; x = <span class="hljs-number"><span class="hljs-number">42.0</span></span>; x * <span class="hljs-number"><span class="hljs-number">4</span></span> <span class="hljs-number"><span class="hljs-number">168.0</span></span></code> </pre><br>  2. The conditional transition block begins with the expression <code>if &lt;condition&gt;</code> and ends with the word <code>end</code> .  You can also have an <code>else</code> flower or <code>else</code> if a flower: <br><pre> <code class="julia hljs"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span> x &gt; y println(<span class="hljs-string"><span class="hljs-string">"X is more than Y"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">elseif</span></span> x == y println(<span class="hljs-string"><span class="hljs-string">"X and Y are equal"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> println(<span class="hljs-string"><span class="hljs-string">"X is less than Y"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">end</span></span></code> </pre><br>  3. There are two loop constructs: <code>while</code> and <code>for</code> .  The second works as in Python, i.e.  iterates over the collection.  Frequent use is iteration over a range of values, the syntax of which is <code>start[:increment]:end</code> .  Unlike Python, the range <i>includes</i> both initial and final values, i.e.  the empty range will not be <code>1:1</code> (this is a range of one value 1), but <code>1:0</code> .  The end of the loop body is marked with the word <code>end</code> . <br><pre> <code class="julia hljs">julia&gt; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> i <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span>:<span class="hljs-number"><span class="hljs-number">3</span></span>; print(i, <span class="hljs-string"><span class="hljs-string">" "</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">end</span></span> <span class="hljs-comment"><span class="hljs-comment">#   1  3   1 ( ) 1 2 3 julia&gt; for i in 1:2:3; print(i, " "); end #   1  3   2 1 3</span></span></code> </pre><br>  4. Functions are defined by the <code>function</code> keyword, the <code>function</code> definition is also completed by the word <code>end</code> .  Arguments with default values ‚Äã‚Äãand named arguments are supported. <br><pre> <code class="julia hljs"><span class="hljs-keyword"><span class="hljs-keyword">function</span></span> square(x) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> x * x <span class="hljs-keyword"><span class="hljs-keyword">end</span></span> <span class="hljs-keyword"><span class="hljs-keyword">function</span></span> cube(x) x * square(x) <span class="hljs-comment"><span class="hljs-comment">#       ; return   end function root(x, degree = 2) #  degree     return x^(1.0/degree) end function greeting(name; times = 42, greet = "hello") #       println(times, " times ", greet, " to ", name) end julia&gt; greeting("John") 42 times hello to John julia&gt; greeting("Mike", greet = "wassup", times = 100500) #           100500 times wassup to Mike</span></span></code> </pre><br><br>  In general, this is all quite similar to Python, except for small differences in the syntax and the fact that blocks of code are not allocated with spaces, but still keywords.  In simple cases, Python programs are even translated to Julia almost one to one. <br>  But there is a significant difference in that in Julia for variables you can explicitly specify types, which allows you to compile programs by getting a quick code. <br>  The second significant difference is that Python implements the ‚Äúclassical‚Äù OOP model with classes and methods, and Julia implements the multiple dispatching model. <br><br><h4>  Type annotations and multiple dispatching </h4><br>  Let's see what a built-in function is: <br><pre> <code class="julia hljs">julia&gt; sqrt sqrt (generic <span class="hljs-keyword"><span class="hljs-keyword">function</span></span> with <span class="hljs-number"><span class="hljs-number">19</span></span> methods)</code> </pre><br>  As the REPL shows us, <code>sqrt</code> is a generic function with 19 methods.  What kind of generic function and what methods? <br><br>  And this means that there are <i>several</i> <code>sqrt</code> functions that are applied to different types of arguments and, accordingly, they calculate the square root using different algorithms.  See what options there are, by typing <br><pre> <code class="julia hljs">julia&gt; methods(sqrt)</code> </pre><br>  It can be seen that the function is defined for different types of numbers, as well as for matrices. <br><br>  Unlike the ‚Äúclassical‚Äù OOP, where a specific implementation of a method is determined only by the calling class (dispatching by the first argument), in Julia the choice of a function is determined by the types (and number) of <i>all</i> its arguments. <br>  When calling a function with specific arguments, from all its methods, the one that most accurately describes the specific set of types with which the function is called is selected, and it is used. <br><br>  A distinctive feature is that the approach used, called by the authors of the language ‚Äújust ahead-of-time‚Äù compilation.  Those.  the functions are compiled for the given data types on the first call, after which the next calls are made much faster.  The difference between the first and subsequent calls can be quite significant: <br><pre> <code class="julia hljs">julia&gt; <span class="hljs-meta"><span class="hljs-meta">@time</span></span> sqrt(<span class="hljs-number"><span class="hljs-number">8</span></span>) <span class="hljs-comment"><span class="hljs-comment">#  @time -      0.006811 seconds (3.15 k allocations: 168.516 KiB) #   ,        2.8284271247461903 julia&gt; @time sqrt(15) 0.000002 seconds (5 allocations: 176 bytes) # 5   -     @time 3.872983346207417</span></span></code> </pre><br>  In the bad case, each function call is a check of the types of the arguments received and a search for the desired method in the list.  However, if you give hints to the compiler, checks can be eliminated, which will lead to faster code. <br><br>  For example, consider calculating the sum <br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_SVG_Display" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-1-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mtext>&amp;#xA0;</mtext><mi>s</mi><mi>u</mi><msubsup><mi>m</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>k</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></msubsup><mtext>&amp;#xA0;</mtext><mi>s</mi><mi>q</mi><mi>r</mi><mi>t</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>(</mo><mo>&amp;#x2212;</mo><mn>1</mn><msup><mo stretchy=&quot;false&quot;>)</mo><mi>k</mi></msup></mrow></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="18.728ex" height="3.262ex" viewBox="0 -987.6 8063.4 1404.6" role="img" focusable="false" style="vertical-align: -0.969ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/450628/&amp;xid=17259,15700021,15700186,15700190,15700253,15700256,15700259&amp;usg=ALkJrhicY_HcMwpVHuyDksdC9Yksmu-FRw#MJMATHI-73" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/450628/&amp;xid=17259,15700021,15700186,15700190,15700253,15700256,15700259&amp;usg=ALkJrhicY_HcMwpVHuyDksdC9Yksmu-FRw#MJMATHI-75" x="719" y="0"></use><g transform="translate(1292,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/450628/&amp;xid=17259,15700021,15700186,15700190,15700253,15700256,15700259&amp;usg=ALkJrhicY_HcMwpVHuyDksdC9Yksmu-FRw#MJMATHI-6D" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/450628/&amp;xid=17259,15700021,15700186,15700190,15700253,15700256,15700259&amp;usg=ALkJrhicY_HcMwpVHuyDksdC9Yksmu-FRw#MJMATHI-4E" x="1242" y="488"></use><g transform="translate(878,-327)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/450628/&amp;xid=17259,15700021,15700186,15700190,15700253,15700256,15700259&amp;usg=ALkJrhicY_HcMwpVHuyDksdC9Yksmu-FRw#MJMATHI-6B" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/450628/&amp;xid=17259,15700021,15700186,15700190,15700253,15700256,15700259&amp;usg=ALkJrhicY_HcMwpVHuyDksdC9Yksmu-FRw#MJMAIN-3D" x="521" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/450628/&amp;xid=17259,15700021,15700186,15700190,15700253,15700256,15700259&amp;usg=ALkJrhicY_HcMwpVHuyDksdC9Yksmu-FRw#MJMAIN-31" x="1300" y="0"></use></g></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/450628/&amp;xid=17259,15700021,15700186,15700190,15700253,15700256,15700259&amp;usg=ALkJrhicY_HcMwpVHuyDksdC9Yksmu-FRw#MJMATHI-73" x="3793" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/450628/&amp;xid=17259,15700021,15700186,15700190,15700253,15700256,15700259&amp;usg=ALkJrhicY_HcMwpVHuyDksdC9Yksmu-FRw#MJMATHI-71" x="4263" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/450628/&amp;xid=17259,15700021,15700186,15700190,15700253,15700256,15700259&amp;usg=ALkJrhicY_HcMwpVHuyDksdC9Yksmu-FRw#MJMATHI-72" x="4723" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/450628/&amp;xid=17259,15700021,15700186,15700190,15700253,15700256,15700259&amp;usg=ALkJrhicY_HcMwpVHuyDksdC9Yksmu-FRw#MJMATHI-74" x="5175" y="0"></use><g transform="translate(5536,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/450628/&amp;xid=17259,15700021,15700186,15700190,15700253,15700256,15700259&amp;usg=ALkJrhicY_HcMwpVHuyDksdC9Yksmu-FRw#MJMAIN-28" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/450628/&amp;xid=17259,15700021,15700186,15700190,15700253,15700256,15700259&amp;usg=ALkJrhicY_HcMwpVHuyDksdC9Yksmu-FRw#MJMAIN-2212" x="389" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/450628/&amp;xid=17259,15700021,15700186,15700190,15700253,15700256,15700259&amp;usg=ALkJrhicY_HcMwpVHuyDksdC9Yksmu-FRw#MJMAIN-31" x="1168" y="0"></use><g transform="translate(1668,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/450628/&amp;xid=17259,15700021,15700186,15700190,15700253,15700256,15700259&amp;usg=ALkJrhicY_HcMwpVHuyDksdC9Yksmu-FRw#MJMAIN-29" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/450628/&amp;xid=17259,15700021,15700186,15700190,15700253,15700256,15700259&amp;usg=ALkJrhicY_HcMwpVHuyDksdC9Yksmu-FRw#MJMATHI-6B" x="550" y="583"></use></g></g></g></svg><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mtext>&nbsp;</mtext><mi>s</mi><mi>u</mi><msubsup><mi>m</mi><mrow class="MJX-TeXAtom-ORD"><mi>k</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></msubsup><mtext>&nbsp;</mtext><mi>s</mi><mi>q</mi><mi>r</mi><mi>t</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">(</mo><mo>‚àí</mo><mn>1</mn><msup><mo stretchy="false">)</mo><mi>k</mi></msup></mrow></math></span></span></div><script type="math/tex;mode=display" id="MathJax-Element-1"> \ sum_ {k = 1} ^ N \ sqrt {(- 1) ^ k} </script></p><br><pre> <code class="julia hljs"><span class="hljs-keyword"><span class="hljs-keyword">function</span></span> mysqrt(num) <span class="hljs-comment"><span class="hljs-comment">#    -     #   -           if num &gt;= 0 return sqrt(num) else return sqrt(complex(num)) end end function S(n) #    sum = 0 sgn = -1 for k = 1:n sum += mysqrt(sgn) sgn = -sgn end return sum end function S_typed(n::Integer) # ..     ,      #     sum::Complex = 0.0 sgn::Int = -1 for k = 1:n sum += mysqrt(sgn) sgn = -sgn end return sum end</span></span></code> </pre><br>  The benchmark shows that the <code>S_typed()</code> function not only executes faster, but also does not require memory allocations on every call, unlike <code>S()</code> .  The problem here is that the type of the <code>mysqrt()</code> returned from <code>mysqrt()</code> is not defined, as is the type of the right side of the expression <br><pre> <code class="julia hljs">sum = sum + mysqrt(sgn)</code> </pre><br>  As a result, the compiler cannot even understand what type the <code>sum</code> will be at each iteration.  So, boxing (hitch type labels) variable and memory allocation. <br>  For the <code>S_typed()</code> function, the compiler knows in advance that the <code>sum</code> is a complex value, so the code is more optimized (in particular, the <code>mysqrt()</code> call can be effectively zainlaynit, leading the return value to always <code>Complex</code> ). <br><br>  More importantly, for <code>S_typed()</code> compiler knows that the return value is of type <code>Complex</code> , but for <code>S()</code> type of output value is not defined again, which will slow down all functions where <code>S()</code> will be called. <br>  You can check what the compiler thinks about the types returned from the expression using the macro <code>@code_warntype</code> : <br><pre> <code class="julia hljs">julia&gt; <span class="hljs-meta"><span class="hljs-meta">@code_warntype</span></span> S(<span class="hljs-number"><span class="hljs-number">3</span></span>) Body::<span class="hljs-built_in"><span class="hljs-built_in">Any</span></span> <span class="hljs-comment"><span class="hljs-comment">#     ,      ... julia&gt; @code_warntype S_typed(3) Body::Complex{Float64} #      ...</span></span></code> </pre><br>  If a function is called for you somewhere in the loop, for which <code>@code_warntype</code> cannot deduce the returned type, or for which it is in the body somewhere, it shows the receipt of the <code>Any</code> value - then optimizing these calls will most likely give a very noticeable performance increase. <br><br><h4>  Composite types </h4><br>  A programmer can define composite data types for his needs with a <code>struct</code> : <br><pre> <code class="julia hljs">julia&gt; <span class="hljs-keyword"><span class="hljs-keyword">struct</span></span> GenericStruct <span class="hljs-comment"><span class="hljs-comment">#   struct    name b::Int c::Char v::Vector end #       #       ,        julia&gt; s = GenericStruct("Name", 1, 'z', [3., 0]) GenericStruct("Name", 1, 'z', [3.0, 0.0]) julia&gt; s.name, sb, sc, sv ("Name", 1, 'z', [3.0, 0.0])</span></span></code> </pre><br>  Structures in Julia are immutable, that is, by creating a copy of the structure, you cannot change field values ‚Äã‚Äã(more precisely, you cannot change the address of fields in the memory ‚Äî elements of mutable fields, such as <code>sv</code> in the example above, can be changed).  Mutable structures are created by the <code>mutable struct</code> construction, the syntax of which is the same as for ordinary structures. <br><br>  Inheritance of structures in the ‚Äúclassical‚Äù sense is not supported, but there is a possibility of ‚Äúinheriting‚Äù behavior by combining composite types into supertypes or, as they are called in Julia, abstract types.  Type relationships are expressed as <code>A&lt;:B</code> (A - subtype B) and <code>A&gt;:B</code> (A - supertype B).  It looks like this: <br><pre> <code class="julia hljs"><span class="hljs-keyword"><span class="hljs-keyword">abstract type</span></span> NDimPoint <span class="hljs-keyword"><span class="hljs-keyword">end</span></span> <span class="hljs-comment"><span class="hljs-comment">#   -     # ,    -     N  struct PointScalar&lt;:NDimPoint x1::Real end struct Point2D&lt;:NDimPoint x1::Real x2::Real end struct Point3D&lt;:NDimPoint x1::Real x2::Real x3::Real end #     ;   Markdown """ mag(p::NDimPoint) Calculate the magnitude of the radius vector of an N-dimensional point `p` """ function mag(p::NDimPoint) sqrmag = 0.0 # ..   ,       #     T   fieldnames(T) for name in fieldnames(typeof(p)) sqrmag += getfield(p, name)^2 end return sqrt(sqrmag) end """ add(p1::T, p2::T) where T&lt;:NDimPoint Calculate the sum of the radius vectors of two N-dimensional points `p1` and `p2` """ function add(p1::T, p2::T) where T&lt;:NDimPoint #  -  , ..       #     list comprehension sumvector = [Float64(getfield(p1, name) + getfield(p1, name)) for name in fieldnames(T)] #     ,    #  ...      , .. # f([1, 2, 3]...) -   ,  f(1, 2, 3) return T(sumvector...) end</span></span></code> </pre><br><h4>  Case study: Polynomials </h4><br>  The type system, coupled with multiple dispatching, is convenient for expressing mathematical concepts.  Consider the example of a simple library for working with polynomials. <br>  We introduce two types of polynomials: ‚Äúcanonical‚Äù, defined by coefficients with powers, and ‚Äúinterpolation‚Äù, defined by a set of pairs (x, f (x)).  For simplicity, we will consider only valid arguments. <br><br>  A structure that has an array or a tuple of coefficients as a field is suitable for storing a polynomial in a regular record.  So that it is completely immutable, let it be a tuple.  Thus, the code for defining an abstract type, the structure of a polynomial and calculating the value of a polynomial at a given point is quite simple: <br><pre> <code class="julia hljs"><span class="hljs-keyword"><span class="hljs-keyword">abstract type</span></span> AbstractPolynomial <span class="hljs-keyword"><span class="hljs-keyword">end</span></span> <span class="hljs-string"><span class="hljs-string">""" Polynomial &lt;: AbstractPolynomial Polynomials written in the canonical form """</span></span> <span class="hljs-keyword"><span class="hljs-keyword">struct</span></span> Polynomial&lt;:AbstractPolynomial degree::<span class="hljs-built_in"><span class="hljs-built_in">Int</span></span> coeff::<span class="hljs-built_in"><span class="hljs-built_in">NTuple</span></span>{N, <span class="hljs-built_in"><span class="hljs-built_in">Float64</span></span>} <span class="hljs-keyword"><span class="hljs-keyword">where</span></span> N <span class="hljs-comment"><span class="hljs-comment"># NTuple{N, Type} -    N    end """ evpoly(p::Polynomial, z::Real) Evaluate polynomial `p` at `z` using the Horner's rule """ function evpoly(p::Polynomial, z::Real) ans = p.coeff[end] for idx = p.degree:-1:1 ans = p.coeff[idx] + z * ans end return ans end</span></span></code> </pre><br><br>  Interpolation polynomials require a different representation structure and method of calculation.  In particular, if the set of interpolation points is known in advance, and the same polynomial is planned to be calculated at different points, <a href="https://en.wikipedia.org/wiki/Newton_polynomial">Newton's interpolation formula is</a> convenient: <br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_SVG_Display" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-2-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mi>P</mi><mo stretchy=&quot;false&quot;>(</mo><mi>x</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><mtext>&amp;#xA0;</mtext><mi>s</mi><mi>u</mi><msubsup><mi>m</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>k</mi><mo>=</mo><mn>0</mn></mrow><mi>N</mi></msubsup><mrow class=&quot;MJX-TeXAtom-ORD&quot;><msub><mi>c</mi><mi>k</mi></msub><msub><mi>n</mi><mi>k</mi></msub><mo stretchy=&quot;false&quot;>(</mo><mi>x</mi><mo stretchy=&quot;false&quot;>)</mo></mrow><mo>,</mo></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="24.578ex" height="3.021ex" viewBox="0 -883.9 10582.2 1300.8" role="img" focusable="false" style="vertical-align: -0.969ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/450628/&amp;xid=17259,15700021,15700186,15700190,15700253,15700256,15700259&amp;usg=ALkJrhicY_HcMwpVHuyDksdC9Yksmu-FRw#MJMATHI-50" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/450628/&amp;xid=17259,15700021,15700186,15700190,15700253,15700256,15700259&amp;usg=ALkJrhicY_HcMwpVHuyDksdC9Yksmu-FRw#MJMAIN-28" x="751" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/450628/&amp;xid=17259,15700021,15700186,15700190,15700253,15700256,15700259&amp;usg=ALkJrhicY_HcMwpVHuyDksdC9Yksmu-FRw#MJMATHI-78" x="1141" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/450628/&amp;xid=17259,15700021,15700186,15700190,15700253,15700256,15700259&amp;usg=ALkJrhicY_HcMwpVHuyDksdC9Yksmu-FRw#MJMAIN-29" x="1713" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/450628/&amp;xid=17259,15700021,15700186,15700190,15700253,15700256,15700259&amp;usg=ALkJrhicY_HcMwpVHuyDksdC9Yksmu-FRw#MJMAIN-3D" x="2380" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/450628/&amp;xid=17259,15700021,15700186,15700190,15700253,15700256,15700259&amp;usg=ALkJrhicY_HcMwpVHuyDksdC9Yksmu-FRw#MJMATHI-73" x="3687" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/450628/&amp;xid=17259,15700021,15700186,15700190,15700253,15700256,15700259&amp;usg=ALkJrhicY_HcMwpVHuyDksdC9Yksmu-FRw#MJMATHI-75" x="4156" y="0"></use><g transform="translate(4729,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/450628/&amp;xid=17259,15700021,15700186,15700190,15700253,15700256,15700259&amp;usg=ALkJrhicY_HcMwpVHuyDksdC9Yksmu-FRw#MJMATHI-6D" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/450628/&amp;xid=17259,15700021,15700186,15700190,15700253,15700256,15700259&amp;usg=ALkJrhicY_HcMwpVHuyDksdC9Yksmu-FRw#MJMATHI-4E" x="1242" y="488"></use><g transform="translate(878,-327)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/450628/&amp;xid=17259,15700021,15700186,15700190,15700253,15700256,15700259&amp;usg=ALkJrhicY_HcMwpVHuyDksdC9Yksmu-FRw#MJMATHI-6B" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/450628/&amp;xid=17259,15700021,15700186,15700190,15700253,15700256,15700259&amp;usg=ALkJrhicY_HcMwpVHuyDksdC9Yksmu-FRw#MJMAIN-3D" x="521" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/450628/&amp;xid=17259,15700021,15700186,15700190,15700253,15700256,15700259&amp;usg=ALkJrhicY_HcMwpVHuyDksdC9Yksmu-FRw#MJMAIN-30" x="1300" y="0"></use></g></g><g transform="translate(6980,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/450628/&amp;xid=17259,15700021,15700186,15700190,15700253,15700256,15700259&amp;usg=ALkJrhicY_HcMwpVHuyDksdC9Yksmu-FRw#MJMATHI-63" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/450628/&amp;xid=17259,15700021,15700186,15700190,15700253,15700256,15700259&amp;usg=ALkJrhicY_HcMwpVHuyDksdC9Yksmu-FRw#MJMATHI-6B" x="613" y="-213"></use><g transform="translate(902,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/450628/&amp;xid=17259,15700021,15700186,15700190,15700253,15700256,15700259&amp;usg=ALkJrhicY_HcMwpVHuyDksdC9Yksmu-FRw#MJMATHI-6E" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/450628/&amp;xid=17259,15700021,15700186,15700190,15700253,15700256,15700259&amp;usg=ALkJrhicY_HcMwpVHuyDksdC9Yksmu-FRw#MJMATHI-6B" x="849" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/450628/&amp;xid=17259,15700021,15700186,15700190,15700253,15700256,15700259&amp;usg=ALkJrhicY_HcMwpVHuyDksdC9Yksmu-FRw#MJMAIN-28" x="1971" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/450628/&amp;xid=17259,15700021,15700186,15700190,15700253,15700256,15700259&amp;usg=ALkJrhicY_HcMwpVHuyDksdC9Yksmu-FRw#MJMATHI-78" x="2361" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/450628/&amp;xid=17259,15700021,15700186,15700190,15700253,15700256,15700259&amp;usg=ALkJrhicY_HcMwpVHuyDksdC9Yksmu-FRw#MJMAIN-29" x="2933" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/450628/&amp;xid=17259,15700021,15700186,15700190,15700253,15700256,15700259&amp;usg=ALkJrhicY_HcMwpVHuyDksdC9Yksmu-FRw#MJMAIN-2C" x="10303" y="0"></use></g></svg><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>P</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><mtext>&nbsp;</mtext><mi>s</mi><mi>u</mi><msubsup><mi>m</mi><mrow class="MJX-TeXAtom-ORD"><mi>k</mi><mo>=</mo><mn>0</mn></mrow><mi>N</mi></msubsup><mrow class="MJX-TeXAtom-ORD"><msub><mi>c</mi><mi>k</mi></msub><msub><mi>n</mi><mi>k</mi></msub><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow><mo>,</mo></math></span></span></div><script type="math/tex;mode=display" id="MathJax-Element-2"> P (x) = \ sum_ {k = 0} ^ N {c_k n_k (x)}, </script></p><br>  where <i>n <sub>k</sub></i> ( <i>x</i> ) are basic polynomials, <i>n <sub>0</sub></i> ( <i>x</i> ) and for <i>k</i> &gt; 0 <br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_SVG_Display" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-3-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><msub><mi>n</mi><mi>k</mi></msub><mo stretchy=&quot;false&quot;>(</mo><mi>x</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><mtext>&amp;#xA0;</mtext><mi>p</mi><mi>r</mi><mi>o</mi><msubsup><mi>d</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>i</mi><mo>=</mo><mn>0</mn></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>k</mi><mo>&amp;#x2212;</mo><mn>1</mn></mrow></msubsup><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>(</mo><mi>x</mi><mo>&amp;#x2212;</mo><msub><mi>x</mi><mi>i</mi></msub><mo stretchy=&quot;false&quot;>)</mo></mrow><mo>,</mo></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="25.81ex" height="3.262ex" viewBox="0 -987.6 11112.7 1404.6" role="img" focusable="false" style="vertical-align: -0.969ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/450628/&amp;xid=17259,15700021,15700186,15700190,15700253,15700256,15700259&amp;usg=ALkJrhicY_HcMwpVHuyDksdC9Yksmu-FRw#MJMATHI-6E" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/450628/&amp;xid=17259,15700021,15700186,15700190,15700253,15700256,15700259&amp;usg=ALkJrhicY_HcMwpVHuyDksdC9Yksmu-FRw#MJMATHI-6B" x="849" y="-213"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/450628/&amp;xid=17259,15700021,15700186,15700190,15700253,15700256,15700259&amp;usg=ALkJrhicY_HcMwpVHuyDksdC9Yksmu-FRw#MJMAIN-28" x="1069" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/450628/&amp;xid=17259,15700021,15700186,15700190,15700253,15700256,15700259&amp;usg=ALkJrhicY_HcMwpVHuyDksdC9Yksmu-FRw#MJMATHI-78" x="1458" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/450628/&amp;xid=17259,15700021,15700186,15700190,15700253,15700256,15700259&amp;usg=ALkJrhicY_HcMwpVHuyDksdC9Yksmu-FRw#MJMAIN-29" x="2031" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/450628/&amp;xid=17259,15700021,15700186,15700190,15700253,15700256,15700259&amp;usg=ALkJrhicY_HcMwpVHuyDksdC9Yksmu-FRw#MJMAIN-3D" x="2698" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/450628/&amp;xid=17259,15700021,15700186,15700190,15700253,15700256,15700259&amp;usg=ALkJrhicY_HcMwpVHuyDksdC9Yksmu-FRw#MJMATHI-70" x="4004" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/450628/&amp;xid=17259,15700021,15700186,15700190,15700253,15700256,15700259&amp;usg=ALkJrhicY_HcMwpVHuyDksdC9Yksmu-FRw#MJMATHI-72" x="4508" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/450628/&amp;xid=17259,15700021,15700186,15700190,15700253,15700256,15700259&amp;usg=ALkJrhicY_HcMwpVHuyDksdC9Yksmu-FRw#MJMATHI-6F" x="4959" y="0"></use><g transform="translate(5445,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/450628/&amp;xid=17259,15700021,15700186,15700190,15700253,15700256,15700259&amp;usg=ALkJrhicY_HcMwpVHuyDksdC9Yksmu-FRw#MJMATHI-64" x="0" y="0"></use><g transform="translate(524,403)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/450628/&amp;xid=17259,15700021,15700186,15700190,15700253,15700256,15700259&amp;usg=ALkJrhicY_HcMwpVHuyDksdC9Yksmu-FRw#MJMATHI-6B" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/450628/&amp;xid=17259,15700021,15700186,15700190,15700253,15700256,15700259&amp;usg=ALkJrhicY_HcMwpVHuyDksdC9Yksmu-FRw#MJMAIN-2212" x="521" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/450628/&amp;xid=17259,15700021,15700186,15700190,15700253,15700256,15700259&amp;usg=ALkJrhicY_HcMwpVHuyDksdC9Yksmu-FRw#MJMAIN-31" x="1300" y="0"></use></g><g transform="translate(520,-308)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/450628/&amp;xid=17259,15700021,15700186,15700190,15700253,15700256,15700259&amp;usg=ALkJrhicY_HcMwpVHuyDksdC9Yksmu-FRw#MJMATHI-69" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/450628/&amp;xid=17259,15700021,15700186,15700190,15700253,15700256,15700259&amp;usg=ALkJrhicY_HcMwpVHuyDksdC9Yksmu-FRw#MJMAIN-3D" x="345" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/450628/&amp;xid=17259,15700021,15700186,15700190,15700253,15700256,15700259&amp;usg=ALkJrhicY_HcMwpVHuyDksdC9Yksmu-FRw#MJMAIN-30" x="1124" y="0"></use></g></g><g transform="translate(7342,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/450628/&amp;xid=17259,15700021,15700186,15700190,15700253,15700256,15700259&amp;usg=ALkJrhicY_HcMwpVHuyDksdC9Yksmu-FRw#MJMAIN-28" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/450628/&amp;xid=17259,15700021,15700186,15700190,15700253,15700256,15700259&amp;usg=ALkJrhicY_HcMwpVHuyDksdC9Yksmu-FRw#MJMATHI-78" x="389" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/450628/&amp;xid=17259,15700021,15700186,15700190,15700253,15700256,15700259&amp;usg=ALkJrhicY_HcMwpVHuyDksdC9Yksmu-FRw#MJMAIN-2212" x="1184" y="0"></use><g transform="translate(2184,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/450628/&amp;xid=17259,15700021,15700186,15700190,15700253,15700256,15700259&amp;usg=ALkJrhicY_HcMwpVHuyDksdC9Yksmu-FRw#MJMATHI-78" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/450628/&amp;xid=17259,15700021,15700186,15700190,15700253,15700256,15700259&amp;usg=ALkJrhicY_HcMwpVHuyDksdC9Yksmu-FRw#MJMATHI-69" x="809" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/450628/&amp;xid=17259,15700021,15700186,15700190,15700253,15700256,15700259&amp;usg=ALkJrhicY_HcMwpVHuyDksdC9Yksmu-FRw#MJMAIN-29" x="3101" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/450628/&amp;xid=17259,15700021,15700186,15700190,15700253,15700256,15700259&amp;usg=ALkJrhicY_HcMwpVHuyDksdC9Yksmu-FRw#MJMAIN-2C" x="10834" y="0"></use></g></svg><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><msub><mi>n</mi><mi>k</mi></msub><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><mtext>&nbsp;</mtext><mi>p</mi><mi>r</mi><mi>o</mi><msubsup><mi>d</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mo>=</mo><mn>0</mn></mrow><mrow class="MJX-TeXAtom-ORD"><mi>k</mi><mo>‚àí</mo><mn>1</mn></mrow></msubsup><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">(</mo><mi>x</mi><mo>‚àí</mo><msub><mi>x</mi><mi>i</mi></msub><mo stretchy="false">)</mo></mrow><mo>,</mo></math></span></span></div><script type="math/tex;mode=display" id="MathJax-Element-3"> n_k (x) = \ prod_ {i = 0} ^ {k-1} {(x-x_i)}, </script></p><br>  where <i>x <sub>i</sub></i> - interpolation nodes. <br><br>  From the above formulas it is clear that storage is conveniently organized as a set of interpolation nodes <i>x <sub>i</sub></i> and coefficients <i>c <sub>i</sub></i> , and the calculation can be done in a manner similar to Horner‚Äôs scheme. <br><pre> <code class="julia hljs"><span class="hljs-string"><span class="hljs-string">""" InterpPolynomial &lt;: AbstractPolynomial Interpolation polynomials in Newton's form """</span></span> <span class="hljs-keyword"><span class="hljs-keyword">struct</span></span> InterpPolynomial&lt;:AbstractPolynomial degree::<span class="hljs-built_in"><span class="hljs-built_in">Int</span></span> xval::<span class="hljs-built_in"><span class="hljs-built_in">NTuple</span></span>{N, <span class="hljs-built_in"><span class="hljs-built_in">Float64</span></span>} <span class="hljs-keyword"><span class="hljs-keyword">where</span></span> N coeff::<span class="hljs-built_in"><span class="hljs-built_in">NTuple</span></span>{N, <span class="hljs-built_in"><span class="hljs-built_in">Float64</span></span>} <span class="hljs-keyword"><span class="hljs-keyword">where</span></span> N <span class="hljs-keyword"><span class="hljs-keyword">end</span></span> <span class="hljs-string"><span class="hljs-string">""" evpoly(p::Polynomial, z::Real) Evaluate polynomial `p` at `z` using the Horner's rule """</span></span> <span class="hljs-keyword"><span class="hljs-keyword">function</span></span> evpoly(p::InterpPolynomial, z::<span class="hljs-built_in"><span class="hljs-built_in">Real</span></span>) ans = p.coeff[p.degree+<span class="hljs-number"><span class="hljs-number">1</span></span>] <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> idx = p.degree:-<span class="hljs-number"><span class="hljs-number">1</span></span>:<span class="hljs-number"><span class="hljs-number">1</span></span> ans = ans * (z - p.xval[idx]) + p.coeff[idx] <span class="hljs-keyword"><span class="hljs-keyword">end</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> ans <span class="hljs-keyword"><span class="hljs-keyword">end</span></span></code> </pre><br>  The function for calculating the value of a polynomial in both cases is called the same - <code>evpoly()</code> - but it takes different types of arguments. <br><br>  In addition to the calculation function, it would be nice to also write a function that creates a polynomial from known data. <br><br>  For this, Julia has two methods: external constructors and internal constructors.  An external constructor is simply a function that returns an object of the appropriate type.  The inner constructor is a function that is entered inside the structure description and replaces the standard constructor.  To construct interpolation polynomials, it is advisable to use the internal constructor, since <br><ul><li>  it is more convenient to get a polynomial not through interpolation nodes and coefficients, but through nodes and values ‚Äã‚Äãof the interpolated function </li><li>  interpolation nodes must necessarily be different </li><li>  the number of nodes and coefficients must match </li></ul><br>  Writing an internal constructor, in which these rules are guaranteed to be observed, ensures that all created variables of the <code>InterpPolynomial</code> type <code>InterpPolynomial</code> at least be correctly processed by the <code>evpoly()</code> function. <br><br>  We write the constructor of ordinary polynomials, which takes as input a one-dimensional array or a tuple of coefficients.  The constructor of the interpolation polynomial takes as input the interpolation nodes and the desired values ‚Äã‚Äãin them and uses the <a href="https://en.wikipedia.org/wiki/Newton_polynomial">method of divided differences</a> to calculate the coefficients. <br><pre> <code class="julia hljs"><span class="hljs-string"><span class="hljs-string">""" Polynomial &lt;: AbstractPolynomial Polynomials written in the canonical form --- Polynomial(v::T) where T&lt;:Union{Vector{&lt;:Real}, NTuple{&lt;:Any, &lt;:Real}}) Construct a `Polynomial` from the list of the coefficients. The coefficients are assumed to go from power 0 in the ascending order. If an empty collection is provided, the constructor returns a zero polynomial. """</span></span> <span class="hljs-keyword"><span class="hljs-keyword">struct</span></span> Polynomial&lt;:AbstractPolynomial degree::<span class="hljs-built_in"><span class="hljs-built_in">Int</span></span> coeff::<span class="hljs-built_in"><span class="hljs-built_in">NTuple</span></span>{N, <span class="hljs-built_in"><span class="hljs-built_in">Float64</span></span>} <span class="hljs-keyword"><span class="hljs-keyword">where</span></span> N <span class="hljs-keyword"><span class="hljs-keyword">function</span></span> Polynomial(v::T <span class="hljs-keyword"><span class="hljs-keyword">where</span></span> T&lt;:<span class="hljs-built_in"><span class="hljs-built_in">Union</span></span>{<span class="hljs-built_in"><span class="hljs-built_in">Vector</span></span>{&lt;:<span class="hljs-built_in"><span class="hljs-built_in">Real</span></span>}, <span class="hljs-built_in"><span class="hljs-built_in">NTuple</span></span>{&lt;:<span class="hljs-built_in"><span class="hljs-built_in">Any</span></span>, &lt;:<span class="hljs-built_in"><span class="hljs-built_in">Real</span></span>}}) <span class="hljs-comment"><span class="hljs-comment">#     /     P(x) ‚â° 0 coeff = isempty(v) ? (0.0,) : tuple([Float64(x) for x in v]...) #   -   new #  -    return new(length(coeff)-1, coeff) end end """ InterpPolynomial &lt;: AbstractPolynomial Interpolation polynomials in Newton's form --- InterpPolynomial(xsample::Vector{&lt;:Real}, fsample::Vector{&lt;:Real}) Construct an `InterpPolynomial` from a vector of points `xsample` and corresponding function values `fsample`. All values in `xsample` must be distinct. """ struct InterpPolynomial&lt;:AbstractPolynomial degree::Int xval::NTuple{N, Float64} where N coeff::NTuple{N, Float64} where N function InterpPolynomial(xsample::X, fsample::F) where {X&lt;:Union{Vector{&lt;:Real}, NTuple{&lt;:Any, &lt;:Real}}, F&lt;:Union{Vector{&lt;:Real}, NTuple{&lt;:Any, &lt;:Real}}} #   ,    ,   f  ,   if !allunique(xsample) throw(DomainError("Cannot interpolate with duplicate X points")) end N = length(xsample) if length(fsample) != N throw(DomainError("Lengths of X and F are not the same")) end coeff = [Float64(f) for f in fsample] #     (Stoer, Bulirsch, Introduction to Numerical Analysis, . 2.1.3) for i = 2:N for j = 1:(i-1) coeff[i] = (coeff[j] - coeff[i]) / (xsample[j] - xsample[i]) end end new(N-1, tuple([Float64(x) for x in xsample]...), tuple(coeff...)) end end</span></span></code> </pre><br>  In addition to the actual generation of polynomials, it would be nice to be able to perform arithmetic operations with them. <br><br>  Since in Julia, arithmetic operators are ordinary functions to which an infix notation is added as syntactic sugar (the expressions <code>a + b</code> and <code>+(a, b)</code> are both valid and absolutely identical), their overload is done in the same way as writing additional methods to its functions. <br><br>  The only subtle point is that the custom code is run from the module (namespace) <code>Main</code> , and the functions of the standard library are in the <code>Base</code> module, so when overloaded, you must either import the <code>Base</code> module or write the full name of the function. <br><br>  So, add the addition of a polynomial with a number: <br><pre> <code class="julia hljs"><span class="hljs-comment"><span class="hljs-comment"># -   Base.+  , #    Base.:+,   " :+   Base" function Base.:+(p::Polynomial, x::Real) Polynomial(tuple(p.coeff[1] + x, p.coeff[2:end]...)) end function Base.:+(p::InterpPolynomial, x::Real) # ..           - #          . #       - #        fval::Vector{Float64} = [evpoly(p, xval) + x for xval in p.xval] InterpPolynomial(p.xval, fval) end #       function Base.:+(x::Real, p::AbstractPolynomial) return p + x end</span></span></code> </pre><br>  To add two ordinary polynomials, it is enough to add the coefficients, and when adding an interpolation polynomial with another, you can find the sum values ‚Äã‚Äãat several points and build a new interpolation on them. <br><br><pre> <code class="julia hljs"><span class="hljs-keyword"><span class="hljs-keyword">function</span></span> Base.:+(p1::Polynomial, p2::Polynomial) <span class="hljs-comment"><span class="hljs-comment">#    ,      deg = max(p1.degree, p2.degree) coeff = zeros(deg+1) coeff[1:p1.degree+1] .+= p1.coeff coeff[1:p2.degree+1] .+= p2.coeff Polynomial(coeff) end function Base.:+(p1::InterpPolynomial, p2::InterpPolynomial) xmax = max(p1.xval..., p2.xval...) xmin = min(p1.xval..., p2.xval...) deg = max(p1.degree, p2.degree) dx = xmax - xmin #         #       chebgrid = zeros(deg+1) for k = 1:deg-1 chebgrid[k+1] = xmax - 0.5 * dx * (1 + cos((k - 0.5) * œÄ / (deg - 1))) end chebgrid[1] = xmin chebgrid[end] = xmax fsample = [evpoly(p1, x) + evpoly(p2, x) for x in chebgrid] InterpPolynomial(chebgrid, fsample) end function Base.:+(p1::InterpPolynomial, p2::Polynomial) xmax = max(p1.xval...) xmin = min(p1.xval...) deg = max(p1.degree, p2.degree) dx = xmax - xmin chebgrid = zeros(deg+1) for k = 1:deg-1 chebgrid[k+1] = xmax - 0.5 * dx * (1 + cos((k - 0.5) * œÄ / (deg - 1))) end chebgrid[1] = xmin chebgrid[end] = xmax fsample = [evpoly(p1, x) + evpoly(p2, x) for x in chebgrid] InterpPolynomial(chebgrid, fsample) end function Base.:+(p1::Polynomial, p2::InterpPolynomial) p2 + p1 end</span></span></code> </pre><br>  In the same way, you can add other arithmetic operations on polynomials, as a result of getting a representation of them in the code in a natural mathematical notation. <br><br>  That's all for now.  I will try to write further about the implementation of other numerical methods. <br><br>  In preparing the materials used: <br><ol><li>  Julia language documentation: <a href="https://docs.julialang.org/">docs.julialang.org</a> </li><li>  Julia language discussion platform: <a href="https://discourse.julialang.org/">discourse.julialang.org</a> </li><li>  J.Stoer, W. Bulirsch.  Introduction to Numerical Analysis </li><li>  Julia Hub: <a href="https://habr.com/ru/hub/julia/">habr.com/ru/hub/julia</a> </li><li>  Think Julia: <a href="https://benlauwens.github.io/ThinkJulia.jl/latest/book.html">benlauwens.github.io/ThinkJulia.jl/latest/book.html</a> </li></ol></div><p>Source: <a href="https://habr.com/ru/post/450628/">https://habr.com/ru/post/450628/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../450614/index.html">Joomla Digest for April 2019</a></li>
<li><a href="../450618/index.html">Why, according to statistics from Yandex and StackOverfow C #, are programmers the cheapest?</a></li>
<li><a href="../45062/index.html">Yahoo Search Beat: Key Engineer Goes To Microsoft</a></li>
<li><a href="../450620/index.html">Neutrino Mystery from Supernova 1987A</a></li>
<li><a href="../450626/index.html">Fix design pattern - Singleton in PHP</a></li>
<li><a href="../45063/index.html">Ruby on Rails. Results of the first month</a></li>
<li><a href="../450632/index.html">Crack a basic in 768 bytes</a></li>
<li><a href="../450640/index.html">How to understand that you really quit smoking</a></li>
<li><a href="../450642/index.html">PHP Digest 155 (April 22 - May 6, 2019)</a></li>
<li><a href="../450644/index.html">Cryptocurrency: lives or dies? Part 3</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>