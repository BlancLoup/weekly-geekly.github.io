<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>3 Ways to Break Single Responsibility Principle</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Single Responsibility Principe is simple enough to understand and is easy to follow. 
 But in my work I often encounter a violation of this principle....">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>3 Ways to Break Single Responsibility Principle</h1><div class="post__text post__text-html js-mediator-article">  Single Responsibility Principe is simple enough to understand and is easy to follow. <br>  But in my work I often encounter a violation of this principle.  In this article, I collected the sickest of those ways to break the SPR that I met. <br><a name="habracut"></a><br><h2>  First way: <b>Singleton</b> </h2><br>  Singleton - implies that in addition to its core responsibilities, the class also deals with controlling the number of its own copies, which violates the Single Responsibility Principle. <br><br>  Very easy to create a singleton.  It is enough to copy a couple of lines of code from Wikipedia into your favorite IDE.  Singleton is everywhere, you don‚Äôt need to bother with transferring the object to the right place and you don‚Äôt have to manage the memory either, there is only one instance, and it‚Äôs also eternal.  This lightness, perhaps, is the reason why Singleton is used for other purposes. <br><br><h4>  Singleton increases code connectivity </h4><br>  Singleton dependency is not visible in the public interface.  You can get and use the copy anywhere, no matter what. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Complicated dependencies, and even more hidden ones (those that are not visible in the public interface), lead to the appearance of unexpected effects in parts of the application that, at first glance, are not related to those parts where the code is modified.  This leads to unexpected bugs.  In addition, such bugs may not be found immediately after making changes, due to the non-obvious scope of functionality affected by the change. <br><br><h4>  A singleton instance cannot be replaced without a tambourine dance </h4><br>  Singleton makes polymorphism against yourself impossible.  So, autotests are impossible.  Changing Singleton's behavior during execution is difficult.  The need to translate a component into a special mode that requires a different behavior of Singleton causes pain and suffering. <br><br><h4>  Singleton can store its state </h4><br>  This leads to a change in behavior when changing the order of calls to class methods.  Since Singleton is everywhere, it‚Äôs almost impossible to control the order of calls.  This can lead to a variety of artifacts.  This problem exacerbates the negative effects of increasing code connectivity and generates even more sophisticated bugs. <br><br><h4>  There are more secure spawning patterns. </h4><br>  Increasing the connectivity of the code and the impossibility of replacing its instance successfully solves IoC.  Implementing this principle, for example using Dependency Injection, takes the responsibility of controlling the number of class instances and makes the dependencies more explicit. <br><br><h4>  Despite all the horrors described above, there are places where it is appropriate to use Singleton </h4><br>  A singleton is appropriate in cases where more than one instance of an object cannot logically exist.  For example, NSApplication. <br><br>  In ready-made libraries, using Singleton is justified in situations when there is no need or expensive to customize or replace something. <br><br><h2>  The second way: <b>mixing architectural layers</b> </h2><br>  There are a huge number of ways to mix architectural layers.  Each of the ways is laying out its own rake. <br><br><h4>  Business logic in the model. </h4><br>  Placing business logic in the model object, we add to it, in addition to the primary responsibility - data storage, additional responsibilities associated with the processing of this data.  As a rule, with such an approach, the majority of operations that can be performed with this object accumulate in the model object.  What is a multiple SRP violation. <br><br>  The presence of business logic in the model objects makes it impossible to reuse part of the business logic for another model object, makes it difficult to expand the model, it predisposes to the implementation of polymorphism through copy-paste.  When creating a similar object, a part of the code with business logic is copied with minor changes.  This approach makes it almost impossible to safely change the part of the logic that is in the model. <br><br>  To detect such a violation is quite simple, by the presence of any methods in the model object. <br>  Often there are methods for storing the model object in the device‚Äôs memory or methods for updating data from a remote resource. <br><br><h4>  Incorrect use of MVC, MVP, MVVM patterns </h4><br>  All these patterns are quite similar, it can be seen even by abbreviations.  Everyone has a View and Model.  They differ in the way View interacts with the Model via the intermediate layer. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/web/8ea/c60/f74/8eac60f746dc4bf4bd64187ea3b46067.png"></div><br>  But each of these patterns has one common drawback - the proliferation of Controller, Presenter, or View-Model.  The essence of the problem lies in the misunderstanding of the View component and the component storing business logic (Controller, Presenter or View-Model). <br><br>  The view must contain logic to display the Controller, Presenter, or View-Model user interface must contain business logic.  The MVC iOS SDK deserves the use of words. It imposes the use of MVC.  But the UIViewController is not a MVC controller, since in most cases it contains the logic to display the user interface. <br>  This fact makes it almost impossible to implement the correct MVC.  At best, the UIViewController becomes part of the View, the business logic is moved to other layers. <br><br>  On the other hand, after the separation of the logic required to display the interface, in the Controller, Presenter, or View-Model, there may still be too much code left.  This is very often due to the fact that a single object containing business logic is created for a single screen, and it can implement several user scripts, which again breaks SRP. <br><br>  Each object containing business logic must implement no more than one user script. <br><br>  As a rule, many user scripts can consist of the same operations, saving and retrieving data from local storage, requests to a remote server, etc. <br>  In this case, all the logic that does not relate to the user scenario must be transferred to the infrastructure layer. <br><br>  The solution to the problem of ‚Äúexpanding controller‚Äù will be the competent use of architectural patterns.  If you stick to SRP when writing code and take out of Controller, Presenter or View-Model and all code that is not its primary responsibility, the logic will become more transparent, user scripts will be clearer and easier to read. <br><br><h2>  Third way: <b>NSNotificationCenter</b> </h2><br>  IOS notifications are a great way to connect everything with everything! <br><br>  NSNotificationCenter is a private, but quite a bright representative of Singleton.  Despite the fact that notifications are an interaction pattern (Communication Pattern), and Singleton is a generating pattern (Creational Pattern), notifications retain all the disadvantages of Singleton. <br><br>  By starting to observate a notification that is not related to the main responsibilities of the class, we are breaking the SRP. <br><br>  The main problems that arise when using notifications: <br><br>  Enhancement of the code connectivity is achieved due to the fact that absolutely any class in absolutely any part of the application can send a notification and receive it. <br><br>  If the notification is sent, we can neither intercept nor replace it. <br><br>  If several objects are subscribed to one notification, then it is impossible to control the order of receipt of notification. <br><br>  The solution to the problems described is to abandon the use of notifications in favor of more convenient mechanisms. <br><br>  An exception may be the use of notifications for notifying about a change in the global state of the application, for example, a change in the state of a network connection or the departure of an application to the background and exit from the background. <br><br>  Formal signs of SRP violation: <br><br><ul><li>  One of the most noticeable signs is the proliferation of the size of a class or method. </li><li>  Class inheritance from more protocols (subject to ISP). </li><li>  Using singleton-s can indicate a violation of SRP. </li><li>  Transmission of information on the state change of a specific object using the NSNotificationCenter (it is possible to notify about the change of the global state) </li><li>  Accumulation in objects of utility methods. </li><li>  A larger number of public class methods may also indicate a violation of the SRP. </li><li>  A greater number of private methods that can be divided into groups.  In this case, each group most likely has its own area of ‚Äã‚Äãresponsibility. </li></ul></div><p>Source: <a href="https://habr.com/ru/post/330142/">https://habr.com/ru/post/330142/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../330126/index.html">Electronic signature in Bitrix24. Theory and experience of implementation</a></li>
<li><a href="../330128/index.html">Single Line Diagrams in Revit</a></li>
<li><a href="../330130/index.html">Task: find a triangle with a smaller perimeter</a></li>
<li><a href="../330134/index.html">Synchronize database structure between applications</a></li>
<li><a href="../330140/index.html">Blockchain + distributed storage = Sia</a></li>
<li><a href="../330144/index.html">Teamwork. How to reconcile the designer and coder</a></li>
<li><a href="../330146/index.html">JSF 2 + Maven + Jetty. CDI, form and AJAX</a></li>
<li><a href="../330148/index.html">Why tree shaking does not work and how to live with it</a></li>
<li><a href="../330150/index.html">Writing Guard</a></li>
<li><a href="../330152/index.html">How data science helps the development of medicine. Lecture in Yandex</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>