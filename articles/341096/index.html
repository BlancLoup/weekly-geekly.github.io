<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Fake emails from almost any person in less than 5 minutes and ways to protect</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="What is email authentication? 
 For most of the past 40 years, users had to take a leap of faith every time they opened an email. Do you think that th...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Fake emails from almost any person in less than 5 minutes and ways to protect</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/webt/p-/io/yk/p-ioykuv4smgpumlh89gw-gqumq.png"><br><br><h3>  What is email authentication? </h3><br>  For most of the past 40 years, users had to take a leap of faith every time they opened an email.  Do you think that the letter really comes from the person specified in the sender column?  Most will easily answer ‚Äúyes‚Äù and in fact will be very surprised to learn how easy it is to fake email from almost any sender. <br><br>  When creating the Internet, there was originally no way to verify the identity of the sender.  During the development of basic e-mail protocols, the cost of computing power, implementation, and ease of use were balanced with the risk of fraud.  It was hard to imagine that 84% of all email in the future would have a malicious load and be phishing or spam. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      The result is that the headers of letters, including the From: and Reply-to: fields, are very easy to fake.  In some cases, it is as easy as typing "john@company.com" in the "From:" field.  By combining this with unsuspecting content, convincing graphics and formatting, it is possible to deceive people who thought that the message in their mailbox really came from the bank, the Federal Tax Service, the head or president of the United States. <br><br> <a href="https://habrahabr.ru/company/cloud4y/blog/341096/"><img src="https://habrastorage.org/webt/c9/yu/a2/c9yua2m1qoqpnxhnxbnoxzwono4.png"></a> <br><br>  Taking into account the widespread distribution of e-mail, you are aware of the basis of our current information security crisis.  Weakness in email has led to a mass of phishing attacks aimed at getting people to click on malicious links, download and open malicious files, send a W-2 form (similar to 2-NDFL in the US), or transfer funds to criminals. <br><a name="habracut"></a><br>  Most recently, Coupa, a Silicon Valley company, <a href="http://www.bankinfosecurity.com/silicon-valley-firm-coupa-hit-by-w-2-fraudsters-a-9788">was in the spotlight</a> after sending payroll data to all 625 employees to a fraudster.  Last year, one of Europe's largest companies, Leoni AG, lost $ 45 million when an employee mistakenly transferred money to a fraudster account because of a fake email.  The FBI estimates phishing attacks like ‚ÄúCompromise business correspondence‚Äù (BEC - Business Email Compromise) cost US companies $ 3 billion a year. <br><br>  On databreaches.net a list of phishing forms of the W-2 was compiled.  The work on the list this year indicates that the number of cases since 2016 is growing and at the moment <a href="https://www.databreaches.net/victim-of-w-2-scams-2017-list/">it consists of 204 reports</a> .  From the list it can be understood that there are known cases of theft of data of thousands of employees and this type of fraud is very common. <br><br><h3>  How an attacker can spoof unprotected email from almost any person in less than 5 minutes </h3><br>  In fact, a fake address in the "from" field is the basis and initial stage of most attacks.  Why worry about email fraud with a conditional ‚Äúcompany.com‚Äù when it is possible to simply register a similar fake domain (for example, c0mpany.com) and use it?  Or create a Gmail account (randomaddress1347356@gmail.com), give it a friendly name that looks like the name of the company's CEO?  Because, in fact, to fake sending a letter from the address of a real person is even easier than registering a fake domain or creating a Gmail account. <br><br><h4>  Three easy ways </h4><br>  On the Internet you can easily find <b>sites</b> that allow you to send fake letters.  There are dozens of them, here are just a couple of examples: spoofbox.com and anonymailer.net.  Many of them are free, some cost money, these services are positioned as legitimate, and the main purpose of the use is supposed to be a rally of friends. <br><br>  The usage algorithm is simple.  You only need to enter the recipient's email address in the "To:" field, put any desired email address in the "From:" field and confirm the sending after creating the message.  According to the terms of the user agreement, the responsibility for damage lies entirely with the clients of the service. <br><br>  The next method is to send using the <b>UNIX command line</b> .  If you have a computer with a customized mail service, just enter this command: <br><br> <code>mail -aFrom:whatever@anydomain.com</code> <br> <br>  The result is a message in which the ‚ÄúFrom‚Äù field will contain ‚Äúany@anydomain.com‚Äù.  Having entered the subject line and the rest of the message, after pressing Ctrl + D the message will be sent to the recipient.  The performance of this idea depends on how your system is configured.  However, it works in many cases. <br><br>  <b>Using PHP</b> , you can create an email with a few lines of very simple code: <br><br><pre> <code class="php hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?php</span></span> $to = <span class="hljs-string"><span class="hljs-string">'nobody@example.com'</span></span>; $subject = <span class="hljs-string"><span class="hljs-string">'the subject'</span></span>; $message = <span class="hljs-string"><span class="hljs-string">'hello'</span></span>; $headers = <span class="hljs-string"><span class="hljs-string">'From: webmaster@example.com'</span></span> . <span class="hljs-string"><span class="hljs-string">"\r\n"</span></span> . <span class="hljs-string"><span class="hljs-string">'Reply-To: webmaster@example.com'</span></span> . <span class="hljs-string"><span class="hljs-string">"\r\n"</span></span> . <span class="hljs-string"><span class="hljs-string">'X-Mailer: PHP/'</span></span> . phpversion(); mail($to, $subject, $message, $headers); <span class="hljs-meta"><span class="hljs-meta">?&gt;</span></span></code> </pre> <br>  In fact, these are lines of code used as an example in the <a href="http://php.net/manual/en/function.mail.php">online tutorial</a> for the mail () function with additional / header headers. <br><br>  These spoofing tools are greatly simplified.  To make the messages more realistic, it takes a little more work and, of course, social engineering skills.  But the main technical component is very simple.  The only thing that really prevents spoofing is email authentication using SPF record sharing, DKIM signatures, and DMARC.  Next, we describe how these technologies work and how they differ.  They are not new, but fortunately for scammers, most domains on the Internet are not yet secure.  For example, only <a href="https://blog.valimail.com/federal-agencies-have-80-days-to-fix-their-email">about 4% of .gov domains</a> use authentication.  What about the other 96%?  Attackers can send emails under the guise of outgoing mail from these domains at any time. <br><br>  According to the <a href="http://thehill.com/policy/cybersecurity/356179-one-in-four-emails-from-federal-accounts-are-frauds-says-fed-email">source</a> , one of the four letters from .gov domains is fraudulent.  Domains justice.gov, House.gov, Senate.gov, Whitehouse.gov, and also democrats.org, dnc.org, gop.com, rnc.org.  and DonaldJTrump.com - all of them can be easily used for spoofing by mail scammers. <br><br><h3>  Ways to protect against spoofing </h3><br>  The simplicity described above of using the e-mail vulnerability without authentication and the widespread use of these methods as an initial stage for the largest cyber attacks, focuses the attention of the IT community on the need to use mail authentication technologies.  By implementing email authentication, you can ensure that any user ‚Äî an employee, client, or partner who receives an email ‚Äî can determine if the email has been sent by a legitimate company representative.  In addition, you can get transparency and control of who sends email on your behalf. <br><br>  The importance of this has increased dramatically due to the rapid growth of cloud services ( <a href="https://cloud4y.ru/cloud-services/">SaaS</a> ), more than 10,000 of which send email on behalf of their clients on sales, marketing, customer support, HR, accounting, legal and other services.  Thanks to forced authentication, you can block anyone who is trying to send an email on your behalf ‚Äî spammers, phishers, and even ‚Äúgray‚Äù senders who may be legitimate but not listed by you in the list of allowed ones. <br><br>  Authentication email standards allow the mail server to verify that the email with your domain in the "From:" field was allowed to be sent on your behalf.  Before getting the message in the recipient's inbox, the mail server can check: <br><br><ul><li>  Using an <a href="https://ru.wikipedia.org/wiki/Sender_Policy_Framework">SPF record</a> , does the sending server have the right to use the domain name (or names) specified in the message headers? </li><li>  If a cryptographic <a href="https://ru.wikipedia.org/wiki/DomainKeys_Identified_Mail">DKIM signature is</a> attached to the message, using the public version of the key in the DNS record of the domain, you can decrypt the headers of the incoming messages and find out whether the message really comes from the stated sender. </li><li>  By configuring <a href="https://ru.wikipedia.org/wiki/DMARC">DMARC</a> , domain owners can create rules for processing emails that come from unauthorized domains and check if the headers match each other (for example, From: and Reply-to fields :).  The rules include instructions on what the receiving server should do with unauthenticated messages, for example, do not skip them, put them in a spam folder, or mark them as potentially dangerous.  Email authentication gives the domain owner global control over what happens to messages sent on their behalf by anyone and anyone.  For example, if you submit a domain as the sender of the mail and publish a DMARC record requesting information, then you will receive from all recipient domains that also support DMARC, statistics on all mail that comes with a return address from your domain.  The statistics come in XML and contain the IP address of each sender that is signed by your domain, the number of messages from each IP address, the result of processing these messages in accordance with the DMARC rules, SPF results and DKIM results </li></ul><br><h3>  Why is sharing of these technologies necessary? </h3><br>  In a simplified sense, SPF allows you to create a white list for IP addresses.  If a mail server with an IP address that is not on your list tries to send an email using your domain, the SPF authentication test will fail.  However, the big problem with SPF is that it uses the domain specified in the Return-Path field for authentication, and not the From field that people actually read. <br><br>  Worse, phishing intruders can configure SPF records for their own domains.  Then they can send emails that seem to come from a company or a trusted brand, but the domain of this company will be displayed in the From field, and the domain of the fraudster in Return-Path.  Such letters will be authenticated by SPF.  The additional use of <b>DMARC solves this problem by allowing the domain owner to require ‚Äúleveling‚Äù, which means that the return and outgoing addresses must be the same.</b> <br><br>  SPF records are text, but the syntax is rather complex.  You can easily make typos that are difficult to detect.  In doing so, they will make SPF recording useless.  An analysis of the SPF records of all <a href="https://blog.valimail.com/even-cyber-security-leaders-struggle-with-email-safety">62 sponsors of the RSA 2017 conference showed</a> that only 58 published SPF, while 17 sponsors of the conference on cyber security had errors in the record.  Companies that do not have much experience in the IT field often find SPF even more difficult. <br><br>  Also, DKIM is not particularly effective against fraud without the use of DMARC.  To stop phishing, the most important address is the domain in the "From" field.  However, checking only DKIM signatures says nothing about the domain in this field.  The domain used for signing a message may be completely different from the domain specified in the "From" field.  In other words, hackers can create messages that subscribe via DKIM using the domain they control, but in the "From" field there will be your bank email.  Most people do not intend to dig into the headers of all incoming messages to make sure that the DKIM signature data is legitimate.  It is also worth considering a large number of legitimate postal services that can do mailings on behalf of the sender and the problem of preserving the privacy of the private key used to sign messages. <br><br>  These two early standards, while important, contain important gaps.  DMARC builds on and complements them.  DMARC significantly increases the credibility of the email you send, regardless of whether you receive emails from your own email servers or cloud services that you allow to send emails. <br><br><img src="https://habrastorage.org/webt/be/jc/rj/bejcrjtkhs_pjsgt6bpj9ap0dek.png"><br><br>  The main contributions of DMARC are: <br><br><ol><li>  setting a policy that tells receiving e-mail servers what to do with e-mail messages that are not authenticated (nothing, quarantine or rejection), </li><li>  reporting mechanism. </li></ol><br>  Having a policy and feedback mechanism is what makes it all work. <br><br>  <b>Check that DMARC is configured using services.</b> <br>  ‚Üí <a href="https://mxtoolbox.com/SuperTool.aspx%3Faction%3Ddmarc%253A">mxtoolbox.com</a> <br>  ‚Üí <a href="https://www.mail-tester.com/">mail-tester.com</a> and others. <br><br>  <b>The article is based on a translation from sources:</b> <br>  ‚Üí <a href="https://hackernoon.com/how-to-fake-an-email-from-almost-anyone-in-under-5-minutes-12169dd44a92">How to Fake an Email</a> <br>  ‚Üí <a href="https://blog.valimail.com/what-is-email-authentication">What is Email Authentication?</a> <br>  ‚Üí <a href="https://blog.valimail.com/what-is-spf">What is SPF?</a> <br>  ‚Üí <a href="https://blog.valimail.com/what-is-dkim">What is DKIM?</a> <br>  ‚Üí <a href="https://blog.valimail.com/what-is-dmarc">What is DMARC?</a> <br><br>  <b>Related articles on Habrahabr:</b> <br>  ‚Üí We <a href="https://habrahabr.ru/post/326382/">forge letters from the largest Russian banks</a> <br>  ‚Üí <a href="https://habrahabr.ru/post/322616/">Set up DKIM / SPF / DMARC records or defend against spoofing</a> <br>  ‚Üí <a href="https://habrahabr.ru/post/307852/">Why does Sberbank have an incorrect SPF record for a domain?</a> <br>  ‚Üí <a href="https://habrahabr.ru/company/mailru/blog/315778/">Implementing DMARC to protect your corporate domain from spoofing</a> </div><p>Source: <a href="https://habr.com/ru/post/341096/">https://habr.com/ru/post/341096/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../341080/index.html">How to render frame Unreal Engine</a></li>
<li><a href="../341084/index.html">Implementing HFT robots on CEPappliance devices</a></li>
<li><a href="../341086/index.html">Numbers and letters: how was SmartData conference</a></li>
<li><a href="../341092/index.html">Results of web activity after 10 years</a></li>
<li><a href="../341094/index.html">Stryker, mutation testing in javascript</a></li>
<li><a href="../341100/index.html">We help taxi service: redesign of the logo and the appearance of corporate identity</a></li>
<li><a href="../341102/index.html">Sharing with RAIDIX and Apple Xsan. Apple saved for video editors</a></li>
<li><a href="../341106/index.html">Android O and background services</a></li>
<li><a href="../341108/index.html">Moxy Strategies (Part 2)</a></li>
<li><a href="../341110/index.html">Another operating system architecture</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>