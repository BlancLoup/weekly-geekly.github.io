<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Creating a game on Blend4Web. Programmer's path</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In my first article on Habr√©, devoted to the development of a browser game, I showed the main stages of creating the base scene for Blend4Web. A coupl...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Creating a game on Blend4Web. Programmer's path</h1><div class="post__text post__text-html js-mediator-article">  In my <a href="http://habrahabr.ru/post/263453/">first article</a> on Habr√©, devoted to the development of a browser game, I showed the main stages of creating the base scene for Blend4Web.  A couple of primitives, several textures plus the built-in capabilities of the platform made it possible to easily embody the conceived idea - water with refraction and caustics. <br><br>  One may admire the modulations on the seabed.  The time has come for real work.  First of all, you need to understand programming and take the first steps in writing code. <br><a name="habracut"></a><br>  It just so happens that I write code for games exclusively in C #, and JavaScript is not very familiar to me.  But learning another programming language is a simple task.  Experience with Unity allowed me to create the basic architectural blanks that migrate from project to project, which allows you to deploy the core backbone of the new application in just 15 minutes. <br><br>  Already traditionally, I divide the game project into several scenes: <br><ul><li>  The App contains global objects for controlling gameplay, advertising, social functions. </li><li>  Splash is a buffer level where I usually show the process of loading game data, download ads or connect to social services. </li><li>  MainMenu - the main menu of the program. </li><li>  Level1x - current game level without GUI. </li><li>  GameGUI is the actual game GUI loaded by the current level. </li></ul><br>  Such a scheme allows independently adjusting each block of the game: add new levels, perform interface translations, connect social functions.  Basically, communication between the blocks is built on events. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Of course, I would like to use something similar for a new game.  But you need to consider the possibility of JavaScript and features work with Blend4Web.  As it turned out, much of the programming experience for Unity was unacceptable for Blend4Web.  Now about everything in order. <br><br>  The Blend4Web platform is designed for developing WebGL applications.  Accordingly, you need to create a small wrapper in HTML.  A typical code looks like this: <br><pre><code class="html hljs xml"><span class="hljs-meta"><span class="hljs-meta">&lt;!DOCTYPE html&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">html</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">head</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">meta</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">charset</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"UTF-8"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"text/javascript"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">src</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"b4w.full.min.js"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="undefined"></span><span class="hljs-tag"><span class="undefined"></span><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"text/javascript"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">src</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"js/game_app.js"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="undefined"></span><span class="hljs-tag"><span class="undefined"></span><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">style</span></span></span><span class="hljs-tag">&gt;</span></span><span class="css"><span class="css"> </span><span class="hljs-selector-tag"><span class="css"><span class="hljs-selector-tag">body</span></span></span><span class="css"> { </span><span class="hljs-attribute"><span class="css"><span class="hljs-attribute">margin</span></span></span><span class="css">: </span><span class="hljs-number"><span class="css"><span class="hljs-number">0</span></span></span><span class="css">; </span><span class="hljs-attribute"><span class="css"><span class="hljs-attribute">padding</span></span></span><span class="css">: </span><span class="hljs-number"><span class="css"><span class="hljs-number">0</span></span></span><span class="css">; </span><span class="hljs-attribute"><span class="css"><span class="hljs-attribute">overflow</span></span></span><span class="css">: hidden; } </span><span class="hljs-selector-id"><span class="css"><span class="hljs-selector-id">#canvas3d</span></span></span><span class="css"> { </span><span class="hljs-attribute"><span class="css"><span class="hljs-attribute">position</span></span></span><span class="css">: absolute; </span><span class="hljs-attribute"><span class="css"><span class="hljs-attribute">width</span></span></span><span class="css">: </span><span class="hljs-number"><span class="css"><span class="hljs-number">1024px</span></span></span><span class="css">; </span><span class="hljs-attribute"><span class="css"><span class="hljs-attribute">height</span></span></span><span class="css">: </span><span class="hljs-number"><span class="css"><span class="hljs-number">768px</span></span></span><span class="css">; </span><span class="hljs-attribute"><span class="css"><span class="hljs-attribute">overflow</span></span></span><span class="css">: hidden; } </span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">style</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">head</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">body</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"canvas3d"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">body</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">html</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br>  Taking the standard example from the framework documentation, I added a restriction on resolution from myself, since resizing the window involved showing unnecessary areas of the scene.  The new version 15.07 has the option force_container_ratio, which should be responsible for maintaining the proportions for different types of displays.  But she didn‚Äôt really work for me, so I went back to the hard limiters. <br><br>  Interestingly, the developers offer two versions of the compiled engine: b4w.min.js and b4w.full.min.js.  By the name it is clear that the first file is a light version.  It‚Äôs just not clear what was removed from it (I couldn‚Äôt find the information in the help), so I decided to use b4w.full.min.js.  By the way, to work with physics you need to connect another file uranium.js. <br><br>  Take a look at the line script type = "text / javascript" src = "js / game_app.js".  It declares a file game_app.js - this is the main script for managing the game.  I have already shown in the past articles the simplest programming examples for Blend4Web.  But I would like to squeeze out of game_app.js more than simple engine initialization.  Here I am going to concentrate all the global functions of the game. <br><br>  Programming itself begins with the registration of its module in the space b4w.  The app module is already present here.  That is why I decided to add the ‚Äúgame_‚Äù prefix to the name of my scripts in order not to have any further problems. <br><pre> <code class="javascript hljs"><span class="hljs-meta"><span class="hljs-meta">"use strict"</span></span> b4w.register(<span class="hljs-string"><span class="hljs-string">"game_app"</span></span>, <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">exports, require</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> m_app = b4w.require(<span class="hljs-string"><span class="hljs-string">"app"</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> m_data = b4w.require(<span class="hljs-string"><span class="hljs-string">"data"</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> m_main = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">"main"</span></span>); exports.init = <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ m_app.init({ <span class="hljs-attr"><span class="hljs-attr">canvas_container_id</span></span>: <span class="hljs-string"><span class="hljs-string">"canvas3d"</span></span>, <span class="hljs-attr"><span class="hljs-attr">callback</span></span>: init_cb, <span class="hljs-attr"><span class="hljs-attr">physics_enabled</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, <span class="hljs-attr"><span class="hljs-attr">autoresize</span></span>: <span class="hljs-literal"><span class="hljs-literal">true</span></span> }); }</code> </pre><br>  This is the first stage - where a new game_app module is registered and the engine initialization function is described: <br><ul><li>  canvas_container_id - the name of the output container should be the same as in HTML. </li><li>  callback - a function that will be called after the initialization. </li><li>  physics_enabled - using physics.  While I do not need it in the game, so I set it to false.  Note that the activation of physics requires connecting to the project file uranium.js. </li><li>  autoresize is an option that forces the engine to automatically resize the screen in accordance with the browser window.  In my case, it is useless, but if you open the canvas to the full page, you cannot do without it. </li></ul><br>  After the engine initialization, the function init_cb is called, which in turn loads the scene from the main menu of the game. <br><pre> <code class="javascript hljs"><span class="hljs-comment"><span class="hljs-comment">//   function init_cb(canvas_elem, success) { loadMainMenu(); } //    function loadMainMenu() { m_data.load("mainmenu.json", mainmenu_cb); } //   function mainmenu_cb() { }</span></span></code> </pre><br>  I want to stop using GUI.  It is not in Blend4Web.  It is annoying at first, but there are two ways to solve the problem. <br><br>  The first option offered by the framework developers themselves is to use the capabilities of plain HTML.  In general, all the official lessons prove that it works, but I prefer my own version - Blender.  No problem creating a scene with buttons and handlers.  This decision may be wrong and you will have to return to HTML, but for now let it remain as it is. <br><br>  It is necessary to take into account one more nuance when loading the scene with the data.load function.  As I understand it - this is the only option that is in the API and is very peculiar. <br><pre> <code class="javascript hljs">m_data.load(<span class="hljs-string"><span class="hljs-string">"mainmenu.json"</span></span>); m_data.load(<span class="hljs-string"><span class="hljs-string">"scene.json"</span></span>);</code> </pre><br>  What do you think will happen when these two lines of code are executed?  If you think that replacing one scene with another, you are mistaken.  In fact, scene.json elements will be added to mainmenu.json.  The data.load function does not destroy the previous scene, but loads a new one into it.  This approach allows you to dynamically load objects, which is very important when developing a web application, and additional function parameters help to manage this process (see the <a href="https://www.blend4web.com/api_doc/module-data.html">help</a> ). <br><br>  Therefore, to replace one scene with another - you need to destroy the previous one.  For this there is a command data.unload (id).  As the ID, you can specify the sequence number that the scenes receive during loading.  For example, a primitive replacement code may be as follows: <br><pre> <code class="javascript hljs">data.load(<span class="hljs-string"><span class="hljs-string">"mainmenu.json"</span></span>); data.unload (); data.load(<span class="hljs-string"><span class="hljs-string">"scene.json"</span></span>);</code> </pre><br>  But the question is, does the load function work with the cache or does it constantly load data from the network? <br><br>  One more thing that interested me at this stage is how to make a ‚Äúdownload bar‚Äù.  It puzzled me so much that I rummaged through the official forum and was about to ask this question to the developers, but fortunately did not have time.  Everything turned out to be very simple and there are corresponding functions in the SDK help.  Therefore, the banal conclusion - see the documentation! <br><br>  The developers offer a special module, which is called preloader.  There are ready-made functions for creating the most diverse ‚Äústripes‚Äù.  Notice, not banal transfer of percent of loading of the file, but full-fledged, already visual decisions.  But so far I have decided not to bother and chose the easiest option. <br><br>  This is an example of how to create a ‚Äúdownload bar‚Äù with Blend4Web: <br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> m_preloader = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">"preloader"</span></span>); <span class="hljs-comment"><span class="hljs-comment">//     function init_cb(canvas_elem, success) { m_preloader.create_simple_preloader({ bg_color:"#00000000", bar_color:"#FFF", background_container_id: "preloader", canvas_container_id: "canvas3d", preloader_fadeout: true}); load(); } //  function load() { var p_cb = preloader_cb; m_data.load("scene.json", load_cb,p_cb,true); } // ‚Äú‚Äù function preloader_cb(percentage) { m_preloader.update_preloader(percentage); }    HTML      : &lt;body&gt; &lt;div id="preloader"&gt;&lt;/div&gt; &lt;div id="canvas3d"&gt;&lt;/div&gt; &lt;/body&gt;</span></span></code> </pre><br>  So, the main menu is loaded, the user clicks the ‚ÄúStart‚Äù button and goes into the game.  This chain and need to create. <br><br>  In my work, I always follow the simple rule - do not mix actions from different blocks in one ‚Äúbottle‚Äù.  One script provides overall control of the application, the other is responsible for the GUI, the third for social functions, etc.  This approach allows you to quickly find errors or perform an upgrade program.  I want to use the same thing when programming a game for WebGL.  Therefore, the processing functions of the main menu should be in a separate file. <br><br>  It turned out that this is easy.  The principle is the same as when creating the first script. <br><pre> <code class="javascript hljs">b4w.register(<span class="hljs-string"><span class="hljs-string">"game_mainmenu"</span></span>, <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">exports, require</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> m_mouse = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">"mouse"</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> m_scenes = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">"scenes"</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> mg_app = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">"game_app"</span></span>); exports.mainmenu_cb = <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ addEventListener(<span class="hljs-string"><span class="hljs-string">"mousedown"</span></span>, main_canvas_down); m_mouse.enable_mouse_hover_outline(); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">main_canvas_down</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">e</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> x = m_mouse.get_coords_x(e); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> y = m_mouse.get_coords_y(e); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> obj = m_scenes.pick_object(x, y); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> obj_name = m_scenes.get_object_name(obj); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (obj_name == <span class="hljs-string"><span class="hljs-string">"btStart"</span></span>) { m_mouse.disable_mouse_hover_outline(); mg_app.loadScene(); } } });</code> </pre><br>  This is the complete code.  Its task is to determine the mouse click on the button object in the menu and start loading the game level. <br><br>  First, let's consider the relationship of both scripts.  Pay attention to the piece of code from the game_app file: <br><pre> <code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">loadMainMenu</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> p_cb = preloader_cb; m_data.load(<span class="hljs-string"><span class="hljs-string">"mainmenu.json"</span></span>, m_mainmenu.mainmenu_cb,p_cb,<span class="hljs-literal"><span class="hljs-literal">true</span></span>); }</code> </pre><br>  So loadMainMenu is trying to load a scene with a button.  When this process is complete, m_mainmenu.mainmenu_cb will be started.  Only in this case the implementation of this function is in another module, which becomes available after its connection in the header: <br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> m_mainmenu = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">"game_mainmenu"</span></span>);</code> </pre><br>  The scene is loaded and control passes to the function of another game_mainmenu script: <br><pre> <code class="javascript hljs">exports.mainmenu_cb = <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ addEventListener(<span class="hljs-string"><span class="hljs-string">"mousedown"</span></span>, main_canvas_down); m_mouse.enable_mouse_hover_outline(); }</code> </pre><br>  Blend4Web offers its own event model.  The script subscribes to a specific event that generates the engine.  In my case, this is a mouse click on the canvas.  In the function shown earlier two commands: <br><ul><li>  addEventListener () - subscription to the event; </li><li>  m_mouse.enable_mouse_hover_outline () - selection of an object when the cursor is over it. </li></ul><br>  Blend4Web has presets for selecting objects in the scene.  Setup is done directly in Blender.  In the Object panel you need to enable the Selectable and Enable Outlining options for the primitive (see figure).  In addition, you can adjust the thickness and color of the frame, as well as its flickering in the Render panel.  Now, when the cursor passes over such an object, it will be marked with an outline. <br><br><img src="https://habrastorage.org/files/935/c9d/293/935c9d29326b40c7abea89d73978aeb3.jpg" alt="image"><br><br>  Go ahead.  The player clicked the mouse within the working container.  The ‚Äúmousedown‚Äù event is generated and the main_canvas_down function is executed: <br><pre> <code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">main_canvas_down</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">e</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-comment"><span class="hljs-comment">//     XY var x = m_mouse.get_coords_x(e); var y = m_mouse.get_coords_y(e); // 3D     var obj = m_scenes.pick_object(x, y); //      var obj_name = m_scenes.get_object_name(obj); if (obj_name == "btStart") { m_mouse.disable_mouse_hover_outline(); mg_app.loadScene(); } }</span></span></code> </pre><br>  As you can see, the game_mainmenu script only provides the main menu.  The level loading itself is performed in the game_app script (call mg_app.loadScene ()), i.e.  I managed to correctly set the scripts for the intended functionality. <br><br><h4>  findings </h4><br>  Programming turned out to be quite easy.  I managed to partially reproduce my application workflow in Unity and for Blend4Web: to divide scenes by meaning, to determine the functionality of scripts.  In some cases, Blend4Web presented pleasant surprises - this is a ready preloader and edging of objects in the scene (I confess, you need to create the same for Unity yourself).  The only thing that did not like is the lack of small examples.  I think my whining on this topic has already become familiar, but it really slowed down the process. <br><br>  Maybe it is worth creating something like a wiki with examples and let the users fill it in?  Hey, developers!  I am personally ready to give a couple of examples. <br><br>  <a href="http://www.prandgames.com/share/waterhunter/index.html">Test build</a> <br>  <a href="https://bitbucket.org/prandgames/waterhunter">Sources</a> </div><p>Source: <a href="https://habr.com/ru/post/264115/">https://habr.com/ru/post/264115/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../264101/index.html">Can information security increase revenue, increase customer loyalty, and solve other business problems?</a></li>
<li><a href="../264103/index.html">Application Development with NexStreaming NexPlayer SDK</a></li>
<li><a href="../264105/index.html">Each host branch with capistrano</a></li>
<li><a href="../264109/index.html">Starkon 2015 through the eyes of an indie developer</a></li>
<li><a href="../264113/index.html">Code contracts vs incoming data validation</a></li>
<li><a href="../264117/index.html">Passing the Experience: The Jedi Path</a></li>
<li><a href="../264119/index.html">"All Tolstoy in one click": how we did it</a></li>
<li><a href="../264121/index.html">Botan.io - an experimental analytics tool for Telegram bots from Yandex</a></li>
<li><a href="../264123/index.html">Researchers have created a worm that can infect Mac firmware</a></li>
<li><a href="../264125/index.html">What is the difference between data science, data analysis, big data, analytics, data mining and machine learning</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>