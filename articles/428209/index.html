<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Developer Cookbook: Domain Driven Design Recipes (Part 2, Structure and Interaction)</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Introduction 


 In the first article, we identified the scope of these practices, for which projects they can be applied, and for which they should n...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Developer Cookbook: Domain Driven Design Recipes (Part 2, Structure and Interaction)</h1><div class="post__text post__text-html js-mediator-article"><p><img src="https://habrastorage.org/webt/fr/vw/on/frvwonyhe7k6st_x65v67hcbrcs.jpeg" alt="ddd-header"></p><br><h1 id="vvedenie">  Introduction </h1><br><p>  <a href="https://habr.com/post/426663/">In the first article,</a> we identified the scope of these practices, for which projects they can be applied, and for which they should not. </p><br><p>  In this article I would like to make a brief overview of the basic principles of DDD, and also to share my personal experience of their application.  More details will be given about communication and structural approaches with examples of their implementation. </p><br><p>  In the following article I will paint the possible combinations of the applied design patterns with regard to their implementation, and ultimately I will give an example of a specific implementation of one small microservice. </p><a name="habracut"></a><br><h1 id="ddd">  DDD </h1><br><p>  Recall the definition given earlier: </p><br><blockquote>  Domain-based design (DDD, Domain-driven design) is an approach to developing software for complex needs satisfaction, by strongly linking the implementation with the main business models that are in constant development. </blockquote><p>  The reference book that describes the practice of building complex systems is the book <a href="https://domainlanguage.com/ddd/">Domain Driven Dedign</a> (Big Blue Book) by Eric Evans.  If you read any review article on this topic, you already know about it.  By the time DDD is used in practice, you will have to read it.  This is not the easiest book to read: </p><br><blockquote>  The canonical source for DDD is Eric Evans book.  It is not a real investment. <br><br>  Martin Fowler: January 15, 2014 </blockquote><p>  If you scroll through the content of the book, it will seem to you not quite structured.  But the map will help us. <br><img src="https://habrastorage.org/webt/oh/5e/tj/oh5etj1mf-uvet2bdyn7y1olj8k.png" alt="DDD-map"></p><br><p>  The map highlighted the practices that we consider today. </p><br><p>  The scope of the practices reviewed in the book is huge.  The scope of practices that can be applied outside of this book is even greater.  Before adopting at least some of them, set goals for yourself.  Let me give you my example. </p><br><ul><li>  Increase productivity. </li><li>  Write clear code. </li><li>  Scaling at software development level. </li></ul><br><h2 id="edinyy-yazyk">  Common language </h2><br><p>  Software development rarely leads to the creation of something new, as a rule, it is a simulation of something existing. </p><br><blockquote>  Model - a representation of a real object, which includes only the necessary properties and functions. </blockquote><p>  We cannot create a software product that will cover the entire subject area.  It is possible to reproduce only the part that will play the necessary functionality. </p><br><p>  A good example of a model would be a topographic map.  She is a terrain model.  The map does not contain meadows of fields and rivers, it only reflects the location of real objects relative to each other. </p><br><p>  To build a clear and clear model for all, you need to speak the same language.  This tells us not only Eric Evans, but common sense.  If programmers use their own terms, and business their own slang, then the former will simply not understand what needs to be done.  The business in this case will not be able to realize the real value of the development of a particular 'feature'.  How many times have you heard: "Yes, it's just add a button"? </p><br><p>  Your goal as a system designer should be to get the maximum understanding of each other from the whole team.  How to achieve this?  Start talking.  If people begin to communicate in any cramped group, they will have a generally accepted set of terms.  In different companies, the process of introducing a common language is likely to be different.  This can be a strong-willed decision, as well as a democratic procedure.  The language can be designated explicitly, and it can be entered implicitly, in this case it is just started to speak it.  A good way to introduce a common language will be common documentation. </p><br><h3 id="kak-vesti-dokumentaciyu-proekta">  How to maintain project documentation </h3><br><ol><li>  Any communication between business and development should improve your model. </li><li>  After the meeting, record the result in the form of documentation (Scrum artifact), and show this documentation to all participants of the development process. </li><li>  Use a single language in the documentation. </li><li>  The most important thing: do not waste time on documentation.  You will still have to write code, and the documentation will be rewritten many times, spending resources is expensive.  Instead of messing with the UML drawing application for a long time, use a tissue, pen, and camera on your phone. </li><li>  Documentation requires discipline, you can not write it from time to time. </li><li>  Separate documentation: <br><ul><li> Comments in the code - describe incomprehensible moments directly in the code, leave <code>#ODO:</code> (remove when merging the code in the master).  Express your opinion in the comments, for example, you have to use one or another crutch when working with legasy code. </li><li>  Comments to the <code>README.md</code> project in the root directory of your project should contain technical information: how to run the project, how to run tests, etc.  It is also a good idea to have a map, where you have all the projects, and on which servers they are running.  Separately write down all accepted agreements. </li><li>  And the most important is the knowledge base.  The collection of documents describing business processes is the part of the documents that is available to you as well as to business. </li></ul></li><li>  The main error of those who write documentation is redundancy.  Do not try to cover everything and everyone, convey only the general meaning.  Documentation should complement your project, but not replace it.  Do not record all terms that have ambiguous meaning only.  If the definition takes more than two sentences, this is a bad definition. </li></ol><br><p>  Example of documentation: </p><br><pre> <code class="markdown hljs"><span class="hljs-section"><span class="hljs-section">#         . # :  : -    - email -  ## : ###        ,     email  ,    1  (      email  ). ###           .          email . ###  email  email     .    ,    email.   . ###       ,     ,    .   . ###      email,    ,       .   2 . ###                  .    ,     ,             .</span></span></code> </pre><br><p>  Note that in this example we did not specify an explicit dictionary, nevertheless, we fixed the concept <em>User</em> , <em>Authorization</em> , <em>Registration</em> .  Writing such documentation will not take an expert more than 20 minutes. </p><br><p>  For a person who is not an expert in the subject area, the process of writing documentation is perceived as something complicated.  It is necessary to separate the collection of knowledge and the recording of collected knowledge. <code> !=  +  .</code> </p><br><blockquote>  ‚ÄúWhat you call the universe,‚Äù argued the fourth, ‚Äúis, in fact, a cluster of worlds that, like the skin of an onion, are one on top of another and are gradually separated from each other. <br><br>  - Unusually clearly stated!  - admired abderity.  - Amazingly clear!  ‚ÄúThey thought they understood the philosopher, because they knew very well what an onion was.‚Äù 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      History of Aberdites, Kristov Martin Wiland </blockquote><br><h2 id="ogranichennyy-konteksty-i-domeny">  Limited contexts and domains </h2><br><p>  Imagine that we are a designer of a progressive startup.  We all love cold pizza, swearing with couriers and hours to fill out forms on the site.  Therefore, we came up with a wonderful startup "Four turtles and one rat": </p><br><ul><li>  There is a website where pizzerias are registered and they post their actual dishes. </li><li>  These pizzerias do not have their own courier service. </li><li>  There are customers who cannot reach the pizzeria, but they are ready to order via the website or mobile application. </li><li>  Killer 'feature': the couriers are not specially hired staff, but ordinary people who have registered through the mobile application </li><li>  Couriers receive orders, after their execution they receive payment for the work done. </li><li>  Waiting for such couriers have longer, but the delivery, and accordingly the pizza comes out cheaper. </li></ul><br><p>  Let us recall the documentation we described in the previous chapter.  There the term <em>registration was</em> used in our single dictionary.  But in this project we have several: </p><br><ul><li>  Customer Registration </li><li>  Pizza registration </li><li>  Courier Registration </li><li>  Order Registration </li></ul><br><p>  Unified language belongs to a limited context.  The domain of the above documentation is the 'Authorization System'.  Let's try to highlight domains for our startup. </p><br><p>  But before we get down to this, let's look at the terminology for a bit, what a domain is and what a limited context is. </p><br><blockquote>  Domain (Domain) - is the representation of the real business structure that solves a specific task. </blockquote><p>  For example: Logistics System, Payment System, Authorization System, Order Management System. </p><br><p>  The domain is divided into subdomains, which describe smaller structures, for example: a basket of orders, a system for constructing routes. </p><br><p>  Each domain has a limited area of ‚Äã‚Äãresponsibility - limited functionality. </p><br><blockquote>  Bounded context - a set of domain restrictions that helps the domain focus only on one task for its best solution. </blockquote><p>  I like to represent this term as such an abstraction.  A domain is a circle.  The limited context is a circle. </p><br><p><img src="https://habrastorage.org/webt/nf/nm/jz/nfnmjzlgui85mvfatppogqv-kdq.jpeg" alt="Domain context"></p><br><p>  Even in DDD terminology, the core is distinguished. </p><br><blockquote>  Core (Core domain) - the most important domain that most succinctly characterizes your business. </blockquote><p>  So, the domains of the project "Four turtles and one rat": </p><br><p>  <strong>Work with pizzeria</strong> (Pizzarias) </p><br><p>  <em>Context</em> : b2b everything related to working with pizzerias </p><br><p>  <em>Subdomains</em> : </p><br><ul><li>  registration of new pizzerias </li><li>  add assortment </li><li>  update the status of the presence of a product </li></ul><br><p>  <strong>Work with the client</strong> (Clients) </p><br><p>  <em>Context</em> : b2c, everything related to working with pizza customers </p><br><p>  <em>Subdomains</em> : </p><br><ul><li>  view assortment </li><li>  information materials </li></ul><br><p>  <strong>Work with couriers</strong> (Delivery system) </p><br><p>  <em>Context</em> : b2e, all that relates to working with couriers </p><br><p>  <em>Subdomains</em> : </p><br><ul><li>  courier registration </li><li>  assignment </li><li>  registration of applications for withdrawal of funds earned by the courier. </li></ul><br><p>  Order system </p><br><p>  <em>Context</em> : Core.  Allows you to coordinate all individual domains, providing a full cycle from receiving the order to the delivery of pizza to the user.  He is not a performer, but plays the role of a conductor. </p><br><p>  <em>Subdomains</em> : </p><br><ul><li>  order acceptance </li><li>  order execution </li><li>  order status tracking </li></ul><br><p>  Billing <strong>system</strong> </p><br><p>  <em>Context</em> : Contains all financial transactions.  Provides interaction with the processing center. </p><br><p>  <em>Subdomains</em> : </p><br><ul><li>  receiving money for orders </li><li>  issuance of money to couriers for work done </li></ul><br><p>  <strong>Statistics System</strong> </p><br><p>  <em>Context</em> : The collection and processing (not issuing) of analytical information. </p><br><p>  <em>Subdomains</em> : </p><br><ul><li>  statistics on the means </li><li>  statistics on requests </li></ul><br><p>  <strong>Management System</strong> (Managment panel) </p><br><p>  <em>Context</em> : Issuing analytical information.  Management decisions toolkit. </p><br><ul><li>  analytics based on collected statistics </li><li>  premoderation of courier payments </li></ul><br><p>  On the basis of domains, let's draw up his map. </p><br><blockquote>  Domain map (Context map) - a graphical tool that allows you to describe the relationship between individual domains. </blockquote><p><img src="https://habrastorage.org/webt/p1/ks/po/p1kspot2qqut90gzcn1b9fhxyn8.png" alt="Context-map"></p><br><p>  The map shows the connections between domains.  This map is very superficial, but the subject area has not been studied enough.  This is the first draft, rewriting which you will get the expected result. </p><br><p>  The most important thing in the map is that we see connections between domains.  This structure fits very well on the microservice architecture: </p><br><blockquote>  The main principle of microservice architecture: weak connectivity and strong grip. </blockquote><p>  This principle is given in Sam Newman's book, <a href="http://shop.oreilly.com/product/0636920033158.do">Creating Microservices</a> , this is the second book that you will have to read in order to begin the practical use of the approaches described in this article.  What is meant: the domains should be loosely connected with each other, but closely linked inside. </p><br><p>  The translation of these terms is taken from the official Russian translation and, perhaps, reflects the transmitted meaning poorly.  In the original, the terms sound like: Low coupling (connectedness, gearing, grip, conjugacy), high cohesion (connectedness, strength). </p><br><h2 id="praktika-realizacii-domennogo-razdelenie">  The practice of implementing domain separation </h2><br><p>  I would like to share my personal experience - a set of informed decisions.  I do not urge you to use these solutions.  But they can be a good choice if you don‚Äôt know where to start.  With personal experience, the toolkit will be customized to your needs. </p><br><p>  The main principles that guided us: </p><br><ul><li>  Ease of solution.  Make complex things simple, not simple complex. </li><li>  Pragmatism.  You should always look at the situation, and in the absence of an existing solution, develop a new one.  Try to type everything, but avoid dogmatism. </li><li>  Code! = Documentation.  The code is the instructions for the machine, the documentation is the manual for people.  Do not confuse them and give out one after another. </li><li>  <a href="https://subvisual.co/blog/posts/19-solid-principles-in-ruby/">SOLID</a> </li></ul><br><h3 id="kak-realizovat-domeny">  How to implement domains? </h3><br><p>  It is very convenient to allocate domains as separate microservices. </p><br><blockquote>  Microservices is a separate application that implements the logic of one domain. </blockquote><p>  In DDD-development, limited context will serve as the principle of separating microservice into a separate application.  This does not negate the technical principle of separation of services (if this is due to the need to ensure high performance).  But the contextual principle will be dominant and mandatory. </p><br><h3 id="kak-vydelit-svyazi-mezhdu-domenami">  How to highlight the connection between domains? </h3><br><p>  Links between domains are always APIs.  It can be RESTful json api, gRPC, AMPQ.  In this article we will not compare one protocol with another and highlight their advantages and disadvantages; each of them has its own scope.  But nevertheless, we will stop on the general recommendations: </p><br><p>  <strong>Be flexible in the choice of protocol and rigid in the uniformity of its implementation.</strong> </p><br><p>  Choose a protocol for each pair of domains individually, do not try to use http everywhere, perhaps you will need asynchronous queues somewhere and the benefits of AMPQ will become obvious to you.  Do not ignore this feature because you have RESTful everywhere. </p><br><p>  On the other hand, if you implement RESTful json, use one data structuring standard.  You can take ready for example jsonapi or openapi.  If for some reason, ready-made solutions do not suit you and you feel that you can develop your own standard - describe and use it.  But apply it everywhere, do not breed the "zoo" of standards.  If you need to communicate with an external system, where they know nothing about your standards, write a microservice adapter. </p><br><p><img src="https://habrastorage.org/webt/cz/ff/go/czffgobmp7v9lr2pzkjx0-3y5xq.png" alt="Adapter"></p><br><h3 id="kak-realizovat-sabdomeny">  How to implement subdomains? </h3><br><p>  As separate modules inside microservice. </p><br><blockquote>  A module is an implementation of a subdomain, by putting the logic in a separate namespace (Namespace) within one microservice. </blockquote><p>  How does all this look?  Let's look at an example.  As we remember, we have a domain. <strong>Work with couriers</strong> (Delivery system) - this domain has three subdomains: </p><br><ul><li>  courier registration (registration) </li><li>  issuing tasks </li><li>  registration of applications for withdrawal of funds earned by the courier (withdrawal) </li><li>  check that your microservice is running, auxiliary, technical tool (healt_checker) </li></ul><br><p>  Imagine this all in the form of a folder structure: </p><br><pre> <code class="bash hljs">$ tree --dirsfirst delivery_system delivery_system ‚îú‚îÄ‚îÄ app/ ‚îÇ ‚îú‚îÄ‚îÄ health_checker/ ‚îÇ ‚îÇ ‚îî‚îÄ‚îÄ endpoints.rb ‚îÇ ‚îú‚îÄ‚îÄ registrations/ ‚îÇ ‚îÇ ‚îú‚îÄ‚îÄ entities/ ‚îÇ ‚îÇ ‚îú‚îÄ‚îÄ forms/ ‚îÇ ‚îÇ ‚îú‚îÄ‚îÄ repositories/ ‚îÇ ‚îÇ ‚îú‚îÄ‚îÄ interactor/ ‚îÇ ‚îÇ ‚îú‚îÄ‚îÄ services/ ‚îÇ ‚îÇ ‚îú‚îÄ‚îÄ validations/ ‚îÇ ‚îÇ ‚îú‚îÄ‚îÄ endpoints.rb ‚îÇ ‚îÇ ‚îî‚îÄ‚îÄ helpers.rb ‚îÇ ‚îú‚îÄ‚îÄ tasks ‚îÇ ‚îÇ ‚îú‚îÄ‚îÄ entities/ ‚îÇ ‚îÇ ‚îú‚îÄ‚îÄ queries/ ‚îÇ ‚îÇ ‚îú‚îÄ‚îÄ repositories/ ‚îÇ ‚îÇ ‚îú‚îÄ‚îÄ endpoints.rb ‚îÇ ‚îÇ ‚îî‚îÄ‚îÄ helpers.rb ‚îÇ ‚îî‚îÄ‚îÄ withdrawals ‚îÇ ‚îú‚îÄ‚îÄ entities/ ‚îÇ ‚îú‚îÄ‚îÄ forms/ ‚îÇ ‚îú‚îÄ‚îÄ repositories/ ‚îÇ ‚îú‚îÄ‚îÄ interactor/ ‚îÇ ‚îú‚îÄ‚îÄ services/ ‚îÇ ‚îú‚îÄ‚îÄ validations/ ‚îÇ ‚îú‚îÄ‚îÄ endpoints.rb ‚îÇ ‚îî‚îÄ‚îÄ helpers.rb ‚îú‚îÄ‚îÄ config/ ‚îú‚îÄ‚îÄ db/ ‚îú‚îÄ‚îÄ docs/ ‚îú‚îÄ‚îÄ lib/ ‚îÇ ‚îú‚îÄ‚îÄ schemas/ ‚îÇ ‚îî‚îÄ‚îÄ values/ ‚îú‚îÄ‚îÄ public ‚îú‚îÄ‚îÄ specs ‚îú‚îÄ‚îÄ config.ru ‚îú‚îÄ‚îÄ Gemfile ‚îú‚îÄ‚îÄ Gemfile.lock ‚îú‚îÄ‚îÄ Rakefile ‚îî‚îÄ‚îÄ README.md</code> </pre> <br><p>  Each folder in the <code>apps/</code> directory implements a particular subdomain, within each domain there are different patterns: <code>entities</code> , <code>forms</code> , <code>services</code> , etc. We will look at each of the applied patterns in detail in one of our future articles. </p><br><p>  Each such pattern is implemented in the corresponding namespace (Namespace).  For example, the form of creating wigs for payment to the courier: </p><br><pre> <code class="ruby hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">module</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Withdrawal</span></span></span><span class="hljs-class"> </span><span class="hljs-comment"><span class="hljs-class"><span class="hljs-comment">#   module Forms #  class Create end end end</span></span></span></span></code> </pre> <br><h3 id="kak-realizovat-svyazi-mezhdu-sabdomeny">  How to implement links between subdomains? </h3><br><p>  Let's look at a specific example.  We have a courier account: <code>Registrations::Entities::Account</code> .  It relates to the <code>Registrations</code> subdomain - since we do not consider this domain as a registration process, but rather as an account table and registration book, as indicated in our documentation for the business. </p><br><p>  We have two <em>processes</em> in the execution of which we access this account. </p><br><ul><li>  Create an account (Registration) </li><li>  Creating a request for withdrawal of funds earned by a courier (Wihtdrawal) </li></ul><br><p>  As we see these two processes belong to different subdomains - Registration and Wihtdrawal. </p><br><pre> <code class="ruby hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">module</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Registrations</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">module</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Serivices</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">CreateAccount</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">def</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">call</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">account</span></span></span><span class="hljs-class"> = </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Entities::Account</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">new</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">end</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">end</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">end</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">end</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">module</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Withdrwals</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">module</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Serivices</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">CreateOrder</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">def</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">call</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">account</span></span></span><span class="hljs-class"> = </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Registrations::Entities::Account</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">new</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">end</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">end</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">end</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">end</span></span></span></span></code> </pre> <br><p>  In the first call, an appeal to the class will be implemented through a call to <code>Entities::Account</code> .  And in the second case, through an explicit call to <code>Registrations::Entities::Account</code> .  Those.  if we explicitly specify a subdomain, then a class from another subdomain, and so we clearly designate the connection. </p><br><p>  If a class does not explicitly refer to any of the subdomains, it makes sense to put it in the <code>lib/</code> folder.  As a rule, these are classes that implement the 'ValueObject' pattern.  We will look at this pattern in more detail in one of the following articles. </p><br><h2 id="realizaciya-cherez-model">  Implementation through the model. </h2><br><p>  To quote Eric Evans: </p><br><blockquote>  If the architecture of the program, or at least some of its central part, does not correspond to the structure of the domain model, then such a model is practically useless, and the correctness of the program‚Äôs work must also be put under suspicion.  At the same time, the too complex interrelationships between models and functions in a software architecture are difficult to understand, and in practice they are difficult to maintain as the architecture changes. </blockquote><p>  Let us recall an example of a good model that I already cited at the beginning of this article - a topographic map.  Our goal is to be able to quickly find the distance between two settlements.  We could use a reference table with two points between cities.  And we can use the card.  Both here and there we will get the same result at about the same time.  But the map is more compact, it more accurately displays the subject area, it is more universal.  Map as a model is incredibly expressive.  And if we consider it within the framework of this task, then it is more convenient to measure the distance on the map than on the territory itself, which it reflects.  A model that reflects the subject area may exceed it in some properties.  This is really amazing. </p><br><p>  The implementation of the model is always a creative process with an unpredictable result.  The quality of your code is not its performance, and not its complexity, it is simplicity and expressiveness.  Improve it through constant refactoring, make it flexible and cut off all unnecessary.  Separate the layer that will be responsible for the business logic of the model from the layers whose need is due to the technical implementation.  How we managed to do this will be discussed later. </p><br><hr><br><div class="spoiler">  <b class="spoiler_title">sources of inspiration</b> <div class="spoiler_text"><ul><li>  Problem-Oriented Design, Eric J. Evans </li><li>  Creating microservices, Sam Newman </li><li>  <a href="http://gorodinski.com/blog/2013/04/29/sub-domains-and-bounded-contexts-in-domain-driven-design-ddd/">http://gorodinski.com/blog/2013/04/29/sub-domains-and-bounded-contexts-in-domain-driven-design-ddd/</a> </li><li>  <a href="https://martinfowler.com/bliki/BoundedContext.html">https://martinfowler.com/bliki/BoundedContext.html</a> </li><li>  <a href="https://habr.com/post/316438/">https://habr.com/post/316438/</a> </li><li>  <a href="https://dotnetcodr.com/2015/08/06/domain-driven-design-with-web-api-revisited-part-1-introduction/">https://dotnetcodr.com/2015/08/06/domain-driven-design-with-web-api-revisited-part-1-introduction/</a> </li><li>  History of the Abderites, Kristov Martin Wieland </li></ul><br></div></div></div><p>Source: <a href="https://habr.com/ru/post/428209/">https://habr.com/ru/post/428209/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../428193/index.html">Pro departure tours</a></li>
<li><a href="../428197/index.html">Effective personal finance. Level 1</a></li>
<li><a href="../428201/index.html">Wormholes in JavaScript</a></li>
<li><a href="../428203/index.html">We look charts: estimates and forecasts for the cloud computing market, data in 2018</a></li>
<li><a href="../428205/index.html">Lifehacks NaviHaka</a></li>
<li><a href="../428211/index.html">The book "Evolutionary Architecture. Continuous change support</a></li>
<li><a href="../428213/index.html">How to interpret model predictions in SHAP</a></li>
<li><a href="../428217/index.html">Million video calls per day or ‚ÄúCall Mom!‚Äù</a></li>
<li><a href="../428219/index.html">Where did the practice of mass relocation of qualified personnel come from?</a></li>
<li><a href="../428221/index.html">Generating arbitrary realistic entities using AI</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>