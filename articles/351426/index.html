<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Restore Microsoft Money online features. Quotes</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Microsoft Money has a long history. From the first version of Windows 3.0 released in 1991 to the Plus version of 2007, Money was a handy tool for man...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Restore Microsoft Money online features. Quotes</h1><div class="post__text post__text-html js-mediator-article">  Microsoft Money has a long history.  From the first version of Windows 3.0 released in 1991 to the Plus version of 2007, Money was a handy tool for managing personal finances. <br><br>  In addition to the usual management of accounts, Money also offered developed online services. <br>  They can be divided into three components: <br><br><ol><li>  Get data on quotes and currency conversion. </li><li>  Synchronization of data on accounts, as it is now fashionable to say, with the cloud. </li><li>  Work with online banking, including payment of bills via OFX protocol. </li></ol><br>  Unfortunately, in 2011, Microsoft supported the fashion for closing services, closed the online service MSN Money, and the first two functions stopped working. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      And the free version of Money Plus Sunset, released in 2010, no longer contained support for online functions, becoming a simple tool for offline account management. <br><br>  I have been using Microsoft Money 2004 Standard since 2006.  During this time, there were attempts to go to other programs or online services, but nonetheless Money was more convenient.  But the non-working functions were frankly frustrating.  And if online banking in our country is useless, because  As far as I know, not even one of the large banks supports work through OFX for individuals, there was a lack of exchange rate data.  And online synchronization after working with one online service was a dream in general. <br><br>  The community has created several tools of varying degrees of kontilnosti, but they have one fatal flaw: they are not integrated into Money and require manual labor to produce results. <br><br>  Well, since it was not necessary to wait for a miracle, then the realization of a dream into reality <br>  is the work of the hands of those who dream. <br><a name="habracut"></a><br>  Immediately I will make a reservation, everything written below refers to version 2004. Perhaps previous versions will not have the necessary functionality, and subsequent ones will have different behavior from the expected one. <br><br>  The task of returning online functions can be divided into two major steps: <br><br><ol><li>  Obtain data on quotes and exchange rates. </li><li>  Synchronization with online service. </li></ol><br>  The default URL for Money trying to get quotes is <br><br><pre><code class="hljs objectivec">http:<span class="hljs-comment"><span class="hljs-comment">//moneycentral.msn.com/Scripts/invisapi.dll</span></span></code> </pre> <br>  Microsoft Money has a complex and flexible structure.  Seemingly monolithic program <br>  consists of many components connected through OLE.  Most components have settings either in ini-files or in the registry, and this is a great opportunity to change the program's behavior without interfering with its files. <br><br>  Therefore, it is possible to change the URL of the request by specifying its string value in the registry <br><br><pre> <code class="hljs tex">HKLM<span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Software</span></span></span></span><span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">\</span></span></span></span>Microsoft<span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">\</span></span></span></span>Investor<span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">\</span></span></span></span>StockQuotes<span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">\</span></span></span></span>QuoteServerURL</code> </pre> <br>  Then we can redirect requests from Microsoft servers to our own server. <br><br>  Money sends the request to the specified URL using the HTTP GET command including a list of required data as address parameters. <br><br>  Example: <br><br><pre> <code class="hljs ruby"><span class="hljs-symbol"><span class="hljs-symbol">http:</span></span>/<span class="hljs-regexp"><span class="hljs-regexp">/moneycentral.msn.com/</span></span>Scripts/invisapi.dll?V=<span class="hljs-number"><span class="hljs-number">5</span></span>&amp;S=$US<span class="hljs-symbol"><span class="hljs-symbol">:INDU</span></span>,<span class="hljs-regexp"><span class="hljs-regexp">/RUBUS,/</span></span>ECUUS,<span class="hljs-regexp"><span class="hljs-regexp">/ATSUS,/</span></span>BECUS,<span class="hljs-regexp"><span class="hljs-regexp">/DEMUS,/</span></span>FIMUS,<span class="hljs-regexp"><span class="hljs-regexp">/FRFUS,/</span></span>GRDUS,<span class="hljs-regexp"><span class="hljs-regexp">/IEPUS,/</span></span>ITLUS,<span class="hljs-regexp"><span class="hljs-regexp">/LUFUS,/</span></span>NLGUS,<span class="hljs-regexp"><span class="hljs-regexp">/PTEUS,/</span></span>ESPUS&amp;Q=<span class="hljs-number"><span class="hljs-number">19</span></span>,<span class="hljs-number"><span class="hljs-number">15</span></span>,<span class="hljs-number"><span class="hljs-number">32</span></span>,<span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">3</span></span>,<span class="hljs-number"><span class="hljs-number">5</span></span>,<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">2</span></span>,<span class="hljs-number"><span class="hljs-number">10</span></span>,<span class="hljs-number"><span class="hljs-number">4</span></span>,<span class="hljs-number"><span class="hljs-number">17</span></span>,<span class="hljs-number"><span class="hljs-number">18</span></span>,<span class="hljs-number"><span class="hljs-number">8</span></span>C,E9,EA,<span class="hljs-number"><span class="hljs-number">1</span></span>E,<span class="hljs-number"><span class="hljs-number">8</span></span>,<span class="hljs-number"><span class="hljs-number">9</span></span>,A2,<span class="hljs-number"><span class="hljs-number">104</span></span>,<span class="hljs-number"><span class="hljs-number">3</span></span>A,<span class="hljs-number"><span class="hljs-number">3</span></span>B,<span class="hljs-number"><span class="hljs-number">3</span></span>C,<span class="hljs-number"><span class="hljs-number">3</span></span>D,<span class="hljs-number"><span class="hljs-number">7</span></span>F,<span class="hljs-number"><span class="hljs-number">7</span></span>D,<span class="hljs-number"><span class="hljs-number">7</span></span>,<span class="hljs-number"><span class="hljs-number">13</span></span>,<span class="hljs-number"><span class="hljs-number">14</span></span>,<span class="hljs-number"><span class="hljs-number">14</span></span>E,<span class="hljs-number"><span class="hljs-number">14</span></span>F,EB,<span class="hljs-number"><span class="hljs-number">21</span></span>,<span class="hljs-number"><span class="hljs-number">192</span></span>,<span class="hljs-number"><span class="hljs-number">16</span></span>A&amp;N=<span class="hljs-number"><span class="hljs-number">8</span></span>,<span class="hljs-number"><span class="hljs-number">15</span></span>&amp;H=<span class="hljs-number"><span class="hljs-number">15</span></span>,<span class="hljs-number"><span class="hljs-number">5</span></span>,<span class="hljs-number"><span class="hljs-number">20002</span></span>+<span class="hljs-number"><span class="hljs-number">20201</span></span>+<span class="hljs-number"><span class="hljs-number">20170916</span></span>+<span class="hljs-number"><span class="hljs-number">20180316</span></span>,<span class="hljs-number"><span class="hljs-number">20006</span></span>+<span class="hljs-number"><span class="hljs-number">20201</span></span>+<span class="hljs-number"><span class="hljs-number">20170916</span></span>+<span class="hljs-number"><span class="hljs-number">20180316</span></span>,<span class="hljs-number"><span class="hljs-number">20000</span></span>+<span class="hljs-number"><span class="hljs-number">20201</span></span>+<span class="hljs-number"><span class="hljs-number">20170916</span></span>+<span class="hljs-number"><span class="hljs-number">20180316</span></span>,<span class="hljs-number"><span class="hljs-number">20001</span></span>+<span class="hljs-number"><span class="hljs-number">20201</span></span>+<span class="hljs-number"><span class="hljs-number">20170916</span></span>+<span class="hljs-number"><span class="hljs-number">20180316</span></span>,<span class="hljs-number"><span class="hljs-number">20004</span></span>+<span class="hljs-number"><span class="hljs-number">20201</span></span>+<span class="hljs-number"><span class="hljs-number">20170916</span></span>+<span class="hljs-number"><span class="hljs-number">20180316</span></span></code> </pre> <br>  Here is a coded request for obtaining data on the index of the stock exchange INDU, its historical data for the year, as well as data on exchange rates. <br><br>  It is interesting that instead of the modern currency code USD, the US is used, and the ruble code in the query uses the correct one: RUB. <br><br>  In response, Money expects data in binary form.  Unfortunately, the InvAPI protocol is very confusing and its recovery is very time consuming. <br><br>  Fortunately for us, Money can work with two more formats: QWB and WebQUOTE. <br>  Therefore, it is not very clear why Microsoft switched to using binary InvAPI by rejecting decently structured WebQUOTE based on XML, given that XML is used very widely in Money. <br><br>  To use alternative protocols, you need to create a key in the <code>HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Money\12.0\Online\WebQuoteServers.</code> branch <code>HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Money\12.0\Online\WebQuoteServers.</code> <br>  A subsection can have an arbitrary name and must contain the following parameters: <br><br><ul><li>  <i>WebQTSrvrURL</i> - the main parameter that contains the URL to which the request will be sent </li><li>  <i>ServerType</i> - If the server is using QWB protocol, then the value of the parameter must be equal to QWB.  If WebQUOTE is used, this parameter should be absent. </li></ul><br>  The following parameters should contain a list of countries, separated by commas, whose indexes are supported by the server: <br><br><ul><li>  <i>FundCountries</i> - stock market </li><li>  <i>MnyMktCountries</i> - Cash Market, Shares </li><li>  <i>StockCountries</i> - promotions </li><li>  <i>TBillCountries</i> - Unknown </li></ul><br>  The purpose of the following parameters is unknown: <br><br><ul><li>  <i>LookUpURL</i> </li><li>  <i>XRateFrom</i> </li><li>  <i>XRateTo</i> </li></ul><br>  There is a nuance with the order of server descriptions: if the WebQUOTE server is the first to be sorted, followed by the QWB, then the request will be made to both.  If on the contrary, then only to the QWB server. <br><br>  It was not possible to find out starting with which version of Money support for the QWB (Quotes Write Back) protocol appeared.  But by all indications, this was the very first protocol used for data acquisition.  Money 2000 was able to import files in this format.  But version 2004 does not have this feature anymore. <br><br>  When using QWB Money generates a URL with request parameters and sends it via HTTP using the GET method. <br><br>  For example: <br><br><pre> <code class="hljs objectivec">http:<span class="hljs-comment"><span class="hljs-comment">//example.com/msmoney/webqt.qwb?N=INDU</span></span></code> </pre> <br>  Where <br><br><pre> <code class="hljs objectivec">http:<span class="hljs-comment"><span class="hljs-comment">//example.com/msmoney/webqt.qwb?N=</span></span></code> </pre>  - This is the value of the WebQTSrvrURL parameter. <br><br>  The format of the answer is simple: the format header, date / time, and listing data by index. <br><br>  Example: <br><br><pre> <code class="hljs css">&lt;<span class="hljs-selector-tag"><span class="hljs-selector-tag">FORMAT</span></span>&gt;<span class="hljs-selector-tag"><span class="hljs-selector-tag">QWB2</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.0</span></span> &lt;<span class="hljs-selector-tag"><span class="hljs-selector-tag">DATE</span></span>&gt;20180311105300 <span class="hljs-selector-tag"><span class="hljs-selector-tag">US</span></span><span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:INDU</span></span>@<span class="hljs-keyword"><span class="hljs-keyword">179</span></span>.<span class="hljs-keyword"><span class="hljs-keyword">98</span></span>@<span class="hljs-keyword"><span class="hljs-keyword">0</span></span>@<span class="hljs-keyword"><span class="hljs-keyword">0</span></span>@<span class="hljs-keyword"><span class="hljs-keyword">0</span></span>@<span class="hljs-keyword"><span class="hljs-keyword">0</span></span>@<span class="hljs-keyword"><span class="hljs-keyword">0</span></span>@<span class="hljs-keyword"><span class="hljs-keyword">0</span></span>@<span class="hljs-keyword"><span class="hljs-keyword">0</span></span>@<span class="hljs-keyword"><span class="hljs-keyword">0</span></span>@<span class="hljs-keyword"><span class="hljs-keyword">0</span></span>@<span class="hljs-keyword"><span class="hljs-keyword">0</span></span>@<span class="hljs-keyword"><span class="hljs-keyword">USD</span></span>@</code> </pre> <br>  Date format - YYYYMMDDHHmmSS <br><br>  Field value: <br><br>  0 - WKN with country information, and in fact the name of the index from the query <br>  1 - Last (Course at a specified time) (double) <br>  2 - High (The highest bid on the day) (double) <br>  3 - Low (Lowest bidding price on this day) (double) <br>  4 - Open (Opening Price) (double) <br>  5 - 52 week max (52 week range, from DATE) (double) <br>  6 - 52 week min (Range in 52 weeks, from DATE) (double) <br>  7 - P / E Ratio (EPS) (Price / Earnings (P / E)) (double) <br>  8 - Volume (long) Trading Volume <br>  9 - ?  1/0 (bool) <br>  10 - Shares Outstanding (double) <br>  11 - Market Capitalization (double) <br>  12 - Currency Code (US, RUR ...) <br><br>  This format is designed to receive data on stocks and indices (securities), the exchange rate cannot be obtained through it. <br><br>  WebQUOTE is the next step in the development of the data acquisition protocol. <br>  Its use allows to obtain more detailed data. <br><br>  Money forms a request in the form of an XML document and sends it to the server using the POST method.  The request body looks like this: <br><br><pre> <code class="xml hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?xml version="1.0" encoding="windows-1251"?&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">WEBQUOTE</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Version</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"1.0"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Source</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Money2K"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">QUOTERQ</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Symbol</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"$INDU"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"INDEX"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Country</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"US"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">HISTQUOTERQ</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Symbol</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"$INDU"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"INDEX"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Country</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"US"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">StartDate</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"20170918"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">EndDate</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"20180318"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">WEBQUOTE</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br>  The response format is as follows: <br><br><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">WEBQUOTE</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">EXRATERS</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">CurrFrom</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">""</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">CurrTo</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">""</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">datetime</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">""</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">rate</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">""</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">QUOTERS</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Symbol</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">""</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Country</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">""</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"STOCK|INDEX|MUTUAL|OTHER"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Currency</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"string"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">DateTime</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"YYYYmmDD"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Price</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"double"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Low</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"double"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">High</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"double"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Open</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"double"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">PrevClose</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"double"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">YearHigh</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"double"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">YearLow</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"double"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Pe</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"double"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Vol</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"dword"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Out</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"double"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Cap</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"double"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">NewsURL</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"string"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Ask</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"double"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Bid</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"double"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Beta</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"double"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">DividendYield</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"double"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">AmtEPS</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"double"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Size</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"long"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">LastUpdate</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"YYYYmmDD"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">FYI</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"YYYYmmDD"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">News</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"YYYYmmDD"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">PercentCash</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"double"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">PercentOther</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"double"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">PercentSmall</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"double"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">PercentLarge</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"double"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">PercentMedium</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"double"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">BaseUnit</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"long"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">HISTQUOTERS</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Symbol</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">""</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Country</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">""</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"STOCK|INDEX|MUTUAL|OTHER"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Currency</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"string"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">DateTime</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"YYYYmmDD"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Price</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"double"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Low</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"double"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">High</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"double"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Open</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"double"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">PrevClose</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"double"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">YearHigh</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"double"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">YearLow</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"double"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Pe</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"double"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Vol</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"dword"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Out</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"double"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Cap</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"double"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">NewsURL</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"string"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Ask</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"double"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Bid</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"double"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Beta</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"double"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">DividendYield</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"double"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">AmtEPS</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"double"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Size</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"long"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">LastUpdate</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"YYYYmmDD"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">FYI</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"YYYYmmDD"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">News</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"YYYYmmDD"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">PercentCash</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"double"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">PercentOther</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"double"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">PercentSmall</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"double"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">PercentLarge</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"double"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">PercentMedium</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"double"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">BaseUnit</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"long"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">WEBQUOTE</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br>  Where <br><br>  <i>EXRATERS</i> - currency conversion data. <br>  <i>QUOTERS</i> - data on quotes at the time of the request. <br>  <i>HISTQUOTERS</i> - historical data on quotes. <br><br>  The set of returned data is much expanded compared to QWB.  From the name of the attributes is quite clear what data they should contain. <br><br>  Interestingly, Money never requests currency conversion data, but if it contains this data in response, it processes and stores it perfectly. <br><br>  When forming a response using any protocol, currency codes stored in the database should be taken into account.  For example, the ruble code in Money is recorded as RUR, and if you write RUB, the parsing will end with an error. <br><br>  There is also a third option: the use of the OFX protocol.  Data in this format can be imported by a file, for example, formed by one of the utilities, or obtained online <br>  from a bank connected to Money.  But this method is secondary to QWB and WebQUOTE and requires manual intervention. </div><p>Source: <a href="https://habr.com/ru/post/351426/">https://habr.com/ru/post/351426/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../351414/index.html">Corporate IaaS digest: 25 materials on virtualization, infrastructure and information security</a></li>
<li><a href="../351416/index.html">TECO Editor: EMACS, I am your father</a></li>
<li><a href="../351418/index.html">FastTrack Training. "Network Basics". "Value of Collaboration Products from Cisco." Eddie Martin December 2012</a></li>
<li><a href="../351420/index.html">The digest of interesting materials for the mobile developer # 245 (March 12 - March 18)</a></li>
<li><a href="../351424/index.html">SNAP Issues: Incomplete Object Paradigm and Premature Typing</a></li>
<li><a href="../351428/index.html">Is it possible to teach artificial intelligence to joke?</a></li>
<li><a href="../351430/index.html">Auto Test Concepts</a></li>
<li><a href="../351432/index.html">Comparison of Material Design CSS frameworks</a></li>
<li><a href="../351434/index.html">Solving big problems with a small semantic analyzer</a></li>
<li><a href="../351436/index.html">Analysis of trends in the cryptocurrency market (for example, Bitcoin)</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>