<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Mayhem - a machine that can find vulnerabilities in programs and fix them.</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="The program won first place in the DARPA Cyber ‚Äã‚ÄãGrand Challenge competition, dedicated to the automation of ethical hacking 


 In 2011, when investo...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Mayhem - a machine that can find vulnerabilities in programs and fix them.</h1><div class="post__text post__text-html js-mediator-article"><h3>  The program won first place in the DARPA Cyber ‚Äã‚ÄãGrand Challenge competition, dedicated to the automation of ethical hacking </h3><br><img src="https://spectrum.ieee.org/image/MzIxMzU1Ng.octet-stream"><br><br>  In 2011, when investor Mark Andriessen <a href="https://a16z.com/2016/08/20/why-software-is-eating-the-world/">said</a> that ‚Äúprograms are eating the world,‚Äù this idea was fresh.  Now it is obvious that software penetrates all aspects of our lives.  From sophisticated electronic devices like medical equipment and robotic mobiles to the simplest ones, like light bulbs connected to the Internet and thermometers - we are surrounded by software. <br><br>  This means that we are vulnerable to attacks on this software like never before. <br><a name="habracut"></a><br>  Each year, <a href="https://www.csoonline.com/article/3151003/application-development/world-will-need-to-secure-111-billion-lines-of-new-software-code-in-2017.html">111 billion lines of code</a> are added to existing programs, and each of them serves as a new potential target.  Steve Morgan, founder and editor-in-chief of research firm <a href="https://cybersecurityventures.com/">Cybersecurity Ventures,</a> predicts that system hacks committed through previously unknown vulnerabilities - what the industry calls ‚Äúzero-day vulnerability‚Äù - will happen in the US every day by 2021, although in 2015 they occurred <a href="http://investor.symantec.com/About/Investors/press-releases/press-release-details/2016/One-New-Zero-Day-Discovered-on-Average-Every-Week-in-2015-Twice-the-Rate-of-a-Year-Ago-as-Advanced-Attackers-Exploit-Stockpile-and-Resell-High-Value-Vulnerabilities/defa">weekly</a> . 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      To solve this problem, I and my colleagues at Carnegie Mellon University spent almost 10 years creating a technology that could automatically make the software secure.  Then in 2012 we founded the company <a href="https://forallsecure.com/">ForAllSecure</a> to present our product to the world.  We only had to prove that we can do what we declare, and we did it in the form of participation in a competition. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/5fc/efb/9aa/5fcefb9aab4f7c6803f21ac9cc01770f.jpg"><br>  <i>The Magnificent Seven: competing computers glow in front of an audience of the finals of the Cyber ‚Äã‚ÄãGrand Challenge competition held in Las Vegas in 2016.</i> <br><br>  Fast forward to 2016: our group has accumulated in the toilet of a hotel in Las Vegas, and bites its nails, being sure that it has lost a competition for which several thousand hours were preparing.  It was the DARPA Cyber ‚Äã‚ÄãGrand Challenge (CGC) competition, one of many events (such as the robot competition held in the early 2000s) organized by the Department of Defense's promising research projects to stimulate technological breakthroughs to ensure national security.  CGC appeared due to the fact that DARPA acknowledged that for the United States one day may come a day when they do not have enough people or tools to repel cyber attacks. <br><br>  On the battlefield for cybersecurity, there are tech-savvy hackers, and among the best of them are those who are able to creatively use the weak points in the software to penetrate through the protection of the organization.  The criminals who do this for personal use are called black-het hackers, and often they create tools with which script-kiddies, people who use ready-made programs, can create havoc, as, for example, happened in 2016, when Internet botnets Things launched a massive attack all over the Internet, gaining access to surveillance cameras in homes from ordinary people.  Conversely, ethical, or white-hat hackers use their skills to prevent such attacks.  But ethical hackers are not enough to protect all software, the number of which in the commercial world is rapidly increasing, not to mention the general infrastructure and military platforms vital for national and global security. <br><br>  In 2014, DARPA announced the Cyber ‚Äã‚ÄãGrand Challenge contest - a two-year project to test the possibility of developing AI systems that can find, test and patch software weaknesses.  In 2015, a hundred teams entered the prequalification phase.  In 2016, seven of them reached the final, where they had to present a system that could reason - one that would not only notice the problem, but also make an assumption about its origin.  The champion receives $ 2 million, and the second and third places - $ 1 million and $ 750,000. <br><br>  After DARPA released these details, my colleagues and I immediately realized that this would be a great opportunity to demonstrate that the automatic cyber security system we developed is not a simple theoretical toy.  When we talked about ForAllSecure, we were always faced with skepticism about the practicality of our solution.  We decided that we needed to win the competition, considering that we had worked on it for a whole decade. <br><br>  Our research at the university began with a simple assumption: people need a way to check the software they buy to ensure its security.  Programmers, of course, will make every effort to eliminate security problems, but their main tasks are simpler: they need to release the product on time and ensure that he does what he has to.  The problem is that hackers will find ways to get software to do what it shouldn't. <br><br>  Today, best practices in the field of software security involve the use of special tools to review the source code and highlight potential weaknesses.  This process produces a lot of false-positive results - marks the places that are not really weak - so a person should go through them all and check each of them.  To improve the speed of detecting errors, some companies rely on ethical hackers who carry out a one-time analysis or participate in reward search programs, and pay them for the number and severity of bugs found.  But only the most successful companies can afford to check the programs of the highest quality.  And the problem is only complicated when the final product includes various components with open source and other work of third parties. <br><br>  We presented the Mayhem system, which automates the work of ethical hackers.  She not only pointed out possible weaknesses, she exploited these vulnerabilities, proving their weakness.  This was also a key point at CGC - demonstrating evidence of vulnerability and creating a working exploit was one of the ways to get victory points.  And since Mayhem was a machine that can be scaled, such an analysis can proceed at speeds inaccessible to humans. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/9d4/65e/51e/9d465e51e7d22d1f0ca83870d687e912.jpg"><br>  <i>Mayhem, like her six rivals, required water cooling.</i>  <i>But statistics on consumption and temperature showed that Mayhem worked more actively than others.</i> <br><br>  We approached the creation of Mayhem, having a ready-made software analysis system, developed by us at the university, and based on a formal analysis of the program text.  This method can be compared with a mathematical formula describing each path a program can follow, that is, issuing a constantly forking analytic tree.  Such a tree may quickly become too large to work with, but we have come up with tricky ways of eliminating some paths that reduce the whole tree to several branches.  After that we can study the remaining branches in more detail. <br><br>  <a href="https://en.wikipedia.org/wiki/Symbolic_execution">Symbolic execution</a> creates an equation denoting the entire logic of the program ‚Äî for example, x + 5 = 7 ‚Äî and then solves this equation.  Compare this strategy with another software analysis method, <a href="https://ru.wikipedia.org/wiki/%25D0%25A4%25D0%25B0%25D0%25B7%25D0%25B7%25D0%25B8%25D0%25BD%25D0%25B3">fuzzing</a> , when you try to feed random values ‚Äã‚Äãto the program in an attempt to drop it, after which you can already identify the vulnerabilities that led to a halt and how they could be used in a deliberate attack.  Fuzzing enters random data until they make the value of the equation true, determining that x = 2. <br><br>  Both approaches have their strengths, but for many years fuzzing had the advantage of ease of implementation and processing speed of the input data.  Character execution concealed a huge and untapped potential for anyone who could tame it.  In the Mayhem system, which we began to create in 2010, we were able to achieve this by combining both approaches. <br><br>  Fuzzing is trying at great speed to make informed assumptions about what kind of input data can make the program behave in a new way, and then track which data actually leads to such a result.  Symbolic execution is an attempt to ask a mathematician to formally deduce exactly which input data can help create an exploit.  We found that it is better to find some errors through quick-guessing, and others with a mathematical approach.  Therefore, we decided to use both methods in parallel.  Symbolic execution goes deep into the sequential study of one part of the program, and outputs input data that runs this part of the code.  Then the system transfers this data to the program for fuzzing, which starts to thresh very quickly on this section of the code, shaking out vulnerability from it. <br><br>  Another ability of Mayhem is to work directly with binary code, unlike people who study text files, that is, source code.  This means that the system can analyze the program without the help of the person who developed it, and this is very important in the case of programs that include components written by third-party developers whose source code can no longer be found.  But it is difficult to make judgments about a binary code, because, unlike the original one, it has neither functions, nor logical variables, nor data abstractions.  The binary code has only one memory and fixed-length bit vectors - an efficient data storage structure.  To work with this code, you need to be a machine, and to create a machine that can work with such restrictions, the engineers really had to work a lot. <br><br>  After determining the vulnerability, Mayhem generates a working exploit - such a code that a black hat hacker could use to crack.  The goal is to demonstrate that the exploit can be used to gain privileged access to the operating system.  As a result, Mayhem identifies vulnerabilities with absolute certainty, rather than simply pointing out possible problems, as most code analysis tools do. <br><br>  In 2014, we experienced Mayhem on all programs included in the Debian distribution, the popular version of Linux that is used all over the world for workstations and servers.  Mayhem found almost 14,000 unique vulnerabilities, and then narrowed this list to 250 new ones that deserved the highest priority.  It took a week to test everything, because we scaled Mayhem on many servers in the Amazon cloud, and hardly required human intervention.  We sent the most important finds to the Debian community.  One of the reasons for our decision to turn a research project into a commercial company was our desire to collaborate on such a scale with developers, analyzing thousands of programs in search of a huge number of vulnerabilities. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/b99/f6b/faf/b99f6bfaf0a7b10a50012e5cf5702522.jpg"><br>  <i>The Mayhem project team: engineers from ForAllSecure are posing against the background of their brainchild at the closing ceremony.</i>  <i>The author of the article, David Brumley, is in the first row, third from the left.</i> <br><br>  On June 3, 2015, over a hundred participants were admitted to the qualifying round, and they were given 131 unique tasks, each of which contained known vulnerabilities.  Seven teams that scored the most points (issued for finding vulnerabilities and patches to them) got to the Cyber ‚Äã‚ÄãGrand Challenge final.  ForAllSecure more than doubled the achievement of the participant who took second place in points.  And this brief moment of joy quickly gave way to the realization that real pressure begins only now! <br><br>  The task of creating a fully autonomous cybernetic decision-making system based on the Mayhem technology turned out to be a very complex enterprise.  In particular, we managed to do this thanks to the fact that DARPA allocated enough finances to seven finalists in order to support a whole year of development.  Among the main components of the technology are a set of tools that translate executable programs into a relatively easy-to-understand and analyze language, as well as active tools for finding and exploiting vulnerabilities, protective tools for automatically creating patches for defective binary code, and a program for effective coordination of work. <br><br>  In preparation for the final, we faced two serious difficulties.  First, although we were pleased with how Mayhem copes with the search for vulnerabilities, it seemed to us that the patches would not be effective enough.  In competition, as in reality, there is no point in adding a patch that will devour more CPU time than the solution to this problem costs.  Therefore, we have been working on a system for adding automatic patches for a very long time, increasing consumption by no more than 5%. <br><br>  Secondly, we needed a winning strategy.  Suppose we found a vulnerability and made a patch for it.  Perhaps you should not immediately roll it if it slows down the program too much.  Sometimes it is worth waiting and applying the patch only as a last resort.  We have developed an expert system that takes a decision on when to patch the program. <br><br>  When our team entered the Las Vegas ballroom, where the final was held on August 5, 2016, we saw seven huge stands with flashing lights located on a huge stage, under which was a reservoir with 180 tons of water cooling the participants' computers.  Participants had to prepare the car the night before the start of the competition, and then DARPA selected all access to them.  Machines were cut off from the Internet and in general from the outside world.  We could only monitor how Mayhem works, monitor the power consumption and temperature of the system, statistics for which were displayed next to each rack.  Mayhem constantly worked more actively than rivals - and we hoped that it was a good sign. <br><br>  For nearly 100 rounds, the competing systems received new programs, and had to analyze the code for vulnerabilities and issue the necessary patches to protect in just a few minutes.  Points in each round were given for the ability of the machine to find and prove the existence of vulnerabilities, as well as for the effectiveness of patches. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/e85/fec/eee/e85feceeeb0b12fc404f9261c7340f01.jpg"><br>  <i>Victory by a wide margin: Mayhem managed to create a big margin, then fell after the 40th round.</i>  <i>But the team was not aware of this gap until the very end of the competition.</i> <br><br>  To make the presentation more interesting, the organizers decided to announce the final points only at the very end of the competition.  This meant that in the process we did not know whether we were winning or losing, we only saw Mayhem send messages about the vulnerabilities found.  However, a few hours after the start of the competition, after the 40th round, it became clear to us that Mayhem had stopped sending messages.  The program has dropped. <br><br>  Inside, everything sank, because it seemed to us that our worst nightmare was becoming a reality.  We asked the organizers to restart the program, but they did not allow us to do this.  And since only half of the competition was completed, we began to prepare for the disgraceful defeat. <br><br>  The organizers began to comment on the situation at the end of the competition, and beautiful visualizations showed us how the machines of each team found and corrected security problems in the programs in seconds, compared with the months or years that real people would spend on it.  More than 5,000 people were present in the hall, and the guest commentators ‚Äî the astrophysicist and the most famous hackers ‚Äî fueled their interest.  We have prepared for them to announce our defeat and confirm it with information on the screen. <br><br>  However, watching the points that were added after each round, we suddenly realized that the initial gap between Mayhem was enough to keep the first place, although he finished working after the 40th round.  After the announcement of the results of the last round, we felt as if the mountain had fallen from its shoulders.  We won. <br><br>  Mike Walker, director of the DARPA program, said that this demonstration of autonomous cyber defense was "only the beginning of a revolution" in the software security world.  He compared the results with the first flights of the Wright brothers, which had not flown far, but indicated the way to transcontinental flights. <br><br>  So far, ForAllSecure sells the first versions of its new service to early customers, including the US government and companies operating in high-tech and aerospace fields.  At this stage, the service basically determines the presence of problems, which are then corrected by human experts.  For quite a while, systems like Mayhem will work together with people security experts, making the software world safer.  But we believe that in the distant future, machine intelligence will be able to cope with this task on its own. </div><p>Source: <a href="https://habr.com/ru/post/442178/">https://habr.com/ru/post/442178/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../442162/index.html">STM32 fast start. Part 1 Software, Materials, Cube MX</a></li>
<li><a href="../442164/index.html">Roskomnadzor plans to fine Facebook for non-compliance</a></li>
<li><a href="../442166/index.html">Alternative metro scheme of Minsk</a></li>
<li><a href="../442168/index.html">Habramegairing: the best articles and Habra statistics for 12 years. Part 2/2</a></li>
<li><a href="../442176/index.html">Scientists grow a universal army of T-lymphocytes to destroy cancer</a></li>
<li><a href="../442180/index.html">Free distribution of "iron"</a></li>
<li><a href="../442182/index.html">Emergency Room: The secret life of Facebook moderators in the US</a></li>
<li><a href="../442186/index.html">Facebook is preparing to release digital coins tied to a basket of currencies and secured by the company's capital</a></li>
<li><a href="../442188/index.html">Then finish it. Chapter 1, in which it all begins (and, very bad)</a></li>
<li><a href="../442190/index.html">SketchUp extension (plug-in) for furniture designing by a programmer</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>