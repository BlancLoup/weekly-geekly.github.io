<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Argparse - Parsing arguments and command line parameters with ease</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Starting with Python version 2.7, the argparse library was included in the set of standard libraries for processing arguments (parameters, keys) of th...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Argparse - Parsing arguments and command line parameters with ease</h1><div class="post__text post__text-html js-mediator-article">  Starting with Python version 2.7, the argparse library was included in the set of standard libraries for processing arguments (parameters, keys) of the command line.  I would like to stop your attention on it. <br><a name="habracut"></a><br>  To begin, consider what interesting argparse offers. <br><br>  Argparse is an elegant tool for: <br><ul><li>  argument analysis sys.argv; </li><li>  converting string arguments into objects of your program and working with them; </li><li>  formatting and displaying informative prompts; </li><li>  much more. </li></ul><br><br>  One of the arguments of opponents of including argparse in Python was the argument that the standard modules already contain two libraries for semantic processing (parsing) of command line parameters.  However, as the argparse developers claim, the getopt and optparse libraries are inferior to argparse for several reasons: <br><ul><li>  Possessing the full range of actions with the usual command line parameters, they are not able to handle positional arguments.  Positional arguments are arguments that affect the operation of the program, depending on the order in which they are passed to this program.  The simplest example is the cp program, which has at least 2 such arguments <em>("cp source destination")</em> . </li><li>  argparse produces better hint messages at the output with minimal costs (in this respect, some code redundancy can often be observed when working with optparse); </li><li>  argparse allows the programmer to set for himself which characters are parameters and which are not.  In contrast, optparse considers options with syntax like "-pf, -file, + rgb, / f, etc." internally inconsistent "and" not supported by optpars and never will be "; </li><li>  argparse will give you the ability to use multiple variable values ‚Äã‚Äãwith one command line argument (nargs); </li><li>  argparse supports subcommands.  This is when the main parser sends to another (subparser), depending on the input arguments. </li></ul>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      To start working with argparse you need to set the parser: <br><br><pre><code class="python hljs">ap.py: <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> argparse parser = argparse.ArgumentParser(description=<span class="hljs-string"><span class="hljs-string">'Great Description To Be Here'</span></span>)</code> </pre> <br><br>  Further, the parser should indicate which objects you expect from it.  In the particular case, it might look like this: <br><br><pre> <code class="python hljs">parser.add_argument(<span class="hljs-string"><span class="hljs-string">'-n'</span></span>, action=<span class="hljs-string"><span class="hljs-string">'store'</span></span>, dest=<span class="hljs-string"><span class="hljs-string">'n'</span></span>, help=<span class="hljs-string"><span class="hljs-string">'Simple value'</span></span>)</code> </pre> <br><br>  If the action (action) for this argument is not specified, then by default it will be stored (store) in the namespace, and we can also specify the type of this argument (int, boolean, etc.).  If the name of the returned argument (dest) is specified, its value will be stored in the corresponding attribute namespace. <br><br>  In our case: <br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">print</span></span> parser.parse_args([<span class="hljs-string"><span class="hljs-string">'-n'</span></span>, <span class="hljs-string"><span class="hljs-string">'3'</span></span>]) Namespace(n=<span class="hljs-string"><span class="hljs-string">'3'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> parser.parse_args([]) Namespace(n=<span class="hljs-keyword"><span class="hljs-keyword">None</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> parser.parse_args([<span class="hljs-string"><span class="hljs-string">'-a'</span></span>, <span class="hljs-string"><span class="hljs-string">'3'</span></span>]) error: unrecognized arguments: -a <span class="hljs-number"><span class="hljs-number">3</span></span></code> </pre> <br><br>  A simple example of a program that squares up the value of a positional argument (square) and forms an output depending on the optional argument (-v): <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> argparse parser = argparse.ArgumentParser() parser.add_argument(<span class="hljs-string"><span class="hljs-string">"square"</span></span>, type=int, help=<span class="hljs-string"><span class="hljs-string">"display a square of a given number"</span></span>) parser.add_argument(<span class="hljs-string"><span class="hljs-string">"-v"</span></span>, <span class="hljs-string"><span class="hljs-string">"--verbose"</span></span>, action=<span class="hljs-string"><span class="hljs-string">"store_true"</span></span>, help=<span class="hljs-string"><span class="hljs-string">"increase output verbosity"</span></span>) args = parser.parse_args() answer = args.square**<span class="hljs-number"><span class="hljs-number">2</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> args.verbose: print(<span class="hljs-string"><span class="hljs-string">"the square of {} equals {}"</span></span>.format(args.square, answer)) <span class="hljs-keyword"><span class="hljs-keyword">else</span></span>: print(answer)</code> </pre> <br><br>  Let's stop on actions ( <strong>actions</strong> ).  They may be as follows: <br>  <strong>- store:</strong> returns the value to the namespace (after an optional type cast).  As already mentioned, store is the default action; <br><br>  <strong>- store_const:</strong> mainly used for flags.  Either return the value specified in const to you, or (if nothing is specified), None.  Example: <br><br><pre> <code class="python hljs">parser.add_argument(<span class="hljs-string"><span class="hljs-string">'--LifetheUniverseandEverything'</span></span>, action=<span class="hljs-string"><span class="hljs-string">'store_const'</span></span>, const=<span class="hljs-number"><span class="hljs-number">42</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> parser.parse_args([<span class="hljs-string"><span class="hljs-string">'--LifetheUniverseandEverything'</span></span>]) Namespace(LifetheUniverseandEverything=<span class="hljs-number"><span class="hljs-number">42</span></span>)</code> </pre> <br><br>  <strong>- store_true / store_false:</strong> analogue of store_const, but for Boolean True and False; <br><br>  <strong>- append:</strong> returns a list by adding the values ‚Äã‚Äãof the argument elements to it.  Example: <br><pre> <code class="python hljs">parser.add_argument(<span class="hljs-string"><span class="hljs-string">'--l'</span></span>, action=<span class="hljs-string"><span class="hljs-string">'append'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> parser.parse_args(<span class="hljs-string"><span class="hljs-string">'--la --lb --l Y'</span></span>.split()) Namespace(l=[<span class="hljs-string"><span class="hljs-string">'abY'</span></span>])</code> </pre> <br><br>  <strong>- append_const:</strong> returns the value defined in the argument specification to the list.  Until I had a case in which append_const would be needed. <br><br>  <strong>- count:</strong> as the name implies, it counts how many times the value of this argument occurs.  Example: <br><br><pre> <code class="python hljs">parser.add_argument(<span class="hljs-string"><span class="hljs-string">'--verbose'</span></span>, <span class="hljs-string"><span class="hljs-string">'-v'</span></span>, action=<span class="hljs-string"><span class="hljs-string">'count'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> parser.parse_args(<span class="hljs-string"><span class="hljs-string">'-vvv'</span></span>.split()) Namespace(verbose=<span class="hljs-number"><span class="hljs-number">3</span></span>)</code> </pre> <br><br>  Depending on the add_help (boolean type) argument passed to the constructor of the parser, it will be determined whether or not to include in the standard output using the keys ['-h', '--help'] help messages.  The same will take place with the argument version (string type), the default keys: ['-v', '--version'].  When requesting help or a version number, further execution is interrupted. <br><br><pre> <code class="python hljs">parser = argparse.ArgumentParser(add_help=<span class="hljs-keyword"><span class="hljs-keyword">True</span></span>, version=<span class="hljs-string"><span class="hljs-string">'4.0'</span></span>)</code> </pre> <br><br>  Sometimes it is necessary to define a certain set of command line parameters that will be distributed to all parsers of your program.  In this case, often give an example of the need for authorization: <br><br><pre> <code class="python hljs">parent_parser = argparse.ArgumentParser(add_help=<span class="hljs-keyword"><span class="hljs-keyword">False</span></span>) parent_parser.add_argument(<span class="hljs-string"><span class="hljs-string">'--user'</span></span>, action=<span class="hljs-string"><span class="hljs-string">"store"</span></span>) parent_parser.add_argument(<span class="hljs-string"><span class="hljs-string">'--password'</span></span>, action=<span class="hljs-string"><span class="hljs-string">"store"</span></span>) child_parser = argparse.ArgumentParser(parents=[parent_parser]) child_parser.add_argument(<span class="hljs-string"><span class="hljs-string">'--show_all'</span></span>, action=<span class="hljs-string"><span class="hljs-string">"store_true"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> child_parser.parse_args([<span class="hljs-string"><span class="hljs-string">'--user'</span></span>, <span class="hljs-string"><span class="hljs-string">'guest'</span></span>]) Namespace(password=<span class="hljs-keyword"><span class="hljs-keyword">None</span></span>, show_all=<span class="hljs-keyword"><span class="hljs-keyword">False</span></span>, user=<span class="hljs-string"><span class="hljs-string">'guest'</span></span>)</code> </pre> <br><br>  Notice that the parent parser is created with the add_help = False parameter.  This is done because each parser will honestly try to add its own '-h' key handler, which will cause a conflict situation.  This raises the question of what to do if your child parser has the same keys as the parent and you want to use them without any conflicts?  This is done by simply adding a conflict_handler argument: <br><br><pre> <code class="python hljs">parent_parser = argparse.ArgumentParser(add_help=<span class="hljs-keyword"><span class="hljs-keyword">False</span></span>) parent_parser.add_argument(<span class="hljs-string"><span class="hljs-string">'--user'</span></span>, action=<span class="hljs-string"><span class="hljs-string">"store"</span></span>) parent_parser.add_argument(<span class="hljs-string"><span class="hljs-string">'--password'</span></span>, action=<span class="hljs-string"><span class="hljs-string">"store"</span></span>) child_parser = argparse.ArgumentParser(parents=[parent_parser], conflict_handler=<span class="hljs-string"><span class="hljs-string">'resolve'</span></span>) child_parser.add_argument(<span class="hljs-string"><span class="hljs-string">'--user'</span></span>, action=<span class="hljs-string"><span class="hljs-string">"store"</span></span>, default=<span class="hljs-string"><span class="hljs-string">"Guest"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> child_parser.parse_args() Namespace(password=<span class="hljs-keyword"><span class="hljs-keyword">None</span></span>, user=<span class="hljs-string"><span class="hljs-string">'Guest'</span></span>)</code> </pre> <br><br>  In addition to the above approach to processing commands of different levels, there is also an alternative approach that allows you to combine the processing of all commands in one program using subparsers.  Best of all, an example will tell you: <br><br><pre> <code class="python hljs">ap.py <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> argparse parser = argparse.ArgumentParser() subparsers = parser.add_subparsers(help=<span class="hljs-string"><span class="hljs-string">'List of commands'</span></span>) <span class="hljs-comment"><span class="hljs-comment"># A list command list_parser = subparsers.add_parser('list', help='List contents') list_parser.add_argument('dirname', action='store', help='Directory to list') # A create command create_parser = subparsers.add_parser('create', help='Create a directory') create_parser.add_argument('dirname', action='store', help='New directory to create') create_parser.add_argument('--read-only', default=False, action='store_true', help='Set permissions to prevent writing to the directory', )</span></span></code> </pre> <br><br>  This is what the program will issue with the key '-h': <br><br> <code>usage: ap.py [-h] {list,create} ... <br> <br> positional arguments: <br> {list,create} list of commands <br> list List contents <br> create Create a directory <br> <br> optional arguments: <br> -h, --help show this help message and exit</code> <br> <br>  In the example, the following things can be noted: <br>  1. <em>positional</em> arguments list, create, passed to the program - essentially subparsers; <br>  2. the '--read-only' argument of the subparser create_parser is <em>optional</em> , dir_name is necessary for both subparsers; <br>  3. Help (help) is provided for both the parser and for each of the subparsers. <br><br>  In general, argparse is a fairly powerful and lightweight library, providing, in my opinion, a very convenient interface for working with command line parameters.  Next time I will try to cover issues such as file arguments (for more advanced work with files), variable lists of arguments, groups of arguments and more detail on the typing of arguments. <br>  Thanks for attention. <br><br>  Bibliography: <br>  <a href="http://www.python.org/dev/peps/pep-0389/">Why aren't getopt and optparse enough (PEP 389)</a> <br>  <a href="http://docs.python.org/dev/howto/argparse.html">Argparse positional and optional arguments</a> <br>  <a href="http://docs.python.org/library/argparse.html">Argparse documentation</a> <br>  <a href="http://bip.weizmann.ac.il/course/python/PyMOTW/PyMOTW/docs/argparse/index.html">Parser for command-line options, arguments and sub-commands</a> </div><p>Source: <a href="https://habr.com/ru/post/144416/">https://habr.com/ru/post/144416/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../144409/index.html">Create a web form to send faxes through Asterisk</a></li>
<li><a href="../144410/index.html">What old games do you think are old school?</a></li>
<li><a href="../144411/index.html">QScintilla: highlight syntax in application</a></li>
<li><a href="../144412/index.html">Test Driven Design - the first implementation experience</a></li>
<li><a href="../144414/index.html">OutWiker. Open Source program for storing notes</a></li>
<li><a href="../144417/index.html">CISCO ACE. Part 2: balancing remote servers and applications</a></li>
<li><a href="../144418/index.html">Data exchange between a web application and MantisBT</a></li>
<li><a href="../144419/index.html">Python binding for libsass. Exclusively for Habr</a></li>
<li><a href="../144420/index.html">Take Python with you</a></li>
<li><a href="../144421/index.html">Since when do you manage to enter the habr-captcha?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>