<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ROBOT based on: android, arduino, bluetooth. Start</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Creating a robot, even a simple one with limited functionality, is quite an interesting and fascinating task. Recently, amateur robotics is experienci...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>ROBOT based on: android, arduino, bluetooth. Start</h1><div class="post__text post__text-html js-mediator-article">  Creating a robot, even a simple one with limited functionality, is quite an interesting and fascinating task.  Recently, amateur robotics is experiencing a real boom, even those people who are very far from electronics (I belong to them) have begun to get involved in it.  The time has passed when it was necessary to sit at night with a soldering iron, or poison boards.  Everything has become much easier, you just need to buy an Arduino, a set of wiring, sensors, sensors, motors, and forth to build your first robot.  Thus, the focus of developers - amateurs has shifted from electronics and mechanical parts to programming. <br>  This series of articles will contain information for a quick start on creating your first robot, from purchasing the necessary parts to launching it into our world. <br><a name="habracut"></a><br>  I note that I write articles in the course of independent study of the material and the creation of my first robot. <br><br>  It is assumed that the person reading the article already has experience in: <br><ul><li>  Install and configure the development environment for android devices. </li><li>  Writing the first Hello World program for android devices. </li><li>  Installing drivers and development environment for Arduino. </li><li>  Writing the first program (turn on, turn off) LEDs on the Arduino. </li></ul><br><br><h5>  Abbreviations </h5><br>  BT - Bluetooth; <br>  Android - device with Android OS, for example, a smartphone; <br>  Sketch - an application for Arduino; <br>  Arduino - Arduino Nano. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h5>  General scheme of the robot </h5><br>  Let the robot has the following general scheme (Fig. 1).  Android is the ‚Äúbrain‚Äù in which all data are processed and calculations are performed.  Based on the results of the calculation, the commands received by the BT module and subsequently received via the serial port in the Arduino are transmitted via the BT channel.  Arduino processes incoming commands and executes them with the help of "muscles" (Motors LEDs, etc.).  In addition, the Arduino receives data from the "sense organs" (sensors, sensors, etc.), which it brings into a convenient form and sends it via the BT module to the "brain".  And so it repeats to infinity. <br><img src="https://habrastorage.org/getpro/habr/post_images/ccb/d06/e02/ccbd06e021c42746b2be4faa6396cb25.jpg" alt="image"><br>  Picture 1 <br>  The rationale for just such a robot scheme is as follows: <br>  -BT module and Arduino Nano have low cost, as well as small volume and weight. <br>  -Android, not expensive and affordable device, already has a huge number of people, including me. <br>  -Android has its sensors, sensors and a screen for displaying information <br>  -Easy to write code for applications for both Android and Arduino. <br>  To simplify the task of building a robot, I suggest using the ‚Äúfrom simple to complex‚Äù method, i.e.  as in the study of the programming language, create the first program ‚ÄúHello word‚Äù.  Of course, this will not be one program, but at least two (for arduino and android).  In each subsequent article, the functionality of the robot will increase. <br><br><h5>  Formulation of the problem </h5><br>  Assemble a simple device that has: <br>  -2 buttons (b1, b2). <br>  -1 LED (Led). <br>  And the functional is executed: <br>  - the main activity contains 2 buttons ‚ÄúUnpair 0‚Äù and ‚ÄúSend 1‚Äù, when clicked, data is transmitted from the Android to the Arduino via the BT channel, corresponding to ‚Äú0‚Äù and ‚Äú1‚Äù, the Arduino processes them and lights or extinguishes the LED. <br>  -data about pressing or releasing buttons from arduino is transferred to android, information about this is displayed on the main activity screen. <br><br><h5>  Purchase of necessary parts and components. </h5><br>  1) Android device - LG P500 smartphone (version Android 2.3.3), or any other device based on Android version 2.3.3 and higher.  I do not indicate the price, because I did not buy it separately, but I use my smartphone. <br>  2) Arduino NanoV3.0 ( <a href="http://dx.com/ru/p/nano-v3-0-avr-atmega328-p-20au-module-board-usb-cable-for-arduino-118037">dx.com/en/p/nano-v3-0-avr-atmega328-p-20au-module-board-usb-cable-for-arduino-118037</a> ) - $ 11.32 <br>  3) Bluetooth Module ( <a href="http://dx.com/ru/p/bluetooth-board-module-4-pin-121326">dx.com/ru/p/bluetooth-board-module-4-pin-121326</a> ) - $ 10.57 <br>  4) Dummy wires ( <a href="http://dx.com/ru/p/30cm-breadboard-wires-for-electronic-diy-40-cable-pack-80207">dx.com/ru/p/30cm-breadboard-wires-for-electronic-diy-40-cable-pack-80207</a> ) - $ 2.51 <br>  5) Buttons - 2 pcs., LED - 1 pc.  - 50 rubles <br>  Total: 855.20 rubles. <br><br><h4>  Let's get to work </h4><br><h5>  Arduino </h5><br>  Let's collect from the available details the scheme (fig. 2) <br><img src="https://habrastorage.org/getpro/habr/post_images/1d3/0a7/6b6/1d30a76b6795549ad5163151cbfcbb0a.jpg" alt="image"><br>  Figure 2 <br>  Power is supplied to the arduino via a USB cable that connects to the computer, and the software (sketch) running on it is also loaded via it.  It should be noted that you can load the sketch into the arduino only when the power is disconnected from the Bluetooth module (Pin (17) 3V3), otherwise an error occurs. <br>  Details of the installation of the Arduino development environment and drivers can be found on the official website: <a href="http://arduino.ru/Guide/Windows">arduino.ru/Guide/Windows</a> <br>  Below is the sketch that needs to be loaded into arduino: <br><pre><code class="cpp hljs"><span class="hljs-comment"><span class="hljs-comment">//  int led = 12; //  int b1 = 11; //  int b2 = 10; //  int value_1,value_2 = 0; //       char incomingbyte; //     //  void setup() { Serial.begin(38400); pinMode(led,OUTPUT); digitalWrite(led, HIGH); pinMode(b1,INPUT); digitalWrite(b1, HIGH); pinMode(b2,INPUT); digitalWrite(b2, HIGH); } //       void contact_bounce(int buttton){ value_1 = digitalRead(buttton); if (!value_1){ delay(80); value_2 = digitalRead(buttton); if (!value_2){ Serial.print("Press button b"); Serial.println(buttton); } } } //   void loop() { if (Serial.available() &gt; 0){ incomingbyte = Serial.read(); if (incomingbyte == '1'){ digitalWrite(led,HIGH); Serial.println("LED ON"); } if (incomingbyte=='0'){ digitalWrite(led,LOW); Serial.println("LED OFF"); } } contact_bounce(b1); contact_bounce(b2); }</span></span></code> </pre> <br>  We declare variables, in front of each is a comment. <br>  We initiate a serial connection and set the data transfer rate in bits per second (baud).  My BT module is running at 38400 speed, but it can be 9600 speed (the speed of the BT module can be set using AT commands).  Set the operation mode of the specified input / output (pin) as an input or as an output.  We give HIGH value to the inputs and outputs. <br>  The void contact_bounce (int buttton) function handles button presses and allows you to eliminate contact bounce, which occurs when contacts or a divergence of contacts in mechanical switching devices, such as a button, occurs multiple closure and opening. <br>  In the main Loop loop, we listen to the serial port, and if we receive data on it, we process them.  In addition, we call the function of processing the pressing of buttons and eliminating the chattering of contacts. <br>  Having loaded the sketch into arduino, we can test its performance by running the port monitor.  Pressing the buttons in the monitor window will display ‚ÄúPress button b‚Äù.  Check the work of the LED will be possible only after writing an application for android. <br>  In this article for Arduino only this sketch will be used. Let's proceed to developing an application for android. <br><br><h5>  Android </h5><br>  For easy debugging of the android application, I recommend using not ‚ÄúAndroid virtual device‚Äù, but a real smartphone with Android OS version 2.3.3 and connected via USB cable to computer in ‚ÄúDebug‚Äù mode.  There is a huge amount of articles on how to do this. <br><br><h5>  Android STEP 1 </h5><br>  Create a new project ‚ÄúAndroid application project‚Äù <br>  To work with BT, you must set the rights to use it with our application.  To do this, go to the manifest, select the Permissions tab, click add, then Uses permission, and set the following rights: android.permission.BLUETOOTH, android.permission.BLUETOOTH_ADMIN <br>  Now let's create the main activity, in res / layout / activity_main.xml we place the code: <br><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">LinearLayout</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:android</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://schemas.android.com/apk/res/android"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_width</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"fill_parent"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_height</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"fill_parent"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:orientation</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"vertical"</span></span></span><span class="hljs-tag"> &gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">LinearLayout</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_width</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"match_parent"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_height</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"wrap_content"</span></span></span><span class="hljs-tag"> &gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Button</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"@+id/b1"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_width</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"wrap_content"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_height</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"wrap_content"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:text</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">" "</span></span></span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">0</span></span></span><span class="hljs-tag">"" /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Button</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"@+id/b2"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_width</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"wrap_content"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_height</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"wrap_content"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:text</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">" "</span></span></span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">1</span></span></span><span class="hljs-tag">"" /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">LinearLayout</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">TextView</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"@+id/txtrobot"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_width</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"wrap_content"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_height</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"wrap_content"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:text</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"  "</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">LinearLayout</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br>  Thus, the main activity will take the form: <br><img src="https://habrastorage.org/getpro/habr/post_images/97a/f68/57a/97af6857ad800a391001a77c4fe6a2ac.jpg" alt="image"><br>  Figure 3 <br>  The txtrobot text box will display all the information we need.  The b1 and b2 buttons will send commands to the arduino. <br>  Now go to src /../ MainActivity.java here and our main code will be located.  Connect the package Api for Bluetooth: <br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.bluetooth.*;</code> </pre><br>  Before using BT it is necessary to make sure that it is present in our android.  Let's create an instance of the BluetoothAdapter class (responsible for working with the BT module installed in android): <br><pre> <code class="java hljs">btAdapter = BluetoothAdapter.getDefaultAdapter();</code> </pre><br>  If the android does not have BT, then null will be returned: <br><pre> <code class="java hljs">TextView mytext = (TextView) findViewById(R.id.txtrobot); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (btAdapter != <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>){ mytext.setText(<span class="hljs-string"><span class="hljs-string">"Bluetooth "</span></span>); }<span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { mytext.setText(<span class="hljs-string"><span class="hljs-string">"Bluetooth "</span></span>); }</code> </pre><br>  In this form, the program can already be run.  On the android screen, you should see the inscription: "Bluetooth is present." <br>  Now you need to make sure that BT is on, or suggest to enable it.  Add a constant: <br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> REQUEST_ENABLE_BT = <span class="hljs-number"><span class="hljs-number">1</span></span>;</code> </pre><br>  and code: <br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (btAdapter.isEnabled()){ mytext.setText(<span class="hljs-string"><span class="hljs-string">"Bluetooth .  ."</span></span>); }<span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { Intent enableBtIntent = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Intent(BluetoothAdapter.ACTION_REQUEST_ENABLE); startActivityForResult(enableBtIntent, REQUEST_ENABLE_BT); }</code> </pre><br>  By running the modified application on the android, you will be given a "Request for permission to turn on Bluetooth", confirming it, thereby activating BT. <br>  Full application code: <br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> com.robot.bluetest; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.os.Bundle; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.app.Activity; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.widget.TextView; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.bluetooth.*; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.content.Intent; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">MainActivity</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Activity</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> REQUEST_ENABLE_BT = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> BluetoothAdapter btAdapter; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> TextView mytext; <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">protected</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onCreate</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Bundle savedInstanceState)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">super</span></span>.onCreate(savedInstanceState); setContentView(R.layout.activity_main); btAdapter = BluetoothAdapter.getDefaultAdapter(); mytext = (TextView) findViewById(R.id.txtrobot); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (btAdapter != <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>){ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (btAdapter.isEnabled()){ mytext.setText(<span class="hljs-string"><span class="hljs-string">"Bluetooth .  ."</span></span>); }<span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { Intent enableBtIntent = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Intent(BluetoothAdapter.ACTION_REQUEST_ENABLE); startActivityForResult(enableBtIntent, REQUEST_ENABLE_BT); } }<span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { mytext.setText(<span class="hljs-string"><span class="hljs-string">"Bluetooth "</span></span>); } } }</code> </pre><br><br><h5>  Android STEP 2 </h5><br>  For further experiments, it is necessary to ‚Äúpair‚Äù our android and BT module, for this purpose on the android in the BT settings, perform a search and connect to the BT module, the password is ‚Äú1234‚Äù. <br>  If the remote BT module doesn‚Äôt work normally, just disconnect all the wires from it (VCC, GND, RX, TX), thereby making a hard reset, and reconnect them - this should help. <br>  Now we will try to programmatically connect to a remote BT module: we will place the main connection code in onResume.  onResume is one of the states of our Activity, namely, Activity is visible on the screen, it is in focus, the user can interact with it.  The following is the main Activity code: <br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> com.robot.bluetoothrob2; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.io.IOException; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.os.Bundle; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.app.Activity; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.util.Log; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.widget.Button; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.widget.TextView; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.widget.Toast; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.bluetooth.*; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.content.Intent; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">MainActivity</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Activity</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> REQUEST_ENABLE_BT = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> String LOG_TAG = <span class="hljs-string"><span class="hljs-string">"myLogs"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> BluetoothAdapter btAdapter; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> BluetoothSocket btSocket = <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; <span class="hljs-comment"><span class="hljs-comment">// MAC- Bluetooth  private static String MacAdress = "20:11:02:47:01:60"; public TextView mytext; @Override protected void onCreate(Bundle savedInstanceState) { super.onCreate(savedInstanceState); setContentView(R.layout.activity_main); btAdapter = BluetoothAdapter.getDefaultAdapter(); mytext = (TextView) findViewById(R.id.txtrobot); if (btAdapter != null){ if (btAdapter.isEnabled()){ mytext.setText("Bluetooth .  ."); }else { Intent enableBtIntent = new Intent(BluetoothAdapter.ACTION_REQUEST_ENABLE); startActivityForResult(enableBtIntent, REQUEST_ENABLE_BT); } }else { MyError("Fatal Error", "Bluetooth "); } } @Override public void onResume() { super.onResume(); Log.d(LOG_TAG, "*** ***"); //      MAC  BluetoothDevice device = btAdapter.getRemoteDevice(MacAdress); mytext.setText("*** device = " + device.getName() + "***"); } private void MyError(String title, String message){ Toast.makeText(getBaseContext(), title + " - " + message, Toast.LENGTH_LONG).show(); finish(); } }</span></span></code> </pre><br>  Access to the remote BT module is obtained by its MAC address btAdapter.getRemoteDevice (MacAdress).  Learn the MAC address of the BT module, you can use the program for android: Bluetooth Terminal. <br>  To make sure that access to the BT module is obtained, use the getName () method, which allows you to get the name of the remote BT module, and display the result on the android screen. <br>  Also in this example, the possibility of logging was added, which you can view during the program execution and detect existing errors.  In addition, the MyError function has been created, which is called if you need to crash the application. <br>  Having launched the application, the name of the remote BT module will be displayed on the android screen in the ‚Äútxtrobot‚Äù text box. <br><br><h5>  Android STEP 3 </h5><br>  Access to the remote BT module is obtained, our next step is to transfer data from the android to it.  To do this in onResume (), create a socket: <br><pre> <code class="java hljs">btSocket = device.createRfcommSocketToServiceRecord(MY_UUID);</code> </pre><br>  where UUID (Universally Unique Identifier) ‚Äã‚Äãis an identification standard used in software creation.  Add the UUID constant to the definition: <br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> UUID MY_UUID = UUID.fromString(<span class="hljs-string"><span class="hljs-string">"00001101-0000-1000-8000-00805F9B34FB"</span></span>);</code> </pre><br>  In order not to slow down the connection, we will cancel the search for other BT devices: <br><pre> <code class="java hljs">btAdapter.cancelDiscovery();</code> </pre><br>  Try to connect: <br><pre> <code class="java hljs">btSocket.connect();</code> </pre><br>  If not successful, close the socket: <br><pre> <code class="java hljs">btSocket.close();</code> </pre><br>  Since the methods of sending and receiving data are blocking, they should be performed in a separate thread to prevent the main application from hanging.  To do this, create a class: <br><pre> <code class="java hljs"> <span class="hljs-comment"><span class="hljs-comment">//      private class ConnectedThred extends Thread{ private final BluetoothSocket copyBtSocket; private final OutputStream OutStrem; public ConnectedThred(BluetoothSocket socket){ copyBtSocket = socket; OutputStream tmpOut = null; try{ tmpOut = socket.getOutputStream(); } catch (IOException e){} OutStrem = tmpOut; } public void sendData(String message) { byte[] msgBuffer = message.getBytes(); Log.d(LOG_TAG, "*** : " + message + "***" ); try { OutStrem.write(msgBuffer); } catch (IOException e) {} } public void cancel(){ try { copyBtSocket.close(); }catch(IOException e){} } public Object status_OutStrem(){ if (OutStrem == null){return null; }else{return OutStrem;} } }</span></span></code> </pre><br>  In the constructor public ConnectedThred (BluetoothSocket socket) an object is created that controls the transmission of data through a socket: <br><pre> <code class="java hljs">tmpOut = socket.getOutputStream();</code> </pre><br>  To send data from the main activity, the sendData (String message) method is called with the text message parameter, which is converted to the type byte.  The cancel () method allows you to close the socket. <br>  Let us write, handlers for pressing buttons b1 and b2, containing the call to the function sendData (String message) and make a record of this in the log.  The full application code is shown below: <br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> com.robot.bluetoothrob2; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.io.IOException; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.io.OutputStream; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.net.Socket; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.util.UUID; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> com.robot.bluetoothrob2.R; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.os.Bundle; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.app.Activity; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.util.Log; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.view.View; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.view.View.OnClickListener; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.widget.Button; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.widget.TextView; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.widget.Toast; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.bluetooth.*; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.content.Intent; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">MainActivity</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Activity</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> REQUEST_ENABLE_BT = <span class="hljs-number"><span class="hljs-number">1</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> String LOG_TAG = <span class="hljs-string"><span class="hljs-string">"myLogs"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> BluetoothAdapter btAdapter = <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> BluetoothSocket btSocket = <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> String MacAddress = <span class="hljs-string"><span class="hljs-string">"20:11:02:47:01:60"</span></span>; <span class="hljs-comment"><span class="hljs-comment">// MAC-   private static final UUID MY_UUID = UUID.fromString("00001101-0000-1000-8000-00805F9B34FB"); private ConnectedThred MyThred = null; public TextView mytext; Button b1, b2; @Override protected void onCreate(Bundle savedInstanceState) { super.onCreate(savedInstanceState); setContentView(R.layout.activity_main); btAdapter = BluetoothAdapter.getDefaultAdapter(); mytext = (TextView) findViewById(R.id.txtrobot); if (btAdapter != null){ if (btAdapter.isEnabled()){ mytext.setText("Bluetooth .  ."); }else { Intent enableBtIntent = new Intent(BluetoothAdapter.ACTION_REQUEST_ENABLE); startActivityForResult(enableBtIntent, REQUEST_ENABLE_BT); } }else { MyError("Fatal Error", "Bluetooth "); } b1 = (Button) findViewById(R.id.b1); b2 = (Button) findViewById(R.id.b2); b1.setOnClickListener(new OnClickListener() { public void onClick(View v) { MyThred.sendData("0"); mytext.setText(" : 0"); } }); b2.setOnClickListener(new OnClickListener() { public void onClick(View v) { MyThred.sendData("1"); mytext.setText(" : 1"); } }); } @Override public void onResume() { super.onResume(); BluetoothDevice device = btAdapter.getRemoteDevice(MacAddress); Log.d(LOG_TAG, "***  Device***"+device.getName()); try { btSocket = device.createRfcommSocketToServiceRecord(MY_UUID); Log.d(LOG_TAG, "... ..."); } catch (IOException e) { MyError("Fatal Error", " onResume()    : " + e.getMessage() + "."); } btAdapter.cancelDiscovery(); Log.d(LOG_TAG, "***   ***"); Log.d(LOG_TAG, "***...***"); try { btSocket.connect(); Log.d(LOG_TAG, "***  ***"); } catch (IOException e) { try { btSocket.close(); } catch (IOException e2) { MyError("Fatal Error", " onResume()    " + e2.getMessage() + "."); } } MyThred = new ConnectedThred(btSocket); } @Override public void onPause() { super.onPause(); Log.d(LOG_TAG, "...In onPause()..."); if (MyThred.status_OutStrem() != null) { MyThred.cancel(); } try { btSocket.close(); } catch (IOException e2) { MyError("Fatal Error", " onPause()    " + e2.getMessage() + "."); } } private void MyError(String title, String message){ Toast.makeText(getBaseContext(), title + " - " + message, Toast.LENGTH_LONG).show(); finish(); } //     private class ConnectedThred extends Thread{ private final BluetoothSocket copyBtSocket; private final OutputStream OutStrem; public ConnectedThred(BluetoothSocket socket){ copyBtSocket = socket; OutputStream tmpOut = null; try{ tmpOut = socket.getOutputStream(); } catch (IOException e){} OutStrem = tmpOut; } public void sendData(String message) { byte[] msgBuffer = message.getBytes(); Log.d(LOG_TAG, "*** : " + message + "***" ); try { OutStrem.write(msgBuffer); } catch (IOException e) {} } public void cancel(){ try { copyBtSocket.close(); }catch(IOException e){} } public Object status_OutStrem(){ if (OutStrem == null){return null; }else{return OutStrem;} } } }</span></span></code> </pre><br>  The application we wrote allows us to transfer data from ‚ÄúAndroid‚Äù to Arduino - ‚Äú0‚Äù and ‚Äú1‚Äù, which in turn for Arduino are commands ‚Äú1‚Äù - light the LED, and ‚Äú0‚Äù - put it out.  Thus, taking into account the general scheme of the robot, we have learned to give commands from the ‚Äúbrain‚Äù to the ‚Äúmuscles‚Äù.  It remains the case for small, to teach the android to take data from the "sense organs". <br><br><h5>  Android STEP 4 </h5><br>  Receiving data as well as sending, must be performed in a separate thread to avoid freezing of the main activity.  We will display the received data from the BT module on the screen of the main activity in the text field - MyText.  But there is a difficulty - working with view components is available only from the main stream.  And the new threads that we create do not have access to the elements of the screen.  To solve this problem, we use the mechanism Handler. <br>  Handler is a mechanism that allows you to work with a message queue.  It is bound to a specific thread (thread) and works with its queue.  Handler can put messages in a queue.  At the same time, he sets himself as the recipient of this message.  And when the time comes, the system takes the message out of the queue and sends it to the addressee (ie, in the Handler) for processing. <br>  Declare a handler: <br><pre> <code class="java hljs">Handler h;</code> </pre><br>  Create your Handler: <br><pre> <code class="java hljs"> h = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Handler() { <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">handleMessage</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(android.os.Message msg)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">switch</span></span> (msg.what) { <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> ArduinoData: <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>[] readBuf = (<span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>[]) msg.obj; String strIncom = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> String(readBuf, <span class="hljs-number"><span class="hljs-number">0</span></span>, msg.arg1); mytext.setText(<span class="hljs-string"><span class="hljs-string">"  Arduino: "</span></span> + strIncom); <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; } }; };</code> </pre><br>  in it we implement the handleMessage message handling method.  We extract the what, obj and int attributes from the message.  Let's transform the received message into a string and put it into the text field of the main activity: mytext.setText (‚ÄúData from Arduino:‚Äù + strIncom); <br>  In the stream for data transfer, we add a function to start this stream, and place a loop with the function of reading data there: <br><pre> <code class="java hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">run</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>[] buffer = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>[<span class="hljs-number"><span class="hljs-number">1024</span></span>]; <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> bytes; <span class="hljs-keyword"><span class="hljs-keyword">while</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">true</span></span>){ <span class="hljs-keyword"><span class="hljs-keyword">try</span></span>{ bytes = InStrem.read(buffer); h.obtainMessage(ArduinoData, bytes, -<span class="hljs-number"><span class="hljs-number">1</span></span>, buffer).sendToTarget(); }<span class="hljs-keyword"><span class="hljs-keyword">catch</span></span>(IOException e){<span class="hljs-keyword"><span class="hljs-keyword">break</span></span>;} } }</code> </pre><br>  The full application code is shown below: <br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> com.robot.bluetoothrob2; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.io.IOException; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.io.InputStream; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.io.OutputStream; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.net.Socket; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.util.UUID; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> com.robot.bluetoothrob2.R; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.os.Bundle; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.os.Handler; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.app.Activity; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.util.Log; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.view.View; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.view.View.OnClickListener; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.widget.Button; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.widget.TextView; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.widget.Toast; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.bluetooth.*; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.content.Intent; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">MainActivity</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Activity</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> REQUEST_ENABLE_BT = <span class="hljs-number"><span class="hljs-number">1</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> ArduinoData = <span class="hljs-number"><span class="hljs-number">1</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> String LOG_TAG = <span class="hljs-string"><span class="hljs-string">"myLogs"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> BluetoothAdapter btAdapter = <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> BluetoothSocket btSocket = <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> String MacAddress = <span class="hljs-string"><span class="hljs-string">"20:11:02:47:01:60"</span></span>; <span class="hljs-comment"><span class="hljs-comment">// MAC-   private static final UUID MY_UUID = UUID.fromString("00001101-0000-1000-8000-00805F9B34FB"); private ConnectedThred MyThred = null; public TextView mytext; Button b1, b2; Handler h; @Override protected void onCreate(Bundle savedInstanceState) { super.onCreate(savedInstanceState); setContentView(R.layout.activity_main); btAdapter = BluetoothAdapter.getDefaultAdapter(); mytext = (TextView) findViewById(R.id.txtrobot); if (btAdapter != null){ if (btAdapter.isEnabled()){ mytext.setText("Bluetooth .  ."); }else { Intent enableBtIntent = new Intent(BluetoothAdapter.ACTION_REQUEST_ENABLE); startActivityForResult(enableBtIntent, REQUEST_ENABLE_BT); } }else { MyError("Fatal Error", "Bluetooth "); } b1 = (Button) findViewById(R.id.b1); b2 = (Button) findViewById(R.id.b2); b1.setOnClickListener(new OnClickListener() { public void onClick(View v) { MyThred.sendData("0"); //mytext.setText(" : 0"); } }); b2.setOnClickListener(new OnClickListener() { public void onClick(View v) { MyThred.sendData("1"); // mytext.setText(" : 1"); } }); h = new Handler() { public void handleMessage(android.os.Message msg) { switch (msg.what) { case ArduinoData: byte[] readBuf = (byte[]) msg.obj; String strIncom = new String(readBuf, 0, msg.arg1); mytext.setText("  Arduino: " + strIncom); break; } }; }; } @Override public void onResume() { super.onResume(); BluetoothDevice device = btAdapter.getRemoteDevice(MacAddress); Log.d(LOG_TAG, "***  Device***"+device.getName()); try { btSocket = device.createRfcommSocketToServiceRecord(MY_UUID); Log.d(LOG_TAG, "... ..."); } catch (IOException e) { MyError("Fatal Error", " onResume()    : " + e.getMessage() + "."); } btAdapter.cancelDiscovery(); Log.d(LOG_TAG, "***   ***"); Log.d(LOG_TAG, "***...***"); try { btSocket.connect(); Log.d(LOG_TAG, "***  ***"); } catch (IOException e) { try { btSocket.close(); } catch (IOException e2) { MyError("Fatal Error", " onResume()    " + e2.getMessage() + "."); } } MyThred = new ConnectedThred(btSocket); MyThred.start(); } @Override public void onPause() { super.onPause(); Log.d(LOG_TAG, "...In onPause()..."); if (MyThred.status_OutStrem() != null) { MyThred.cancel(); } try { btSocket.close(); } catch (IOException e2) { MyError("Fatal Error", " onPause()    " + e2.getMessage() + "."); } } private void MyError(String title, String message){ Toast.makeText(getBaseContext(), title + " - " + message, Toast.LENGTH_LONG).show(); finish(); } //     private class ConnectedThred extends Thread{ private final BluetoothSocket copyBtSocket; private final OutputStream OutStrem; private final InputStream InStrem; public ConnectedThred(BluetoothSocket socket){ copyBtSocket = socket; OutputStream tmpOut = null; InputStream tmpIn = null; try{ tmpOut = socket.getOutputStream(); tmpIn = socket.getInputStream(); } catch (IOException e){} OutStrem = tmpOut; InStrem = tmpIn; } public void run() { byte[] buffer = new byte[1024]; int bytes; while(true){ try{ bytes = InStrem.read(buffer); h.obtainMessage(ArduinoData, bytes, -1, buffer).sendToTarget(); }catch(IOException e){break;} } } public void sendData(String message) { byte[] msgBuffer = message.getBytes(); Log.d(LOG_TAG, "*** : " + message + "***" ); try { OutStrem.write(msgBuffer); } catch (IOException e) {} } public void cancel(){ try { copyBtSocket.close(); }catch(IOException e){} } public Object status_OutStrem(){ if (OutStrem == null){return null; }else{return OutStrem;} } } }</span></span></code> </pre><br><br>  In step 4, an application is presented that allows both transmitting BT from android to arduino commands and receiving data from arduino.  Thus, we learned to give commands and accept data, and therefore completed the task. <br>  In addition, this application is a template, at its base you can create more complex applications, which in turn will be able to process data, for example, from an ultrasonic sensor, as well as to give commands to the motors, to move the robot. <br>  For the next article I ordered new parts and modules.  Below is a list and prices: <br><table><tbody><tr><td>  Name </td><td>  Link </td><td>  Price ye </td><td>  Price, rub </td><td>  Qty </td><td>  Amount </td></tr><tr><td>  Layout </td><td>  <a href="http://dx.com/p/solderless-breadboard-with-400-tie-point-white-121534">dx.com/p/solderless-breadboard-with-400-tie-point-white-121534</a> </td><td>  3.1 </td><td>  102.3 </td><td>  2 </td><td>  204.6 </td></tr><tr><td>  Ultrasound sensor </td><td>  <a href="http://dx.com/p/ultrasonic-sensor-distance-measuring-module-138563">dx.com/p/ultrasonic-sensor-distance-measuring-module-138563</a> </td><td>  3.9 </td><td>  128.7 </td><td>  3 </td><td>  386.1 </td></tr><tr><td>  Driver for motor 2 pcs. </td><td>  <a href="http://dx.com/ru/p/hg7881-two-channel-motor-driver-board-blue-green-black-2-5-12v-215795">dx.com/en/p/hg7881-two-channel-motor-driver-board-blue-green-black-2-5-12v-215795</a> </td><td>  2.8 </td><td>  92.4 </td><td>  2 </td><td>  184.8 </td></tr><tr><td>  Platform </td><td>  <a href="http://dx.com/ru/p/zl-4-smart-car-chassis-kit-for-arduino-black-yellow-152992">dx.com/ru/p/zl-4-smart-car-chassis-kit-for-arduino-black-yellow-152992</a> </td><td>  28.2 </td><td>  930.6 </td><td>  one </td><td>  930.6 </td></tr><tr><td>  Connection wiring </td><td>  <a href="http://dx.com/p/breadboard-jumper-wire-cord-kit-for-arduino-diy-140-piece-pack-138220">dx.com/p/breadboard-jumper-wire-cord-kit-for-arduino-diy-140-piece-pack-138220</a> </td><td>  6.9 </td><td>  227.7 </td><td>  one </td><td>  227.7 </td></tr><tr><td>  Nutrition </td><td>  <a href="http://dx.com/ru/p/dc-power-converter-module-for-electronic-diy-219232">dx.com/en/p/dc-power-converter-module-for-electronic-diy-219232</a> </td><td>  2.3 </td><td>  75.9 </td><td>  one </td><td>  75.9 </td></tr></tbody></table><br>  RESULT: 1933.8 </div><p>Source: <a href="https://habr.com/ru/post/208466/">https://habr.com/ru/post/208466/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../208452/index.html">The desired Start button will return to Windows 8.2</a></li>
<li><a href="../208454/index.html">Criticism of Bob Martin‚Äôs book Principles, Patterns, and Techniques for Agile Development in C #</a></li>
<li><a href="../208458/index.html">Introducing Github Attendance Analytics</a></li>
<li><a href="../208460/index.html">Project Christine: Razer Liquid-cooled Modular PC</a></li>
<li><a href="../208464/index.html">C #. Sort Type Members with ReSharper</a></li>
<li><a href="../208468/index.html">Kali Linux introduces an ‚Äúemergency‚Äù password leading to full disk encryption</a></li>
<li><a href="../208470/index.html">6 applications in the "smart home" board USBasp. Non-standard use of USBasp</a></li>
<li><a href="../208472/index.html">Twister: Decentralized, P2P analog Twitter</a></li>
<li><a href="../208474/index.html">Twenty thousand lines of code that will shake the world?</a></li>
<li><a href="../208476/index.html">The largest digital camera, the GAIA telescope, was successfully delivered to the L2 (Sun-Earth) design point</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>