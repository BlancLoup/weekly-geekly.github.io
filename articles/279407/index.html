<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Is Grounded in a 2D Platform: How to find out if a character is worth it?</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="I'll be brief. Fought over this task for a long time, therefore I decided to share the solution. Engine - Unity3D. 

 Formulation of the problem 
 The...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Is Grounded in a 2D Platform: How to find out if a character is worth it?</h1><div class="post__text post__text-html js-mediator-article">  I'll be brief.  Fought over this task for a long time, therefore I decided to share the solution.  Engine - Unity3D. <br><a name="habracut"></a><br><h4>  Formulation of the problem </h4><br>  There is a character, there are platforms.  Of course, the character collider and rigbodody, all twelve.  On the platforms, too, colliders.  On the platforms - effectors, because the platforms should be solid only from above.  That is, if the character fell on the platform, he stands on it.  But if a character walks past a platform or jumps under it - he freely passes through it. <br><br>  A character can jump only if he is standing on the platform.  Need to know if we are worth it. <br><br>  Conditions: 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      1) The shape of the platform is arbitrary. <br>  2) The character can stand on the very edge of the platform. <br>  3) Platforms may be inclined. <br>  4) Platforms can move. <br><br><h4>  Popular solution and why it does not fit </h4><br>  In the standard example of an asset store, it is proposed to use additional gameobject under the character, throw raikas from gamer into gameobject and see if there is an intersection with the ground. <br><br>  1) If we ‚Äúwalk by‚Äù or ‚Äújump on‚Äù, then the rakecast will completely catch the ‚Äúground‚Äù, although the character is not worth it. <br>  2) Raikast works on a specific point, not on the area.  So, if the platform is not exactly below the raikast point - for example, we are standing on the edge of the platform, or on a small pebble - the check will not notice it. <br><br><h4>  Decision </h4><br>  The solution can not be obtained logically, only by experiment.  For it stems from the features of the physics of the engine.  You need: <br>  using System.Linq is generally a handy thing, I recommend reading it, if not yet.  I use for search in collections, destroys 90% of forychs with nested iffs. <br>  GetComponent (). Bounds.min.y - the bottom of your collider, I mean the minimum ordinate <br>  OnCollisionStay2D <a href="http://docs.unity3d.com/ScriptReference/Collider2D.OnCollisionStay2D.html">docs.unity3d.com/ScriptReference/Collider2D.OnCollisionStay2D.html</a> <br>  OnCollisionExit2D <br>  CollisionContacts <a href="http://docs.unity3d.com/ScriptReference/Collision-contacts.html">docs.unity3d.com/ScriptReference/Collision-contacts.html</a> <a href="http://docs.unity3d.com/ScriptReference/ContactPoint-point.html">docs.unity3d.com/ScriptReference/ContactPoint-point.html</a> <br><br>  OnCollisionStay2D is triggered when the character and platform are moving relative to each other.  When a character hits the platform i.  with OnCollisionEnter2D, the above event will also work. <br><br>  So, it turns out, if the character is on the platform, then geometrically his collider and platform collider do not overlap.  So, the "bottom of the character" should be EXTREMELY above the point of contact.  EVERYTHING! <br><br>  1) Create a list: <br><br><pre><code class="cs hljs">List&lt;Collider2D&gt; GroundColliders = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> List&lt;Collider2D&gt;();</code> </pre> <br>  2) On the OnCollisionStay2D event, we check and, if necessary, add colliders: <br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">OnCollisionStay2D</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">Collision2D coll</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!GroundColliders.Contains(coll.collider)) <span class="hljs-keyword"><span class="hljs-keyword">foreach</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">var</span></span> p <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> coll.contacts) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (p.point.y &lt; myCollider.bounds.min.y) { GroundColliders.Add(coll.collider); <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; } }</code> </pre><br>  3) If we no longer intersect with the platform, remove it from the list: <br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">OnCollisionExit2D</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">Collision2D coll</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (GroundColliders.Contains(coll.collider)) GroundColliders.Remove(coll.collider); }</code> </pre><br>  4) Guess what we are checking: <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">bool</span></span> IsGrounded { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> GroundColliders.Count &gt; <span class="hljs-number"><span class="hljs-number">0</span></span>; } }</code> </pre><br>  Simply, understandably, quite universally, without any tags, rakes, additional gameobjects.  Use on health. </div><p>Source: <a href="https://habr.com/ru/post/279407/">https://habr.com/ru/post/279407/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../279393/index.html">Parallel noise and random number functions for OpenCL cores</a></li>
<li><a href="../279395/index.html">Windows 2008 R2 on HP DL380 G4p</a></li>
<li><a href="../279397/index.html">Anatomy of document editors: a common code for online and offline versions of ONLYOFFICE editors</a></li>
<li><a href="../279403/index.html">Update KB3035583 can automatically update Windows 7 to Windows 10</a></li>
<li><a href="../279405/index.html">Register for the ‚ÄúEasy Cloud Protection of Corporate Network with Low Total Cost of Ownership‚Äù webinar</a></li>
<li><a href="../279409/index.html">Parsers to all! Analyzing and testing existing HTML parsers</a></li>
<li><a href="../279411/index.html">Sports betting fraud</a></li>
<li><a href="../279413/index.html">DI plugins in Magento 2</a></li>
<li><a href="../279417/index.html">JPoint Witnesses: What Makes a Programmer Special?</a></li>
<li><a href="../279419/index.html">Why I write my algorithms in 95% of cases, and I will continue to develop code bikes</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>