<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Meet: Hash steganography. Very slow but top secret</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Yes, dear reader, you read it right: top secret . Moreover, I ask you to note that it is completely secret in the strictest mathematical sense: it is ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Meet: Hash steganography. Very slow but top secret</h1><div class="post__text post__text-html js-mediator-article">  Yes, dear reader, you read it right: <b><i>top secret</i></b> .  Moreover, I ask you to note that it is <i>completely secret</i> in the strictest mathematical sense: it is <a href="https://www.zurich.ibm.com/~cca/papers/stego.pdf">completely secret according to Kaschen</a> , because the <a href="https://ru.wikipedia.org/wiki/%25D0%25A0%25D0%25B0%25D1%2581%25D1%2581%25D1%2582%25D0%25BE%25D1%258F%25D0%25BD%25D0%25B8%25D0%25B5_%25D0%259A%25D1%2583%25D0%25BB%25D1%258C%25D0%25B1%25D0%25B0%25D0%25BA%25D0%25B0_%25E2%2580%2594_%25D0%259B%25D0%25B5%25D0%25B9%25D0%25B1%25D0%25BB%25D0%25B5%25D1%2580%25D0%25B0">Kullback ‚Äì Leibler distance</a> in my mathematical construction will be zero;  and not ‚Äúalmost zero‚Äù, but a genuinely zero, without any ‚Äúinfinitely small‚Äù and other vulgar approximations! <br><br>  How?  It's very simple - I won't <i>sprinkle</i> anything in the <i>stegcontainer</i> at all.  Indeed, if we do not inject anything, then the <i>empty container is</i> indistinguishable from the <i>stegocontainer</i> , right? <br><br>  ‚ÄúWait, but if we don‚Äôt <i>sprinkle</i> anything <b><u>at</u></b> all, then we <b><u>do</u></b> n‚Äôt give anything <b><u>at</u></b> all !!!‚Äù - the reader will reasonably argue with me. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Absolutely right!  We will not intersperse!  There is a way, without distorting the container, nevertheless to transfer information.  How? <br><br>  Schematic <b>Hash steganography <a href="https://ru.wikipedia.org/wiki/%25D0%259A%25D0%25BE%25D0%25BF%25D0%25B8%25D0%25BB%25D0%25B5%25D1%2584%25D1%2582">…î‚Éù</a></b> <br>  can be represented as: <br> <a href="https://habrahabr.ru/post/272935/"><img src="https://habrastorage.org/files/912/1c9/806/9121c9806ada40619a316812d823d5db.gif"></a> <br><br>  Text explanation for the picture under the cut. <br><br><a name="habracut"></a><br><br><h2>  Hash steganography </h2><br><br>  The idea is very simple.  We take a big bunch of pictures.  In the modern world, an oversupply of gadgets, self-helpers and cheap memory for storing the photographs, the generation of a large number of pictures, I think, will not make any special problems ... <br>  If you are too lazy to generate, there are many sites that provide a huge number of photos (and other pictures). <br>  We write a simple script in Python and upload data. <br><br>  Now we take some good <a href="https://ru.wikipedia.org/wiki/%25D0%25A5%25D0%25B5%25D1%2588%25D0%25B8%25D1%2580%25D0%25BE%25D0%25B2%25D0%25B0%25D0%25BD%25D0%25B8%25D0%25B5">hash function</a> .  Of all the properties of the "goodness" of the hash function, we are only interested in <b>equiprobability</b> ;  that is, you can even take (from a cryptographic point of view) not the best hash transformation, for example, <a href="http://habrahabr.ru/post/137316/">MD5, which rightly lost public trust</a> . <br><br>  We run all the pictures through the hash function, the data is entered into the table: <br>  <b>picture -&gt; hash</b> <br><br>  For example: <br><ul><li>  1.jpg -&gt; 0xd131dd02c5e6eec4693d9a0698aff95c </li><li>  2.jpg -&gt; 0x55ad340609f4b30283e488832571415a </li><li>  ... </li></ul><br><br>  Fix some integer <b>n</b> . <br>  For example, <b>n = 2</b> . <br><br>  We compose a new tablet, choosing the first (or the last ones, who like it) <b>n</b> <a href="https://ru.wikipedia.org/wiki/%25D0%259D%25D0%25B8%25D0%25B1%25D0%25B1%25D0%25BB">nibbles (nibbles)</a> from the hash. <br>  For our example: <br><ul><li>  1.jpg -&gt; <b>0xd1</b> </li><li>  2.jpg -&gt; <b>0x55</b> </li><li>  ... </li></ul><br><br>  Since no definitions can not do, we introduce the concept of a <b>hash code</b> . <br>  <b>The hash code</b> is the first <b>n</b> nibbles of the hash image. <br>  We denote the function of the computation by <b>H (...)</b> . <br>  For example: <b>H (cat1.jpg) = 0xd1;</b>  <b>H (cat2.jpg) = 0x55</b> <br><br>  We make an <a href="https://ru.wikipedia.org/wiki/%25D0%2598%25D0%25BD%25D0%25B4%25D0%25B5%25D0%25BA%25D1%2581_(%25D0%25B1%25D0%25B0%25D0%25B7%25D1%258B_%25D0%25B4%25D0%25B0%25D0%25BD%25D0%25BD%25D1%258B%25D1%2585)">index</a> on a <i>hash code</i> in our table.  This is necessary so that we quickly enough (namely, <b>O (log (M)</b> , where M is the number of pictures in the database) could find the necessary string in the <i>hash code</i> database. <br><br>  Suppose we want to send a message (in hexadecimal form): <b>55d134237598</b> .  Divide it into <b>n</b> nibbles.  As an example, we chose <b>n = 2</b> , then the message <b>55d134237598</b> should be split into 2 nibbls.  If we ‚Äúbreak‚Äù we will have spaces, then it will look like this: <b>55 d1 34 23 75 98</b> .  The resulting "pieces", each of which contains <b>n</b> nibbles, will be called <b>words</b> .  That is, we all got <b>6 words</b> . <br><br>  Next we do the following. <br><ol><li>  Take the <i>word</i> .  We are looking for a picture in which the <i>hash code</i> matches our <i>word</i> .  If there are several such pictures, we take any of them. </li><li>  We transfer the picture to the channel </li><li>  take the second <i>word</i> , look for a <i>hash code that</i> matches the second word </li><li>  We transfer the picture to the channel </li><li>  go to the third word ... and so on ... </li></ol><br><br>  Let's look at the GIF one more time for understanding, which shows the principle of transferring 3 words: <b>55 d1 34</b> <br><img src="https://habrastorage.org/files/912/1c9/806/9121c9806ada40619a316812d823d5db.gif"><br><br>  Please note that if we take an arbitrary image in the database, then the probability that <br>  its <i>hash code</i> will coincide with an arbitrarily given <i>word</i> equal to <b>(1/2 ^ (4 * n))</b> ( <s>oh, why there is still no LaTeX on a habr</s> ). <br><br>  For <b>n = 1,</b> this value is <b>1/16</b> , for <b>n = 2,</b> this value is already <b>1/256</b> . <br>  The lower this probability, the more photos need to be placed in the database to meet our steganographic needs. <br><br>  On the other hand, the greater the <b>n</b> , the greater the <i>speed of the code</i> . <br>  Unfortunately, with increasing <b>n</b> , the speed increases <i>linearly</i> , but the need for the number of photos is <a href="https://ru.wikipedia.org/wiki/%25D0%25AD%25D0%25BA%25D1%2581%25D0%25BF%25D0%25BE%25D0%25BD%25D0%25B5%25D0%25BD%25D1%2586%25D0%25B8%25D0%25B0%25D0%25BB%25D1%258C%25D0%25BD%25D1%258B%25D0%25B9_%25D1%2580%25D0%25BE%25D1%2581%25D1%2582"><i>exponential</i></a> . <br><br>  For this reason, hash steganography is very slow.  However, for the transfer of short messages, it is quite acceptable. <br><br><h2>  Formal description </h2><br><br>  Now let's give a formal description of the stegosystem. <br><br>  We define the stegosystem as a set of objects <b>I.</b> <br>  Define a set of <i>words</i> <b>S</b> <br>  We define the function <b>H (i)</b> , which for each <b>i</b> of <b>I</b> puts the word <b>s</b> from <b>S</b> into correspondence. <br>  Let's call this function a <b>hash code</b> . <br><br>  To send a message <b>s1, s2, s3, ..., sm you</b> should find such <b>i1, i2, i3, ..., im</b> , <br>  for which it is true: <b>H (i1) = s1, H (i2) = s2, ..., H (im) = sm</b> . <br><br>  That's the whole mathematical model.  As you can see - nothing complicated. <br><br>  In order for each word <b>s</b> not to sort through the pictures, until H ( <b>i</b> ) becomes equal to <b>s</b> <br>  It is reasonable to select a sufficiently large number of images, pre-calculate their hash codes, write to the database and build an index by hash codes. <br><br>  How many images should there be so that with a probability of 99.999% you can send an arbitrary message <b>s1, s2, s3, ..., sm of</b> length <b>m</b> ?  We denote this number by <b>M.</b> <br><br>  For me, this question is open ... There are no other ways except for the <a href="https://ru.wikipedia.org/wiki/%25D0%259C%25D0%25B5%25D1%2582%25D0%25BE%25D0%25B4_%25D0%259C%25D0%25BE%25D0%25BD%25D1%2582%25D0%25B5-%25D0%259A%25D0%25B0%25D1%2580%25D0%25BB%25D0%25BE">Monte Carlo</a> method for calculating <b>M</b> from <b>m</b> and <b>n</b> . <br><br><h2>  Upgrades </h2><br><br>  Note that our hash steganography is a typical pure steganography, so it would be nice to encrypt the data itself.  For example, you can use a stream cipher;  in this case, before submitting the desired stego-message to the input of the stegosystem, it should be summed up with a certain gamma.  For example, the desired message <b>55 d1 34 23 75 98</b> can be encrypted with the Vernama cipher and an already encrypted sequence sent to the input of the stegosystem. <br><br>  Another, in my opinion, an important upgrade is to remove the image from the database after using it;  so that after using the picture it is not reused. <br><br>  You can also try to play with probabilities and with the reliability of the system.  For example, what happens if we want to transfer the <i>word</i> <b>0x55</b> , but we already have images with the <i>hash code</i> <b>0x55 in our database</b> ? <br>  For now, there are two options: either pass with an error or in some way generate a lot of new photos in the hope that at least one of them will have a <i>hash code</i> equal to <b>0x55</b> ... <br><br>  However, you can think of another option: use <a href="https://ru.wikipedia.org/wiki/%25D0%259E%25D0%25B1%25D0%25BD%25D0%25B0%25D1%2580%25D1%2583%25D0%25B6%25D0%25B5%25D0%25BD%25D0%25B8%25D0%25B5_%25D0%25B8_%25D0%25B8%25D1%2581%25D0%25BF%25D1%2580%25D0%25B0%25D0%25B2%25D0%25BB%25D0%25B5%25D0%25BD%25D0%25B8%25D0%25B5_%25D0%25BE%25D1%2588%25D0%25B8%25D0%25B1%25D0%25BE%25D0%25BA">robust coding</a> .  Then we have the opportunity to make a few mistakes and the ECC will fix them. <br><br>  And, of course, you can not break into nibbles, but bytes, bits, arbitrary numbers of an arbitrary number system. <br><br>  It should also give an explanation about the channel.  By channel, I meant abstraction in the most general sense of the word.  Most importantly, the order of one word after another must be given.  In principle, you can simply put the files en masse in a folder, enumerating them.  In this case, the folder with the files will be the channel. <br><br><h2>  Examples </h2><br><br><br>  Offhand a few examples of a specific implementation of hash steganography. <br><ol><li>  Publication of images in a social network in a certain sequence. </li><li>  Data transfer via <a href="https://ru.wikipedia.org/wiki/BitTorrent_(%25D0%25BF%25D1%2580%25D0%25BE%25D1%2582%25D0%25BE%25D0%25BA%25D0%25BE%25D0%25BB)">BitTorrent</a> protocol in the <u>right</u> order (so that the necessary <i>hash codes</i> for the transfer of the right <i>words were</i> needed) </li><li>  If the protocol X has the ability to encode the same data in <i>different</i> ways, then the choice of this encoding method to transmit the right <i>words</i> .  For example, suitable <a href="https://ru.wikipedia.org/wiki/ZIP">protocol ZIP</a> </li><li>  Completely arbitrary, <u>meaningful</u> substitution in human language until we get the desired <i>hash code</i> .  For example, the sentence ‚ÄúI went to the forest and saw a gray wolf‚Äù can be replaced with a similar meaningful sentence ‚ÄúI went to the forest and saw a gray wolf‚Äù.  The meaning is the same, but the hash code may be different.  It should be replaced until we get the desired hash code. </li></ol><br><br><h2>  Let's sum up </h2><br><br>  The points. <br><ol><li>  Hash steganography does not distort container data.  Therefore, it is <a href="https://www.zurich.ibm.com/~cca/papers/stego.pdf">top secret (according to Kashen)</a> </li><li>  Hash steganography is slow enough.  As <b>n</b> grows, speed increases linearly, and complexity exponentially. </li><li>  Hash steganography is not sensitive to container data.  There is no LSB for MP3, steganography cannot be applied in prosody for JPEG ... It is only important for hash steganography that the data is digitally representable. </li><li>  Due to claim 1, item 2, item 3, hash steganography can be a good solution for sending short messages </li><li>  Since hash steganography is pure steganography (steganography without a key), encryption is necessary to protect the data. </li><li>  Hash steganography can be a ‚Äúsubalgorithm‚Äù of another steganography algorithm.  True, in this case, we will most likely have to sacrifice <a href="https://www.zurich.ibm.com/~cca/papers/stego.pdf">perfection</a> .  For example, LSB can be divided into <b>U</b> parts of the image.  We take the part and change 1 bit of data in it, we calculate the <i>hash code</i> for this part.  If it coincided with the <i>word</i> , then go to the next part and take the next <i>word</i> .  If not, then try to change the other data bit.  Thus, we changed all <b>U</b> data bits, but transferred <b>4 * U * n</b> data bits.  Increasing <b>n</b> and <b>u</b> can achieve very good results. </li></ol></div><p>Source: <a href="https://habr.com/ru/post/272935/">https://habr.com/ru/post/272935/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../272919/index.html">EGAIS on Windows Embedded POSReady 7. Experience of installation and testing</a></li>
<li><a href="../272921/index.html">Modes and states in SCSS</a></li>
<li><a href="../272923/index.html">Sample Friday Talk</a></li>
<li><a href="../272931/index.html">Conference C ++ Russia 2016, St. Petersburg</a></li>
<li><a href="../272933/index.html">Let the scrolling be with you: theory and practice on the camera in platformers [1/2]</a></li>
<li><a href="../272937/index.html">Why your favorite messenger must die</a></li>
<li><a href="../272943/index.html">December 12 at 12:00 (MSK), see Community DevCamp online</a></li>
<li><a href="../272945/index.html">Little Secrets of a Large Call Center: Predictive Calling</a></li>
<li><a href="../272947/index.html">We test p2p video for overload</a></li>
<li><a href="../272963/index.html">Web Standards Days live from 10:00 today</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>