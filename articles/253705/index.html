<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>HowTo: DMARC</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Recently had to deal with spamming php-script. The culprit was found and destroyed, the hole was closed ... There was a question with the blacklist. I...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>HowTo: DMARC</h1><div class="post__text post__text-html js-mediator-article">  Recently had to deal with spamming php-script.  The culprit was found and destroyed, the hole was closed ... There was a question with the blacklist.  In particular, mail on Gmail (reject) has stopped reaching. <br>  I decided to configure the mail ‚Äúas it should‚Äù - SPF, DKIM and try to configure DMARC. <br>  I will make a reservation right away - I did not even try to figure out the macros and did not configure aspf / adkim (although I wrote about them). <br><br><h4>  What is DMARC? </h4><br>  Described in <a href="https://datatracker.ietf.org/doc/rfc7489/%3Finclude_text%3D1">RFC7489</a> . <br>  DMARC sets the policy for how to check incoming mail in this domain and what to do if emails do not pass SPF or DKIM authentication.  The picture shows at what stage DMARC comes into operation. <br><img src="https://habrastorage.org/getpro/habr/post_images/9a3/e92/506/9a3e92506080e4ab0739de43365443f5.jpg" alt="image: DMARC and the Email Authentication Process"><br><a name="habracut"></a><br><h4>  DMARC setup </h4><br>  You can <a href="https://datatracker.ietf.org/doc/rfc7489/%3Finclude_text%3D1">read the documentation</a> and comprehend Zen, and you can configure the most basic policy - it is very easy to configure - an entry is added to the domain <br><br><h6>  Basic DMARC </h6><br> <code><code>_dmarc.domain.tld IN TXT "v=DMARC1; p=;" <br> <br> p</code> - policy - ,  : <br> <code>none</code> -     ,    ; <br> <code>quarantine</code> -   ; <br> <code>reject</code> -   . <br> <br>                   .   ,            : <br> <br>  DMARC <br> <code>_dmarc.domain.tld IN TXT "v=DMARC1; p=none; sp=none; rua=mailto:postmaster@domain.tld"</code> <br> <br> <code>sp</code> - subdomain policy -        policy; <br> <br> <code>rua</code> - reporting URI for aggregate reports -      mailto:mbox@domain.tld          XML <br> <b class="spoiler_title"> </b>   Mail.ru  <a href="http://habrahabr.ru/company/mailru/blog/170957/">DMARC:     </a> <br> <code class="xml"> &lt;feedback&gt; &lt;report_metadata&gt; &lt;date_range&gt; &lt;begin&gt;1361304000&lt;/begin&gt; &lt;end&gt;1361390400&lt;/end&gt; &lt;/date_range&gt; &lt;email&gt;dmarc_support@corp.mail.ru&lt;/email&gt; &lt;extra_contact_info&gt;http://corp.mail.ru/en&lt;/extra_contact_info&gt; &lt;org_name&gt;Mail.Ru&lt;/org_name&gt; &lt;report_id&gt;1361304000874948&lt;/report_id&gt; &lt;/report_metadata&gt; &lt;policy_published&gt; &lt;adkim&gt;r&lt;/adkim&gt; &lt;aspf&gt;r&lt;/aspf&gt; &lt;domain&gt;adan.ru&lt;/domain&gt; &lt;p&gt;none&lt;/p&gt; &lt;pct&gt;100&lt;/pct&gt; &lt;sp&gt;none&lt;/sp&gt; &lt;/policy_published&gt; &lt;record&gt; &lt;auth_results&gt; &lt;dkim&gt; &lt;domain&gt;adan.ru&lt;/domain&gt; &lt;result&gt;pass&lt;/result&gt; &lt;/dkim&gt; &lt;spf&gt; &lt;domain&gt;adan.ru&lt;/domain&gt; &lt;result&gt;pass&lt;/result&gt; &lt;/spf&gt; &lt;/auth_results&gt; &lt;identifiers&gt; &lt;header_from&gt;adan.ru&lt;/header_from&gt; &lt;/identifiers&gt; &lt;row&gt; &lt;count&gt;20&lt;/count&gt; &lt;policy_evaluated&gt; &lt;disposition&gt;none&lt;/disposition&gt; &lt;dkim&gt;pass&lt;/dkim&gt; &lt;spf&gt;pass&lt;/spf&gt; &lt;/policy_evaluated&gt; &lt;source_ip&gt;176.9.9.172&lt;/source_ip&gt; &lt;/row&gt; &lt;/record&gt; &lt;/feedback&gt;</code> <br> <br>      <code>ri</code> - requested interval -    ,   ,   86400.          . <br> <br>  : <br> -          ; <br> -     ( <code>@domain.tld</code> )     ( <code>@srv1.domain.tld</code> , <code>@srv2.domain.tld</code> ); <br> -           ( <code>postmaster@domain.tld</code> ). <br> <br> , ,  ,         .  , , ... <br> <br>   DMARC <br>    DMARC ,      <code>quarantine</code>  <code>reject</code> ,             : <br> <code>pct</code> - percentage -  ,   , <b></b>   forensic report. ,   <code>"v=DMARC1; p=quarantine; pct=50;"</code>        .   <code>pct=100</code> . <br> <br> <code>aspf</code> - alignment mode for SPF -   SPF: <br> <code>r</code> - relaxed -       RFC5322.From  SPF-        (  ,  ). ,          ,   RFC5321.MailFrom, "some.sub.domain.tld",   RFC5322.From - "mbox@domain.tld"; <br> <code>s</code> - strict -   RFC5321.MailFrom  RFC5322.From   . <br> <br> <code>adkim</code> - alignment mode for DKIM -   DKIM,    : <br> <code>r</code> - relaxed -    :     <code>RFC5322.From</code>        <code><a href="https://publicsuffix.org/"></a> <code>d=    ,         -  : <br> <b class="spoiler_title">  / Organizational Domains</b>     RFC: <br> Organizational Domain: <br> The domain that was registered with a domain name registrar. In the absence of more accurate methods, heuristics are used to determine this, since it is not always the case that the registered domain name is simply a top-level DNS domain plus one component (eg, "example.com", where "com" is a top-level domain). The Organizational Domain is determined by applying the algorithm found in Section 3.2. <br> ... <br> The Organizational Domain is determined using the following algorithm: <br> <br> 1. Acquire a "public suffix" list, ie, a list of DNS domain names reserved for registrations. Some country Top-Level Domains (TLDs) make specific registration requirements, eg, the United Kingdom places company registrations under ".co.uk"; other TLDs such as ".com" appear in the IANA registry of top-level DNS domains. A public suffix list is the union of all of these. Appendix A.6.1 contains some discussion about obtaining a public suffix list. <br> 2. Break the subject DNS domain name into a set of "n" ordered labels. Number these labels from right to left; eg, for "example.com", "com" would be label 1 and "example" would be label 2. <br> 3. Search the public suffix list for the name that matches the largest number of labels found in the subject DNS domain. Let that number be "x". <br> 4. Construct a new DNS domain name using the name that matched from the public suffix list and prefixing to it the "x+1"th label from the subject domain. This new name is the Organizational Domain. <br> <br> Thus, since "com" is an IANA-registered TLD, a subject domain of "abcdexample.com" would have an Organizational Domain of "example.com". <br> <br> The process of determining a suffix is currently a heuristic one. No list is guaranteed to be accurate or current. <br> <br> 1.   " ",         publicsuffix.org <br> 2,     ,       .     - sub.domain.tld</code>   #3 - <code>sub</code> , #2 - <code>domain</code> , #1 - <code>tld</code> . <br> 3.       ,       ,    . <br> 4.     +1  -     . <br> <br> : <br>   info@a.sub.domain.tld <br> : <code>tld</code> - #1, <code>domain</code> - #2, <code>sub</code> - #3, <code>a</code> - #4 <br>       <code>tld</code> ,  =1 <br>        2  - <code>domain.tld</code> <br> <br> <code>s</code> - strict - FQDN   <code><code>d=    RFC5322.From</code>        . <br> <br> <code>ruf</code> - reporting URI for forensic reports -       .           (, Gmail     ). <br> <br> <code>fo</code> - failure report options -      forensic report: <br> <code>0</code> -    -         ; <br> <code>1</code> -          ; <br> <code>d</code> -       DKIM; <br> <code>s</code> -       SPF. <br> <br>    DMARC? <br>      : <br>       DMARC,   : <br> <code>_dmarc.domain.tld IN TXT "v=DMARC1; p=none; sp=none; rua=mailto:postmaster@domain.tld"</code> <br> <br>          -       .      <code>quarantine</code> ,    5% ( <code>pct=5</code> )     , ,      10-20-35-50-75-100%,        <code>reject</code> . <br> <br>   SPF/DKIM    <code>ruf=mailto:your-mbox@domain.tld</code>  <code><code>fo=1     . <br> <br>   ,      ,      -  ,     .</code></code></code></code></code> <h6> <code><code>_dmarc.domain.tld IN TXT "v=DMARC1; p=;" <br> <br> p</code> - policy - ,  : <br> <code>none</code> -     ,    ; <br> <code>quarantine</code> -   ; <br> <code>reject</code> -   . <br> <br>                   .   ,            : <br> <br>  DMARC <br> <code>_dmarc.domain.tld IN TXT "v=DMARC1; p=none; sp=none; rua=mailto:postmaster@domain.tld"</code> <br> <br> <code>sp</code> - subdomain policy -        policy; <br> <br> <code>rua</code> - reporting URI for aggregate reports -      mailto:mbox@domain.tld          XML <br> <b class="spoiler_title"> </b>   Mail.ru  <a href="http://habrahabr.ru/company/mailru/blog/170957/">DMARC:     </a> <br> <code class="xml"> &lt;feedback&gt; &lt;report_metadata&gt; &lt;date_range&gt; &lt;begin&gt;1361304000&lt;/begin&gt; &lt;end&gt;1361390400&lt;/end&gt; &lt;/date_range&gt; &lt;email&gt;dmarc_support@corp.mail.ru&lt;/email&gt; &lt;extra_contact_info&gt;http://corp.mail.ru/en&lt;/extra_contact_info&gt; &lt;org_name&gt;Mail.Ru&lt;/org_name&gt; &lt;report_id&gt;1361304000874948&lt;/report_id&gt; &lt;/report_metadata&gt; &lt;policy_published&gt; &lt;adkim&gt;r&lt;/adkim&gt; &lt;aspf&gt;r&lt;/aspf&gt; &lt;domain&gt;adan.ru&lt;/domain&gt; &lt;p&gt;none&lt;/p&gt; &lt;pct&gt;100&lt;/pct&gt; &lt;sp&gt;none&lt;/sp&gt; &lt;/policy_published&gt; &lt;record&gt; &lt;auth_results&gt; &lt;dkim&gt; &lt;domain&gt;adan.ru&lt;/domain&gt; &lt;result&gt;pass&lt;/result&gt; &lt;/dkim&gt; &lt;spf&gt; &lt;domain&gt;adan.ru&lt;/domain&gt; &lt;result&gt;pass&lt;/result&gt; &lt;/spf&gt; &lt;/auth_results&gt; &lt;identifiers&gt; &lt;header_from&gt;adan.ru&lt;/header_from&gt; &lt;/identifiers&gt; &lt;row&gt; &lt;count&gt;20&lt;/count&gt; &lt;policy_evaluated&gt; &lt;disposition&gt;none&lt;/disposition&gt; &lt;dkim&gt;pass&lt;/dkim&gt; &lt;spf&gt;pass&lt;/spf&gt; &lt;/policy_evaluated&gt; &lt;source_ip&gt;176.9.9.172&lt;/source_ip&gt; &lt;/row&gt; &lt;/record&gt; &lt;/feedback&gt;</code> <br> <br>      <code>ri</code> - requested interval -    ,   ,   86400.          . <br> <br>  : <br> -          ; <br> -     ( <code>@domain.tld</code> )     ( <code>@srv1.domain.tld</code> , <code>@srv2.domain.tld</code> ); <br> -           ( <code>postmaster@domain.tld</code> ). <br> <br> , ,  ,         .  , , ... <br> <br>   DMARC <br>    DMARC ,      <code>quarantine</code>  <code>reject</code> ,             : <br> <code>pct</code> - percentage -  ,   , <b></b>   forensic report. ,   <code>"v=DMARC1; p=quarantine; pct=50;"</code>        .   <code>pct=100</code> . <br> <br> <code>aspf</code> - alignment mode for SPF -   SPF: <br> <code>r</code> - relaxed -       RFC5322.From  SPF-        (  ,  ). ,          ,   RFC5321.MailFrom, "some.sub.domain.tld",   RFC5322.From - "mbox@domain.tld"; <br> <code>s</code> - strict -   RFC5321.MailFrom  RFC5322.From   . <br> <br> <code>adkim</code> - alignment mode for DKIM -   DKIM,    : <br> <code>r</code> - relaxed -    :     <code>RFC5322.From</code>        <code><a href="https://publicsuffix.org/"></a> <code>d=    ,         -  : <br> <b class="spoiler_title">  / Organizational Domains</b>     RFC: <br> Organizational Domain: <br> The domain that was registered with a domain name registrar. In the absence of more accurate methods, heuristics are used to determine this, since it is not always the case that the registered domain name is simply a top-level DNS domain plus one component (eg, "example.com", where "com" is a top-level domain). The Organizational Domain is determined by applying the algorithm found in Section 3.2. <br> ... <br> The Organizational Domain is determined using the following algorithm: <br> <br> 1. Acquire a "public suffix" list, ie, a list of DNS domain names reserved for registrations. Some country Top-Level Domains (TLDs) make specific registration requirements, eg, the United Kingdom places company registrations under ".co.uk"; other TLDs such as ".com" appear in the IANA registry of top-level DNS domains. A public suffix list is the union of all of these. Appendix A.6.1 contains some discussion about obtaining a public suffix list. <br> 2. Break the subject DNS domain name into a set of "n" ordered labels. Number these labels from right to left; eg, for "example.com", "com" would be label 1 and "example" would be label 2. <br> 3. Search the public suffix list for the name that matches the largest number of labels found in the subject DNS domain. Let that number be "x". <br> 4. Construct a new DNS domain name using the name that matched from the public suffix list and prefixing to it the "x+1"th label from the subject domain. This new name is the Organizational Domain. <br> <br> Thus, since "com" is an IANA-registered TLD, a subject domain of "abcdexample.com" would have an Organizational Domain of "example.com". <br> <br> The process of determining a suffix is currently a heuristic one. No list is guaranteed to be accurate or current. <br> <br> 1.   " ",         publicsuffix.org <br> 2,     ,       .     - sub.domain.tld</code>   #3 - <code>sub</code> , #2 - <code>domain</code> , #1 - <code>tld</code> . <br> 3.       ,       ,    . <br> 4.     +1  -     . <br> <br> : <br>   info@a.sub.domain.tld <br> : <code>tld</code> - #1, <code>domain</code> - #2, <code>sub</code> - #3, <code>a</code> - #4 <br>       <code>tld</code> ,  =1 <br>        2  - <code>domain.tld</code> <br> <br> <code>s</code> - strict - FQDN   <code><code>d=    RFC5322.From</code>        . <br> <br> <code>ruf</code> - reporting URI for forensic reports -       .           (, Gmail     ). <br> <br> <code>fo</code> - failure report options -      forensic report: <br> <code>0</code> -    -         ; <br> <code>1</code> -          ; <br> <code>d</code> -       DKIM; <br> <code>s</code> -       SPF. <br> <br>    DMARC? <br>      : <br>       DMARC,   : <br> <code>_dmarc.domain.tld IN TXT "v=DMARC1; p=none; sp=none; rua=mailto:postmaster@domain.tld"</code> <br> <br>          -       .      <code>quarantine</code> ,    5% ( <code>pct=5</code> )     , ,      10-20-35-50-75-100%,        <code>reject</code> . <br> <br>   SPF/DKIM    <code>ruf=mailto:your-mbox@domain.tld</code>  <code><code>fo=1     . <br> <br>   ,      ,      -  ,     .</code></code></code></code></code> </h6> <code><code>_dmarc.domain.tld IN TXT "v=DMARC1; p=;" <br> <br> p</code> - policy - ,  : <br> <code>none</code> -     ,    ; <br> <code>quarantine</code> -   ; <br> <code>reject</code> -   . <br> <br>                   .   ,            : <br> <br>  DMARC <br> <code>_dmarc.domain.tld IN TXT "v=DMARC1; p=none; sp=none; rua=mailto:postmaster@domain.tld"</code> <br> <br> <code>sp</code> - subdomain policy -        policy; <br> <br> <code>rua</code> - reporting URI for aggregate reports -      mailto:mbox@domain.tld          XML <br> <b class="spoiler_title"> </b>   Mail.ru  <a href="http://habrahabr.ru/company/mailru/blog/170957/">DMARC:     </a> <br> <code class="xml"> &lt;feedback&gt; &lt;report_metadata&gt; &lt;date_range&gt; &lt;begin&gt;1361304000&lt;/begin&gt; &lt;end&gt;1361390400&lt;/end&gt; &lt;/date_range&gt; &lt;email&gt;dmarc_support@corp.mail.ru&lt;/email&gt; &lt;extra_contact_info&gt;http://corp.mail.ru/en&lt;/extra_contact_info&gt; &lt;org_name&gt;Mail.Ru&lt;/org_name&gt; &lt;report_id&gt;1361304000874948&lt;/report_id&gt; &lt;/report_metadata&gt; &lt;policy_published&gt; &lt;adkim&gt;r&lt;/adkim&gt; &lt;aspf&gt;r&lt;/aspf&gt; &lt;domain&gt;adan.ru&lt;/domain&gt; &lt;p&gt;none&lt;/p&gt; &lt;pct&gt;100&lt;/pct&gt; &lt;sp&gt;none&lt;/sp&gt; &lt;/policy_published&gt; &lt;record&gt; &lt;auth_results&gt; &lt;dkim&gt; &lt;domain&gt;adan.ru&lt;/domain&gt; &lt;result&gt;pass&lt;/result&gt; &lt;/dkim&gt; &lt;spf&gt; &lt;domain&gt;adan.ru&lt;/domain&gt; &lt;result&gt;pass&lt;/result&gt; &lt;/spf&gt; &lt;/auth_results&gt; &lt;identifiers&gt; &lt;header_from&gt;adan.ru&lt;/header_from&gt; &lt;/identifiers&gt; &lt;row&gt; &lt;count&gt;20&lt;/count&gt; &lt;policy_evaluated&gt; &lt;disposition&gt;none&lt;/disposition&gt; &lt;dkim&gt;pass&lt;/dkim&gt; &lt;spf&gt;pass&lt;/spf&gt; &lt;/policy_evaluated&gt; &lt;source_ip&gt;176.9.9.172&lt;/source_ip&gt; &lt;/row&gt; &lt;/record&gt; &lt;/feedback&gt;</code> <br> <br>      <code>ri</code> - requested interval -    ,   ,   86400.          . <br> <br>  : <br> -          ; <br> -     ( <code>@domain.tld</code> )     ( <code>@srv1.domain.tld</code> , <code>@srv2.domain.tld</code> ); <br> -           ( <code>postmaster@domain.tld</code> ). <br> <br> , ,  ,         .  , , ... <br> <br>   DMARC <br>    DMARC ,      <code>quarantine</code>  <code>reject</code> ,             : <br> <code>pct</code> - percentage -  ,   , <b></b>   forensic report. ,   <code>"v=DMARC1; p=quarantine; pct=50;"</code>        .   <code>pct=100</code> . <br> <br> <code>aspf</code> - alignment mode for SPF -   SPF: <br> <code>r</code> - relaxed -       RFC5322.From  SPF-        (  ,  ). ,          ,   RFC5321.MailFrom, "some.sub.domain.tld",   RFC5322.From - "mbox@domain.tld"; <br> <code>s</code> - strict -   RFC5321.MailFrom  RFC5322.From   . <br> <br> <code>adkim</code> - alignment mode for DKIM -   DKIM,    : <br> <code>r</code> - relaxed -    :     <code>RFC5322.From</code>        <code><a href="https://publicsuffix.org/"></a> <code>d=    ,         -  : <br> <b class="spoiler_title">  / Organizational Domains</b>     RFC: <br> Organizational Domain: <br> The domain that was registered with a domain name registrar. In the absence of more accurate methods, heuristics are used to determine this, since it is not always the case that the registered domain name is simply a top-level DNS domain plus one component (eg, "example.com", where "com" is a top-level domain). The Organizational Domain is determined by applying the algorithm found in Section 3.2. <br> ... <br> The Organizational Domain is determined using the following algorithm: <br> <br> 1. Acquire a "public suffix" list, ie, a list of DNS domain names reserved for registrations. Some country Top-Level Domains (TLDs) make specific registration requirements, eg, the United Kingdom places company registrations under ".co.uk"; other TLDs such as ".com" appear in the IANA registry of top-level DNS domains. A public suffix list is the union of all of these. Appendix A.6.1 contains some discussion about obtaining a public suffix list. <br> 2. Break the subject DNS domain name into a set of "n" ordered labels. Number these labels from right to left; eg, for "example.com", "com" would be label 1 and "example" would be label 2. <br> 3. Search the public suffix list for the name that matches the largest number of labels found in the subject DNS domain. Let that number be "x". <br> 4. Construct a new DNS domain name using the name that matched from the public suffix list and prefixing to it the "x+1"th label from the subject domain. This new name is the Organizational Domain. <br> <br> Thus, since "com" is an IANA-registered TLD, a subject domain of "abcdexample.com" would have an Organizational Domain of "example.com". <br> <br> The process of determining a suffix is currently a heuristic one. No list is guaranteed to be accurate or current. <br> <br> 1.   " ",         publicsuffix.org <br> 2,     ,       .     - sub.domain.tld</code>   #3 - <code>sub</code> , #2 - <code>domain</code> , #1 - <code>tld</code> . <br> 3.       ,       ,    . <br> 4.     +1  -     . <br> <br> : <br>   info@a.sub.domain.tld <br> : <code>tld</code> - #1, <code>domain</code> - #2, <code>sub</code> - #3, <code>a</code> - #4 <br>       <code>tld</code> ,  =1 <br>        2  - <code>domain.tld</code> <br> <br> <code>s</code> - strict - FQDN   <code><code>d=    RFC5322.From</code>        . <br> <br> <code>ruf</code> - reporting URI for forensic reports -       .           (, Gmail     ). <br> <br> <code>fo</code> - failure report options -      forensic report: <br> <code>0</code> -    -         ; <br> <code>1</code> -          ; <br> <code>d</code> -       DKIM; <br> <code>s</code> -       SPF. <br> <br>    DMARC? <br>      : <br>       DMARC,   : <br> <code>_dmarc.domain.tld IN TXT "v=DMARC1; p=none; sp=none; rua=mailto:postmaster@domain.tld"</code> <br> <br>          -       .      <code>quarantine</code> ,    5% ( <code>pct=5</code> )     , ,      10-20-35-50-75-100%,        <code>reject</code> . <br> <br>   SPF/DKIM    <code>ruf=mailto:your-mbox@domain.tld</code>  <code><code>fo=1     . <br> <br>   ,      ,      -  ,     .</code></code></code></code></code> <div class="spoiler"> <code><b class="spoiler_title"><code>_dmarc.domain.tld IN TXT "v=DMARC1; p=;" <br> <br> p</code> - policy - ,  : <br> <code>none</code> -     ,    ; <br> <code>quarantine</code> -   ; <br> <code>reject</code> -   . <br> <br>                   .   ,            : <br> <br>  DMARC <br> <code>_dmarc.domain.tld IN TXT "v=DMARC1; p=none; sp=none; rua=mailto:postmaster@domain.tld"</code> <br> <br> <code>sp</code> - subdomain policy -        policy; <br> <br> <code>rua</code> - reporting URI for aggregate reports -      mailto:mbox@domain.tld          XML <br>     Mail.ru  <a href="http://habrahabr.ru/company/mailru/blog/170957/">DMARC:     </a> <br> <code class="xml"> &lt;feedback&gt; &lt;report_metadata&gt; &lt;date_range&gt; &lt;begin&gt;1361304000&lt;/begin&gt; &lt;end&gt;1361390400&lt;/end&gt; &lt;/date_range&gt; &lt;email&gt;dmarc_support@corp.mail.ru&lt;/email&gt; &lt;extra_contact_info&gt;http://corp.mail.ru/en&lt;/extra_contact_info&gt; &lt;org_name&gt;Mail.Ru&lt;/org_name&gt; &lt;report_id&gt;1361304000874948&lt;/report_id&gt; &lt;/report_metadata&gt; &lt;policy_published&gt; &lt;adkim&gt;r&lt;/adkim&gt; &lt;aspf&gt;r&lt;/aspf&gt; &lt;domain&gt;adan.ru&lt;/domain&gt; &lt;p&gt;none&lt;/p&gt; &lt;pct&gt;100&lt;/pct&gt; &lt;sp&gt;none&lt;/sp&gt; &lt;/policy_published&gt; &lt;record&gt; &lt;auth_results&gt; &lt;dkim&gt; &lt;domain&gt;adan.ru&lt;/domain&gt; &lt;result&gt;pass&lt;/result&gt; &lt;/dkim&gt; &lt;spf&gt; &lt;domain&gt;adan.ru&lt;/domain&gt; &lt;result&gt;pass&lt;/result&gt; &lt;/spf&gt; &lt;/auth_results&gt; &lt;identifiers&gt; &lt;header_from&gt;adan.ru&lt;/header_from&gt; &lt;/identifiers&gt; &lt;row&gt; &lt;count&gt;20&lt;/count&gt; &lt;policy_evaluated&gt; &lt;disposition&gt;none&lt;/disposition&gt; &lt;dkim&gt;pass&lt;/dkim&gt; &lt;spf&gt;pass&lt;/spf&gt; &lt;/policy_evaluated&gt; &lt;source_ip&gt;176.9.9.172&lt;/source_ip&gt; &lt;/row&gt; &lt;/record&gt; &lt;/feedback&gt;</code> <br> <br>      <code>ri</code> - requested interval -    ,   ,   86400.          . <br> <br>  : <br> -          ; <br> -     ( <code>@domain.tld</code> )     ( <code>@srv1.domain.tld</code> , <code>@srv2.domain.tld</code> ); <br> -           ( <code>postmaster@domain.tld</code> ). <br> <br> , ,  ,         .  , , ... <br> <br>   DMARC <br>    DMARC ,      <code>quarantine</code>  <code>reject</code> ,             : <br> <code>pct</code> - percentage -  ,   , <b></b>   forensic report. ,   <code>"v=DMARC1; p=quarantine; pct=50;"</code>        .   <code>pct=100</code> . <br> <br> <code>aspf</code> - alignment mode for SPF -   SPF: <br> <code>r</code> - relaxed -       RFC5322.From  SPF-        (  ,  ). ,          ,   RFC5321.MailFrom, "some.sub.domain.tld",   RFC5322.From - "mbox@domain.tld"; <br> <code>s</code> - strict -   RFC5321.MailFrom  RFC5322.From   . <br> <br> <code>adkim</code> - alignment mode for DKIM -   DKIM,    : <br> <code>r</code> - relaxed -    :     <code>RFC5322.From</code>        <code><a href="https://publicsuffix.org/"></a> <code>d=    ,         -  : <br> <b class="spoiler_title">  / Organizational Domains</b>     RFC: <br> Organizational Domain: <br> The domain that was registered with a domain name registrar. In the absence of more accurate methods, heuristics are used to determine this, since it is not always the case that the registered domain name is simply a top-level DNS domain plus one component (eg, "example.com", where "com" is a top-level domain). The Organizational Domain is determined by applying the algorithm found in Section 3.2. <br> ... <br> The Organizational Domain is determined using the following algorithm: <br> <br> 1. Acquire a "public suffix" list, ie, a list of DNS domain names reserved for registrations. Some country Top-Level Domains (TLDs) make specific registration requirements, eg, the United Kingdom places company registrations under ".co.uk"; other TLDs such as ".com" appear in the IANA registry of top-level DNS domains. A public suffix list is the union of all of these. Appendix A.6.1 contains some discussion about obtaining a public suffix list. <br> 2. Break the subject DNS domain name into a set of "n" ordered labels. Number these labels from right to left; eg, for "example.com", "com" would be label 1 and "example" would be label 2. <br> 3. Search the public suffix list for the name that matches the largest number of labels found in the subject DNS domain. Let that number be "x". <br> 4. Construct a new DNS domain name using the name that matched from the public suffix list and prefixing to it the "x+1"th label from the subject domain. This new name is the Organizational Domain. <br> <br> Thus, since "com" is an IANA-registered TLD, a subject domain of "abcdexample.com" would have an Organizational Domain of "example.com". <br> <br> The process of determining a suffix is currently a heuristic one. No list is guaranteed to be accurate or current. <br> <br> 1.   " ",         publicsuffix.org <br> 2,     ,       .     - sub.domain.tld</code>   #3 - <code>sub</code> , #2 - <code>domain</code> , #1 - <code>tld</code> . <br> 3.       ,       ,    . <br> 4.     +1  -     . <br> <br> : <br>   info@a.sub.domain.tld <br> : <code>tld</code> - #1, <code>domain</code> - #2, <code>sub</code> - #3, <code>a</code> - #4 <br>       <code>tld</code> ,  =1 <br>        2  - <code>domain.tld</code> <br> <br> <code>s</code> - strict - FQDN   <code><code>d=    RFC5322.From</code>        . <br> <br> <code>ruf</code> - reporting URI for forensic reports -       .           (, Gmail     ). <br> <br> <code>fo</code> - failure report options -      forensic report: <br> <code>0</code> -    -         ; <br> <code>1</code> -          ; <br> <code>d</code> -       DKIM; <br> <code>s</code> -       SPF. <br> <br>    DMARC? <br>      : <br>       DMARC,   : <br> <code>_dmarc.domain.tld IN TXT "v=DMARC1; p=none; sp=none; rua=mailto:postmaster@domain.tld"</code> <br> <br>          -       .      <code>quarantine</code> ,    5% ( <code>pct=5</code> )     , ,      10-20-35-50-75-100%,        <code>reject</code> . <br> <br>   SPF/DKIM    <code>ruf=mailto:your-mbox@domain.tld</code>  <code><code>fo=1     . <br> <br>   ,      ,      -  ,     .</code></code></code></code></b></code> <div class="spoiler_text"> <code><code>_dmarc.domain.tld IN TXT "v=DMARC1; p=;" <br> <br> p</code> - policy - ,  : <br> <code>none</code> -     ,    ; <br> <code>quarantine</code> -   ; <br> <code>reject</code> -   . <br> <br>                   .   ,            : <br> <br>  DMARC <br> <code>_dmarc.domain.tld IN TXT "v=DMARC1; p=none; sp=none; rua=mailto:postmaster@domain.tld"</code> <br> <br> <code>sp</code> - subdomain policy -        policy; <br> <br> <code>rua</code> - reporting URI for aggregate reports -      mailto:mbox@domain.tld          XML <br> <b class="spoiler_title"> </b>   Mail.ru  <a href="http://habrahabr.ru/company/mailru/blog/170957/">DMARC:     </a> <br> <code class="xml"> &lt;feedback&gt; &lt;report_metadata&gt; &lt;date_range&gt; &lt;begin&gt;1361304000&lt;/begin&gt; &lt;end&gt;1361390400&lt;/end&gt; &lt;/date_range&gt; &lt;email&gt;dmarc_support@corp.mail.ru&lt;/email&gt; &lt;extra_contact_info&gt;http://corp.mail.ru/en&lt;/extra_contact_info&gt; &lt;org_name&gt;Mail.Ru&lt;/org_name&gt; &lt;report_id&gt;1361304000874948&lt;/report_id&gt; &lt;/report_metadata&gt; &lt;policy_published&gt; &lt;adkim&gt;r&lt;/adkim&gt; &lt;aspf&gt;r&lt;/aspf&gt; &lt;domain&gt;adan.ru&lt;/domain&gt; &lt;p&gt;none&lt;/p&gt; &lt;pct&gt;100&lt;/pct&gt; &lt;sp&gt;none&lt;/sp&gt; &lt;/policy_published&gt; &lt;record&gt; &lt;auth_results&gt; &lt;dkim&gt; &lt;domain&gt;adan.ru&lt;/domain&gt; &lt;result&gt;pass&lt;/result&gt; &lt;/dkim&gt; &lt;spf&gt; &lt;domain&gt;adan.ru&lt;/domain&gt; &lt;result&gt;pass&lt;/result&gt; &lt;/spf&gt; &lt;/auth_results&gt; &lt;identifiers&gt; &lt;header_from&gt;adan.ru&lt;/header_from&gt; &lt;/identifiers&gt; &lt;row&gt; &lt;count&gt;20&lt;/count&gt; &lt;policy_evaluated&gt; &lt;disposition&gt;none&lt;/disposition&gt; &lt;dkim&gt;pass&lt;/dkim&gt; &lt;spf&gt;pass&lt;/spf&gt; &lt;/policy_evaluated&gt; &lt;source_ip&gt;176.9.9.172&lt;/source_ip&gt; &lt;/row&gt; &lt;/record&gt; &lt;/feedback&gt;</code> <br> <br>      <code>ri</code> - requested interval -    ,   ,   86400.          . <br> <br>  : <br> -          ; <br> -     ( <code>@domain.tld</code> )     ( <code>@srv1.domain.tld</code> , <code>@srv2.domain.tld</code> ); <br> -           ( <code>postmaster@domain.tld</code> ). <br> <br> , ,  ,         .  , , ... <br> <br>   DMARC <br>    DMARC ,      <code>quarantine</code>  <code>reject</code> ,             : <br> <code>pct</code> - percentage -  ,   , <b></b>   forensic report. ,   <code>"v=DMARC1; p=quarantine; pct=50;"</code>        .   <code>pct=100</code> . <br> <br> <code>aspf</code> - alignment mode for SPF -   SPF: <br> <code>r</code> - relaxed -       RFC5322.From  SPF-        (  ,  ). ,          ,   RFC5321.MailFrom, "some.sub.domain.tld",   RFC5322.From - "mbox@domain.tld"; <br> <code>s</code> - strict -   RFC5321.MailFrom  RFC5322.From   . <br> <br> <code>adkim</code> - alignment mode for DKIM -   DKIM,    : <br> <code>r</code> - relaxed -    :     <code>RFC5322.From</code>        <code><a href="https://publicsuffix.org/"></a> <code>d=    ,         -  : <br> <b class="spoiler_title">  / Organizational Domains</b>     RFC: <br> Organizational Domain: <br> The domain that was registered with a domain name registrar. In the absence of more accurate methods, heuristics are used to determine this, since it is not always the case that the registered domain name is simply a top-level DNS domain plus one component (eg, "example.com", where "com" is a top-level domain). The Organizational Domain is determined by applying the algorithm found in Section 3.2. <br> ... <br> The Organizational Domain is determined using the following algorithm: <br> <br> 1. Acquire a "public suffix" list, ie, a list of DNS domain names reserved for registrations. Some country Top-Level Domains (TLDs) make specific registration requirements, eg, the United Kingdom places company registrations under ".co.uk"; other TLDs such as ".com" appear in the IANA registry of top-level DNS domains. A public suffix list is the union of all of these. Appendix A.6.1 contains some discussion about obtaining a public suffix list. <br> 2. Break the subject DNS domain name into a set of "n" ordered labels. Number these labels from right to left; eg, for "example.com", "com" would be label 1 and "example" would be label 2. <br> 3. Search the public suffix list for the name that matches the largest number of labels found in the subject DNS domain. Let that number be "x". <br> 4. Construct a new DNS domain name using the name that matched from the public suffix list and prefixing to it the "x+1"th label from the subject domain. This new name is the Organizational Domain. <br> <br> Thus, since "com" is an IANA-registered TLD, a subject domain of "abcdexample.com" would have an Organizational Domain of "example.com". <br> <br> The process of determining a suffix is currently a heuristic one. No list is guaranteed to be accurate or current. <br> <br> 1.   " ",         publicsuffix.org <br> 2,     ,       .     - sub.domain.tld</code>   #3 - <code>sub</code> , #2 - <code>domain</code> , #1 - <code>tld</code> . <br> 3.       ,       ,    . <br> 4.     +1  -     . <br> <br> : <br>   info@a.sub.domain.tld <br> : <code>tld</code> - #1, <code>domain</code> - #2, <code>sub</code> - #3, <code>a</code> - #4 <br>       <code>tld</code> ,  =1 <br>        2  - <code>domain.tld</code> <br> <br> <code>s</code> - strict - FQDN   <code><code>d=    RFC5322.From</code>        . <br> <br> <code>ruf</code> - reporting URI for forensic reports -       .           (, Gmail     ). <br> <br> <code>fo</code> - failure report options -      forensic report: <br> <code>0</code> -    -         ; <br> <code>1</code> -          ; <br> <code>d</code> -       DKIM; <br> <code>s</code> -       SPF. <br> <br>    DMARC? <br>      : <br>       DMARC,   : <br> <code>_dmarc.domain.tld IN TXT "v=DMARC1; p=none; sp=none; rua=mailto:postmaster@domain.tld"</code> <br> <br>          -       .      <code>quarantine</code> ,    5% ( <code>pct=5</code> )     , ,      10-20-35-50-75-100%,        <code>reject</code> . <br> <br>   SPF/DKIM    <code>ruf=mailto:your-mbox@domain.tld</code>  <code><code>fo=1     . <br> <br>   ,      ,      -  ,     .</code></code></code></code></code> <pre> <code class="hljs vhdl"><code>_dmarc.domain.tld <span class="hljs-keyword"><span class="hljs-keyword">IN</span></span> TXT <span class="hljs-string"><span class="hljs-string">"v=DMARC1; p=;"</span></span> <br> <br> p</code> - policy - ,  : <br> <code>none</code> -     ,    ; <br> <code>quarantine</code> -   ; <br> <code><span class="hljs-keyword"><span class="hljs-keyword">reject</span></span></code> -   . <br> <br>                   .   ,            : <br> <br>  DMARC <br> <code>_dmarc.domain.tld <span class="hljs-keyword"><span class="hljs-keyword">IN</span></span> TXT <span class="hljs-string"><span class="hljs-string">"v=DMARC1; p=none; sp=none; rua=mailto:postmaster@domain.tld"</span></span></code> <br> <br> <code>sp</code> - subdomain policy -        policy; <br> <br> <code>rua</code> - reporting URI <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> aggregate reports -      mailto:mbox@domain.tld          XML <br> <b class="spoiler_title"> </b>   Mail.ru  <a href="http://habrahabr.ru/company/mailru/blog/170957/">DMARC:     </a> <br> <code class="xml"> &lt;feedback&gt; &lt;report_metadata&gt; &lt;date_range&gt; &lt;<span class="hljs-keyword"><span class="hljs-keyword">begin</span></span>&gt;<span class="hljs-number"><span class="hljs-number">1361304000</span></span>&lt;/<span class="hljs-keyword"><span class="hljs-keyword">begin</span></span>&gt; &lt;<span class="hljs-keyword"><span class="hljs-keyword">end</span></span>&gt;<span class="hljs-number"><span class="hljs-number">1361390400</span></span>&lt;/<span class="hljs-keyword"><span class="hljs-keyword">end</span></span>&gt; &lt;/date_range&gt; &lt;email&gt;dmarc_support@corp.mail.ru&lt;/email&gt; &lt;extra_contact_info&gt;http://corp.mail.ru/en&lt;/extra_contact_info&gt; &lt;org_name&gt;Mail.Ru&lt;/org_name&gt; &lt;report_id&gt;<span class="hljs-number"><span class="hljs-number">1361304000874948</span></span>&lt;/report_id&gt; &lt;/report_metadata&gt; &lt;policy_published&gt; &lt;adkim&gt;r&lt;/adkim&gt; &lt;aspf&gt;r&lt;/aspf&gt; &lt;domain&gt;adan.ru&lt;/domain&gt; &lt;p&gt;none&lt;/p&gt; &lt;pct&gt;<span class="hljs-number"><span class="hljs-number">100</span></span>&lt;/pct&gt; &lt;sp&gt;none&lt;/sp&gt; &lt;/policy_published&gt; &lt;<span class="hljs-keyword"><span class="hljs-keyword">record</span></span>&gt; &lt;auth_results&gt; &lt;dkim&gt; &lt;domain&gt;adan.ru&lt;/domain&gt; &lt;result&gt;pass&lt;/result&gt; &lt;/dkim&gt; &lt;spf&gt; &lt;domain&gt;adan.ru&lt;/domain&gt; &lt;result&gt;pass&lt;/result&gt; &lt;/spf&gt; &lt;/auth_results&gt; &lt;identifiers&gt; &lt;header_from&gt;adan.ru&lt;/header_from&gt; &lt;/identifiers&gt; &lt;row&gt; &lt;count&gt;<span class="hljs-number"><span class="hljs-number">20</span></span>&lt;/count&gt; &lt;policy_evaluated&gt; &lt;disposition&gt;none&lt;/disposition&gt; &lt;dkim&gt;pass&lt;/dkim&gt; &lt;spf&gt;pass&lt;/spf&gt; &lt;/policy_evaluated&gt; &lt;source_ip&gt;<span class="hljs-number"><span class="hljs-number">176.9</span></span>.<span class="hljs-number"><span class="hljs-number">9.172</span></span>&lt;/source_ip&gt; &lt;/row&gt; &lt;/<span class="hljs-keyword"><span class="hljs-keyword">record</span></span>&gt; &lt;/feedback&gt;</code> <br> <br>      <code>ri</code> - requested interval -    ,   ,   <span class="hljs-number"><span class="hljs-number">86400</span></span>.          . <br> <br>  : <br> -          ; <br> -     ( <code>@domain.tld</code> )     ( <code>@srv1.domain.tld</code> , <code>@srv2.domain.tld</code> ); <br> -           ( <code>postmaster@domain.tld</code> ). <br> <br> , ,  ,         .  , , ... <br> <br>   DMARC <br>    DMARC ,      <code>quarantine</code>  <code><span class="hljs-keyword"><span class="hljs-keyword">reject</span></span></code> ,             : <br> <code>pct</code> - percentage -  ,   , <b></b>   forensic <span class="hljs-keyword"><span class="hljs-keyword">report</span></span>. ,   <code><span class="hljs-string"><span class="hljs-string">"v=DMARC1; p=quarantine; pct=50;"</span></span></code>        .   <code>pct=<span class="hljs-number"><span class="hljs-number">100</span></span></code> . <br> <br> <code>aspf</code> - alignment mode <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> SPF -   SPF: <br> <code>r</code> - relaxed -       RFC5322.From  SPF-        (  ,  ). ,          ,   RFC5321.MailFrom, <span class="hljs-string"><span class="hljs-string">"some.sub.domain.tld"</span></span>,   RFC5322.From - <span class="hljs-string"><span class="hljs-string">"mbox@domain.tld"</span></span>; <br> <code>s</code> - strict -   RFC5321.MailFrom  RFC5322.From   . <br> <br> <code>adkim</code> - alignment mode <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> DKIM -   DKIM,    : <br> <code>r</code> - relaxed -    :     <code>RFC5322.From</code>        <code><a href="https://publicsuffix.org/"></a> <code>d=    ,         -  : <br> <b class="spoiler_title">  / Organizational Domains</b>     RFC: <br> Organizational Domain: <br> The domain that was registered <span class="hljs-keyword"><span class="hljs-keyword">with</span></span> a domain name registrar. <span class="hljs-keyword"><span class="hljs-keyword">In</span></span> the absence <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> more accurate methods, heuristics are used <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> determine this, since it <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> always the <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> that the registered domain name <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> simply a top-level DNS domain plus one <span class="hljs-keyword"><span class="hljs-keyword">component</span></span> (eg, <span class="hljs-string"><span class="hljs-string">"example.com"</span></span>, where <span class="hljs-string"><span class="hljs-string">"com"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> a top-level domain). The Organizational Domain <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> determined by applying the algorithm found <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> Section <span class="hljs-number"><span class="hljs-number">3.2</span></span>. <br> ... <br> The Organizational Domain <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> determined using the following algorithm: <br> <br> <span class="hljs-number"><span class="hljs-number">1</span></span>. Acquire a <span class="hljs-string"><span class="hljs-string">"public suffix"</span></span> list, ie, a list <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> DNS domain names reserved <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> registrations. Some country Top-Level Domains (TLDs) make specific registration requirements, eg, the United Kingdom places company registrations under <span class="hljs-string"><span class="hljs-string">".co.uk"</span></span>; other TLDs such as <span class="hljs-string"><span class="hljs-string">".com"</span></span> appear <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> the IANA registry <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> top-level DNS domains. A public suffix list <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> the union <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> <span class="hljs-keyword"><span class="hljs-keyword">all</span></span> <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> these. Appendix A.<span class="hljs-number"><span class="hljs-number">6.1</span></span> contains some discussion about obtaining a public suffix list. <br> <span class="hljs-number"><span class="hljs-number">2</span></span>. Break the subject DNS domain name into a set <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> <span class="hljs-string"><span class="hljs-string">"n"</span></span> ordered labels. Number these labels from right <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> left; eg, <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> <span class="hljs-string"><span class="hljs-string">"example.com"</span></span>, <span class="hljs-string"><span class="hljs-string">"com"</span></span> would be <span class="hljs-keyword"><span class="hljs-keyword">label</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> <span class="hljs-string"><span class="hljs-string">"example"</span></span> would be <span class="hljs-keyword"><span class="hljs-keyword">label</span></span> <span class="hljs-number"><span class="hljs-number">2</span></span>. <br> <span class="hljs-number"><span class="hljs-number">3</span></span>. Search the public suffix list <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> the name that matches the largest number <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> labels found <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> the subject DNS domain. Let that number be <span class="hljs-string"><span class="hljs-string">"x"</span></span>. <br> <span class="hljs-number"><span class="hljs-number">4</span></span>. Construct a <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> DNS domain name using the name that matched from the public suffix list <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> prefixing <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> it the <span class="hljs-string"><span class="hljs-string">"x+1"</span></span>th <span class="hljs-keyword"><span class="hljs-keyword">label</span></span> from the subject domain. This <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> name <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> the Organizational Domain. <br> <br> Thus, since <span class="hljs-string"><span class="hljs-string">"com"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> an IANA-registered TLD, a subject domain <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> <span class="hljs-string"><span class="hljs-string">"abcdexample.com"</span></span> would have an Organizational Domain <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> <span class="hljs-string"><span class="hljs-string">"example.com"</span></span>. <br> <br> The <span class="hljs-keyword"><span class="hljs-keyword">process</span></span> <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> determining a suffix <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> currently a heuristic one. No list <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> guaranteed <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> be accurate <span class="hljs-keyword"><span class="hljs-keyword">or</span></span> current. <br> <br> <span class="hljs-number"><span class="hljs-number">1</span></span>.   <span class="hljs-string"><span class="hljs-string">" "</span></span>,         publicsuffix.org <br> <span class="hljs-number"><span class="hljs-number">2</span></span>,     ,       .     - sub.domain.tld</code>   #<span class="hljs-number"><span class="hljs-number">3</span></span> - <code>sub</code> , #<span class="hljs-number"><span class="hljs-number">2</span></span> - <code>domain</code> , #<span class="hljs-number"><span class="hljs-number">1</span></span> - <code>tld</code> . <br> <span class="hljs-number"><span class="hljs-number">3</span></span>.       ,       ,    . <br> <span class="hljs-number"><span class="hljs-number">4</span></span>.     +<span class="hljs-number"><span class="hljs-number">1</span></span>  -     . <br> <br> : <br>   info@a.sub.domain.tld <br> : <code>tld</code> - #<span class="hljs-number"><span class="hljs-number">1</span></span>, <code>domain</code> - #<span class="hljs-number"><span class="hljs-number">2</span></span>, <code>sub</code> - #<span class="hljs-number"><span class="hljs-number">3</span></span>, <code>a</code> - #<span class="hljs-number"><span class="hljs-number">4</span></span> <br>       <code>tld</code> ,  =<span class="hljs-number"><span class="hljs-number">1</span></span> <br>        <span class="hljs-number"><span class="hljs-number">2</span></span>  - <code>domain.tld</code> <br> <br> <code>s</code> - strict - FQDN   <code><code>d=    RFC5322.From</code>        . <br> <br> <code>ruf</code> - reporting URI <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> forensic reports -       .           (, Gmail     ). <br> <br> <code>fo</code> - <span class="hljs-literal"><span class="hljs-literal">failure</span></span> <span class="hljs-keyword"><span class="hljs-keyword">report</span></span> options -      forensic <span class="hljs-keyword"><span class="hljs-keyword">report</span></span>: <br> <code><span class="hljs-number"><span class="hljs-number">0</span></span></code> -    -         ; <br> <code><span class="hljs-number"><span class="hljs-number">1</span></span></code> -          ; <br> <code>d</code> -       DKIM; <br> <code>s</code> -       SPF. <br> <br>    DMARC? <br>      : <br>       DMARC,   : <br> <code>_dmarc.domain.tld <span class="hljs-keyword"><span class="hljs-keyword">IN</span></span> TXT <span class="hljs-string"><span class="hljs-string">"v=DMARC1; p=none; sp=none; rua=mailto:postmaster@domain.tld"</span></span></code> <br> <br>          -       .      <code>quarantine</code> ,    <span class="hljs-number"><span class="hljs-number">5</span></span>% ( <code>pct=<span class="hljs-number"><span class="hljs-number">5</span></span></code> )     , ,      <span class="hljs-number"><span class="hljs-number">10</span></span>-<span class="hljs-number"><span class="hljs-number">20</span></span>-<span class="hljs-number"><span class="hljs-number">35</span></span>-<span class="hljs-number"><span class="hljs-number">50</span></span>-<span class="hljs-number"><span class="hljs-number">75</span></span>-<span class="hljs-number"><span class="hljs-number">100</span></span>%,        <code><span class="hljs-keyword"><span class="hljs-keyword">reject</span></span></code> . <br> <br>   SPF/DKIM    <code>ruf=mailto:your-mbox@domain.tld</code>  <code><code>fo=<span class="hljs-number"><span class="hljs-number">1</span></span>     . <br> <br>   ,      ,      -  ,     .</code></code></code></code></code> </pre> <code><code>_dmarc.domain.tld IN TXT "v=DMARC1; p=;" <br> <br> p</code> - policy - ,  : <br> <code>none</code> -     ,    ; <br> <code>quarantine</code> -   ; <br> <code>reject</code> -   . <br> <br>                   .   ,            : <br> <br>  DMARC <br> <code>_dmarc.domain.tld IN TXT "v=DMARC1; p=none; sp=none; rua=mailto:postmaster@domain.tld"</code> <br> <br> <code>sp</code> - subdomain policy -        policy; <br> <br> <code>rua</code> - reporting URI for aggregate reports -      mailto:mbox@domain.tld          XML <br> <b class="spoiler_title"> </b>   Mail.ru  <a href="http://habrahabr.ru/company/mailru/blog/170957/">DMARC:     </a> <br> <code class="xml"> &lt;feedback&gt; &lt;report_metadata&gt; &lt;date_range&gt; &lt;begin&gt;1361304000&lt;/begin&gt; &lt;end&gt;1361390400&lt;/end&gt; &lt;/date_range&gt; &lt;email&gt;dmarc_support@corp.mail.ru&lt;/email&gt; &lt;extra_contact_info&gt;http://corp.mail.ru/en&lt;/extra_contact_info&gt; &lt;org_name&gt;Mail.Ru&lt;/org_name&gt; &lt;report_id&gt;1361304000874948&lt;/report_id&gt; &lt;/report_metadata&gt; &lt;policy_published&gt; &lt;adkim&gt;r&lt;/adkim&gt; &lt;aspf&gt;r&lt;/aspf&gt; &lt;domain&gt;adan.ru&lt;/domain&gt; &lt;p&gt;none&lt;/p&gt; &lt;pct&gt;100&lt;/pct&gt; &lt;sp&gt;none&lt;/sp&gt; &lt;/policy_published&gt; &lt;record&gt; &lt;auth_results&gt; &lt;dkim&gt; &lt;domain&gt;adan.ru&lt;/domain&gt; &lt;result&gt;pass&lt;/result&gt; &lt;/dkim&gt; &lt;spf&gt; &lt;domain&gt;adan.ru&lt;/domain&gt; &lt;result&gt;pass&lt;/result&gt; &lt;/spf&gt; &lt;/auth_results&gt; &lt;identifiers&gt; &lt;header_from&gt;adan.ru&lt;/header_from&gt; &lt;/identifiers&gt; &lt;row&gt; &lt;count&gt;20&lt;/count&gt; &lt;policy_evaluated&gt; &lt;disposition&gt;none&lt;/disposition&gt; &lt;dkim&gt;pass&lt;/dkim&gt; &lt;spf&gt;pass&lt;/spf&gt; &lt;/policy_evaluated&gt; &lt;source_ip&gt;176.9.9.172&lt;/source_ip&gt; &lt;/row&gt; &lt;/record&gt; &lt;/feedback&gt;</code> <br> <br>      <code>ri</code> - requested interval -    ,   ,   86400.          . <br> <br>  : <br> -          ; <br> -     ( <code>@domain.tld</code> )     ( <code>@srv1.domain.tld</code> , <code>@srv2.domain.tld</code> ); <br> -           ( <code>postmaster@domain.tld</code> ). <br> <br> , ,  ,         .  , , ... <br> <br>   DMARC <br>    DMARC ,      <code>quarantine</code>  <code>reject</code> ,             : <br> <code>pct</code> - percentage -  ,   , <b></b>   forensic report. ,   <code>"v=DMARC1; p=quarantine; pct=50;"</code>        .   <code>pct=100</code> . <br> <br> <code>aspf</code> - alignment mode for SPF -   SPF: <br> <code>r</code> - relaxed -       RFC5322.From  SPF-        (  ,  ). ,          ,   RFC5321.MailFrom, "some.sub.domain.tld",   RFC5322.From - "mbox@domain.tld"; <br> <code>s</code> - strict -   RFC5321.MailFrom  RFC5322.From   . <br> <br> <code>adkim</code> - alignment mode for DKIM -   DKIM,    : <br> <code>r</code> - relaxed -    :     <code>RFC5322.From</code>        <code><a href="https://publicsuffix.org/"></a> <code>d=    ,         -  : <br> <b class="spoiler_title">  / Organizational Domains</b>     RFC: <br> Organizational Domain: <br> The domain that was registered with a domain name registrar. In the absence of more accurate methods, heuristics are used to determine this, since it is not always the case that the registered domain name is simply a top-level DNS domain plus one component (eg, "example.com", where "com" is a top-level domain). The Organizational Domain is determined by applying the algorithm found in Section 3.2. <br> ... <br> The Organizational Domain is determined using the following algorithm: <br> <br> 1. Acquire a "public suffix" list, ie, a list of DNS domain names reserved for registrations. Some country Top-Level Domains (TLDs) make specific registration requirements, eg, the United Kingdom places company registrations under ".co.uk"; other TLDs such as ".com" appear in the IANA registry of top-level DNS domains. A public suffix list is the union of all of these. Appendix A.6.1 contains some discussion about obtaining a public suffix list. <br> 2. Break the subject DNS domain name into a set of "n" ordered labels. Number these labels from right to left; eg, for "example.com", "com" would be label 1 and "example" would be label 2. <br> 3. Search the public suffix list for the name that matches the largest number of labels found in the subject DNS domain. Let that number be "x". <br> 4. Construct a new DNS domain name using the name that matched from the public suffix list and prefixing to it the "x+1"th label from the subject domain. This new name is the Organizational Domain. <br> <br> Thus, since "com" is an IANA-registered TLD, a subject domain of "abcdexample.com" would have an Organizational Domain of "example.com". <br> <br> The process of determining a suffix is currently a heuristic one. No list is guaranteed to be accurate or current. <br> <br> 1.   " ",         publicsuffix.org <br> 2,     ,       .     - sub.domain.tld</code>   #3 - <code>sub</code> , #2 - <code>domain</code> , #1 - <code>tld</code> . <br> 3.       ,       ,    . <br> 4.     +1  -     . <br> <br> : <br>   info@a.sub.domain.tld <br> : <code>tld</code> - #1, <code>domain</code> - #2, <code>sub</code> - #3, <code>a</code> - #4 <br>       <code>tld</code> ,  =1 <br>        2  - <code>domain.tld</code> <br> <br> <code>s</code> - strict - FQDN   <code><code>d=    RFC5322.From</code>        . <br> <br> <code>ruf</code> - reporting URI for forensic reports -       .           (, Gmail     ). <br> <br> <code>fo</code> - failure report options -      forensic report: <br> <code>0</code> -    -         ; <br> <code>1</code> -          ; <br> <code>d</code> -       DKIM; <br> <code>s</code> -       SPF. <br> <br>    DMARC? <br>      : <br>       DMARC,   : <br> <code>_dmarc.domain.tld IN TXT "v=DMARC1; p=none; sp=none; rua=mailto:postmaster@domain.tld"</code> <br> <br>          -       .      <code>quarantine</code> ,    5% ( <code>pct=5</code> )     , ,      10-20-35-50-75-100%,        <code>reject</code> . <br> <br>   SPF/DKIM    <code>ruf=mailto:your-mbox@domain.tld</code>  <code><code>fo=1     . <br> <br>   ,      ,      -  ,     .</code></code></code></code></code> </div></div> <code><code>_dmarc.domain.tld IN TXT "v=DMARC1; p=;" <br> <br> p</code> - policy - ,  : <br> <code>none</code> -     ,    ; <br> <code>quarantine</code> -   ; <br> <code>reject</code> -   . <br> <br>                   .   ,            : <br> <br>  DMARC <br> <code>_dmarc.domain.tld IN TXT "v=DMARC1; p=none; sp=none; rua=mailto:postmaster@domain.tld"</code> <br> <br> <code>sp</code> - subdomain policy -        policy; <br> <br> <code>rua</code> - reporting URI for aggregate reports -      mailto:mbox@domain.tld          XML <br> <b class="spoiler_title"> </b>   Mail.ru  <a href="http://habrahabr.ru/company/mailru/blog/170957/">DMARC:     </a> <br> <code class="xml"> &lt;feedback&gt; &lt;report_metadata&gt; &lt;date_range&gt; &lt;begin&gt;1361304000&lt;/begin&gt; &lt;end&gt;1361390400&lt;/end&gt; &lt;/date_range&gt; &lt;email&gt;dmarc_support@corp.mail.ru&lt;/email&gt; &lt;extra_contact_info&gt;http://corp.mail.ru/en&lt;/extra_contact_info&gt; &lt;org_name&gt;Mail.Ru&lt;/org_name&gt; &lt;report_id&gt;1361304000874948&lt;/report_id&gt; &lt;/report_metadata&gt; &lt;policy_published&gt; &lt;adkim&gt;r&lt;/adkim&gt; &lt;aspf&gt;r&lt;/aspf&gt; &lt;domain&gt;adan.ru&lt;/domain&gt; &lt;p&gt;none&lt;/p&gt; &lt;pct&gt;100&lt;/pct&gt; &lt;sp&gt;none&lt;/sp&gt; &lt;/policy_published&gt; &lt;record&gt; &lt;auth_results&gt; &lt;dkim&gt; &lt;domain&gt;adan.ru&lt;/domain&gt; &lt;result&gt;pass&lt;/result&gt; &lt;/dkim&gt; &lt;spf&gt; &lt;domain&gt;adan.ru&lt;/domain&gt; &lt;result&gt;pass&lt;/result&gt; &lt;/spf&gt; &lt;/auth_results&gt; &lt;identifiers&gt; &lt;header_from&gt;adan.ru&lt;/header_from&gt; &lt;/identifiers&gt; &lt;row&gt; &lt;count&gt;20&lt;/count&gt; &lt;policy_evaluated&gt; &lt;disposition&gt;none&lt;/disposition&gt; &lt;dkim&gt;pass&lt;/dkim&gt; &lt;spf&gt;pass&lt;/spf&gt; &lt;/policy_evaluated&gt; &lt;source_ip&gt;176.9.9.172&lt;/source_ip&gt; &lt;/row&gt; &lt;/record&gt; &lt;/feedback&gt;</code> <br> <br>      <code>ri</code> - requested interval -    ,   ,   86400.          . <br> <br>  : <br> -          ; <br> -     ( <code>@domain.tld</code> )     ( <code>@srv1.domain.tld</code> , <code>@srv2.domain.tld</code> ); <br> -           ( <code>postmaster@domain.tld</code> ). <br> <br> , ,  ,         .  , , ... <br> <br>   DMARC <br>    DMARC ,      <code>quarantine</code>  <code>reject</code> ,             : <br> <code>pct</code> - percentage -  ,   , <b></b>   forensic report. ,   <code>"v=DMARC1; p=quarantine; pct=50;"</code>        .   <code>pct=100</code> . <br> <br> <code>aspf</code> - alignment mode for SPF -   SPF: <br> <code>r</code> - relaxed -       RFC5322.From  SPF-        (  ,  ). ,          ,   RFC5321.MailFrom, "some.sub.domain.tld",   RFC5322.From - "mbox@domain.tld"; <br> <code>s</code> - strict -   RFC5321.MailFrom  RFC5322.From   . <br> <br> <code>adkim</code> - alignment mode for DKIM -   DKIM,    : <br> <code>r</code> - relaxed -    :     <code>RFC5322.From</code>        <code><a href="https://publicsuffix.org/"></a> <code>d=    ,         -  : <br> <b class="spoiler_title">  / Organizational Domains</b>     RFC: <br> Organizational Domain: <br> The domain that was registered with a domain name registrar. In the absence of more accurate methods, heuristics are used to determine this, since it is not always the case that the registered domain name is simply a top-level DNS domain plus one component (eg, "example.com", where "com" is a top-level domain). The Organizational Domain is determined by applying the algorithm found in Section 3.2. <br> ... <br> The Organizational Domain is determined using the following algorithm: <br> <br> 1. Acquire a "public suffix" list, ie, a list of DNS domain names reserved for registrations. Some country Top-Level Domains (TLDs) make specific registration requirements, eg, the United Kingdom places company registrations under ".co.uk"; other TLDs such as ".com" appear in the IANA registry of top-level DNS domains. A public suffix list is the union of all of these. Appendix A.6.1 contains some discussion about obtaining a public suffix list. <br> 2. Break the subject DNS domain name into a set of "n" ordered labels. Number these labels from right to left; eg, for "example.com", "com" would be label 1 and "example" would be label 2. <br> 3. Search the public suffix list for the name that matches the largest number of labels found in the subject DNS domain. Let that number be "x". <br> 4. Construct a new DNS domain name using the name that matched from the public suffix list and prefixing to it the "x+1"th label from the subject domain. This new name is the Organizational Domain. <br> <br> Thus, since "com" is an IANA-registered TLD, a subject domain of "abcdexample.com" would have an Organizational Domain of "example.com". <br> <br> The process of determining a suffix is currently a heuristic one. No list is guaranteed to be accurate or current. <br> <br> 1.   " ",         publicsuffix.org <br> 2,     ,       .     - sub.domain.tld</code>   #3 - <code>sub</code> , #2 - <code>domain</code> , #1 - <code>tld</code> . <br> 3.       ,       ,    . <br> 4.     +1  -     . <br> <br> : <br>   info@a.sub.domain.tld <br> : <code>tld</code> - #1, <code>domain</code> - #2, <code>sub</code> - #3, <code>a</code> - #4 <br>       <code>tld</code> ,  =1 <br>        2  - <code>domain.tld</code> <br> <br> <code>s</code> - strict - FQDN   <code><code>d=    RFC5322.From</code>        . <br> <br> <code>ruf</code> - reporting URI for forensic reports -       .           (, Gmail     ). <br> <br> <code>fo</code> - failure report options -      forensic report: <br> <code>0</code> -    -         ; <br> <code>1</code> -          ; <br> <code>d</code> -       DKIM; <br> <code>s</code> -       SPF. <br> <br>    DMARC? <br>      : <br>       DMARC,   : <br> <code>_dmarc.domain.tld IN TXT "v=DMARC1; p=none; sp=none; rua=mailto:postmaster@domain.tld"</code> <br> <br>          -       .      <code>quarantine</code> ,    5% ( <code>pct=5</code> )     , ,      10-20-35-50-75-100%,        <code>reject</code> . <br> <br>   SPF/DKIM    <code>ruf=mailto:your-mbox@domain.tld</code>  <code><code>fo=1     . <br> <br>   ,      ,      -  ,     .</code></code></code></code></code> <h4> <code><code>_dmarc.domain.tld IN TXT "v=DMARC1; p=;" <br> <br> p</code> - policy - ,  : <br> <code>none</code> -     ,    ; <br> <code>quarantine</code> -   ; <br> <code>reject</code> -   . <br> <br>                   .   ,            : <br> <br>  DMARC <br> <code>_dmarc.domain.tld IN TXT "v=DMARC1; p=none; sp=none; rua=mailto:postmaster@domain.tld"</code> <br> <br> <code>sp</code> - subdomain policy -        policy; <br> <br> <code>rua</code> - reporting URI for aggregate reports -      mailto:mbox@domain.tld          XML <br> <b class="spoiler_title"> </b>   Mail.ru  <a href="http://habrahabr.ru/company/mailru/blog/170957/">DMARC:     </a> <br> <code class="xml"> &lt;feedback&gt; &lt;report_metadata&gt; &lt;date_range&gt; &lt;begin&gt;1361304000&lt;/begin&gt; &lt;end&gt;1361390400&lt;/end&gt; &lt;/date_range&gt; &lt;email&gt;dmarc_support@corp.mail.ru&lt;/email&gt; &lt;extra_contact_info&gt;http://corp.mail.ru/en&lt;/extra_contact_info&gt; &lt;org_name&gt;Mail.Ru&lt;/org_name&gt; &lt;report_id&gt;1361304000874948&lt;/report_id&gt; &lt;/report_metadata&gt; &lt;policy_published&gt; &lt;adkim&gt;r&lt;/adkim&gt; &lt;aspf&gt;r&lt;/aspf&gt; &lt;domain&gt;adan.ru&lt;/domain&gt; &lt;p&gt;none&lt;/p&gt; &lt;pct&gt;100&lt;/pct&gt; &lt;sp&gt;none&lt;/sp&gt; &lt;/policy_published&gt; &lt;record&gt; &lt;auth_results&gt; &lt;dkim&gt; &lt;domain&gt;adan.ru&lt;/domain&gt; &lt;result&gt;pass&lt;/result&gt; &lt;/dkim&gt; &lt;spf&gt; &lt;domain&gt;adan.ru&lt;/domain&gt; &lt;result&gt;pass&lt;/result&gt; &lt;/spf&gt; &lt;/auth_results&gt; &lt;identifiers&gt; &lt;header_from&gt;adan.ru&lt;/header_from&gt; &lt;/identifiers&gt; &lt;row&gt; &lt;count&gt;20&lt;/count&gt; &lt;policy_evaluated&gt; &lt;disposition&gt;none&lt;/disposition&gt; &lt;dkim&gt;pass&lt;/dkim&gt; &lt;spf&gt;pass&lt;/spf&gt; &lt;/policy_evaluated&gt; &lt;source_ip&gt;176.9.9.172&lt;/source_ip&gt; &lt;/row&gt; &lt;/record&gt; &lt;/feedback&gt;</code> <br> <br>      <code>ri</code> - requested interval -    ,   ,   86400.          . <br> <br>  : <br> -          ; <br> -     ( <code>@domain.tld</code> )     ( <code>@srv1.domain.tld</code> , <code>@srv2.domain.tld</code> ); <br> -           ( <code>postmaster@domain.tld</code> ). <br> <br> , ,  ,         .  , , ... <br> <br>   DMARC <br>    DMARC ,      <code>quarantine</code>  <code>reject</code> ,             : <br> <code>pct</code> - percentage -  ,   , <b></b>   forensic report. ,   <code>"v=DMARC1; p=quarantine; pct=50;"</code>        .   <code>pct=100</code> . <br> <br> <code>aspf</code> - alignment mode for SPF -   SPF: <br> <code>r</code> - relaxed -       RFC5322.From  SPF-        (  ,  ). ,          ,   RFC5321.MailFrom, "some.sub.domain.tld",   RFC5322.From - "mbox@domain.tld"; <br> <code>s</code> - strict -   RFC5321.MailFrom  RFC5322.From   . <br> <br> <code>adkim</code> - alignment mode for DKIM -   DKIM,    : <br> <code>r</code> - relaxed -    :     <code>RFC5322.From</code>        <code><a href="https://publicsuffix.org/"></a> <code>d=    ,         -  : <br> <b class="spoiler_title">  / Organizational Domains</b>     RFC: <br> Organizational Domain: <br> The domain that was registered with a domain name registrar. In the absence of more accurate methods, heuristics are used to determine this, since it is not always the case that the registered domain name is simply a top-level DNS domain plus one component (eg, "example.com", where "com" is a top-level domain). The Organizational Domain is determined by applying the algorithm found in Section 3.2. <br> ... <br> The Organizational Domain is determined using the following algorithm: <br> <br> 1. Acquire a "public suffix" list, ie, a list of DNS domain names reserved for registrations. Some country Top-Level Domains (TLDs) make specific registration requirements, eg, the United Kingdom places company registrations under ".co.uk"; other TLDs such as ".com" appear in the IANA registry of top-level DNS domains. A public suffix list is the union of all of these. Appendix A.6.1 contains some discussion about obtaining a public suffix list. <br> 2. Break the subject DNS domain name into a set of "n" ordered labels. Number these labels from right to left; eg, for "example.com", "com" would be label 1 and "example" would be label 2. <br> 3. Search the public suffix list for the name that matches the largest number of labels found in the subject DNS domain. Let that number be "x". <br> 4. Construct a new DNS domain name using the name that matched from the public suffix list and prefixing to it the "x+1"th label from the subject domain. This new name is the Organizational Domain. <br> <br> Thus, since "com" is an IANA-registered TLD, a subject domain of "abcdexample.com" would have an Organizational Domain of "example.com". <br> <br> The process of determining a suffix is currently a heuristic one. No list is guaranteed to be accurate or current. <br> <br> 1.   " ",         publicsuffix.org <br> 2,     ,       .     - sub.domain.tld</code>   #3 - <code>sub</code> , #2 - <code>domain</code> , #1 - <code>tld</code> . <br> 3.       ,       ,    . <br> 4.     +1  -     . <br> <br> : <br>   info@a.sub.domain.tld <br> : <code>tld</code> - #1, <code>domain</code> - #2, <code>sub</code> - #3, <code>a</code> - #4 <br>       <code>tld</code> ,  =1 <br>        2  - <code>domain.tld</code> <br> <br> <code>s</code> - strict - FQDN   <code><code>d=    RFC5322.From</code>        . <br> <br> <code>ruf</code> - reporting URI for forensic reports -       .           (, Gmail     ). <br> <br> <code>fo</code> - failure report options -      forensic report: <br> <code>0</code> -    -         ; <br> <code>1</code> -          ; <br> <code>d</code> -       DKIM; <br> <code>s</code> -       SPF. <br> <br>    DMARC? <br>      : <br>       DMARC,   : <br> <code>_dmarc.domain.tld IN TXT "v=DMARC1; p=none; sp=none; rua=mailto:postmaster@domain.tld"</code> <br> <br>          -       .      <code>quarantine</code> ,    5% ( <code>pct=5</code> )     , ,      10-20-35-50-75-100%,        <code>reject</code> . <br> <br>   SPF/DKIM    <code>ruf=mailto:your-mbox@domain.tld</code>  <code><code>fo=1     . <br> <br>   ,      ,      -  ,     .</code></code></code></code></code> </h4> <code><code>_dmarc.domain.tld IN TXT "v=DMARC1; p=;" <br> <br> p</code> - policy - ,  : <br> <code>none</code> -     ,    ; <br> <code>quarantine</code> -   ; <br> <code>reject</code> -   . <br> <br>                   .   ,            : <br> <br>  DMARC <br> <code>_dmarc.domain.tld IN TXT "v=DMARC1; p=none; sp=none; rua=mailto:postmaster@domain.tld"</code> <br> <br> <code>sp</code> - subdomain policy -        policy; <br> <br> <code>rua</code> - reporting URI for aggregate reports -      mailto:mbox@domain.tld          XML <br> <b class="spoiler_title"> </b>   Mail.ru  <a href="http://habrahabr.ru/company/mailru/blog/170957/">DMARC:     </a> <br> <code class="xml"> &lt;feedback&gt; &lt;report_metadata&gt; &lt;date_range&gt; &lt;begin&gt;1361304000&lt;/begin&gt; &lt;end&gt;1361390400&lt;/end&gt; &lt;/date_range&gt; &lt;email&gt;dmarc_support@corp.mail.ru&lt;/email&gt; &lt;extra_contact_info&gt;http://corp.mail.ru/en&lt;/extra_contact_info&gt; &lt;org_name&gt;Mail.Ru&lt;/org_name&gt; &lt;report_id&gt;1361304000874948&lt;/report_id&gt; &lt;/report_metadata&gt; &lt;policy_published&gt; &lt;adkim&gt;r&lt;/adkim&gt; &lt;aspf&gt;r&lt;/aspf&gt; &lt;domain&gt;adan.ru&lt;/domain&gt; &lt;p&gt;none&lt;/p&gt; &lt;pct&gt;100&lt;/pct&gt; &lt;sp&gt;none&lt;/sp&gt; &lt;/policy_published&gt; &lt;record&gt; &lt;auth_results&gt; &lt;dkim&gt; &lt;domain&gt;adan.ru&lt;/domain&gt; &lt;result&gt;pass&lt;/result&gt; &lt;/dkim&gt; &lt;spf&gt; &lt;domain&gt;adan.ru&lt;/domain&gt; &lt;result&gt;pass&lt;/result&gt; &lt;/spf&gt; &lt;/auth_results&gt; &lt;identifiers&gt; &lt;header_from&gt;adan.ru&lt;/header_from&gt; &lt;/identifiers&gt; &lt;row&gt; &lt;count&gt;20&lt;/count&gt; &lt;policy_evaluated&gt; &lt;disposition&gt;none&lt;/disposition&gt; &lt;dkim&gt;pass&lt;/dkim&gt; &lt;spf&gt;pass&lt;/spf&gt; &lt;/policy_evaluated&gt; &lt;source_ip&gt;176.9.9.172&lt;/source_ip&gt; &lt;/row&gt; &lt;/record&gt; &lt;/feedback&gt;</code> <br> <br>      <code>ri</code> - requested interval -    ,   ,   86400.          . <br> <br>  : <br> -          ; <br> -     ( <code>@domain.tld</code> )     ( <code>@srv1.domain.tld</code> , <code>@srv2.domain.tld</code> ); <br> -           ( <code>postmaster@domain.tld</code> ). <br> <br> , ,  ,         .  , , ... <br> <br>   DMARC <br>    DMARC ,      <code>quarantine</code>  <code>reject</code> ,             : <br> <code>pct</code> - percentage -  ,   , <b></b>   forensic report. ,   <code>"v=DMARC1; p=quarantine; pct=50;"</code>        .   <code>pct=100</code> . <br> <br> <code>aspf</code> - alignment mode for SPF -   SPF: <br> <code>r</code> - relaxed -       RFC5322.From  SPF-        (  ,  ). ,          ,   RFC5321.MailFrom, "some.sub.domain.tld",   RFC5322.From - "mbox@domain.tld"; <br> <code>s</code> - strict -   RFC5321.MailFrom  RFC5322.From   . <br> <br> <code>adkim</code> - alignment mode for DKIM -   DKIM,    : <br> <code>r</code> - relaxed -    :     <code>RFC5322.From</code>        <code><a href="https://publicsuffix.org/"></a> <code>d=    ,         -  : <br> <b class="spoiler_title">  / Organizational Domains</b>     RFC: <br> Organizational Domain: <br> The domain that was registered with a domain name registrar. In the absence of more accurate methods, heuristics are used to determine this, since it is not always the case that the registered domain name is simply a top-level DNS domain plus one component (eg, "example.com", where "com" is a top-level domain). The Organizational Domain is determined by applying the algorithm found in Section 3.2. <br> ... <br> The Organizational Domain is determined using the following algorithm: <br> <br> 1. Acquire a "public suffix" list, ie, a list of DNS domain names reserved for registrations. Some country Top-Level Domains (TLDs) make specific registration requirements, eg, the United Kingdom places company registrations under ".co.uk"; other TLDs such as ".com" appear in the IANA registry of top-level DNS domains. A public suffix list is the union of all of these. Appendix A.6.1 contains some discussion about obtaining a public suffix list. <br> 2. Break the subject DNS domain name into a set of "n" ordered labels. Number these labels from right to left; eg, for "example.com", "com" would be label 1 and "example" would be label 2. <br> 3. Search the public suffix list for the name that matches the largest number of labels found in the subject DNS domain. Let that number be "x". <br> 4. Construct a new DNS domain name using the name that matched from the public suffix list and prefixing to it the "x+1"th label from the subject domain. This new name is the Organizational Domain. <br> <br> Thus, since "com" is an IANA-registered TLD, a subject domain of "abcdexample.com" would have an Organizational Domain of "example.com". <br> <br> The process of determining a suffix is currently a heuristic one. No list is guaranteed to be accurate or current. <br> <br> 1.   " ",         publicsuffix.org <br> 2,     ,       .     - sub.domain.tld</code>   #3 - <code>sub</code> , #2 - <code>domain</code> , #1 - <code>tld</code> . <br> 3.       ,       ,    . <br> 4.     +1  -     . <br> <br> : <br>   info@a.sub.domain.tld <br> : <code>tld</code> - #1, <code>domain</code> - #2, <code>sub</code> - #3, <code>a</code> - #4 <br>       <code>tld</code> ,  =1 <br>        2  - <code>domain.tld</code> <br> <br> <code>s</code> - strict - FQDN   <code><code>d=    RFC5322.From</code>        . <br> <br> <code>ruf</code> - reporting URI for forensic reports -       .           (, Gmail     ). <br> <br> <code>fo</code> - failure report options -      forensic report: <br> <code>0</code> -    -         ; <br> <code>1</code> -          ; <br> <code>d</code> -       DKIM; <br> <code>s</code> -       SPF. <br> <br>    DMARC? <br>      : <br>       DMARC,   : <br> <code>_dmarc.domain.tld IN TXT "v=DMARC1; p=none; sp=none; rua=mailto:postmaster@domain.tld"</code> <br> <br>          -       .      <code>quarantine</code> ,    5% ( <code>pct=5</code> )     , ,      10-20-35-50-75-100%,        <code>reject</code> . <br> <br>   SPF/DKIM    <code>ruf=mailto:your-mbox@domain.tld</code>  <code><code>fo=1     . <br> <br>   ,      ,      -  ,     .</code></code></code></code></code> <div class="spoiler"> <code><code><code><b class="spoiler_title"><code>_dmarc.domain.tld IN TXT "v=DMARC1; p=;" <br> <br> p</code> - policy - ,  : <br> <code>none</code> -     ,    ; <br> <code>quarantine</code> -   ; <br> <code>reject</code> -   . <br> <br>                   .   ,            : <br> <br>  DMARC <br> <code>_dmarc.domain.tld IN TXT "v=DMARC1; p=none; sp=none; rua=mailto:postmaster@domain.tld"</code> <br> <br> <code>sp</code> - subdomain policy -        policy; <br> <br> <code>rua</code> - reporting URI for aggregate reports -      mailto:mbox@domain.tld          XML <br> <b class="spoiler_title"> </b>   Mail.ru  <a href="http://habrahabr.ru/company/mailru/blog/170957/">DMARC:     </a> <br> <code class="xml"> &lt;feedback&gt; &lt;report_metadata&gt; &lt;date_range&gt; &lt;begin&gt;1361304000&lt;/begin&gt; &lt;end&gt;1361390400&lt;/end&gt; &lt;/date_range&gt; &lt;email&gt;dmarc_support@corp.mail.ru&lt;/email&gt; &lt;extra_contact_info&gt;http://corp.mail.ru/en&lt;/extra_contact_info&gt; &lt;org_name&gt;Mail.Ru&lt;/org_name&gt; &lt;report_id&gt;1361304000874948&lt;/report_id&gt; &lt;/report_metadata&gt; &lt;policy_published&gt; &lt;adkim&gt;r&lt;/adkim&gt; &lt;aspf&gt;r&lt;/aspf&gt; &lt;domain&gt;adan.ru&lt;/domain&gt; &lt;p&gt;none&lt;/p&gt; &lt;pct&gt;100&lt;/pct&gt; &lt;sp&gt;none&lt;/sp&gt; &lt;/policy_published&gt; &lt;record&gt; &lt;auth_results&gt; &lt;dkim&gt; &lt;domain&gt;adan.ru&lt;/domain&gt; &lt;result&gt;pass&lt;/result&gt; &lt;/dkim&gt; &lt;spf&gt; &lt;domain&gt;adan.ru&lt;/domain&gt; &lt;result&gt;pass&lt;/result&gt; &lt;/spf&gt; &lt;/auth_results&gt; &lt;identifiers&gt; &lt;header_from&gt;adan.ru&lt;/header_from&gt; &lt;/identifiers&gt; &lt;row&gt; &lt;count&gt;20&lt;/count&gt; &lt;policy_evaluated&gt; &lt;disposition&gt;none&lt;/disposition&gt; &lt;dkim&gt;pass&lt;/dkim&gt; &lt;spf&gt;pass&lt;/spf&gt; &lt;/policy_evaluated&gt; &lt;source_ip&gt;176.9.9.172&lt;/source_ip&gt; &lt;/row&gt; &lt;/record&gt; &lt;/feedback&gt;</code> <br> <br>      <code>ri</code> - requested interval -    ,   ,   86400.          . <br> <br>  : <br> -          ; <br> -     ( <code>@domain.tld</code> )     ( <code>@srv1.domain.tld</code> , <code>@srv2.domain.tld</code> ); <br> -           ( <code>postmaster@domain.tld</code> ). <br> <br> , ,  ,         .  , , ... <br> <br>   DMARC <br>    DMARC ,      <code>quarantine</code>  <code>reject</code> ,             : <br> <code>pct</code> - percentage -  ,   , <b></b>   forensic report. ,   <code>"v=DMARC1; p=quarantine; pct=50;"</code>        .   <code>pct=100</code> . <br> <br> <code>aspf</code> - alignment mode for SPF -   SPF: <br> <code>r</code> - relaxed -       RFC5322.From  SPF-        (  ,  ). ,          ,   RFC5321.MailFrom, "some.sub.domain.tld",   RFC5322.From - "mbox@domain.tld"; <br> <code>s</code> - strict -   RFC5321.MailFrom  RFC5322.From   . <br> <br> <code>adkim</code> - alignment mode for DKIM -   DKIM,    : <br> <code>r</code> - relaxed -    :     <code>RFC5322.From</code>        <a href="https://publicsuffix.org/"></a> d=    ,         -  : <br>   / Organizational Domains     RFC: <br> Organizational Domain: <br> The domain that was registered with a domain name registrar. In the absence of more accurate methods, heuristics are used to determine this, since it is not always the case that the registered domain name is simply a top-level DNS domain plus one component (eg, "example.com", where "com" is a top-level domain). The Organizational Domain is determined by applying the algorithm found in Section 3.2. <br> ... <br> The Organizational Domain is determined using the following algorithm: <br> <br> 1. Acquire a "public suffix" list, ie, a list of DNS domain names reserved for registrations. Some country Top-Level Domains (TLDs) make specific registration requirements, eg, the United Kingdom places company registrations under ".co.uk"; other TLDs such as ".com" appear in the IANA registry of top-level DNS domains. A public suffix list is the union of all of these. Appendix A.6.1 contains some discussion about obtaining a public suffix list. <br> 2. Break the subject DNS domain name into a set of "n" ordered labels. Number these labels from right to left; eg, for "example.com", "com" would be label 1 and "example" would be label 2. <br> 3. Search the public suffix list for the name that matches the largest number of labels found in the subject DNS domain. Let that number be "x". <br> 4. Construct a new DNS domain name using the name that matched from the public suffix list and prefixing to it the "x+1"th label from the subject domain. This new name is the Organizational Domain. <br> <br> Thus, since "com" is an IANA-registered TLD, a subject domain of "abcdexample.com" would have an Organizational Domain of "example.com". <br> <br> The process of determining a suffix is currently a heuristic one. No list is guaranteed to be accurate or current. <br> <br> 1.   " ",         publicsuffix.org <br> 2,     ,       .     - sub.domain.tld   #3 - <code>sub</code> , #2 - <code>domain</code> , #1 - <code>tld</code> . <br> 3.       ,       ,    . <br> 4.     +1  -     . <br> <br> : <br>   info@a.sub.domain.tld <br> : <code>tld</code> - #1, <code>domain</code> - #2, <code>sub</code> - #3, <code>a</code> - #4 <br>       <code>tld</code> ,  =1 <br>        2  - <code>domain.tld</code> <br> <br> <code>s</code> - strict - FQDN   <code><code>d=    RFC5322.From</code>        . <br> <br> <code>ruf</code> - reporting URI for forensic reports -       .           (, Gmail     ). <br> <br> <code>fo</code> - failure report options -      forensic report: <br> <code>0</code> -    -         ; <br> <code>1</code> -          ; <br> <code>d</code> -       DKIM; <br> <code>s</code> -       SPF. <br> <br>    DMARC? <br>      : <br>       DMARC,   : <br> <code>_dmarc.domain.tld IN TXT "v=DMARC1; p=none; sp=none; rua=mailto:postmaster@domain.tld"</code> <br> <br>          -       .      <code>quarantine</code> ,    5% ( <code>pct=5</code> )     , ,      10-20-35-50-75-100%,        <code>reject</code> . <br> <br>   SPF/DKIM    <code>ruf=mailto:your-mbox@domain.tld</code>  <code><code>fo=1     . <br> <br>   ,      ,      -  ,     .</code></code></code></b></code></code></code> <div class="spoiler_text"> <code><code><code><code>_dmarc.domain.tld IN TXT "v=DMARC1; p=;" <br> <br> p</code> - policy - ,  : <br> <code>none</code> -     ,    ; <br> <code>quarantine</code> -   ; <br> <code>reject</code> -   . <br> <br>                   .   ,            : <br> <br>  DMARC <br> <code>_dmarc.domain.tld IN TXT "v=DMARC1; p=none; sp=none; rua=mailto:postmaster@domain.tld"</code> <br> <br> <code>sp</code> - subdomain policy -        policy; <br> <br> <code>rua</code> - reporting URI for aggregate reports -      mailto:mbox@domain.tld          XML <br> <b class="spoiler_title"> </b>   Mail.ru  <a href="http://habrahabr.ru/company/mailru/blog/170957/">DMARC:     </a> <br> <code class="xml"> &lt;feedback&gt; &lt;report_metadata&gt; &lt;date_range&gt; &lt;begin&gt;1361304000&lt;/begin&gt; &lt;end&gt;1361390400&lt;/end&gt; &lt;/date_range&gt; &lt;email&gt;dmarc_support@corp.mail.ru&lt;/email&gt; &lt;extra_contact_info&gt;http://corp.mail.ru/en&lt;/extra_contact_info&gt; &lt;org_name&gt;Mail.Ru&lt;/org_name&gt; &lt;report_id&gt;1361304000874948&lt;/report_id&gt; &lt;/report_metadata&gt; &lt;policy_published&gt; &lt;adkim&gt;r&lt;/adkim&gt; &lt;aspf&gt;r&lt;/aspf&gt; &lt;domain&gt;adan.ru&lt;/domain&gt; &lt;p&gt;none&lt;/p&gt; &lt;pct&gt;100&lt;/pct&gt; &lt;sp&gt;none&lt;/sp&gt; &lt;/policy_published&gt; &lt;record&gt; &lt;auth_results&gt; &lt;dkim&gt; &lt;domain&gt;adan.ru&lt;/domain&gt; &lt;result&gt;pass&lt;/result&gt; &lt;/dkim&gt; &lt;spf&gt; &lt;domain&gt;adan.ru&lt;/domain&gt; &lt;result&gt;pass&lt;/result&gt; &lt;/spf&gt; &lt;/auth_results&gt; &lt;identifiers&gt; &lt;header_from&gt;adan.ru&lt;/header_from&gt; &lt;/identifiers&gt; &lt;row&gt; &lt;count&gt;20&lt;/count&gt; &lt;policy_evaluated&gt; &lt;disposition&gt;none&lt;/disposition&gt; &lt;dkim&gt;pass&lt;/dkim&gt; &lt;spf&gt;pass&lt;/spf&gt; &lt;/policy_evaluated&gt; &lt;source_ip&gt;176.9.9.172&lt;/source_ip&gt; &lt;/row&gt; &lt;/record&gt; &lt;/feedback&gt;</code> <br> <br>      <code>ri</code> - requested interval -    ,   ,   86400.          . <br> <br>  : <br> -          ; <br> -     ( <code>@domain.tld</code> )     ( <code>@srv1.domain.tld</code> , <code>@srv2.domain.tld</code> ); <br> -           ( <code>postmaster@domain.tld</code> ). <br> <br> , ,  ,         .  , , ... <br> <br>   DMARC <br>    DMARC ,      <code>quarantine</code>  <code>reject</code> ,             : <br> <code>pct</code> - percentage -  ,   , <b></b>   forensic report. ,   <code>"v=DMARC1; p=quarantine; pct=50;"</code>        .   <code>pct=100</code> . <br> <br> <code>aspf</code> - alignment mode for SPF -   SPF: <br> <code>r</code> - relaxed -       RFC5322.From  SPF-        (  ,  ). ,          ,   RFC5321.MailFrom, "some.sub.domain.tld",   RFC5322.From - "mbox@domain.tld"; <br> <code>s</code> - strict -   RFC5321.MailFrom  RFC5322.From   . <br> <br> <code>adkim</code> - alignment mode for DKIM -   DKIM,    : <br> <code>r</code> - relaxed -    :     <code>RFC5322.From</code>        <a href="https://publicsuffix.org/"></a> d=    ,         -  : <br> <b class="spoiler_title">  / Organizational Domains</b>     RFC: <br> Organizational Domain: <br> The domain that was registered with a domain name registrar. In the absence of more accurate methods, heuristics are used to determine this, since it is not always the case that the registered domain name is simply a top-level DNS domain plus one component (eg, "example.com", where "com" is a top-level domain). The Organizational Domain is determined by applying the algorithm found in Section 3.2. <br> ... <br> The Organizational Domain is determined using the following algorithm: <br> <br> 1. Acquire a "public suffix" list, ie, a list of DNS domain names reserved for registrations. Some country Top-Level Domains (TLDs) make specific registration requirements, eg, the United Kingdom places company registrations under ".co.uk"; other TLDs such as ".com" appear in the IANA registry of top-level DNS domains. A public suffix list is the union of all of these. Appendix A.6.1 contains some discussion about obtaining a public suffix list. <br> 2. Break the subject DNS domain name into a set of "n" ordered labels. Number these labels from right to left; eg, for "example.com", "com" would be label 1 and "example" would be label 2. <br> 3. Search the public suffix list for the name that matches the largest number of labels found in the subject DNS domain. Let that number be "x". <br> 4. Construct a new DNS domain name using the name that matched from the public suffix list and prefixing to it the "x+1"th label from the subject domain. This new name is the Organizational Domain. <br> <br> Thus, since "com" is an IANA-registered TLD, a subject domain of "abcdexample.com" would have an Organizational Domain of "example.com". <br> <br> The process of determining a suffix is currently a heuristic one. No list is guaranteed to be accurate or current. <br> <br> 1.   " ",         publicsuffix.org <br> 2,     ,       .     - sub.domain.tld   #3 - <code>sub</code> , #2 - <code>domain</code> , #1 - <code>tld</code> . <br> 3.       ,       ,    . <br> 4.     +1  -     . <br> <br> : <br>   info@a.sub.domain.tld <br> : <code>tld</code> - #1, <code>domain</code> - #2, <code>sub</code> - #3, <code>a</code> - #4 <br>       <code>tld</code> ,  =1 <br>        2  - <code>domain.tld</code> <br> <br> <code>s</code> - strict - FQDN   <code><code>d=    RFC5322.From</code>        . <br> <br> <code>ruf</code> - reporting URI for forensic reports -       .           (, Gmail     ). <br> <br> <code>fo</code> - failure report options -      forensic report: <br> <code>0</code> -    -         ; <br> <code>1</code> -          ; <br> <code>d</code> -       DKIM; <br> <code>s</code> -       SPF. <br> <br>    DMARC? <br>      : <br>       DMARC,   : <br> <code>_dmarc.domain.tld IN TXT "v=DMARC1; p=none; sp=none; rua=mailto:postmaster@domain.tld"</code> <br> <br>          -       .      <code>quarantine</code> ,    5% ( <code>pct=5</code> )     , ,      10-20-35-50-75-100%,        <code>reject</code> . <br> <br>   SPF/DKIM    <code>ruf=mailto:your-mbox@domain.tld</code>  <code><code>fo=1     . <br> <br>   ,      ,      -  ,     .</code></code></code></code></code></code> <blockquote> <code><code><code><code>_dmarc.domain.tld IN TXT "v=DMARC1; p=;" <br> <br> p</code> - policy - ,  : <br> <code>none</code> -     ,    ; <br> <code>quarantine</code> -   ; <br> <code>reject</code> -   . <br> <br>                   .   ,            : <br> <br>  DMARC <br> <code>_dmarc.domain.tld IN TXT "v=DMARC1; p=none; sp=none; rua=mailto:postmaster@domain.tld"</code> <br> <br> <code>sp</code> - subdomain policy -        policy; <br> <br> <code>rua</code> - reporting URI for aggregate reports -      mailto:mbox@domain.tld          XML <br> <b class="spoiler_title"> </b>   Mail.ru  <a href="http://habrahabr.ru/company/mailru/blog/170957/">DMARC:     </a> <br> <code class="xml"> &lt;feedback&gt; &lt;report_metadata&gt; &lt;date_range&gt; &lt;begin&gt;1361304000&lt;/begin&gt; &lt;end&gt;1361390400&lt;/end&gt; &lt;/date_range&gt; &lt;email&gt;dmarc_support@corp.mail.ru&lt;/email&gt; &lt;extra_contact_info&gt;http://corp.mail.ru/en&lt;/extra_contact_info&gt; &lt;org_name&gt;Mail.Ru&lt;/org_name&gt; &lt;report_id&gt;1361304000874948&lt;/report_id&gt; &lt;/report_metadata&gt; &lt;policy_published&gt; &lt;adkim&gt;r&lt;/adkim&gt; &lt;aspf&gt;r&lt;/aspf&gt; &lt;domain&gt;adan.ru&lt;/domain&gt; &lt;p&gt;none&lt;/p&gt; &lt;pct&gt;100&lt;/pct&gt; &lt;sp&gt;none&lt;/sp&gt; &lt;/policy_published&gt; &lt;record&gt; &lt;auth_results&gt; &lt;dkim&gt; &lt;domain&gt;adan.ru&lt;/domain&gt; &lt;result&gt;pass&lt;/result&gt; &lt;/dkim&gt; &lt;spf&gt; &lt;domain&gt;adan.ru&lt;/domain&gt; &lt;result&gt;pass&lt;/result&gt; &lt;/spf&gt; &lt;/auth_results&gt; &lt;identifiers&gt; &lt;header_from&gt;adan.ru&lt;/header_from&gt; &lt;/identifiers&gt; &lt;row&gt; &lt;count&gt;20&lt;/count&gt; &lt;policy_evaluated&gt; &lt;disposition&gt;none&lt;/disposition&gt; &lt;dkim&gt;pass&lt;/dkim&gt; &lt;spf&gt;pass&lt;/spf&gt; &lt;/policy_evaluated&gt; &lt;source_ip&gt;176.9.9.172&lt;/source_ip&gt; &lt;/row&gt; &lt;/record&gt; &lt;/feedback&gt;</code> <br> <br>      <code>ri</code> - requested interval -    ,   ,   86400.          . <br> <br>  : <br> -          ; <br> -     ( <code>@domain.tld</code> )     ( <code>@srv1.domain.tld</code> , <code>@srv2.domain.tld</code> ); <br> -           ( <code>postmaster@domain.tld</code> ). <br> <br> , ,  ,         .  , , ... <br> <br>   DMARC <br>    DMARC ,      <code>quarantine</code>  <code>reject</code> ,             : <br> <code>pct</code> - percentage -  ,   , <b></b>   forensic report. ,   <code>"v=DMARC1; p=quarantine; pct=50;"</code>        .   <code>pct=100</code> . <br> <br> <code>aspf</code> - alignment mode for SPF -   SPF: <br> <code>r</code> - relaxed -       RFC5322.From  SPF-        (  ,  ). ,          ,   RFC5321.MailFrom, "some.sub.domain.tld",   RFC5322.From - "mbox@domain.tld"; <br> <code>s</code> - strict -   RFC5321.MailFrom  RFC5322.From   . <br> <br> <code>adkim</code> - alignment mode for DKIM -   DKIM,    : <br> <code>r</code> - relaxed -    :     <code>RFC5322.From</code>        <a href="https://publicsuffix.org/"></a> d=    ,         -  : <br> <b class="spoiler_title">  / Organizational Domains</b>     RFC: <br> Organizational Domain: <br> The domain that was registered with a domain name registrar. In the absence of more accurate methods, heuristics are used to determine this, since it is not always the case that the registered domain name is simply a top-level DNS domain plus one component (eg, "example.com", where "com" is a top-level domain). The Organizational Domain is determined by applying the algorithm found in Section 3.2. <br> ... <br> The Organizational Domain is determined using the following algorithm: <br> <br> 1. Acquire a "public suffix" list, ie, a list of DNS domain names reserved for registrations. Some country Top-Level Domains (TLDs) make specific registration requirements, eg, the United Kingdom places company registrations under ".co.uk"; other TLDs such as ".com" appear in the IANA registry of top-level DNS domains. A public suffix list is the union of all of these. Appendix A.6.1 contains some discussion about obtaining a public suffix list. <br> 2. Break the subject DNS domain name into a set of "n" ordered labels. Number these labels from right to left; eg, for "example.com", "com" would be label 1 and "example" would be label 2. <br> 3. Search the public suffix list for the name that matches the largest number of labels found in the subject DNS domain. Let that number be "x". <br> 4. Construct a new DNS domain name using the name that matched from the public suffix list and prefixing to it the "x+1"th label from the subject domain. This new name is the Organizational Domain. <br> <br> Thus, since "com" is an IANA-registered TLD, a subject domain of "abcdexample.com" would have an Organizational Domain of "example.com". <br> <br> The process of determining a suffix is currently a heuristic one. No list is guaranteed to be accurate or current. <br> <br> 1.   " ",         publicsuffix.org <br> 2,     ,       .     - sub.domain.tld   #3 - <code>sub</code> , #2 - <code>domain</code> , #1 - <code>tld</code> . <br> 3.       ,       ,    . <br> 4.     +1  -     . <br> <br> : <br>   info@a.sub.domain.tld <br> : <code>tld</code> - #1, <code>domain</code> - #2, <code>sub</code> - #3, <code>a</code> - #4 <br>       <code>tld</code> ,  =1 <br>        2  - <code>domain.tld</code> <br> <br> <code>s</code> - strict - FQDN   <code><code>d=    RFC5322.From</code>        . <br> <br> <code>ruf</code> - reporting URI for forensic reports -       .           (, Gmail     ). <br> <br> <code>fo</code> - failure report options -      forensic report: <br> <code>0</code> -    -         ; <br> <code>1</code> -          ; <br> <code>d</code> -       DKIM; <br> <code>s</code> -       SPF. <br> <br>    DMARC? <br>      : <br>       DMARC,   : <br> <code>_dmarc.domain.tld IN TXT "v=DMARC1; p=none; sp=none; rua=mailto:postmaster@domain.tld"</code> <br> <br>          -       .      <code>quarantine</code> ,    5% ( <code>pct=5</code> )     , ,      10-20-35-50-75-100%,        <code>reject</code> . <br> <br>   SPF/DKIM    <code>ruf=mailto:your-mbox@domain.tld</code>  <code><code>fo=1     . <br> <br>   ,      ,      -  ,     .</code></code></code></code></code></code> </blockquote> <code><code><code>_dmarc.domain.tld IN TXT "v=DMARC1; p=;" <br> <br> p</code> - policy - ,  : <br> <code>none</code> -     ,    ; <br> <code>quarantine</code> -   ; <br> <code>reject</code> -   . <br> <br>                   .   ,            : <br> <br>  DMARC <br> <code>_dmarc.domain.tld IN TXT "v=DMARC1; p=none; sp=none; rua=mailto:postmaster@domain.tld"</code> <br> <br> <code>sp</code> - subdomain policy -        policy; <br> <br> <code>rua</code> - reporting URI for aggregate reports -      mailto:mbox@domain.tld          XML <br> <b class="spoiler_title"> </b>   Mail.ru  <a href="http://habrahabr.ru/company/mailru/blog/170957/">DMARC:     </a> <br> <code class="xml"> &lt;feedback&gt; &lt;report_metadata&gt; &lt;date_range&gt; &lt;begin&gt;1361304000&lt;/begin&gt; &lt;end&gt;1361390400&lt;/end&gt; &lt;/date_range&gt; &lt;email&gt;dmarc_support@corp.mail.ru&lt;/email&gt; &lt;extra_contact_info&gt;http://corp.mail.ru/en&lt;/extra_contact_info&gt; &lt;org_name&gt;Mail.Ru&lt;/org_name&gt; &lt;report_id&gt;1361304000874948&lt;/report_id&gt; &lt;/report_metadata&gt; &lt;policy_published&gt; &lt;adkim&gt;r&lt;/adkim&gt; &lt;aspf&gt;r&lt;/aspf&gt; &lt;domain&gt;adan.ru&lt;/domain&gt; &lt;p&gt;none&lt;/p&gt; &lt;pct&gt;100&lt;/pct&gt; &lt;sp&gt;none&lt;/sp&gt; &lt;/policy_published&gt; &lt;record&gt; &lt;auth_results&gt; &lt;dkim&gt; &lt;domain&gt;adan.ru&lt;/domain&gt; &lt;result&gt;pass&lt;/result&gt; &lt;/dkim&gt; &lt;spf&gt; &lt;domain&gt;adan.ru&lt;/domain&gt; &lt;result&gt;pass&lt;/result&gt; &lt;/spf&gt; &lt;/auth_results&gt; &lt;identifiers&gt; &lt;header_from&gt;adan.ru&lt;/header_from&gt; &lt;/identifiers&gt; &lt;row&gt; &lt;count&gt;20&lt;/count&gt; &lt;policy_evaluated&gt; &lt;disposition&gt;none&lt;/disposition&gt; &lt;dkim&gt;pass&lt;/dkim&gt; &lt;spf&gt;pass&lt;/spf&gt; &lt;/policy_evaluated&gt; &lt;source_ip&gt;176.9.9.172&lt;/source_ip&gt; &lt;/row&gt; &lt;/record&gt; &lt;/feedback&gt;</code> <br> <br>      <code>ri</code> - requested interval -    ,   ,   86400.          . <br> <br>  : <br> -          ; <br> -     ( <code>@domain.tld</code> )     ( <code>@srv1.domain.tld</code> , <code>@srv2.domain.tld</code> ); <br> -           ( <code>postmaster@domain.tld</code> ). <br> <br> , ,  ,         .  , , ... <br> <br>   DMARC <br>    DMARC ,      <code>quarantine</code>  <code>reject</code> ,             : <br> <code>pct</code> - percentage -  ,   , <b></b>   forensic report. ,   <code>"v=DMARC1; p=quarantine; pct=50;"</code>        .   <code>pct=100</code> . <br> <br> <code>aspf</code> - alignment mode for SPF -   SPF: <br> <code>r</code> - relaxed -       RFC5322.From  SPF-        (  ,  ). ,          ,   RFC5321.MailFrom, "some.sub.domain.tld",   RFC5322.From - "mbox@domain.tld"; <br> <code>s</code> - strict -   RFC5321.MailFrom  RFC5322.From   . <br> <br> <code>adkim</code> - alignment mode for DKIM -   DKIM,    : <br> <code>r</code> - relaxed -    :     <code>RFC5322.From</code>        <a href="https://publicsuffix.org/"></a> <code>d=    ,         -  : <br> <b class="spoiler_title">  / Organizational Domains</b>     RFC: <br> Organizational Domain: <br> The domain that was registered with a domain name registrar. In the absence of more accurate methods, heuristics are used to determine this, since it is not always the case that the registered domain name is simply a top-level DNS domain plus one component (eg, "example.com", where "com" is a top-level domain). The Organizational Domain is determined by applying the algorithm found in Section 3.2. <br> ... <br> The Organizational Domain is determined using the following algorithm: <br> <br> 1. Acquire a "public suffix" list, ie, a list of DNS domain names reserved for registrations. Some country Top-Level Domains (TLDs) make specific registration requirements, eg, the United Kingdom places company registrations under ".co.uk"; other TLDs such as ".com" appear in the IANA registry of top-level DNS domains. A public suffix list is the union of all of these. Appendix A.6.1 contains some discussion about obtaining a public suffix list. <br> 2. Break the subject DNS domain name into a set of "n" ordered labels. Number these labels from right to left; eg, for "example.com", "com" would be label 1 and "example" would be label 2. <br> 3. Search the public suffix list for the name that matches the largest number of labels found in the subject DNS domain. Let that number be "x". <br> 4. Construct a new DNS domain name using the name that matched from the public suffix list and prefixing to it the "x+1"th label from the subject domain. This new name is the Organizational Domain. <br> <br> Thus, since "com" is an IANA-registered TLD, a subject domain of "abcdexample.com" would have an Organizational Domain of "example.com". <br> <br> The process of determining a suffix is currently a heuristic one. No list is guaranteed to be accurate or current. <br> <br> 1.   " ",         publicsuffix.org <br> 2,     ,       .     - sub.domain.tld</code>   #3 - <code>sub</code> , #2 - <code>domain</code> , #1 - <code>tld</code> . <br> 3.       ,       ,    . <br> 4.     +1  -     . <br> <br> : <br>   info@a.sub.domain.tld <br> : <code>tld</code> - #1, <code>domain</code> - #2, <code>sub</code> - #3, <code>a</code> - #4 <br>       <code>tld</code> ,  =1 <br>        2  - <code>domain.tld</code> <br> <br> <code>s</code> - strict - FQDN   <code><code>d=    RFC5322.From</code>        . <br> <br> <code>ruf</code> - reporting URI for forensic reports -       .           (, Gmail     ). <br> <br> <code>fo</code> - failure report options -      forensic report: <br> <code>0</code> -    -         ; <br> <code>1</code> -          ; <br> <code>d</code> -       DKIM; <br> <code>s</code> -       SPF. <br> <br>    DMARC? <br>      : <br>       DMARC,   : <br> <code>_dmarc.domain.tld IN TXT "v=DMARC1; p=none; sp=none; rua=mailto:postmaster@domain.tld"</code> <br> <br>          -       .      <code>quarantine</code> ,    5% ( <code>pct=5</code> )     , ,      10-20-35-50-75-100%,        <code>reject</code> . <br> <br>   SPF/DKIM    <code>ruf=mailto:your-mbox@domain.tld</code>  <code><code>fo=1     . <br> <br>   ,      ,      -  ,     .</code></code></code></code></code> </div></div> <code><code><code>_dmarc.domain.tld IN TXT "v=DMARC1; p=;" <br> <br> p</code> - policy - ,  : <br> <code>none</code> -     ,    ; <br> <code>quarantine</code> -   ; <br> <code>reject</code> -   . <br> <br>                   .   ,            : <br> <br>  DMARC <br> <code>_dmarc.domain.tld IN TXT "v=DMARC1; p=none; sp=none; rua=mailto:postmaster@domain.tld"</code> <br> <br> <code>sp</code> - subdomain policy -        policy; <br> <br> <code>rua</code> - reporting URI for aggregate reports -      mailto:mbox@domain.tld          XML <br> <b class="spoiler_title"> </b>   Mail.ru  <a href="http://habrahabr.ru/company/mailru/blog/170957/">DMARC:     </a> <br> <code class="xml"> &lt;feedback&gt; &lt;report_metadata&gt; &lt;date_range&gt; &lt;begin&gt;1361304000&lt;/begin&gt; &lt;end&gt;1361390400&lt;/end&gt; &lt;/date_range&gt; &lt;email&gt;dmarc_support@corp.mail.ru&lt;/email&gt; &lt;extra_contact_info&gt;http://corp.mail.ru/en&lt;/extra_contact_info&gt; &lt;org_name&gt;Mail.Ru&lt;/org_name&gt; &lt;report_id&gt;1361304000874948&lt;/report_id&gt; &lt;/report_metadata&gt; &lt;policy_published&gt; &lt;adkim&gt;r&lt;/adkim&gt; &lt;aspf&gt;r&lt;/aspf&gt; &lt;domain&gt;adan.ru&lt;/domain&gt; &lt;p&gt;none&lt;/p&gt; &lt;pct&gt;100&lt;/pct&gt; &lt;sp&gt;none&lt;/sp&gt; &lt;/policy_published&gt; &lt;record&gt; &lt;auth_results&gt; &lt;dkim&gt; &lt;domain&gt;adan.ru&lt;/domain&gt; &lt;result&gt;pass&lt;/result&gt; &lt;/dkim&gt; &lt;spf&gt; &lt;domain&gt;adan.ru&lt;/domain&gt; &lt;result&gt;pass&lt;/result&gt; &lt;/spf&gt; &lt;/auth_results&gt; &lt;identifiers&gt; &lt;header_from&gt;adan.ru&lt;/header_from&gt; &lt;/identifiers&gt; &lt;row&gt; &lt;count&gt;20&lt;/count&gt; &lt;policy_evaluated&gt; &lt;disposition&gt;none&lt;/disposition&gt; &lt;dkim&gt;pass&lt;/dkim&gt; &lt;spf&gt;pass&lt;/spf&gt; &lt;/policy_evaluated&gt; &lt;source_ip&gt;176.9.9.172&lt;/source_ip&gt; &lt;/row&gt; &lt;/record&gt; &lt;/feedback&gt;</code> <br> <br>      <code>ri</code> - requested interval -    ,   ,   86400.          . <br> <br>  : <br> -          ; <br> -     ( <code>@domain.tld</code> )     ( <code>@srv1.domain.tld</code> , <code>@srv2.domain.tld</code> ); <br> -           ( <code>postmaster@domain.tld</code> ). <br> <br> , ,  ,         .  , , ... <br> <br>   DMARC <br>    DMARC ,      <code>quarantine</code>  <code>reject</code> ,             : <br> <code>pct</code> - percentage -  ,   , <b></b>   forensic report. ,   <code>"v=DMARC1; p=quarantine; pct=50;"</code>        .   <code>pct=100</code> . <br> <br> <code>aspf</code> - alignment mode for SPF -   SPF: <br> <code>r</code> - relaxed -       RFC5322.From  SPF-        (  ,  ). ,          ,   RFC5321.MailFrom, "some.sub.domain.tld",   RFC5322.From - "mbox@domain.tld"; <br> <code>s</code> - strict -   RFC5321.MailFrom  RFC5322.From   . <br> <br> <code>adkim</code> - alignment mode for DKIM -   DKIM,    : <br> <code>r</code> - relaxed -    :     <code>RFC5322.From</code>        <a href="https://publicsuffix.org/"></a> <code>d=    ,         -  : <br> <b class="spoiler_title">  / Organizational Domains</b>     RFC: <br> Organizational Domain: <br> The domain that was registered with a domain name registrar. In the absence of more accurate methods, heuristics are used to determine this, since it is not always the case that the registered domain name is simply a top-level DNS domain plus one component (eg, "example.com", where "com" is a top-level domain). The Organizational Domain is determined by applying the algorithm found in Section 3.2. <br> ... <br> The Organizational Domain is determined using the following algorithm: <br> <br> 1. Acquire a "public suffix" list, ie, a list of DNS domain names reserved for registrations. Some country Top-Level Domains (TLDs) make specific registration requirements, eg, the United Kingdom places company registrations under ".co.uk"; other TLDs such as ".com" appear in the IANA registry of top-level DNS domains. A public suffix list is the union of all of these. Appendix A.6.1 contains some discussion about obtaining a public suffix list. <br> 2. Break the subject DNS domain name into a set of "n" ordered labels. Number these labels from right to left; eg, for "example.com", "com" would be label 1 and "example" would be label 2. <br> 3. Search the public suffix list for the name that matches the largest number of labels found in the subject DNS domain. Let that number be "x". <br> 4. Construct a new DNS domain name using the name that matched from the public suffix list and prefixing to it the "x+1"th label from the subject domain. This new name is the Organizational Domain. <br> <br> Thus, since "com" is an IANA-registered TLD, a subject domain of "abcdexample.com" would have an Organizational Domain of "example.com". <br> <br> The process of determining a suffix is currently a heuristic one. No list is guaranteed to be accurate or current. <br> <br> 1.   " ",         publicsuffix.org <br> 2,     ,       .     - sub.domain.tld</code>   #3 - <code>sub</code> , #2 - <code>domain</code> , #1 - <code>tld</code> . <br> 3.       ,       ,    . <br> 4.     +1  -     . <br> <br> : <br>   info@a.sub.domain.tld <br> : <code>tld</code> - #1, <code>domain</code> - #2, <code>sub</code> - #3, <code>a</code> - #4 <br>       <code>tld</code> ,  =1 <br>        2  - <code>domain.tld</code> <br> <br> <code>s</code> - strict - FQDN   <code><code>d=    RFC5322.From</code>        . <br> <br> <code>ruf</code> - reporting URI for forensic reports -       .           (, Gmail     ). <br> <br> <code>fo</code> - failure report options -      forensic report: <br> <code>0</code> -    -         ; <br> <code>1</code> -          ; <br> <code>d</code> -       DKIM; <br> <code>s</code> -       SPF. <br> <br>    DMARC? <br>      : <br>       DMARC,   : <br> <code>_dmarc.domain.tld IN TXT "v=DMARC1; p=none; sp=none; rua=mailto:postmaster@domain.tld"</code> <br> <br>          -       .      <code>quarantine</code> ,    5% ( <code>pct=5</code> )     , ,      10-20-35-50-75-100%,        <code>reject</code> . <br> <br>   SPF/DKIM    <code>ruf=mailto:your-mbox@domain.tld</code>  <code><code>fo=1     . <br> <br>   ,      ,      -  ,     .</code></code></code></code></code> <h5> <code><code><code><code>_dmarc.domain.tld IN TXT "v=DMARC1; p=;" <br> <br> p</code> - policy - ,  : <br> <code>none</code> -     ,    ; <br> <code>quarantine</code> -   ; <br> <code>reject</code> -   . <br> <br>                   .   ,            : <br> <br>  DMARC <br> <code>_dmarc.domain.tld IN TXT "v=DMARC1; p=none; sp=none; rua=mailto:postmaster@domain.tld"</code> <br> <br> <code>sp</code> - subdomain policy -        policy; <br> <br> <code>rua</code> - reporting URI for aggregate reports -      mailto:mbox@domain.tld          XML <br> <b class="spoiler_title"> </b>   Mail.ru  <a href="http://habrahabr.ru/company/mailru/blog/170957/">DMARC:     </a> <br> <code class="xml"> &lt;feedback&gt; &lt;report_metadata&gt; &lt;date_range&gt; &lt;begin&gt;1361304000&lt;/begin&gt; &lt;end&gt;1361390400&lt;/end&gt; &lt;/date_range&gt; &lt;email&gt;dmarc_support@corp.mail.ru&lt;/email&gt; &lt;extra_contact_info&gt;http://corp.mail.ru/en&lt;/extra_contact_info&gt; &lt;org_name&gt;Mail.Ru&lt;/org_name&gt; &lt;report_id&gt;1361304000874948&lt;/report_id&gt; &lt;/report_metadata&gt; &lt;policy_published&gt; &lt;adkim&gt;r&lt;/adkim&gt; &lt;aspf&gt;r&lt;/aspf&gt; &lt;domain&gt;adan.ru&lt;/domain&gt; &lt;p&gt;none&lt;/p&gt; &lt;pct&gt;100&lt;/pct&gt; &lt;sp&gt;none&lt;/sp&gt; &lt;/policy_published&gt; &lt;record&gt; &lt;auth_results&gt; &lt;dkim&gt; &lt;domain&gt;adan.ru&lt;/domain&gt; &lt;result&gt;pass&lt;/result&gt; &lt;/dkim&gt; &lt;spf&gt; &lt;domain&gt;adan.ru&lt;/domain&gt; &lt;result&gt;pass&lt;/result&gt; &lt;/spf&gt; &lt;/auth_results&gt; &lt;identifiers&gt; &lt;header_from&gt;adan.ru&lt;/header_from&gt; &lt;/identifiers&gt; &lt;row&gt; &lt;count&gt;20&lt;/count&gt; &lt;policy_evaluated&gt; &lt;disposition&gt;none&lt;/disposition&gt; &lt;dkim&gt;pass&lt;/dkim&gt; &lt;spf&gt;pass&lt;/spf&gt; &lt;/policy_evaluated&gt; &lt;source_ip&gt;176.9.9.172&lt;/source_ip&gt; &lt;/row&gt; &lt;/record&gt; &lt;/feedback&gt;</code> <br> <br>      <code>ri</code> - requested interval -    ,   ,   86400.          . <br> <br>  : <br> -          ; <br> -     ( <code>@domain.tld</code> )     ( <code>@srv1.domain.tld</code> , <code>@srv2.domain.tld</code> ); <br> -           ( <code>postmaster@domain.tld</code> ). <br> <br> , ,  ,         .  , , ... <br> <br>   DMARC <br>    DMARC ,      <code>quarantine</code>  <code>reject</code> ,             : <br> <code>pct</code> - percentage -  ,   , <b></b>   forensic report. ,   <code>"v=DMARC1; p=quarantine; pct=50;"</code>        .   <code>pct=100</code> . <br> <br> <code>aspf</code> - alignment mode for SPF -   SPF: <br> <code>r</code> - relaxed -       RFC5322.From  SPF-        (  ,  ). ,          ,   RFC5321.MailFrom, "some.sub.domain.tld",   RFC5322.From - "mbox@domain.tld"; <br> <code>s</code> - strict -   RFC5321.MailFrom  RFC5322.From   . <br> <br> <code>adkim</code> - alignment mode for DKIM -   DKIM,    : <br> <code>r</code> - relaxed -    :     <code>RFC5322.From</code>        <a href="https://publicsuffix.org/"></a> <code>d=    ,         -  : <br> <b class="spoiler_title">  / Organizational Domains</b>     RFC: <br> Organizational Domain: <br> The domain that was registered with a domain name registrar. In the absence of more accurate methods, heuristics are used to determine this, since it is not always the case that the registered domain name is simply a top-level DNS domain plus one component (eg, "example.com", where "com" is a top-level domain). The Organizational Domain is determined by applying the algorithm found in Section 3.2. <br> ... <br> The Organizational Domain is determined using the following algorithm: <br> <br> 1. Acquire a "public suffix" list, ie, a list of DNS domain names reserved for registrations. Some country Top-Level Domains (TLDs) make specific registration requirements, eg, the United Kingdom places company registrations under ".co.uk"; other TLDs such as ".com" appear in the IANA registry of top-level DNS domains. A public suffix list is the union of all of these. Appendix A.6.1 contains some discussion about obtaining a public suffix list. <br> 2. Break the subject DNS domain name into a set of "n" ordered labels. Number these labels from right to left; eg, for "example.com", "com" would be label 1 and "example" would be label 2. <br> 3. Search the public suffix list for the name that matches the largest number of labels found in the subject DNS domain. Let that number be "x". <br> 4. Construct a new DNS domain name using the name that matched from the public suffix list and prefixing to it the "x+1"th label from the subject domain. This new name is the Organizational Domain. <br> <br> Thus, since "com" is an IANA-registered TLD, a subject domain of "abcdexample.com" would have an Organizational Domain of "example.com". <br> <br> The process of determining a suffix is currently a heuristic one. No list is guaranteed to be accurate or current. <br> <br> 1.   " ",         publicsuffix.org <br> 2,     ,       .     - sub.domain.tld</code>   #3 - <code>sub</code> , #2 - <code>domain</code> , #1 - <code>tld</code> . <br> 3.       ,       ,    . <br> 4.     +1  -     . <br> <br> : <br>   info@a.sub.domain.tld <br> : <code>tld</code> - #1, <code>domain</code> - #2, <code>sub</code> - #3, <code>a</code> - #4 <br>       <code>tld</code> ,  =1 <br>        2  - <code>domain.tld</code> <br> <br> <code>s</code> - strict - FQDN   <code>d=    RFC5322.From</code>        . <br> <br> <code>ruf</code> - reporting URI for forensic reports -       .           (, Gmail     ). <br> <br> <code>fo</code> - failure report options -      forensic report: <br> <code>0</code> -    -         ; <br> <code>1</code> -          ; <br> <code>d</code> -       DKIM; <br> <code>s</code> -       SPF. <br> <br>    DMARC? <br>      : <br>       DMARC,   : <br> <code>_dmarc.domain.tld IN TXT "v=DMARC1; p=none; sp=none; rua=mailto:postmaster@domain.tld"</code> <br> <br>          -       .      <code>quarantine</code> ,    5% ( <code>pct=5</code> )     , ,      10-20-35-50-75-100%,        <code>reject</code> . <br> <br>   SPF/DKIM    <code>ruf=mailto:your-mbox@domain.tld</code>  <code><code>fo=1     . <br> <br>   ,      ,      -  ,     .</code></code></code></code></code> </h5> <code><code><code><code>_dmarc.domain.tld IN TXT "v=DMARC1; p=;" <br> <br> p</code> - policy - ,  : <br> <code>none</code> -     ,    ; <br> <code>quarantine</code> -   ; <br> <code>reject</code> -   . <br> <br>                   .   ,            : <br> <br>  DMARC <br> <code>_dmarc.domain.tld IN TXT "v=DMARC1; p=none; sp=none; rua=mailto:postmaster@domain.tld"</code> <br> <br> <code>sp</code> - subdomain policy -        policy; <br> <br> <code>rua</code> - reporting URI for aggregate reports -      mailto:mbox@domain.tld          XML <br> <b class="spoiler_title"> </b>   Mail.ru  <a href="http://habrahabr.ru/company/mailru/blog/170957/">DMARC:     </a> <br> <code class="xml"> &lt;feedback&gt; &lt;report_metadata&gt; &lt;date_range&gt; &lt;begin&gt;1361304000&lt;/begin&gt; &lt;end&gt;1361390400&lt;/end&gt; &lt;/date_range&gt; &lt;email&gt;dmarc_support@corp.mail.ru&lt;/email&gt; &lt;extra_contact_info&gt;http://corp.mail.ru/en&lt;/extra_contact_info&gt; &lt;org_name&gt;Mail.Ru&lt;/org_name&gt; &lt;report_id&gt;1361304000874948&lt;/report_id&gt; &lt;/report_metadata&gt; &lt;policy_published&gt; &lt;adkim&gt;r&lt;/adkim&gt; &lt;aspf&gt;r&lt;/aspf&gt; &lt;domain&gt;adan.ru&lt;/domain&gt; &lt;p&gt;none&lt;/p&gt; &lt;pct&gt;100&lt;/pct&gt; &lt;sp&gt;none&lt;/sp&gt; &lt;/policy_published&gt; &lt;record&gt; &lt;auth_results&gt; &lt;dkim&gt; &lt;domain&gt;adan.ru&lt;/domain&gt; &lt;result&gt;pass&lt;/result&gt; &lt;/dkim&gt; &lt;spf&gt; &lt;domain&gt;adan.ru&lt;/domain&gt; &lt;result&gt;pass&lt;/result&gt; &lt;/spf&gt; &lt;/auth_results&gt; &lt;identifiers&gt; &lt;header_from&gt;adan.ru&lt;/header_from&gt; &lt;/identifiers&gt; &lt;row&gt; &lt;count&gt;20&lt;/count&gt; &lt;policy_evaluated&gt; &lt;disposition&gt;none&lt;/disposition&gt; &lt;dkim&gt;pass&lt;/dkim&gt; &lt;spf&gt;pass&lt;/spf&gt; &lt;/policy_evaluated&gt; &lt;source_ip&gt;176.9.9.172&lt;/source_ip&gt; &lt;/row&gt; &lt;/record&gt; &lt;/feedback&gt;</code> <br> <br>      <code>ri</code> - requested interval -    ,   ,   86400.          . <br> <br>  : <br> -          ; <br> -     ( <code>@domain.tld</code> )     ( <code>@srv1.domain.tld</code> , <code>@srv2.domain.tld</code> ); <br> -           ( <code>postmaster@domain.tld</code> ). <br> <br> , ,  ,         .  , , ... <br> <br>   DMARC <br>    DMARC ,      <code>quarantine</code>  <code>reject</code> ,             : <br> <code>pct</code> - percentage -  ,   , <b></b>   forensic report. ,   <code>"v=DMARC1; p=quarantine; pct=50;"</code>        .   <code>pct=100</code> . <br> <br> <code>aspf</code> - alignment mode for SPF -   SPF: <br> <code>r</code> - relaxed -       RFC5322.From  SPF-        (  ,  ). ,          ,   RFC5321.MailFrom, "some.sub.domain.tld",   RFC5322.From - "mbox@domain.tld"; <br> <code>s</code> - strict -   RFC5321.MailFrom  RFC5322.From   . <br> <br> <code>adkim</code> - alignment mode for DKIM -   DKIM,    : <br> <code>r</code> - relaxed -    :     <code>RFC5322.From</code>        <a href="https://publicsuffix.org/"></a> <code>d=    ,         -  : <br> <b class="spoiler_title">  / Organizational Domains</b>     RFC: <br> Organizational Domain: <br> The domain that was registered with a domain name registrar. In the absence of more accurate methods, heuristics are used to determine this, since it is not always the case that the registered domain name is simply a top-level DNS domain plus one component (eg, "example.com", where "com" is a top-level domain). The Organizational Domain is determined by applying the algorithm found in Section 3.2. <br> ... <br> The Organizational Domain is determined using the following algorithm: <br> <br> 1. Acquire a "public suffix" list, ie, a list of DNS domain names reserved for registrations. Some country Top-Level Domains (TLDs) make specific registration requirements, eg, the United Kingdom places company registrations under ".co.uk"; other TLDs such as ".com" appear in the IANA registry of top-level DNS domains. A public suffix list is the union of all of these. Appendix A.6.1 contains some discussion about obtaining a public suffix list. <br> 2. Break the subject DNS domain name into a set of "n" ordered labels. Number these labels from right to left; eg, for "example.com", "com" would be label 1 and "example" would be label 2. <br> 3. Search the public suffix list for the name that matches the largest number of labels found in the subject DNS domain. Let that number be "x". <br> 4. Construct a new DNS domain name using the name that matched from the public suffix list and prefixing to it the "x+1"th label from the subject domain. This new name is the Organizational Domain. <br> <br> Thus, since "com" is an IANA-registered TLD, a subject domain of "abcdexample.com" would have an Organizational Domain of "example.com". <br> <br> The process of determining a suffix is currently a heuristic one. No list is guaranteed to be accurate or current. <br> <br> 1.   " ",         publicsuffix.org <br> 2,     ,       .     - sub.domain.tld</code>   #3 - <code>sub</code> , #2 - <code>domain</code> , #1 - <code>tld</code> . <br> 3.       ,       ,    . <br> 4.     +1  -     . <br> <br> : <br>   info@a.sub.domain.tld <br> : <code>tld</code> - #1, <code>domain</code> - #2, <code>sub</code> - #3, <code>a</code> - #4 <br>       <code>tld</code> ,  =1 <br>        2  - <code>domain.tld</code> <br> <br> <code>s</code> - strict - FQDN   <code>d=    RFC5322.From</code>        . <br> <br> <code>ruf</code> - reporting URI for forensic reports -       .           (, Gmail     ). <br> <br> <code>fo</code> - failure report options -      forensic report: <br> <code>0</code> -    -         ; <br> <code>1</code> -          ; <br> <code>d</code> -       DKIM; <br> <code>s</code> -       SPF. <br> <br>    DMARC? <br>      : <br>       DMARC,   : <br> <code>_dmarc.domain.tld IN TXT "v=DMARC1; p=none; sp=none; rua=mailto:postmaster@domain.tld"</code> <br> <br>          -       .      <code>quarantine</code> ,    5% ( <code>pct=5</code> )     , ,      10-20-35-50-75-100%,        <code>reject</code> . <br> <br>   SPF/DKIM    <code>ruf=mailto:your-mbox@domain.tld</code>  <code><code>fo=1     . <br> <br>   ,      ,      -  ,     .</code></code></code></code></code> </div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <p>Source: <a href="https://habr.com/ru/post/253705/">https://habr.com/ru/post/253705/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../253695/index.html">9 video reviews of various IT solutions</a></li>
<li><a href="../253697/index.html">Basics of the combat system in games</a></li>
<li><a href="../253699/index.html">Who came up with the first computer virus?</a></li>
<li><a href="../253701/index.html">Feed operators in Perl 6</a></li>
<li><a href="../253703/index.html">Ruby Together - Ruby Language Development Foundation</a></li>
<li><a href="../253711/index.html">Writing the motion component for RTS in Unreal engine 4</a></li>
<li><a href="../253713/index.html">The digest of interesting materials for the mobile # 95 developer (March 16-22)</a></li>
<li><a href="../253715/index.html">Pros and cons of customized development without TZ</a></li>
<li><a href="../253717/index.html">MailChimp UX Team: Patterns and SVG Animation [Part 5 of the Book]</a></li>
<li><a href="../253719/index.html">Remote control of your smartphone with Node.js and Socket.io</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>