<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>As a vulnerability in REG.RU allowed to get registration data of any domain</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Today I want to talk about how back in 2012 I found a vulnerability in the domain registration system of the company REG.RU. Very often I see stories ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>As a vulnerability in REG.RU allowed to get registration data of any domain</h1><div class="post__text post__text-html js-mediator-article"> Today I want to talk about how back in 2012 I found a vulnerability in the domain registration system of the company REG.RU.  Very often I see stories in which the authors talk about vulnerabilities while mentioning that the company did not pay enough attention to the found bug for a long time or did not fix it at all.  In my case, everything was exactly the opposite, and the vulnerability was eliminated very quickly. <br><br> <a href="https://habr.com/company/poiskvps/blog/429280"><img src="https://habrastorage.org/webt/bx/wh/kl/bxwhklvvnvkoktoq7zgcevrmbxq.jpeg"></a> <br><a name="habracut"></a><br>  In September 2012, <a href="https://www.reg.ru/">REG.RU</a> started registering domains in the <b>ru.com</b> zone and sent all its customers letters offering for free for the first year a domain in the new zone with the name of an already registered domain in the zones <b>ru</b> , <b>RF</b> , <b>su</b> , <b>com</b> , <b>net</b> . <br><br>  Getting a free domain turned out to be quite simple: you had to follow the link from the letter, enter the activation code for the domain, and the domain was registered for free for a year. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <img src="https://habrastorage.org/webt/fw/h1/gp/fwh1gpaq6m27gl4ihvcknielwoq.png"><br><br>  Before registering a domain, the system offered to familiarize itself with the contact details of the ‚Äúoriginal‚Äù domain for which the gift domain will be registered, but this data was open only for viewing without editing so the meaning of their display was not clear.  However, this was the first bug: the registration of a new domain was available via a link like <code>https://www.reg.ru/domain/new/get_free_ru_com?service_id=XXXX</code> , and the service ID could simply be sorted out after seeing who was registered this or that domain. <br><br>  REG.RU specialists made it so that any contacts were not shown completely, but only the first 7 characters of each field were displayed, which theoretically should not fully disclose information about the domain owner, however, for example, my first and last name turned out to be less than 7 characters long and they shown completely.  Well, plus to everything, if you show the first 7 characters of the name, you can often guess which characters to add, a simple example is ‚ÄúVladimi‚Äù. <br><br>  This bug was corrected fairly quickly, and now the system showed only the first 4 characters, which was much better, although a person with the name ‚ÄúHan Solo‚Äù would not be very pleased. <br><br><img src="https://habrastorage.org/webt/nd/t1/qf/ndt1qficctztgphltdk3ia2eb7y.png"><br><br>  The next bug is the ability to register a domain without entering an activation code.  So that all domain owners did not run at once to register free domains, REG.RU decided to send letters not immediately, but within a couple of days, so the load was distributed evenly.  From a technical point of view, it was like this: in the database in the table with domains, a new column ‚ÄúAuthorization code‚Äù was created with a null value, and from time to time users were sent letters with the simultaneous filling of this field with the generated code.  A simple search could follow the link of the form <code>https://www.reg.ru/domain/new/get_free_ru_com?service_id=XXXX</code> , increasing the service ID to the value when the system had not yet issued an authorization code for such a domain and registered the domain with a blank code <br><br>  There was nothing wrong with registering such a domain, but after registering, you could see the full contact details (name, address and telephone number) of the owner of the ‚Äúoriginal‚Äù domain without hidden symbols.  It was easy to fix this bug by simply adding a check for a non-empty authorization code during registration, which the REG.RU specialists also promptly fixed. <br><br>  After a while, I found another bug, but it required a bit more action than just busting the service ID.  To simplify the registration procedure for gift domains, REG.RU made it possible to register a domain without entering an authorization code from a letter, if the e-mail account in the reg.ru system coincided with the e-mail address specified as a contact in the original domain.  For the user, it was quite convenient, but in terms of security, everything was not so good. <br><br>  In 2012, there was no law on the protection of personal data in the current edition, and many domains in the <b>ru</b> zone could see the contact e-mail address through Whois.  At the time of finding this bug, the e-mail address was already hidden, but through the services of viewing the history of the Whois, the e-mail could be viewed, and, most likely, it was relevant.  After that, it was necessary to try to register in the REG.RU system with this e-mail address and after that without an authorization code get a free domain, which in turn opened access to the contact information of the original domain. <br><br>  To be brief, the procedure is as follows: <br><br><ol><li>  Go to the page like <code>https://www.reg.ru/domain/new/get_free_ru_com?service_id=XXXX</code> and look at the domain name with this ID, for example, <b>habr.ru.com</b> . </li><li>  Through the service of viewing the history of Whois we find the e-mail address for the domain <b>habr.ru.</b> </li><li>  Using this e-mail address, we create an account in the REG.RU system (no confirmation of the ownership of the e-mail address was then required). </li><li>  Without entering the verification code, we register the domain <b>habr.ru.com</b> and see the full contact details of the owner <b>habr.ru.</b> </li></ol><br>  Errors that were made by REG.RU could potentially lead to the leakage of a large amount of personal data of domain owners, but all the bugs were fixed very quickly.  From the moment of writing the first letter (and I wrote it personally to the executive director of REG.RU) less than two days passed before fixing all the vulnerabilities, which, in my opinion, is quite a short time for a company of this size and with deadlines for fixing vulnerabilities in other corporations. <br><br><blockquote><div style="text-align:center;"><img src="https://habrastorage.org/webt/op/1d/zd/op1dzdczzwfxzcisazp6zysnoxg.png"></div><br>  <a href="https://vps.today/">Go</a> to <a href="https://vps.today/">VPS.today</a> - a site for searching virtual servers.  1400 tariffs from 120 hosters, convenient interface and a large number of criteria for finding the best virtual server. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/dd/ky/d6/ddkyd6kuoqn62p8il6p3oc4zilq.png"></div></blockquote></div><p>Source: <a href="https://habr.com/ru/post/429280/">https://habr.com/ru/post/429280/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../429270/index.html">Adult journalism: from Russia to the Kremlin</a></li>
<li><a href="../429272/index.html">A brief snapshot of React and Redux functional web development: Chapter 1. Welcome to React</a></li>
<li><a href="../429274/index.html">Startup: how to live up to the round</a></li>
<li><a href="../429276/index.html">Variational autocoders: theory and working code</a></li>
<li><a href="../429278/index.html">Promising magnetic recording technology MAMR: what awaits us in the near future?</a></li>
<li><a href="../429282/index.html">Microsoft fixed a bug with the "deactivation" of licenses for Windows 10</a></li>
<li><a href="../429286/index.html">How to speed up machine learning on a GPU - a new open source platform is introduced</a></li>
<li><a href="../429288/index.html">Developer! Stop thinking you are not a good enough specialist; that's not true.</a></li>
<li><a href="../429290/index.html">Tesla builds another giant battery in Australia</a></li>
<li><a href="../429292/index.html">Technical support 3CX answers: fast free update to the latest version 3CX</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>