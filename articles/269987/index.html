<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Virtual network interface</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="It is well known that Linux drivers are kernel modules. All drivers are modules, but not all modules are drivers. An example of one such group of modu...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Virtual network interface</h1><div class="post__text post__text-html js-mediator-article">  It is well known that Linux drivers are kernel modules.  All drivers are modules, but not all modules are drivers.  An example of one such group of modules that are not drivers and that appear much less frequently in discussions is network filters at various levels of the Linux network stack. <br><br>  Sometimes, and even often enough, I would like to have a network interface that could operate with the traffic of any other interface, but in some way additionally ‚Äúcolor‚Äù this traffic.  This may be needed for additional analysis, or traffic control, or its encryption, ... <br><br>  The idea is extremely simple: to channel the traffic of an already existing network interface to a newly created interface with completely different characteristics (name, IP, mask, subnet, ...).  We will discuss one of the ways to perform such actions in the form of a Linux kernel module (it is not the only one, but we will discuss other methods separately another time). <br><a name="habracut"></a><br><h1>  About interfaces in a couple of words </h1><br>  It is immediately clear that we intend to ‚Äúhang up‚Äù a new interface, which is to be created, to a previously existing one.  Therefore, we will briefly recall what concerns the creation of interfaces (and what is done, for example, by the driver of any network adapter), because there are several nuances that are important for our purposes. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      The network interface is where: <br><ul><li>  For each packet received from the interface, instances of the socket buffer structure (struct sk_buff) are created, then the created instance of the structure moves up the protocol stack up to its recipient in user space, where it is destroyed; </li><li>  The outgoing instances of the struct sk_buff structure, generated somewhere in the upper levels of the user-space protocols, must be sent, and the structure instances themselves are then destroyed (or disposed of in the pool). </li></ul><br>  For at least the last 5-6 years, the network interfaces have been invariably created by the macro: <br><br><pre><code class="hljs cs"><span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> alloc_netdev( sizeof_priv, name, setup )</span></span></code> </pre> <br>  Here (the details will be clear from the example module): <br>  - sizeof_priv - the size of the private interface data area (struct net_device), which will be created by the kernel without our direct participation; <br>  - name - character string - interface name pattern; <br>  - setup ‚Äî address of the interface initialization function; <br><br>  In this almost unchanged form, the process of creating an interface is described everywhere in publications and is mentioned in discussions.  But starting from kernel 3.17, the prototype of the interface creation macro changes (&lt;linux / netdevice.h&gt;): <br><br><pre> <code class="hljs cs"><span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> alloc_netdev( sizeof_priv, name, name_assign_type, setup )</span></span></code> </pre><br>  As it is easy to see, now instead of 3 parameters 4, the 3rd of which is a constant that determines the numbering order of the created interfaces (based on the name pattern), described in the same definition file: <br><pre> <code class="hljs cpp"><span class="hljs-comment"><span class="hljs-comment">/* interface name assignment types (sysfs name_assign_type attribute) */</span></span> <span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> NET_NAME_UNKNOWN 0 </span><span class="hljs-comment"><span class="hljs-meta"><span class="hljs-comment">/* unknown origin (not exposed to userspace) */</span></span></span><span class="hljs-meta"> #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> NET_NAME_ENUM 1 </span><span class="hljs-comment"><span class="hljs-meta"><span class="hljs-comment">/* enumerated by kernel */</span></span></span><span class="hljs-meta"> #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> NET_NAME_PREDICTABLE 2 </span><span class="hljs-comment"><span class="hljs-meta"><span class="hljs-comment">/* predictably named by the kernel */</span></span></span><span class="hljs-meta"> #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> NET_NAME_USER 3 </span><span class="hljs-comment"><span class="hljs-meta"><span class="hljs-comment">/* provided by user-space */</span></span></span><span class="hljs-meta"> #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> NET_NAME_RENAMED 4 </span><span class="hljs-comment"><span class="hljs-meta"><span class="hljs-comment">/* renamed by user-space */</span></span></span></span></code> </pre><br>  This is the first subtlety to pay attention to.  We will not go into these details in more detail, it was only important to note them. <br><br>  But the interface created in this way is not yet operational, it does not perform any actions.  In order to ‚Äúgive life‚Äù to the created network interface, you need to implement an appropriate set of operations for it.  All communication between the network interface and the operations performed on it is carried out through the network interface operation table: <br><pre> <code class="hljs rust"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">net_device_ops</span></span></span></span> { int (*ndo_init)(<span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">net_device</span></span></span></span> *dev); void (*ndo_uninit)(<span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">net_device</span></span></span></span> *dev); int (*ndo_open)(<span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">net_device</span></span></span></span> *dev); int (*ndo_stop)(<span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">net_device</span></span></span></span> *dev); netdev_tx_t (*ndo_start_xmit) (<span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">sk_buff</span></span></span></span> *skb, <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">net_device</span></span></span></span> *dev); ... <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">net_device_stats</span></span></span></span>* (*ndo_get_stats)(<span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">net_device</span></span></span></span> *dev); ... }</code> </pre><br>  In the kernel 3.09, for example, 39 operations are defined in struct net_device_ops, and about 50 operations in the 3.14 kernel, but the actually developed modules implement only a small part of them. <br><br>  It is characteristic that in the interface operations table there is an operation of transferring the socket buffer ndo_start_xmit () to the physical medium, but there is no operation at all to receive packets (socket buffers).  This is quite natural, as we will see shortly: received packets (for example, in the hardware interrupt handler IRQ) immediately after reception by calling netif_rx () (or netif_receive_skb ()) are immediately placed in the queue (core) of received packets, and then sequentially processed by the network stack .  But it is necessary to execute the ndo_start_xmit () function, at least to call the dev_kfree_skb () kernel API, which utilizes (destroys) the socket buffer after a successful (and unsuccessful) transfer operation of the packet.  If this is not done, a weak memory leak (with each packet) will arise in the system, which, ultimately, sooner or later will lead to a system crash.  This is another subtlety that we keep in mind. <br><br>  The last element we need is a struct net_device structure (described in &lt;linux / netdevice.h&gt;) - a description of the network interface.  This is a large structure containing not only the hardware description, but also the configuration parameters of the network interface in relation to the underlying protocols (example is taken from kernel 3.09): <br><pre> <code class="hljs cpp"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">net_device</span></span></span><span class="hljs-class"> {</span></span> <span class="hljs-keyword"><span class="hljs-keyword">char</span></span> name[ IFNAMSIZ ] ; ... <span class="hljs-keyword"><span class="hljs-keyword">unsigned</span></span> <span class="hljs-keyword"><span class="hljs-keyword">long</span></span> base_addr; <span class="hljs-comment"><span class="hljs-comment">/* device I/O address */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">unsigned</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> irq; <span class="hljs-comment"><span class="hljs-comment">/* device IRQ number */</span></span> ... <span class="hljs-keyword"><span class="hljs-keyword">unsigned</span></span> mtu; <span class="hljs-comment"><span class="hljs-comment">/* interface MTU value */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">unsigned</span></span> <span class="hljs-keyword"><span class="hljs-keyword">short</span></span> type; <span class="hljs-comment"><span class="hljs-comment">/* interface hardware type */</span></span> ... <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">net_device_stats</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">stats</span></span></span><span class="hljs-class">;</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">list_head</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">dev_list</span></span></span><span class="hljs-class">;</span></span> ... <span class="hljs-comment"><span class="hljs-comment">/* Interface address info. */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">unsigned</span></span> <span class="hljs-keyword"><span class="hljs-keyword">char</span></span> perm_addr[ MAX_ADDR_LEN ]; <span class="hljs-comment"><span class="hljs-comment">/* permanent hw address */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">unsigned</span></span> <span class="hljs-keyword"><span class="hljs-keyword">char</span></span> addr_len; <span class="hljs-comment"><span class="hljs-comment">/* hardware address length */</span></span> ... }</code> </pre><br>  Here, the type field, for example, defines the type of hardware adapter in terms of the ARP mechanism for resolving MAC addresses (&lt;linux / if_arp.h&gt;): <br><pre> <code class="hljs cpp">... <span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> ARPHRD_ETHER 1 </span><span class="hljs-comment"><span class="hljs-meta"><span class="hljs-comment">/* Ethernet 10Mbps */</span></span></span><span class="hljs-meta"> ... #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> ARPHRD_ARCNET 7 </span><span class="hljs-comment"><span class="hljs-meta"><span class="hljs-comment">/* ARCnet */</span></span></span><span class="hljs-meta"> ... #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> ARPHRD_IEEE1394 24 </span><span class="hljs-comment"><span class="hljs-meta"><span class="hljs-comment">/* IEEE 1394 IPv4 - RFC 2734 */</span></span></span><span class="hljs-meta"> ... #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> ARPHRD_IEEE80211 801 </span><span class="hljs-comment"><span class="hljs-meta"><span class="hljs-comment">/* IEEE 802.11 */</span></span></span></span></code> </pre><br>  A private data structure (mentioned earlier) is usually created and associated with the network interface structure, in which the user can place arbitrary own data of any complexity associated with the interface.  This is especially true if the driver is supposed to create several of the same type of network interfaces.  Access to a private data structure should be determined exclusively by the specially defined netdev_priv () function.  The following shows a possible kind of function ‚Äî this definition is from kernel 3.09, but no one will guarantee that it will not radically change in another kernel: <br><pre> <code class="hljs objectivec"><span class="hljs-comment"><span class="hljs-comment">/* netdev_priv - access network device private data * Get network device private data */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">inline</span></span> <span class="hljs-keyword"><span class="hljs-keyword">void</span></span> *netdev_priv( <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-keyword"><span class="hljs-keyword">struct</span></span> net_device *dev ) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">char</span></span> *)dev + ALIGN( <span class="hljs-keyword"><span class="hljs-keyword">sizeof</span></span>( <span class="hljs-keyword"><span class="hljs-keyword">struct</span></span> net_device ), NETDEV_ALIGN ); }</code> </pre><br>  As it is easy to see from the definition, a private data structure is written directly onto the tail of a struct net_device ‚Äî this is the usual practice of creating structures of variable size accepted in the C language starting from the standard C89 (and in C99). <br><br>  This building material will be enough for us to build a virtual network interface module. <br><br><h1>  Virtual Interface Module </h1><br>  Create a module that will intercept network I / O traffic from another, previously existing system (physical or logical) interface, and handle these streams (virt.c file) ... <br><div class="spoiler">  <b class="spoiler_title">module code</b> <div class="spoiler_text"><pre> <code class="hljs erlang-repl">#include &lt;linux/module.h&gt; #include &lt;linux/version.h&gt; #include &lt;linux/netdevice.h&gt; #include &lt;linux/etherdevice.h&gt; #include &lt;linux/moduleparam.h&gt; #include &lt;net/arp.h&gt; #define ERR(...) printk( KERN_ERR <span class="hljs-string"><span class="hljs-string">"! "</span></span>__VA_ARGS__ ) #define LOG(...) printk( KERN_INFO <span class="hljs-string"><span class="hljs-string">"! "</span></span>__VA_ARGS__ ) static char* link = <span class="hljs-string"><span class="hljs-string">"eth0"</span></span>; //    module_param( link, charp, <span class="hljs-number"><span class="hljs-number">0</span></span> ); static char* ifname = <span class="hljs-string"><span class="hljs-string">"virt"</span></span>; //    module_param( ifname, charp, <span class="hljs-number"><span class="hljs-number">0</span></span> ); static struct net_device *child = NULL; struct priv { struct net_device_stats stats; struct net_device *parent; }; static rx_handler_result_t handle_frame( struct sk_buff **pskb ) { struct sk_buff *skb = *pskb; if( child ) { struct priv *priv = netdev_priv( child ); priv-&gt;stats.rx_packets++; priv-&gt;stats.rx_bytes += skb-&gt;len; LOG( <span class="hljs-string"><span class="hljs-string">"rx: injecting frame from %s to %s"</span></span>, skb-&gt;dev-&gt;name, child-&gt;name ); skb-&gt;dev = child; return RX_HANDLER_ANOTHER; } return RX_HANDLER_PASS; } static int open( struct net_device *dev ) { netif_start_queue( dev ); LOG( <span class="hljs-string"><span class="hljs-string">"%s: device opened"</span></span>, dev-&gt;name ); return <span class="hljs-number"><span class="hljs-number">0</span></span>; } static int stop( struct net_device *dev ) { netif_stop_queue( dev ); LOG( <span class="hljs-string"><span class="hljs-string">"%s: device closed"</span></span>, dev-&gt;name ); return <span class="hljs-number"><span class="hljs-number">0</span></span>; } static netdev_tx_t start_xmit( struct sk_buff *skb, struct net_device *dev ) { struct priv *priv = netdev_priv( dev ); priv-&gt;stats.tx_packets++; priv-&gt;stats.tx_bytes += skb-&gt;len; if( priv-&gt;parent ) { skb-&gt;dev = priv-&gt;parent; skb-&gt;priority = <span class="hljs-number"><span class="hljs-number">1</span></span>; dev_queue_xmit( skb ); LOG( <span class="hljs-string"><span class="hljs-string">"tx: injecting frame from %s to %s"</span></span>, dev-&gt;name, skb-&gt;dev-&gt;name ); return <span class="hljs-number"><span class="hljs-number">0</span></span>; } return NETDEV_TX_OK; } static struct net_device_stats *get_stats( struct net_device *dev ) { return &amp;( (struct priv*)netdev_priv( dev ) )-&gt;stats; } static struct net_device_ops crypto_net_device_ops = { .ndo_open = open, .ndo_stop = stop, .ndo_get_stats = get_stats, .ndo_start_xmit = start_xmit, }; static void setup( struct net_device *dev ) { int j; ether_setup( dev ); memset( netdev_priv(dev), <span class="hljs-number"><span class="hljs-number">0</span></span>, sizeof( struct priv ) ); dev-&gt;netdev_ops = &amp;crypto_net_device_ops; for( j = <span class="hljs-number"><span class="hljs-number">0</span></span>; j &lt; ETH_ALEN; ++j ) // fill in the MAC address with a phoney dev-&gt;dev_addr[ j ] = (char)j; } int __init init( void ) { int err = <span class="hljs-number"><span class="hljs-number">0</span></span>; struct priv *priv; char ifstr[ <span class="hljs-number"><span class="hljs-number">40</span></span> ]; sprintf( ifstr, <span class="hljs-string"><span class="hljs-string">"%s%s"</span></span>, ifname, <span class="hljs-string"><span class="hljs-string">"%d"</span></span> ); #if (LINUX_VERSION_CODE &lt; KERNEL_VERSION(<span class="hljs-number"><span class="hljs-number">3</span></span>, <span class="hljs-number"><span class="hljs-number">17</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>)) child = alloc_netdev( sizeof( struct priv ), ifstr, setup ); #else child = alloc_netdev( sizeof( struct priv ), ifstr, NET_NAME_UNKNOWN, setup ); #endif if( child == NULL ) { ERR( <span class="hljs-string"><span class="hljs-string">"%s: allocate error"</span></span>, THIS_MODULE-&gt;name ); return -ENOMEM; } priv = netdev_priv( child ); priv-&gt;parent = __dev_get_by_name( &amp;init_net, link ); // parent interface if( !priv-&gt;parent ) { ERR( <span class="hljs-string"><span class="hljs-string">"%s: no such net: %s"</span></span>, THIS_MODULE-&gt;name, link ); err = -ENODEV; goto err; } if( priv-&gt;parent-&gt;type != ARPHRD_ETHER &amp;&amp; priv-&gt;parent-&gt;type != ARPHRD_LOOPBACK ) { ERR( <span class="hljs-string"><span class="hljs-string">"%s: illegal net type"</span></span>, THIS_MODULE-&gt;name ); err = -EINVAL; goto err; } /* also, and clone its IP, MAC and other information */ memcpy( child-&gt;dev_addr, priv-&gt;parent-&gt;dev_addr, ETH_ALEN ); memcpy( child-&gt;broadcast, priv-&gt;parent-&gt;broadcast, ETH_ALEN ); if( ( err = dev_alloc_name( child, child-&gt;name ) ) ) { ERR( <span class="hljs-string"><span class="hljs-string">"%s: allocate name, error %i"</span></span>, THIS_MODULE-&gt;name, err ); err = -EIO; goto err; } register_netdev( child ); rtnl_lock(); netdev_rx_handler_register( priv-&gt;parent, &amp;handle_frame, NULL ); rtnl_unlock(); LOG( <span class="hljs-string"><span class="hljs-string">"module %s loaded"</span></span>, THIS_MODULE-&gt;name ); LOG( <span class="hljs-string"><span class="hljs-string">"%s: create link %s"</span></span>, THIS_MODULE-&gt;name, child-&gt;name ); LOG( <span class="hljs-string"><span class="hljs-string">"%s: registered rx handler for %s"</span></span>, THIS_MODULE-&gt;name, priv-&gt;parent-&gt;name ); return <span class="hljs-number"><span class="hljs-number">0</span></span>; err: free_netdev( child ); return err; } void __exit exit( void ) { struct priv *priv = netdev_priv( child ); if( priv-&gt;parent ) { rtnl_lock(); netdev_rx_handler_unregister( priv-&gt;parent ); rtnl_unlock(); LOG( <span class="hljs-string"><span class="hljs-string">"unregister rx handler for %s\n"</span></span>, priv-&gt;parent-&gt;name ); } unregister_netdev( child ); free_netdev( child ); LOG( <span class="hljs-string"><span class="hljs-string">"module %s unloaded"</span></span>, THIS_MODULE-&gt;name ); } module_init( init ); module_exit( exit ); MODULE_AUTHOR( <span class="hljs-string"><span class="hljs-string">"Oleg Tsiliuric"</span></span> ); MODULE_AUTHOR( <span class="hljs-string"><span class="hljs-string">"Nikita Dorokhin"</span></span> ); MODULE_LICENSE( <span class="hljs-string"><span class="hljs-string">"GPL v2"</span></span> ); MODULE_VERSION( <span class="hljs-string"><span class="hljs-string">"2.1"</span></span> );</code> </pre><br></div></div><br>  Everything is simple enough here, but the following points deserve some individual comments: <br><ul><li>  After creating the alloc_netdev () interface, we bind its operations via the crypto_net_device_ops table.  Operations (fields) are defined here: .ndo_open and .ndo_stop (which are called when the interface starts and stops using the command ifconfig up / down), .ndo_get_stats (request for interface statistics), and .ndo_start_xmit (packet transmission). </li><li>  Through a private data region, we retain a link to the parent interface in us to a specific struct priv structure (the sample files show several different uses for the private region to bind). </li><li>  In the table of operations there is no (and cannot be logically) function for receiving socket buffers.  But by calling netdev_rx_handler_register () (which appeared only in kernel 2.6.36) we can add our own filter function handle_frame () to the queue for processing received packets (for the parent interface), which will be called for each packet coming from this interface. </li><li>  At the time of adding the filter to the queue, we need to block access to the queue for a short time (otherwise, we might expect an emergency result).  This is achieved by calling rtnl_lock () and rtnl_unlock (). </li><li>  When an outgoing socket buffer is transferred to the network (the start_xmit () function), we simply replace the interface in the socket buffer structure through which the data should be physically sent. </li><li>  When receiving, on the contrary, socket buffers created in the parent interface are replaced by virtual ones. </li></ul><br><br><h1>  How it works? </h1><br>  Choose any existing and operational network interface (in Fedora 16, one of the Ethernet interfaces was called p7p1 - this is a good illustration of the fact that interfaces can have very different names): <br><pre> <code class="dos hljs">$ ip addr show dev p7p1 <span class="hljs-number"><span class="hljs-number">3</span></span>: p7p1: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu <span class="hljs-number"><span class="hljs-number">1500</span></span> qdisc pfifo_fast state UP qlen <span class="hljs-number"><span class="hljs-number">1000</span></span> link/ether <span class="hljs-number"><span class="hljs-number">08</span></span>:<span class="hljs-number"><span class="hljs-number">00</span></span>:<span class="hljs-number"><span class="hljs-number">27</span></span>:<span class="hljs-number"><span class="hljs-number">9</span></span>e:<span class="hljs-number"><span class="hljs-number">02</span></span>:<span class="hljs-number"><span class="hljs-number">02</span></span> brd ff:ff:ff:ff:ff:ff inet <span class="hljs-number"><span class="hljs-number">192</span></span>.<span class="hljs-number"><span class="hljs-number">168</span></span>.<span class="hljs-number"><span class="hljs-number">56</span></span>.<span class="hljs-number"><span class="hljs-number">101</span></span>/<span class="hljs-number"><span class="hljs-number">24</span></span> brd <span class="hljs-number"><span class="hljs-number">192</span></span>.<span class="hljs-number"><span class="hljs-number">168</span></span>.<span class="hljs-number"><span class="hljs-number">56</span></span>.<span class="hljs-number"><span class="hljs-number">255</span></span> scope global p7p1 inet6 fe80::a00:<span class="hljs-number"><span class="hljs-number">27</span></span>ff:fe9e:<span class="hljs-number"><span class="hljs-number">202</span></span>/<span class="hljs-number"><span class="hljs-number">64</span></span> scope link valid_lft forever preferred_lft forever</code> </pre><br>  We will install our new virtual interface on it and configure it on the IP subnet (192.168.50.0/24), which is different from the original subnet of the p7p1 interface: <br><pre> <code class="dos hljs">$ sudo insmod virt2.ko link=p7p1 $ sudo ifconfig virt0 <span class="hljs-number"><span class="hljs-number">192</span></span>.<span class="hljs-number"><span class="hljs-number">168</span></span>.<span class="hljs-number"><span class="hljs-number">50</span></span>.<span class="hljs-number"><span class="hljs-number">2</span></span> $ ifconfig virt0 virt0 Link encap:Ethernet HWaddr <span class="hljs-number"><span class="hljs-number">08</span></span>:<span class="hljs-number"><span class="hljs-number">00</span></span>:<span class="hljs-number"><span class="hljs-number">27</span></span>:<span class="hljs-number"><span class="hljs-number">9</span></span>E:<span class="hljs-number"><span class="hljs-number">02</span></span>:<span class="hljs-number"><span class="hljs-number">02</span></span> inet addr:<span class="hljs-number"><span class="hljs-number">192</span></span>.<span class="hljs-number"><span class="hljs-number">168</span></span>.<span class="hljs-number"><span class="hljs-number">50</span></span>.<span class="hljs-number"><span class="hljs-number">2</span></span> Bcast:<span class="hljs-number"><span class="hljs-number">192</span></span>.<span class="hljs-number"><span class="hljs-number">168</span></span>.<span class="hljs-number"><span class="hljs-number">50</span></span>.<span class="hljs-number"><span class="hljs-number">255</span></span> Mask:<span class="hljs-number"><span class="hljs-number">255</span></span>.<span class="hljs-number"><span class="hljs-number">255</span></span>.<span class="hljs-number"><span class="hljs-number">255</span></span>.<span class="hljs-number"><span class="hljs-number">0</span></span> inet6 addr: fe80::a00:<span class="hljs-number"><span class="hljs-number">27</span></span>ff:fe9e:<span class="hljs-number"><span class="hljs-number">202</span></span>/<span class="hljs-number"><span class="hljs-number">64</span></span> Scope:Link UP BROADCAST RUNNING MULTICAST MTU:<span class="hljs-number"><span class="hljs-number">1500</span></span> Metric:<span class="hljs-number"><span class="hljs-number">1</span></span> RX packets:<span class="hljs-number"><span class="hljs-number">0</span></span> errors:<span class="hljs-number"><span class="hljs-number">0</span></span> dropped:<span class="hljs-number"><span class="hljs-number">0</span></span> overruns:<span class="hljs-number"><span class="hljs-number">0</span></span> frame:<span class="hljs-number"><span class="hljs-number">0</span></span> TX packets:<span class="hljs-number"><span class="hljs-number">27</span></span> errors:<span class="hljs-number"><span class="hljs-number">0</span></span> dropped:<span class="hljs-number"><span class="hljs-number">0</span></span> overruns:<span class="hljs-number"><span class="hljs-number">0</span></span> carrier:<span class="hljs-number"><span class="hljs-number">0</span></span> collisions:<span class="hljs-number"><span class="hljs-number">0</span></span> txqueuelen:<span class="hljs-number"><span class="hljs-number">1000</span></span> RX bytes:<span class="hljs-number"><span class="hljs-number">0</span></span> (<span class="hljs-number"><span class="hljs-number">0</span></span>.<span class="hljs-number"><span class="hljs-number">0</span></span> b) TX bytes:<span class="hljs-number"><span class="hljs-number">5027</span></span> (<span class="hljs-number"><span class="hljs-number">4</span></span>.<span class="hljs-number"><span class="hljs-number">9</span></span> KiB)</code> </pre><br>  The easiest and fastest way to create a return end of communication (do we need to somehow test our work?) For such a new (192.168.50.2/24) subnet on another LAN host, is to create an alias IP for the network interface of this remote host, like : <br><pre> <code class="dos hljs">$ sudo ifconfig vboxnet0:<span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-number"><span class="hljs-number">192</span></span>.<span class="hljs-number"><span class="hljs-number">168</span></span>.<span class="hljs-number"><span class="hljs-number">50</span></span>.<span class="hljs-number"><span class="hljs-number">1</span></span> $ ifconfig ... vboxnet0 Link encap:Ethernet HWaddr <span class="hljs-number"><span class="hljs-number">0</span></span>A:<span class="hljs-number"><span class="hljs-number">00</span></span>:<span class="hljs-number"><span class="hljs-number">27</span></span>:<span class="hljs-number"><span class="hljs-number">00</span></span>:<span class="hljs-number"><span class="hljs-number">00</span></span>:<span class="hljs-number"><span class="hljs-number">00</span></span> inet addr:<span class="hljs-number"><span class="hljs-number">192</span></span>.<span class="hljs-number"><span class="hljs-number">168</span></span>.<span class="hljs-number"><span class="hljs-number">56</span></span>.<span class="hljs-number"><span class="hljs-number">1</span></span> Bcast:<span class="hljs-number"><span class="hljs-number">192</span></span>.<span class="hljs-number"><span class="hljs-number">168</span></span>.<span class="hljs-number"><span class="hljs-number">56</span></span>.<span class="hljs-number"><span class="hljs-number">255</span></span> Mask:<span class="hljs-number"><span class="hljs-number">255</span></span>.<span class="hljs-number"><span class="hljs-number">255</span></span>.<span class="hljs-number"><span class="hljs-number">255</span></span>.<span class="hljs-number"><span class="hljs-number">0</span></span> inet6 addr: fe80::<span class="hljs-number"><span class="hljs-number">800</span></span>:<span class="hljs-number"><span class="hljs-number">27</span></span>ff:fe00:<span class="hljs-number"><span class="hljs-number">0</span></span>/<span class="hljs-number"><span class="hljs-number">64</span></span> Scope:Link UP BROADCAST RUNNING MULTICAST MTU:<span class="hljs-number"><span class="hljs-number">1500</span></span> Metric:<span class="hljs-number"><span class="hljs-number">1</span></span> RX packets:<span class="hljs-number"><span class="hljs-number">0</span></span> errors:<span class="hljs-number"><span class="hljs-number">0</span></span> dropped:<span class="hljs-number"><span class="hljs-number">0</span></span> overruns:<span class="hljs-number"><span class="hljs-number">0</span></span> frame:<span class="hljs-number"><span class="hljs-number">0</span></span> TX packets:<span class="hljs-number"><span class="hljs-number">223</span></span> errors:<span class="hljs-number"><span class="hljs-number">0</span></span> dropped:<span class="hljs-number"><span class="hljs-number">0</span></span> overruns:<span class="hljs-number"><span class="hljs-number">0</span></span> carrier:<span class="hljs-number"><span class="hljs-number">0</span></span> collisions:<span class="hljs-number"><span class="hljs-number">0</span></span> txqueuelen:<span class="hljs-number"><span class="hljs-number">1000</span></span> RX bytes:<span class="hljs-number"><span class="hljs-number">0</span></span> (<span class="hljs-number"><span class="hljs-number">0</span></span>.<span class="hljs-number"><span class="hljs-number">0</span></span> b) TX bytes:<span class="hljs-number"><span class="hljs-number">36730</span></span> (<span class="hljs-number"><span class="hljs-number">35</span></span>.<span class="hljs-number"><span class="hljs-number">8</span></span> KiB) vboxnet0:<span class="hljs-number"><span class="hljs-number">1</span></span> Link encap:Ethernet HWaddr <span class="hljs-number"><span class="hljs-number">0</span></span>A:<span class="hljs-number"><span class="hljs-number">00</span></span>:<span class="hljs-number"><span class="hljs-number">27</span></span>:<span class="hljs-number"><span class="hljs-number">00</span></span>:<span class="hljs-number"><span class="hljs-number">00</span></span>:<span class="hljs-number"><span class="hljs-number">00</span></span> inet addr:<span class="hljs-number"><span class="hljs-number">192</span></span>.<span class="hljs-number"><span class="hljs-number">168</span></span>.<span class="hljs-number"><span class="hljs-number">50</span></span>.<span class="hljs-number"><span class="hljs-number">1</span></span> Bcast:<span class="hljs-number"><span class="hljs-number">192</span></span>.<span class="hljs-number"><span class="hljs-number">168</span></span>.<span class="hljs-number"><span class="hljs-number">50</span></span>.<span class="hljs-number"><span class="hljs-number">255</span></span> Mask:<span class="hljs-number"><span class="hljs-number">255</span></span>.<span class="hljs-number"><span class="hljs-number">255</span></span>.<span class="hljs-number"><span class="hljs-number">255</span></span>.<span class="hljs-number"><span class="hljs-number">0</span></span> UP BROADCAST RUNNING MULTICAST MTU:<span class="hljs-number"><span class="hljs-number">1500</span></span> Metric:<span class="hljs-number"><span class="hljs-number">1</span></span></code> </pre><br>  (The hypervisor network interface of the VirtualBox virtual machines is shown here, but it doesn‚Äôt matter, and you can do exactly the same with the interface of any physical device). <br><br>  Now from the newly created virtual interface we can check the transparency of the network by sending ICMP: <br><pre> <code class="dos hljs">$ <span class="hljs-built_in"><span class="hljs-built_in">ping</span></span> <span class="hljs-number"><span class="hljs-number">192</span></span>.<span class="hljs-number"><span class="hljs-number">168</span></span>.<span class="hljs-number"><span class="hljs-number">50</span></span>.<span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-built_in"><span class="hljs-built_in">PING</span></span> <span class="hljs-number"><span class="hljs-number">192</span></span>.<span class="hljs-number"><span class="hljs-number">168</span></span>.<span class="hljs-number"><span class="hljs-number">50</span></span>.<span class="hljs-number"><span class="hljs-number">1</span></span> (<span class="hljs-number"><span class="hljs-number">192</span></span>.<span class="hljs-number"><span class="hljs-number">168</span></span>.<span class="hljs-number"><span class="hljs-number">50</span></span>.<span class="hljs-number"><span class="hljs-number">1</span></span>) <span class="hljs-number"><span class="hljs-number">56</span></span>(<span class="hljs-number"><span class="hljs-number">84</span></span>) bytes of data. <span class="hljs-number"><span class="hljs-number">64</span></span> bytes from <span class="hljs-number"><span class="hljs-number">192</span></span>.<span class="hljs-number"><span class="hljs-number">168</span></span>.<span class="hljs-number"><span class="hljs-number">50</span></span>.<span class="hljs-number"><span class="hljs-number">1</span></span>: icmp_req=<span class="hljs-number"><span class="hljs-number">1</span></span> ttl=<span class="hljs-number"><span class="hljs-number">64</span></span> <span class="hljs-built_in"><span class="hljs-built_in">time</span></span>=<span class="hljs-number"><span class="hljs-number">0</span></span>.<span class="hljs-number"><span class="hljs-number">371</span></span> ms <span class="hljs-number"><span class="hljs-number">64</span></span> bytes from <span class="hljs-number"><span class="hljs-number">192</span></span>.<span class="hljs-number"><span class="hljs-number">168</span></span>.<span class="hljs-number"><span class="hljs-number">50</span></span>.<span class="hljs-number"><span class="hljs-number">1</span></span>: icmp_req=<span class="hljs-number"><span class="hljs-number">2</span></span> ttl=<span class="hljs-number"><span class="hljs-number">64</span></span> <span class="hljs-built_in"><span class="hljs-built_in">time</span></span>=<span class="hljs-number"><span class="hljs-number">0</span></span>.<span class="hljs-number"><span class="hljs-number">210</span></span> ms <span class="hljs-number"><span class="hljs-number">64</span></span> bytes from <span class="hljs-number"><span class="hljs-number">192</span></span>.<span class="hljs-number"><span class="hljs-number">168</span></span>.<span class="hljs-number"><span class="hljs-number">50</span></span>.<span class="hljs-number"><span class="hljs-number">1</span></span>: icmp_req=<span class="hljs-number"><span class="hljs-number">3</span></span> ttl=<span class="hljs-number"><span class="hljs-number">64</span></span> <span class="hljs-built_in"><span class="hljs-built_in">time</span></span>=<span class="hljs-number"><span class="hljs-number">0</span></span>.<span class="hljs-number"><span class="hljs-number">184</span></span> ms <span class="hljs-number"><span class="hljs-number">64</span></span> bytes from <span class="hljs-number"><span class="hljs-number">192</span></span>.<span class="hljs-number"><span class="hljs-number">168</span></span>.<span class="hljs-number"><span class="hljs-number">50</span></span>.<span class="hljs-number"><span class="hljs-number">1</span></span>: icmp_req=<span class="hljs-number"><span class="hljs-number">4</span></span> ttl=<span class="hljs-number"><span class="hljs-number">64</span></span> <span class="hljs-built_in"><span class="hljs-built_in">time</span></span>=<span class="hljs-number"><span class="hljs-number">0</span></span>.<span class="hljs-number"><span class="hljs-number">242</span></span> ms ^C --- <span class="hljs-number"><span class="hljs-number">192</span></span>.<span class="hljs-number"><span class="hljs-number">168</span></span>.<span class="hljs-number"><span class="hljs-number">50</span></span>.<span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-built_in"><span class="hljs-built_in">ping</span></span> statistics --- <span class="hljs-number"><span class="hljs-number">4</span></span> packets transmitted, <span class="hljs-number"><span class="hljs-number">4</span></span> received, <span class="hljs-number"><span class="hljs-number">0</span></span>% packet loss, <span class="hljs-built_in"><span class="hljs-built_in">time</span></span> <span class="hljs-number"><span class="hljs-number">3001</span></span>ms rtt min/avg/max/mdev = <span class="hljs-number"><span class="hljs-number">0</span></span>.<span class="hljs-number"><span class="hljs-number">184</span></span>/<span class="hljs-number"><span class="hljs-number">0</span></span>.<span class="hljs-number"><span class="hljs-number">251</span></span>/<span class="hljs-number"><span class="hljs-number">0</span></span>.<span class="hljs-number"><span class="hljs-number">371</span></span>/<span class="hljs-number"><span class="hljs-number">0</span></span>.<span class="hljs-number"><span class="hljs-number">074</span></span> ms $ sudo tcpdump -i virt0 tcpdump: verbose output suppressed, use -v or -vv <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> full protocol decode listening on virt0, link-<span class="hljs-built_in"><span class="hljs-built_in">type</span></span> EN10MB (Ethernet), capture size <span class="hljs-number"><span class="hljs-number">65535</span></span> bytes <span class="hljs-number"><span class="hljs-number">00</span></span>:<span class="hljs-number"><span class="hljs-number">13</span></span>:<span class="hljs-number"><span class="hljs-number">02</span></span>.<span class="hljs-number"><span class="hljs-number">228615</span></span> IP <span class="hljs-number"><span class="hljs-number">192</span></span>.<span class="hljs-number"><span class="hljs-number">168</span></span>.<span class="hljs-number"><span class="hljs-number">50</span></span>.<span class="hljs-number"><span class="hljs-number">1</span></span> &gt; <span class="hljs-number"><span class="hljs-number">192</span></span>.<span class="hljs-number"><span class="hljs-number">168</span></span>.<span class="hljs-number"><span class="hljs-number">50</span></span>.<span class="hljs-number"><span class="hljs-number">2</span></span>: ICMP <span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> request, id <span class="hljs-number"><span class="hljs-number">5609</span></span>, seq <span class="hljs-number"><span class="hljs-number">1</span></span>, length <span class="hljs-number"><span class="hljs-number">64</span></span> <span class="hljs-number"><span class="hljs-number">00</span></span>:<span class="hljs-number"><span class="hljs-number">13</span></span>:<span class="hljs-number"><span class="hljs-number">02</span></span>.<span class="hljs-number"><span class="hljs-number">228716</span></span> ARP, Request who-has <span class="hljs-number"><span class="hljs-number">192</span></span>.<span class="hljs-number"><span class="hljs-number">168</span></span>.<span class="hljs-number"><span class="hljs-number">50</span></span>.<span class="hljs-number"><span class="hljs-number">1</span></span> tell <span class="hljs-number"><span class="hljs-number">192</span></span>.<span class="hljs-number"><span class="hljs-number">168</span></span>.<span class="hljs-number"><span class="hljs-number">50</span></span>.<span class="hljs-number"><span class="hljs-number">2</span></span>, length <span class="hljs-number"><span class="hljs-number">28</span></span> <span class="hljs-number"><span class="hljs-number">00</span></span>:<span class="hljs-number"><span class="hljs-number">13</span></span>:<span class="hljs-number"><span class="hljs-number">02</span></span>.<span class="hljs-number"><span class="hljs-number">228786</span></span> ARP, Reply <span class="hljs-number"><span class="hljs-number">192</span></span>.<span class="hljs-number"><span class="hljs-number">168</span></span>.<span class="hljs-number"><span class="hljs-number">50</span></span>.<span class="hljs-number"><span class="hljs-number">1</span></span> is-<span class="hljs-built_in"><span class="hljs-built_in">at</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span>a:<span class="hljs-number"><span class="hljs-number">00</span></span>:<span class="hljs-number"><span class="hljs-number">27</span></span>:<span class="hljs-number"><span class="hljs-number">00</span></span>:<span class="hljs-number"><span class="hljs-number">00</span></span>:<span class="hljs-number"><span class="hljs-number">00</span></span> (oui Unknown), length <span class="hljs-number"><span class="hljs-number">46</span></span> <span class="hljs-number"><span class="hljs-number">00</span></span>:<span class="hljs-number"><span class="hljs-number">13</span></span>:<span class="hljs-number"><span class="hljs-number">02</span></span>.<span class="hljs-number"><span class="hljs-number">228803</span></span> IP <span class="hljs-number"><span class="hljs-number">192</span></span>.<span class="hljs-number"><span class="hljs-number">168</span></span>.<span class="hljs-number"><span class="hljs-number">50</span></span>.<span class="hljs-number"><span class="hljs-number">2</span></span> &gt; <span class="hljs-number"><span class="hljs-number">192</span></span>.<span class="hljs-number"><span class="hljs-number">168</span></span>.<span class="hljs-number"><span class="hljs-number">50</span></span>.<span class="hljs-number"><span class="hljs-number">1</span></span>: ICMP <span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> reply, id <span class="hljs-number"><span class="hljs-number">5609</span></span>, seq <span class="hljs-number"><span class="hljs-number">1</span></span>, length <span class="hljs-number"><span class="hljs-number">64</span></span> <span class="hljs-number"><span class="hljs-number">00</span></span>:<span class="hljs-number"><span class="hljs-number">13</span></span>:<span class="hljs-number"><span class="hljs-number">03</span></span>.<span class="hljs-number"><span class="hljs-number">227996</span></span> IP <span class="hljs-number"><span class="hljs-number">192</span></span>.<span class="hljs-number"><span class="hljs-number">168</span></span>.<span class="hljs-number"><span class="hljs-number">50</span></span>.<span class="hljs-number"><span class="hljs-number">1</span></span> &gt; <span class="hljs-number"><span class="hljs-number">192</span></span>.<span class="hljs-number"><span class="hljs-number">168</span></span>.<span class="hljs-number"><span class="hljs-number">50</span></span>.<span class="hljs-number"><span class="hljs-number">2</span></span>: ICMP <span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> request, id <span class="hljs-number"><span class="hljs-number">5609</span></span>, seq <span class="hljs-number"><span class="hljs-number">2</span></span>, length <span class="hljs-number"><span class="hljs-number">64</span></span> <span class="hljs-number"><span class="hljs-number">00</span></span>:<span class="hljs-number"><span class="hljs-number">13</span></span>:<span class="hljs-number"><span class="hljs-number">03</span></span>.<span class="hljs-number"><span class="hljs-number">228059</span></span> IP <span class="hljs-number"><span class="hljs-number">192</span></span>.<span class="hljs-number"><span class="hljs-number">168</span></span>.<span class="hljs-number"><span class="hljs-number">50</span></span>.<span class="hljs-number"><span class="hljs-number">2</span></span> &gt; <span class="hljs-number"><span class="hljs-number">192</span></span>.<span class="hljs-number"><span class="hljs-number">168</span></span>.<span class="hljs-number"><span class="hljs-number">50</span></span>.<span class="hljs-number"><span class="hljs-number">1</span></span>: ICMP <span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> reply, id <span class="hljs-number"><span class="hljs-number">5609</span></span>, seq <span class="hljs-number"><span class="hljs-number">2</span></span>, length <span class="hljs-number"><span class="hljs-number">64</span></span> <span class="hljs-number"><span class="hljs-number">00</span></span>:<span class="hljs-number"><span class="hljs-number">13</span></span>:<span class="hljs-number"><span class="hljs-number">04</span></span>.<span class="hljs-number"><span class="hljs-number">228016</span></span> IP <span class="hljs-number"><span class="hljs-number">192</span></span>.<span class="hljs-number"><span class="hljs-number">168</span></span>.<span class="hljs-number"><span class="hljs-number">50</span></span>.<span class="hljs-number"><span class="hljs-number">1</span></span> &gt; <span class="hljs-number"><span class="hljs-number">192</span></span>.<span class="hljs-number"><span class="hljs-number">168</span></span>.<span class="hljs-number"><span class="hljs-number">50</span></span>.<span class="hljs-number"><span class="hljs-number">2</span></span>: ICMP <span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> request, id <span class="hljs-number"><span class="hljs-number">5609</span></span>, seq <span class="hljs-number"><span class="hljs-number">3</span></span>, length <span class="hljs-number"><span class="hljs-number">64</span></span> ... <span class="hljs-number"><span class="hljs-number">00</span></span>:<span class="hljs-number"><span class="hljs-number">14</span></span>:<span class="hljs-number"><span class="hljs-number">09</span></span>.<span class="hljs-number"><span class="hljs-number">236014</span></span> ARP, Request who-has <span class="hljs-number"><span class="hljs-number">192</span></span>.<span class="hljs-number"><span class="hljs-number">168</span></span>.<span class="hljs-number"><span class="hljs-number">50</span></span>.<span class="hljs-number"><span class="hljs-number">2</span></span> tell <span class="hljs-number"><span class="hljs-number">192</span></span>.<span class="hljs-number"><span class="hljs-number">168</span></span>.<span class="hljs-number"><span class="hljs-number">50</span></span>.<span class="hljs-number"><span class="hljs-number">1</span></span>, length <span class="hljs-number"><span class="hljs-number">46</span></span> <span class="hljs-number"><span class="hljs-number">00</span></span>:<span class="hljs-number"><span class="hljs-number">14</span></span>:<span class="hljs-number"><span class="hljs-number">09</span></span>.<span class="hljs-number"><span class="hljs-number">236052</span></span> ARP, Reply <span class="hljs-number"><span class="hljs-number">192</span></span>.<span class="hljs-number"><span class="hljs-number">168</span></span>.<span class="hljs-number"><span class="hljs-number">50</span></span>.<span class="hljs-number"><span class="hljs-number">2</span></span> is-<span class="hljs-built_in"><span class="hljs-built_in">at</span></span> <span class="hljs-number"><span class="hljs-number">08</span></span>:<span class="hljs-number"><span class="hljs-number">00</span></span>:<span class="hljs-number"><span class="hljs-number">27</span></span>:<span class="hljs-number"><span class="hljs-number">9</span></span>e:<span class="hljs-number"><span class="hljs-number">02</span></span>:<span class="hljs-number"><span class="hljs-number">02</span></span> (oui Unknown), length <span class="hljs-number"><span class="hljs-number">28</span></span> tcpdump: pcap_loop: The interface went down <span class="hljs-number"><span class="hljs-number">16</span></span> packets captured <span class="hljs-number"><span class="hljs-number">16</span></span> packets received by filter <span class="hljs-number"><span class="hljs-number">0</span></span> packets dropped by kernel</code> </pre><br>  And then create (now the opposite, on a remote host) a full-fledged SSH session to a new virtual interface: <br><pre> <code class="dos hljs">$ ssh <span class="hljs-number"><span class="hljs-number">192</span></span>.<span class="hljs-number"><span class="hljs-number">168</span></span>.<span class="hljs-number"><span class="hljs-number">50</span></span>.<span class="hljs-number"><span class="hljs-number">2</span></span> Nasty PTR record "<span class="hljs-number"><span class="hljs-number">192</span></span>.<span class="hljs-number"><span class="hljs-number">168</span></span>.<span class="hljs-number"><span class="hljs-number">50</span></span>.<span class="hljs-number"><span class="hljs-number">2</span></span>" is <span class="hljs-built_in"><span class="hljs-built_in">set</span></span> up <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> <span class="hljs-number"><span class="hljs-number">192</span></span>.<span class="hljs-number"><span class="hljs-number">168</span></span>.<span class="hljs-number"><span class="hljs-number">50</span></span>.<span class="hljs-number"><span class="hljs-number">2</span></span>, ignoring olej@<span class="hljs-number"><span class="hljs-number">192</span></span>.<span class="hljs-number"><span class="hljs-number">168</span></span>.<span class="hljs-number"><span class="hljs-number">50</span></span>.<span class="hljs-number"><span class="hljs-number">2</span></span>'s password: Last login: Tue Apr <span class="hljs-number"><span class="hljs-number">3</span></span> <span class="hljs-number"><span class="hljs-number">10</span></span>:<span class="hljs-number"><span class="hljs-number">21</span></span>:<span class="hljs-number"><span class="hljs-number">28</span></span> <span class="hljs-number"><span class="hljs-number">2012</span></span> from <span class="hljs-number"><span class="hljs-number">192</span></span>.<span class="hljs-number"><span class="hljs-number">168</span></span>.<span class="hljs-number"><span class="hljs-number">1</span></span>.<span class="hljs-number"><span class="hljs-number">5</span></span> $ uname -a Linux fedora16vm.localdomain <span class="hljs-number"><span class="hljs-number">3</span></span>.<span class="hljs-number"><span class="hljs-number">3</span></span>.<span class="hljs-number"><span class="hljs-number">0</span></span>-<span class="hljs-number"><span class="hljs-number">8</span></span>.fc16.i686 #<span class="hljs-number"><span class="hljs-number">1</span></span> SMP Thu Mar <span class="hljs-number"><span class="hljs-number">29</span></span> <span class="hljs-number"><span class="hljs-number">18</span></span>:<span class="hljs-number"><span class="hljs-number">33</span></span>:<span class="hljs-number"><span class="hljs-number">55</span></span> UTC <span class="hljs-number"><span class="hljs-number">2012</span></span> i686 i686 i386 GNU/Linux $ <span class="hljs-keyword"><span class="hljs-keyword">exit</span></span> logout Connection to <span class="hljs-number"><span class="hljs-number">192</span></span>.<span class="hljs-number"><span class="hljs-number">168</span></span>.<span class="hljs-number"><span class="hljs-number">50</span></span>.<span class="hljs-number"><span class="hljs-number">2</span></span> closed. $</code> </pre><br>  With this newly created virtual interface, you can do a lot of exciting experiments in a wide variety of network configurations! <br><br><h1>  What's next? </h1><br>  An astute reader, even if he carefully read the previous text, has the right to exclaim in this place: ‚ÄúBut your virtual interface does not complement, but replaces the parent interface?‚Äù.  Yes, in the shown variant exactly like this: loading such a module <b>prohibits</b> traffic on the parent interface, but unloading the module again <b>restores</b> it. <br><br>  This misfortune is easy to help.  In order for the newly created virtual network interface to work independently <b>in addition</b> to the parent one, it is necessary: <br><ul><li>  In filters (both reception and transmission), analyze the IP address field in the socket buffer structure and replace the interface only for IP belonging to the virtual interface. </li><li>  At the reception, we should separate the processing of socket buffers corresponding to the IP and ARP protocols, because the data structures of these protocols, of course, differ (field struct sk_buff * -&gt; protocol). </li></ul><br>  It may seem complicated in the verbal description, but in the module code everything is quite simple, and adds no more than 25 lines of code.  And this option is given in the archive of examples (virt-full subdirectory, this code is not given here, so as not to overload the text): <br><pre> <code class="dos hljs">$ <span class="hljs-built_in"><span class="hljs-built_in">ping</span></span> <span class="hljs-number"><span class="hljs-number">192</span></span>.<span class="hljs-number"><span class="hljs-number">168</span></span>.<span class="hljs-number"><span class="hljs-number">50</span></span>.<span class="hljs-number"><span class="hljs-number">2</span></span> <span class="hljs-built_in"><span class="hljs-built_in">PING</span></span> <span class="hljs-number"><span class="hljs-number">192</span></span>.<span class="hljs-number"><span class="hljs-number">168</span></span>.<span class="hljs-number"><span class="hljs-number">50</span></span>.<span class="hljs-number"><span class="hljs-number">2</span></span> (<span class="hljs-number"><span class="hljs-number">192</span></span>.<span class="hljs-number"><span class="hljs-number">168</span></span>.<span class="hljs-number"><span class="hljs-number">50</span></span>.<span class="hljs-number"><span class="hljs-number">2</span></span>) <span class="hljs-number"><span class="hljs-number">56</span></span>(<span class="hljs-number"><span class="hljs-number">84</span></span>) bytes of data. <span class="hljs-number"><span class="hljs-number">64</span></span> bytes from <span class="hljs-number"><span class="hljs-number">192</span></span>.<span class="hljs-number"><span class="hljs-number">168</span></span>.<span class="hljs-number"><span class="hljs-number">50</span></span>.<span class="hljs-number"><span class="hljs-number">2</span></span>: icmp_req=<span class="hljs-number"><span class="hljs-number">1</span></span> ttl=<span class="hljs-number"><span class="hljs-number">64</span></span> <span class="hljs-built_in"><span class="hljs-built_in">time</span></span>=<span class="hljs-number"><span class="hljs-number">0</span></span>.<span class="hljs-number"><span class="hljs-number">473</span></span> ms <span class="hljs-number"><span class="hljs-number">64</span></span> bytes from <span class="hljs-number"><span class="hljs-number">192</span></span>.<span class="hljs-number"><span class="hljs-number">168</span></span>.<span class="hljs-number"><span class="hljs-number">50</span></span>.<span class="hljs-number"><span class="hljs-number">2</span></span>: icmp_req=<span class="hljs-number"><span class="hljs-number">2</span></span> ttl=<span class="hljs-number"><span class="hljs-number">64</span></span> <span class="hljs-built_in"><span class="hljs-built_in">time</span></span>=<span class="hljs-number"><span class="hljs-number">0</span></span>.<span class="hljs-number"><span class="hljs-number">256</span></span> ms <span class="hljs-number"><span class="hljs-number">64</span></span> bytes from <span class="hljs-number"><span class="hljs-number">192</span></span>.<span class="hljs-number"><span class="hljs-number">168</span></span>.<span class="hljs-number"><span class="hljs-number">50</span></span>.<span class="hljs-number"><span class="hljs-number">2</span></span>: icmp_req=<span class="hljs-number"><span class="hljs-number">3</span></span> ttl=<span class="hljs-number"><span class="hljs-number">64</span></span> <span class="hljs-built_in"><span class="hljs-built_in">time</span></span>=<span class="hljs-number"><span class="hljs-number">0</span></span>.<span class="hljs-number"><span class="hljs-number">281</span></span> ms ^C --- <span class="hljs-number"><span class="hljs-number">192</span></span>.<span class="hljs-number"><span class="hljs-number">168</span></span>.<span class="hljs-number"><span class="hljs-number">50</span></span>.<span class="hljs-number"><span class="hljs-number">2</span></span> <span class="hljs-built_in"><span class="hljs-built_in">ping</span></span> statistics --- <span class="hljs-number"><span class="hljs-number">3</span></span> packets transmitted, <span class="hljs-number"><span class="hljs-number">3</span></span> received, <span class="hljs-number"><span class="hljs-number">0</span></span>% packet loss, <span class="hljs-built_in"><span class="hljs-built_in">time</span></span> <span class="hljs-number"><span class="hljs-number">1999</span></span>ms rtt min/avg/max/mdev = <span class="hljs-number"><span class="hljs-number">0</span></span>.<span class="hljs-number"><span class="hljs-number">256</span></span>/<span class="hljs-number"><span class="hljs-number">0</span></span>.<span class="hljs-number"><span class="hljs-number">336</span></span>/<span class="hljs-number"><span class="hljs-number">0</span></span>.<span class="hljs-number"><span class="hljs-number">473</span></span>/<span class="hljs-number"><span class="hljs-number">0</span></span>.<span class="hljs-number"><span class="hljs-number">099</span></span> ms $ <span class="hljs-built_in"><span class="hljs-built_in">ping</span></span> <span class="hljs-number"><span class="hljs-number">192</span></span>.<span class="hljs-number"><span class="hljs-number">168</span></span>.<span class="hljs-number"><span class="hljs-number">56</span></span>.<span class="hljs-number"><span class="hljs-number">101</span></span> <span class="hljs-built_in"><span class="hljs-built_in">PING</span></span> <span class="hljs-number"><span class="hljs-number">192</span></span>.<span class="hljs-number"><span class="hljs-number">168</span></span>.<span class="hljs-number"><span class="hljs-number">56</span></span>.<span class="hljs-number"><span class="hljs-number">101</span></span> (<span class="hljs-number"><span class="hljs-number">192</span></span>.<span class="hljs-number"><span class="hljs-number">168</span></span>.<span class="hljs-number"><span class="hljs-number">56</span></span>.<span class="hljs-number"><span class="hljs-number">101</span></span>) <span class="hljs-number"><span class="hljs-number">56</span></span>(<span class="hljs-number"><span class="hljs-number">84</span></span>) bytes of data. <span class="hljs-number"><span class="hljs-number">64</span></span> bytes from <span class="hljs-number"><span class="hljs-number">192</span></span>.<span class="hljs-number"><span class="hljs-number">168</span></span>.<span class="hljs-number"><span class="hljs-number">56</span></span>.<span class="hljs-number"><span class="hljs-number">101</span></span>: icmp_req=<span class="hljs-number"><span class="hljs-number">1</span></span> ttl=<span class="hljs-number"><span class="hljs-number">64</span></span> <span class="hljs-built_in"><span class="hljs-built_in">time</span></span>=<span class="hljs-number"><span class="hljs-number">2</span></span>.<span class="hljs-number"><span class="hljs-number">63</span></span> ms <span class="hljs-number"><span class="hljs-number">64</span></span> bytes from <span class="hljs-number"><span class="hljs-number">192</span></span>.<span class="hljs-number"><span class="hljs-number">168</span></span>.<span class="hljs-number"><span class="hljs-number">56</span></span>.<span class="hljs-number"><span class="hljs-number">101</span></span>: icmp_req=<span class="hljs-number"><span class="hljs-number">2</span></span> ttl=<span class="hljs-number"><span class="hljs-number">64</span></span> <span class="hljs-built_in"><span class="hljs-built_in">time</span></span>=<span class="hljs-number"><span class="hljs-number">0</span></span>.<span class="hljs-number"><span class="hljs-number">306</span></span> ms <span class="hljs-number"><span class="hljs-number">64</span></span> bytes from <span class="hljs-number"><span class="hljs-number">192</span></span>.<span class="hljs-number"><span class="hljs-number">168</span></span>.<span class="hljs-number"><span class="hljs-number">56</span></span>.<span class="hljs-number"><span class="hljs-number">101</span></span>: icmp_req=<span class="hljs-number"><span class="hljs-number">3</span></span> ttl=<span class="hljs-number"><span class="hljs-number">64</span></span> <span class="hljs-built_in"><span class="hljs-built_in">time</span></span>=<span class="hljs-number"><span class="hljs-number">0</span></span>.<span class="hljs-number"><span class="hljs-number">225</span></span> ms ^C --- <span class="hljs-number"><span class="hljs-number">192</span></span>.<span class="hljs-number"><span class="hljs-number">168</span></span>.<span class="hljs-number"><span class="hljs-number">56</span></span>.<span class="hljs-number"><span class="hljs-number">101</span></span> <span class="hljs-built_in"><span class="hljs-built_in">ping</span></span> statistics --- <span class="hljs-number"><span class="hljs-number">3</span></span> packets transmitted, <span class="hljs-number"><span class="hljs-number">3</span></span> received, <span class="hljs-number"><span class="hljs-number">0</span></span>% packet loss, <span class="hljs-built_in"><span class="hljs-built_in">time</span></span> <span class="hljs-number"><span class="hljs-number">2002</span></span>ms rtt min/avg/max/mdev = <span class="hljs-number"><span class="hljs-number">0</span></span>.<span class="hljs-number"><span class="hljs-number">225</span></span>/<span class="hljs-number"><span class="hljs-number">1</span></span>.<span class="hljs-number"><span class="hljs-number">053</span></span>/<span class="hljs-number"><span class="hljs-number">2</span></span>.<span class="hljs-number"><span class="hljs-number">630</span></span>/<span class="hljs-number"><span class="hljs-number">1</span></span>.<span class="hljs-number"><span class="hljs-number">115</span></span> ms $ dmesg | tail -n19 [<span class="hljs-number"><span class="hljs-number">58382</span></span>.<span class="hljs-number"><span class="hljs-number">498200</span></span>] virt0: no IPv6 routers present [<span class="hljs-number"><span class="hljs-number">58391</span></span>.<span class="hljs-number"><span class="hljs-number">368273</span></span>] device virt0 entered promiscuous <span class="hljs-built_in"><span class="hljs-built_in">mode</span></span> [<span class="hljs-number"><span class="hljs-number">58409</span></span>.<span class="hljs-number"><span class="hljs-number">904046</span></span>] ! rx: IP4 to IP=<span class="hljs-number"><span class="hljs-number">192</span></span>.<span class="hljs-number"><span class="hljs-number">168</span></span>.<span class="hljs-number"><span class="hljs-number">50</span></span>.<span class="hljs-number"><span class="hljs-number">2</span></span> [<span class="hljs-number"><span class="hljs-number">58409</span></span>.<span class="hljs-number"><span class="hljs-number">904050</span></span>] ! rx: injecting frame from p7p1 to virt0 [<span class="hljs-number"><span class="hljs-number">58409</span></span>.<span class="hljs-number"><span class="hljs-number">904197</span></span>] ! tx: injecting frame from virt0 to p7p1 [<span class="hljs-number"><span class="hljs-number">58409</span></span>.<span class="hljs-number"><span class="hljs-number">904212</span></span>] ! rx: ARP <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> <span class="hljs-number"><span class="hljs-number">192</span></span>.<span class="hljs-number"><span class="hljs-number">168</span></span>.<span class="hljs-number"><span class="hljs-number">50</span></span>.<span class="hljs-number"><span class="hljs-number">2</span></span> [<span class="hljs-number"><span class="hljs-number">58409</span></span>.<span class="hljs-number"><span class="hljs-number">904214</span></span>] ! rx: injecting frame from p7p1 to virt0 [<span class="hljs-number"><span class="hljs-number">58409</span></span>.<span class="hljs-number"><span class="hljs-number">904262</span></span>] ! tx: injecting frame from virt0 to p7p1 [<span class="hljs-number"><span class="hljs-number">58410</span></span>.<span class="hljs-number"><span class="hljs-number">903427</span></span>] ! rx: IP4 to IP=<span class="hljs-number"><span class="hljs-number">192</span></span>.<span class="hljs-number"><span class="hljs-number">168</span></span>.<span class="hljs-number"><span class="hljs-number">50</span></span>.<span class="hljs-number"><span class="hljs-number">2</span></span> [<span class="hljs-number"><span class="hljs-number">58410</span></span>.<span class="hljs-number"><span class="hljs-number">903431</span></span>] ! rx: injecting frame from p7p1 to virt0 [<span class="hljs-number"><span class="hljs-number">58410</span></span>.<span class="hljs-number"><span class="hljs-number">903531</span></span>] ! tx: injecting frame from virt0 to p7p1 [<span class="hljs-number"><span class="hljs-number">58411</span></span>.<span class="hljs-number"><span class="hljs-number">903447</span></span>] ! rx: IP4 to IP=<span class="hljs-number"><span class="hljs-number">192</span></span>.<span class="hljs-number"><span class="hljs-number">168</span></span>.<span class="hljs-number"><span class="hljs-number">50</span></span>.<span class="hljs-number"><span class="hljs-number">2</span></span> [<span class="hljs-number"><span class="hljs-number">58411</span></span>.<span class="hljs-number"><span class="hljs-number">903451</span></span>] ! rx: injecting frame from p7p1 to virt0 [<span class="hljs-number"><span class="hljs-number">58411</span></span>.<span class="hljs-number"><span class="hljs-number">903547</span></span>] ! tx: injecting frame from virt0 to p7p1 [<span class="hljs-number"><span class="hljs-number">58414</span></span>.<span class="hljs-number"><span class="hljs-number">694485</span></span>] ! rx: ARP <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> <span class="hljs-number"><span class="hljs-number">192</span></span>.<span class="hljs-number"><span class="hljs-number">168</span></span>.<span class="hljs-number"><span class="hljs-number">56</span></span>.<span class="hljs-number"><span class="hljs-number">101</span></span> [<span class="hljs-number"><span class="hljs-number">58414</span></span>.<span class="hljs-number"><span class="hljs-number">696846</span></span>] ! rx: IP4 to IP=<span class="hljs-number"><span class="hljs-number">192</span></span>.<span class="hljs-number"><span class="hljs-number">168</span></span>.<span class="hljs-number"><span class="hljs-number">56</span></span>.<span class="hljs-number"><span class="hljs-number">101</span></span> [<span class="hljs-number"><span class="hljs-number">58415</span></span>.<span class="hljs-number"><span class="hljs-number">696508</span></span>] ! rx: IP4 to IP=<span class="hljs-number"><span class="hljs-number">192</span></span>.<span class="hljs-number"><span class="hljs-number">168</span></span>.<span class="hljs-number"><span class="hljs-number">56</span></span>.<span class="hljs-number"><span class="hljs-number">101</span></span> [<span class="hljs-number"><span class="hljs-number">58416</span></span>.<span class="hljs-number"><span class="hljs-number">696572</span></span>] ! rx: IP4 to IP=<span class="hljs-number"><span class="hljs-number">192</span></span>.<span class="hljs-number"><span class="hljs-number">168</span></span>.<span class="hljs-number"><span class="hljs-number">56</span></span>.<span class="hljs-number"><span class="hljs-number">101</span></span> [<span class="hljs-number"><span class="hljs-number">58419</span></span>.<span class="hljs-number"><span class="hljs-number">712245</span></span>] ! rx: ARP <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> <span class="hljs-number"><span class="hljs-number">192</span></span>.<span class="hljs-number"><span class="hljs-number">168</span></span>.<span class="hljs-number"><span class="hljs-number">56</span></span>.<span class="hljs-number"><span class="hljs-number">101</span></span></code> </pre><br>  Archive codes for further experimentation can take <a href="https://yadi.sk/d/F-Lx6t66kBK8s">here</a> or <a href="https://drive.google.com/file/d/0B__cqmYoRw_6dDJvUEZmUFBoekE/view%3Fusp%3Dsharing">here</a> . </div><p>Source: <a href="https://habr.com/ru/post/269987/">https://habr.com/ru/post/269987/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../269973/index.html">A series of webinars on working with data</a></li>
<li><a href="../269975/index.html">Microsoft events for IT professionals in November</a></li>
<li><a href="../269981/index.html">PG as Perl evolution for mathematicians at WeBWorK</a></li>
<li><a href="../269983/index.html">A simple generator of the DGML file of the state machine transition graph</a></li>
<li><a href="../269985/index.html">Writing our SynchronizationContext</a></li>
<li><a href="../269989/index.html">Solving the problem of installing GitHub for Windows with Amazon Web Services S3</a></li>
<li><a href="../269991/index.html">Practical application of Fourier transform for signal analysis. Introduction for beginners</a></li>
<li><a href="../269993/index.html">JSON for fans of braces</a></li>
<li><a href="../269995/index.html">Cloud for development companies: BadgeKeeper Achievement System Designer - Developer Service</a></li>
<li><a href="../269997/index.html">October 31, 2015 - EOL applications for Kerio Control 7 for Windows (Post # 3 - free webinar (November 13, 2015)</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>