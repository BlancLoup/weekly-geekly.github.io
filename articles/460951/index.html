<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Create Android Live Wallpapers</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="I need to display on the phone screen technical information about his condition, more precisely, about his condition in the test pool. I always want t...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Create Android Live Wallpapers</h1><div class="post__text post__text-html js-mediator-article"><p>  I need to display on the phone screen technical information about his condition, more precisely, about his condition in the test pool.  I always want to see this information, that is, on the Home screen, and without additional body movements. </p><br><p>  There are only two ways that will not affect the execution of other applications: Widget or Live wallpaper.  I chose Live wallpaper, they are also ‚Äúlive wallpapers‚Äù because they automatically get to all pages of the Home screen, and even to the Lock screen.  This article provides practical guidance on how to create live wallpapers. </p><a name="habracut"></a><br><h3 id="v-poiskah-pravdy">  In search of the truth </h3><br><p>  Documentation about the "live wallpaper" cat cried.  Since the first (and only) <a href="https://android-developers.googleblog.com/2010/02/live-wallpapers.html">announcement on the blog</a> that happened more than 9 years ago, Google has not made a single intelligible example or codelab on this topic.  I had to understand. </p><br><p>  First basics.  The internal mechanics of Android is such that we can only install the application on the device, and the device of all applications is the same.  Since "live wallpaper" is also an application, the choice of a control component is not great, and we should expect that it will be Service.  Finding it is easy: it's <a href="https://developer.android.com/reference/android/service/wallpaper/WallpaperService.html">WallpaperService</a> . </p><br><p>  There may be several instances of ‚Äúlive wallpaper‚Äù, and their life cycle will be different from that of Activity or View.  Accordingly, there should be one more base class.  This is <a href="https://developer.android.com/reference/android/service/wallpaper/WallpaperService.Engine.html">WallpaperService.Engine</a> (and it is necessarily <em>inner</em> for <a href="https://developer.android.com/reference/android/service/wallpaper/WallpaperService.html">WallpaperService</a> !).  If you look closely, it will turn out to be the same provider of life cycle events as Activity, Service and others like them. </p><br><p>  The life cycle of "live wallpaper" looks like this: </p><br><p>  <a href="https://developer.android.com/reference/android/service/wallpaper/WallpaperService.Engine.html">onCreate (SurfaceHolder surfaceHolder)</a> <br>  <a href="https://developer.android.com/reference/android/service/wallpaper/WallpaperService.Engine.html">onSurfaceCreated (SurfaceHolder holder)</a> <br>  <a href="https://developer.android.com/reference/android/service/wallpaper/WallpaperService.Engine.html">onSurfaceChanged (SurfaceHolder holder, int format, int width, int height)</a> <br>  <a href="https://developer.android.com/reference/android/service/wallpaper/WallpaperService.Engine.html">onVisibilityChanged (boolean visible)</a> <br>  <a href="https://developer.android.com/reference/android/service/wallpaper/WallpaperService.Engine.html">onSurfaceRedrawNeeded (SurfaceHolder holder)</a> <br>  <a href="https://developer.android.com/reference/android/service/wallpaper/WallpaperService.Engine.html">onSurfaceDestroyed (SurfaceHolder holder)</a> <br>  <a href="https://developer.android.com/reference/android/service/wallpaper/WallpaperService.Engine.html">onDestroy ()</a> </p><br><p>  From this list it becomes clear when you can / need to redraw the picture (or start redrawing if you have animation), and when it's time to stop all activity and not waste battery. </p><br><p> The <a href="https://developer.android.com/reference/android/service/wallpaper/WallpaperService.Engine.html">onSurfaceRedrawNeeded ()</a> method stands out from the rest, read below.  Also, there is an <a href="https://developer.android.com/reference/android/service/wallpaper/WallpaperService.Engine.html">isVisible ()</a> method to help (which in Kotlin turns into an <code>isVisible</code> property). </p><br><p>  Now you can build this constructor.  I'll start from the end. </p><br><h3 id="risuem">  Draw </h3><br><p>  We will have to draw ourselves on <a href="https://developer.android.com/reference/android/graphics/Canvas.html">Canvas</a> , we will not have any layout and inflater.  How to get <a href="https://developer.android.com/reference/android/graphics/Canvas.html">Canvas</a> from <a href="https://developer.android.com/reference/android/view/SurfaceHolder.html">SurfaceHolder</a> and how to draw on it is beyond the scope of this article, there is a simple example below. </p><br><pre> <code class="kotlin hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">dummyDraw</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(c: </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">Canvas</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span></span> { c.save() c.drawColor(Color.CYAN) c.restore() } <span class="hljs-comment"><span class="hljs-comment">// surfaceHolder property is actually a call to the getSurfaceHolder() method fun drawSynchronously() = drawSynchronously(surfaceHolder) fun drawSynchronously(holder: SurfaceHolder) { if (!isVisible) return var c: Canvas? = null try { c = holder.lockCanvas() c?.let { dummyDraw(it) } } finally { c?.let { holder.unlockCanvasAndPost(it) } } }</span></span></code> </pre><br><h3 id="metody-zhiznennogo-cikla-engine">  Engine Life Cycle Methods </h3><br><p>  All lifecycle methods except <code>onSurfaceRedrawNeeded</code> do not require immediate redrawing.  Therefore, a good tone would be to redraw the queue. </p><br><pre> <code class="kotlin hljs"><span class="hljs-keyword"><span class="hljs-keyword">override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onSurfaceCreated</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(holder: </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">SurfaceHolder</span></span></span></span><span class="hljs-function"><span class="hljs-params">?)</span></span></span></span> { <span class="hljs-keyword"><span class="hljs-keyword">super</span></span>.onSurfaceCreated(holder) redrawHandler.planRedraw() } <span class="hljs-keyword"><span class="hljs-keyword">override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onSurfaceChanged</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(holder: </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">SurfaceHolder</span></span></span></span><span class="hljs-function"><span class="hljs-params">?, format: </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">Int</span></span></span></span><span class="hljs-function"><span class="hljs-params">, width: </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">Int</span></span></span></span><span class="hljs-function"><span class="hljs-params">, height: </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">Int</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span></span> { <span class="hljs-keyword"><span class="hljs-keyword">super</span></span>.onSurfaceChanged(holder, format, width, height) redrawHandler.planRedraw() } <span class="hljs-keyword"><span class="hljs-keyword">override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onVisibilityChanged</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(visible: </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">Boolean</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span></span> { <span class="hljs-keyword"><span class="hljs-keyword">super</span></span>.onVisibilityChanged(visible) redrawHandler.planRedraw() } <span class="hljs-keyword"><span class="hljs-keyword">override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onSurfaceDestroyed</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(holder: </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">SurfaceHolder</span></span></span></span><span class="hljs-function"><span class="hljs-params">?)</span></span></span></span> { <span class="hljs-keyword"><span class="hljs-keyword">super</span></span>.onSurfaceDestroyed(holder) redrawHandler.omitRedraw() } <span class="hljs-keyword"><span class="hljs-keyword">override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onDestroy</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span> { <span class="hljs-keyword"><span class="hljs-keyword">super</span></span>.onDestroy() redrawHandler.omitRedraw() } <span class="hljs-keyword"><span class="hljs-keyword">override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onSurfaceRedrawNeeded</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(holder: </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">SurfaceHolder</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span></span> { <span class="hljs-keyword"><span class="hljs-keyword">super</span></span>.onSurfaceRedrawNeeded(holder) redrawHandler.omitRedraw() drawSynchronously(holder) <span class="hljs-comment"><span class="hljs-comment">// do it immediately, don't plan }</span></span></code> </pre> <br><p>  Pay attention to <a href="https://developer.android.com/reference/android/service/wallpaper/WallpaperService.Engine.html">onSurfaceRedrawNeeded</a> , which gives us a call to <a href="https://developer.android.com/reference/android/view/SurfaceHolder.Callback2.html">the SurfaceHolder callback of the same name</a> , which occurs when resizing and similar events.  This callback allows you to redraw immediately, without allowing the user to display the old (and already incorrect) picture.  The system ensures that until a return from this method has occurred, the output to the screen will be paused. </p><br><h3 id="scheduler">  Scheduler </h3><br><p>  I like to redefine Handler, and not to run Runnable in it.  In my opinion, so elegant. </p><br><p>  In case you have animation or regular updates, you will need to make a regular queuing of the message ( <a href="https://developer.android.com/reference/android/os/Handler.html">postAtTime ()</a> and <a href="https://developer.android.com/reference/android/os/Handler.html">postDelayed ()</a> to help you).  If the data is updated occasionally, just call <code>planRedraw()</code> to update it. </p><br><pre> <code class="kotlin hljs"><span class="hljs-keyword"><span class="hljs-keyword">val</span></span> redrawHandler = RedrawHandler() <span class="hljs-keyword"><span class="hljs-keyword">inner</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">RedrawHandler</span></span></span><span class="hljs-class"> : </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Handler</span></span></span></span>(Looper.getMainLooper()) { <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> redraw = <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">omitRedraw</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span> { removeMessages(redraw) } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">planRedraw</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span> { omitRedraw() sendEmptyMessage(redraw) } <span class="hljs-keyword"><span class="hljs-keyword">override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">handleMessage</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(msg: </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">Message</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span></span> { <span class="hljs-keyword"><span class="hljs-keyword">when</span></span> (msg.what) { redraw -&gt; drawSynchronously() <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> -&gt; <span class="hljs-keyword"><span class="hljs-keyword">super</span></span>.handleMessage(msg) } } }</code> </pre> <br><h3 id="service--engine">  Service &amp; engine </h3><br><p>  This mareshka from Service and Engine is assembled like this: </p><br><pre> <code class="kotlin hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">FooBarWallpaperService</span></span></span><span class="hljs-class"> : </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">WallpaperService</span></span></span></span>() { <span class="hljs-keyword"><span class="hljs-keyword">override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onCreateEngine</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span> = FooBarEngine() <span class="hljs-keyword"><span class="hljs-keyword">inner</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">FooBarEngine</span></span></span><span class="hljs-class"> : </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Engine</span></span></span></span>() { .... } }</code> </pre> <br><h3 id="androidmanifest-i-drugie-zaklinaniya">  AndroidManifest and other spells </h3><br><p>  I call spells in software development that it is impossible to understand, but it is necessary to repeat exactly. </p><br><p>  In <code>.../app/src/main/res/xml</code> must be an XML file with a description of "live wallpaper".  The name of this file must be specified in AndroidManifest (look for the word <code>foobarwallpaper</code> in the example below) </p><br><pre> <code class="xml hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">wallpaper</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:android</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://schemas.android.com/apk/res/android"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:thumbnail</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"@drawable/some_drawable_preview"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:description</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"@string/wallpaper_description"</span></span></span><span class="hljs-tag"> /&gt;</span></span></code> </pre> <br><p>  Do not lose <code>permission</code> , <code>meta-data</code> and <code>intent-filter</code> in the description of the Service: </p><br><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">service</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">".FooBarWallpaperService"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:enabled</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"true"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:label</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Wallpaper Example"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:permission</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"android.permission.BIND_WALLPAPER"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">meta-data</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"android.service.wallpaper"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:resource</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"@xml/foobarwallpaper"</span></span></span><span class="hljs-tag"> &gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">meta-data</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">intent-filter</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">action</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"android.service.wallpaper.WallpaperService"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">action</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">intent-filter</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">service</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br><h3 id="kak-dobavit">  How to add </h3><br><p>  "Live wallpapers" are hiding, therefore a hint.  I describe how it looks on my Samsung. </p><br><p>  To start, long press somewhere on the Home screen, the phone will go into the desktop settings mode, the <em>Wallpapers</em> icon will appear. </p><br><p>  We click on the <em>Wallpapers</em> icon, several sections, we need <em>My wallpapers</em> , click on the inscription <em>View all</em> in the upper right corner of the section, the list opens in full screen. </p><br><p>  We press the "three points" of the menu call, in it the <em>LIve wallpapers</em> item (I have one), a list of available "live wallpapers" appears. </p><br><p>  Select our wallpaper, and select "Home and lock screen". </p><br><p>  A ‚Äúpreview‚Äù will appear, which is already being drawn by our application (to recognize this moment, there is the <a href="https://developer.android.com/reference/android/service/wallpaper/WallpaperService.Engine.html">isPreview ()</a> method), click <em>Set as wallpaper</em> ... And we don‚Äôt see anything, because we return to the list of available wallpapers. </p><br><p>  Click "Home" and enjoy. </p><br><h3 id="prichem-tut-android-watch">  And then Android Watch ?! </h3><br><p>  An interesting observation along the way is that Faces in Android Watch are made in exactly the same way (with the accuracy that they have their own base classes with their own implementation): the same <a href="https://developer.android.com/training/wearables/watch-faces/service">Service + Engine</a> , almost the same <a href="https://developer.android.com/training/wearables/watch-faces/service">metadata and intent filter for Service in the manifest</a> (in which the word wallpaper occurs four times :), you also need <a href="https://developer.android.com/training/wearables/watch-faces/drawing">to write your own sheduler based on Handler</a> . </p><br><p>  In the base classes of <em>Watch Faces</em> there is a ready-made <code>onDraw()</code> , where Canvas is passed to, and there is <code>invalidate()</code> for calling it.  But this is not a fundamental difference, but the implemented part of the boilerplate. </p><br><p>  Unlike Live Wallpaper, there are examples for Watch Faces, you can dig into them (links <a href="https://developer.android.com/training/wearables/watch-faces/service">here</a> , at the very beginning). </p><br><h3 id="chto-poluchilos">  What happened </h3><br><p>  Screenshots for an application that paints a green screen make little sense.  But a couple of pictures that based on this turned out to be done for the combat stand, under the spoiler. </p><br><div class="spoiler">  <b class="spoiler_title">A couple of pictures</b> <div class="spoiler_text"><p><img src="https://habrastorage.org/webt/a8/6z/jf/a86zjfmyavmfyyhpwsm6fhi6hau.jpeg"><br><img src="https://habrastorage.org/webt/h8/cu/1-/h8cu1-cyot8nvehv6srjhc03xuk.jpeg"></p><br><p>  Stickers are the remaining problem detection system of the previous generation. </p></div></div><br><h3 id="blagodarnosti">  Acknowledgments </h3><br><p>  If not for these two articles, I would have wandered in the darkness much longer.  I can‚Äôt imagine how they could have been written already in 2010 with such quality documentation ?! </p><br><p>  <a href="https://www.pushing-pixels.org/2010/02/01/live-wallpapers-with-android-sdk-2-1.html">Kirill Grouchnikov, Live wallpapers</a> <br>  <a href="https://www.vogella.com/tutorials/AndroidLiveWallpaper/article.html">Vogella, Android Live Wallpaper - Tutorial</a> </p><br><h3 id="ishodniki">  Source code </h3><br><p>  ‚Üí <a href="https://github.com/JollyDroidNotebook/live_wallpaper_lab">GitHub</a> </p></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <p>Source: <a href="https://habr.com/ru/post/460951/">https://habr.com/ru/post/460951/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../460939/index.html">Longrid on the history of Russian mining and the relationship of regulators to it</a></li>
<li><a href="../460941/index.html">Business Email Compromise: No Defense Against Attack</a></li>
<li><a href="../460943/index.html">How to choose promising keys for SEO based on scenario forecasting in Google Data Studio (+ template)</a></li>
<li><a href="../460945/index.html">Experience in using a telegram channel to increase recognition and revenue growth of a gaming studio</a></li>
<li><a href="../460947/index.html">WASM Meet Up 1/08</a></li>
<li><a href="../460953/index.html">Pointers are complex, or what is stored in a byte?</a></li>
<li><a href="../460955/index.html">Educational program for passing parameters by value to constructors and setters (modern C ++, examples)</a></li>
<li><a href="../460959/index.html">Microsoft's new technology allows 3D copies of a real person to speak any language</a></li>
<li><a href="../46096/index.html">Play Pong ... with your browser windows!</a></li>
<li><a href="../460961/index.html">Setting up Unit tests in mixed Swift + Objective-C projects</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>