<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>IMAPSync. Transfer mail between servers</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In this article, I want to share the experience of transferring mail between different servers using the wonderful IMAPSync utility. 

 - Getting IMAP...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>IMAPSync. Transfer mail between servers</h1><div class="post__text post__text-html js-mediator-article">  In this article, I want to share the experience of transferring mail between different servers using the wonderful <b>IMAPSync</b> utility. <br><br>  - Getting IMAPSync.exe from github sources (compiled under Windows). <br>  - Transfer mail via IMAP between servers. <br><br>  In my case, the challenge was to transfer mail from my IDECO server to the pdd.yandex.ru server.  I could not do this with Yandex tools, the import tool for the domain and the mail collection tool in the mailbox properties always gave one error - the wrong password.  Technical support answered once a day, but the problem was not solved.  There were recommendations to change the password, wait, disable two-factor authentication, etc.  In general, standard replies, unfortunately.  I did not want to use biz.mail.ru, which perfectly imported everything on the test boxes.  Since I have more experience with Yandex, and more like the work of mail from Yandex, it was decided to find another way to transfer mail.  They became IMAPSync. <br><a name="habracut"></a><br>  We start, provided that we have created empty (or not so) boxes on the destination server with the logins and passwords we need. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h3>  Compiling IMAPSync.exe from source for Windows </h3><br><ol><li>  Prepare tools for compilation: <br>  For example, we will use the path "D: \ IMAPSync \" <br><br>  Download the latest version of IMAPSync from <a href="https://github.com/imapsync/imapsync">github</a> , using the example of <a href="">IMAPSync v1.678</a> <br>  Unpack the archive in D: \ IMAPSync \ imapsync-1.678 \ *. * <br>  Copy the imapsync file from D: \ IMAPSync \ imapsync-1.678 \ to D: \ IMAPSync \ imapsync-1.678 \ W \ <br><br>  Download <a href="http://strawberryperl.com/releases.html">Strawberry-perl</a> , on the example of the version <a href="">Strawberry-perl-5.22.2.1-32bit-portable.zip</a> <br><div class="spoiler">  <b class="spoiler_title">Read more about different versions and problems.</b> <div class="spoiler_text">  Successful installation of packages and compilation IMAPSync tested on versions: <br><pre><code class="html hljs xml">strawberry-perl-5.20.3.3-32bit-portable strawberry-perl-5.22.1.3-32bit-portable strawberry-perl-5.22.2.1-32bit-portable</code> </pre> <br>  Errors found on versions: <br><pre> <code class="dos hljs">strawberry-perl-<span class="hljs-number"><span class="hljs-number">5</span></span>.<span class="hljs-number"><span class="hljs-number">24</span></span>.<span class="hljs-number"><span class="hljs-number">0</span></span>.<span class="hljs-number"><span class="hljs-number">1</span></span>-<span class="hljs-number"><span class="hljs-number">32</span></span>bit-portable (  ppm install Unicode::String)</code> </pre></div></div>  Unpack the archive in D: \ IMAPSync \ strawberry-perl-5.22.2.1-32bit-portable \ *. * <br>  Run D: \ IMAPSync \ strawberry-perl-5.22.2.1-32bit-portable \ portableshell.bat <br><br>  The command line will appear (the perl environment variables are already configured here), in it we run <br><pre> <code class="html hljs xml">ppm install Unicode::String D:\IMAPSync\imapsync-1.678\W\install_modules.bat</code> </pre><br>  At this stage, the firewall (firewall) may request to open access for the application ‚ÄúD: \ IMAPSync \ strawberry-perl-5.22.2.1-32bit-portable \ perl \ bin \ perl.exe‚Äù <br>  You must enable network access to successfully install the modules. <br><br>  We rerun the command for visual monitoring of errors. <br><pre> <code class="html hljs xml">D:\IMAPSync\imapsync-1.678\W\install_modules.bat</code> </pre><br>  We are convinced that all the modules are installed, there are no errors, you can proceed to compile. <br><br></li><li>  Run the compilation: <br><pre> <code class="html hljs xml">D:\IMAPSync\imapsync-1.678\W\build_exe.bat</code> </pre><br>  On exit we get imapsync.exe - we run it in the same command line window and check that it should show help: <br><div class="spoiler">  <b class="spoiler_title">Result.</b>  <b class="spoiler_title">Help for all parameters</b> <div class="spoiler_text"><pre> <code class="html hljs xml"> Several options are mandatory. str means string int means integer reg means regular expression cmd means command --dry : Makes imapsync doing nothing, just print what would be done without --dry. --host1 str : Source or "from" imap server. Mandatory. --port1 int : Port to connect on host1. Default is 143, 993 if --ssl1 --user1 str : User to login on host1. Mandatory. --showpasswords : Shows passwords on output instead of "MASKED". Useful to restart a complete run by just reading the log. --password1 str : Password for the user1. --host2 str : "destination" imap server. Mandatory. --port2 int : Port to connect on host2. Default is 143, 993 if --ssl2 --user2 str : User to login on host2. Mandatory. --password2 str : Password for the user2. --passfile1 str : Password file for the user1. It must contain the password on the first line. This option avoids to show the password on the command line like --password1 does. --passfile2 str : Password file for the user2. Contains the password. --ssl1 : Use a SSL connection on host1. --ssl2 : Use a SSL connection on host2. --tls1 : Use a TLS connection on host1. --tls2 : Use a TLS connection on host2. --debugssl int : SSL debug mode from 0 to 4. --timeout1 int : Connection timeout in seconds for host1. Default is 120 and 0 means no timeout at all. --timeout2 int : Connection timeout in seconds for host2. Default is 120 and 0 means no timeout at all. --authmech1 str : Auth mechanism to use with host1: PLAIN, LOGIN, CRAM-MD5 etc. Use UPPERCASE. --authmech2 str : Auth mechanism to use with host2. See --authmech1 --authuser1 str : User to auth with on host1 (admin user). Avoid using --authmech1 SOMETHING with --authuser1. --authuser2 str : User to auth with on host2 (admin user). --proxyauth1 : Use proxyauth on host1. Requires --authuser1. Required by Sun/iPlanet/Netscape IMAP servers to be able to use an administrative user. --proxyauth2 : Use proxyauth on host2. Requires --authuser2. --authmd51 : Use MD5 authentification for host1. --authmd52 : Use MD5 authentification for host2. --domain1 str : Domain on host1 (NTLM authentication). --domain2 str : Domain on host2 (NTLM authentication). --folder str : Sync this folder. --folder str : and this one, etc. --folderrec str : Sync this folder recursively. --folderrec str : and this one, etc. --folderfirst str : Sync this folder first. --folderfirst "Work" --folderfirst str : then this one, etc. --folderlast str : Sync this folder last. --folderlast "[Gmail]/All Mail" --folderlast str : then this one, etc. --nomixfolders : Do not merge folders when host1 is case sensitive while host2 is not (like Exchange). Only the first similar folder is synced (ex: Sent SENT sent -&gt; Sent). --skipemptyfolders : Empty host1 folders are not created on host2. --include reg : Sync folders matching this regular expression --include reg : or this one, etc. in case both --include --exclude options are use, include is done before. --exclude reg : Skips folders matching this regular expression Several folders to avoid: --exclude 'fold1|fold2|f3' skips fold1, fold2 and f3. --exclude reg : or this one, etc. --subfolder2 str : Move whole host1 folders hierarchy under this host2 folder str . It does it by adding two --regextrans2 options before all others. Add --debug to see what's really going on. --automap : guesses folders mapping, for folders like "Sent", "Junk", "Drafts", "All", "Archive", "Flagged". --f1f2 str1=str2 : Force folder str1 to be synced to str2, --f1f2 overrides --automap and --regextrans2. --regextrans2 reg : Apply the whole regex to each destination folders. --regextrans2 reg : and this one. etc. When you play with the --regextrans2 option, first add also the safe options --dry --justfolders Then, when happy, remove --dry, remove --justfolders. Have in mind that --regextrans2 is applied after prefix and separator inversion. For examples see http://imapsync.lamiral.info/FAQ.d/FAQ.Folders_Mapping.txt --tmpdir str : Where to store temporary files and subdirectories. Will be created if it doesn't exist. Default is system specific, Unix is /tmp but it's often small and deleted at reboot. --tmpdir /var/tmp should be better. --pidfile str : The file where imapsync pid is written. --pidfilelocking : Abort if pidfile already exists. Usefull to avoid concurrent transfers on the same mailbox. --nolog : Turn off logging on file --logfile str : Change the default log filename (can be dirname/filename). --logdir str : Change the default log directory. Default is LOG_imapsync --prefix1 str : Remove prefix to all destination folders (usually INBOX. or INBOX/ or an empty string "") you have to use --prefix1 if host1 imap server does not have NAMESPACE capability, so imapsync suggests to use it. All other cases are bad. --prefix2 str : Add prefix to all host2 folders. See --prefix1 --sep1 str : Host1 separator in case NAMESPACE is not supported. --sep2 str : Host2 separator in case NAMESPACE is not supported. --skipmess reg : Skips messages maching the regex. Example: 'm/[\x80-ff]/' # to avoid 8bits messages. --skipmess is applied before --regexmess --skipmess reg : or this one, etc. --pipemess cmd : Apply this cmd command to each message content before the copy. --pipemess cmd : and this one, etc. --disarmreadreceipts : Disarms read receipts (host2 Exchange issue) --regexmess reg : Apply the whole regex to each message before transfer. Example: 's/\000/ /g' # to replace null by space. --regexmess reg : and this one, etc. --regexflag reg : Apply the whole regex to each flags list. Example: 's/"Junk"//g' # to remove "Junk" flag. --regexflag reg : and this one, etc. --delete : Deletes messages on host1 server after a successful transfer. Option --delete has the following behavior: it marks messages as deleted with the IMAP flag \Deleted, then messages are really deleted with an EXPUNGE IMAP command. --delete2 : Delete messages in host2 that are not in host1 server. Useful for backup or pre-sync. --delete2duplicates : Delete messages in host2 that are duplicates. Works only without --useuid since duplicates are detected with an header part of each message. --delete2folders : Delete folders in host2 that are not in host1 server. For safety, first try it like this (it is safe): --delete2folders --dry --justfolders --nofoldersizes --delete2foldersonly reg : Deleted only folders matching regex. Example: --delete2foldersonly "/^Junk$|^INBOX.Junk$/" --delete2foldersbutnot reg : Do not delete folders matching regex. Example: --delete2foldersbutnot "/Tasks$|Contacts$|Foo$/" --noexpunge : Do not expunge messages on host1. Expunge really deletes messages marked deleted. Expunge is made at the beginning, on host1 only. Newly transferred messages are also expunged if option --delete is given. No expunge is done on host2 account (unless --expunge2) --expunge1 : Expunge messages on host1 after messages transfer. --expunge2 : Expunge messages on host2 after messages transfer. --uidexpunge2 : uidexpunge messages on the host2 account that are not on the host1 account, requires --delete2 --nomixfolders : Avoid merging folders that are considered different on host1 but the same on destination host2 because of case sensitivities and insensitivities. --syncinternaldates : Sets the internal dates on host2 same as host1. Turned on by default. Internal date is the date a message arrived on a host (mtime). --idatefromheader : Sets the internal dates on host2 same as the "Date:" headers. --maxsize int : Skip messages larger (or equal) than int bytes --minsize int : Skip messages smaller (or equal) than int bytes --maxage int : Skip messages older than int days. final stats (skipped) don't count older messages see also --minage --minage int : Skip messages newer than int days. final stats (skipped) don't count newer messages You can do (+ are the messages selected): past|----maxage+++++++++++++++&gt;now past|+++++++++++++++minage----&gt;now past|----maxage+++++minage----&gt;now (intersection) past|++++minage-----maxage++++&gt;now (union) --search str : Selects only messages returned by this IMAP SEARCH command. Applied on both sides. --search1 str : Same as --search for selecting host1 messages only. --search2 str : Same as --search for selecting host2 messages only. --search CRIT equals --search1 CRIT --search2 CRIT --exitwhenover int : Stop syncing when total bytes transferred reached. Gmail per day allows 2500000000 = 2.5 GB downloaded from Gmail as host2 500000000 = 500 MB uploaded to Gmail as host1. --maxlinelength int : skip messages with a line length longer than int bytes. RFC 2822 says it must be no more than 1000 bytes. --useheader str : Use this header to compare messages on both sides. Ex: Message-ID or Subject or Date. --useheader str and this one, etc. --subscribed : Transfers subscribed folders. --subscribe : Subscribe to the folders transferred on the host2 that are subscribed on host1. On by default. --subscribeall : Subscribe to the folders transferred on the host2 even if they are not subscribed on host1. --nofoldersizes : Do not calculate the size of each folder in bytes and message counts. Default is to calculate them. --nofoldersizesatend: Do not calculate the size of each folder in bytes and message counts at the end. Default is on. --justfoldersizes : Exit after having printed the folder sizes. --syncacls : Synchronises acls (Access Control Lists). --nosyncacls : Does not synchronize acls. This is the default. Acls in IMAP are not standardized, be careful. --usecache : Use cache to speedup. --nousecache : Do not use cache. Caveat: --useuid --nousecache creates duplicates on multiple runs. --useuid : Use uid instead of header as a criterium to recognize messages. Option --usecache is then implied unless --nousecache is used. --debug : Debug mode. --debugfolders : Debug mode for the folders part only. --debugcontent : Debug content of the messages transfered. Huge ouput. --debugflags : Debug mode for flags. --debugimap1 : IMAP debug mode for host1. Very verbose. --debugimap2 : IMAP debug mode for host2. Very verbose. --debugimap : IMAP debug mode for host1 and host2. --debugmemory : Debug mode showing memory consumption after each copy. --errorsmax int : Exit when int number of errors is reached. Default is 50. --tests : Run local non-regression tests. Exit code 0 means all ok. --testslive : Run a live test with test1.lamiral.info imap server. Useful to check the basics. Needs internet connexion. --version : Print only software version. --noreleasecheck : Do not check for new imapsync release (a http request). --releasecheck : Check for new imapsync release (a http request). --noid : Do not send/receive ID command to imap servers. --justconnect : Just connect to both servers and print useful information. Need only --host1 and --host2 options. --justlogin : Just login to both host1 and host2 with users credentials, then exit. --justfolders : Do only things about folders (ignore messages). --help : print this help. Example: to synchronize imap account "test1" on "test1.lamiral.info" to imap account "test2" on "test2.lamiral.info" with test1 password "secret1" and test2 password "secret2" D:\IMAPSync\imapsync-imapsync-1.678\W\imapsync.exe ^ --host1 test1.lamiral.info --user1 test1 --password1 secret1 ^ --host2 test2.lamiral.info --user2 test2 --password2 secret2 Here is a [MSWin32] system (Windows NT Fronik 6.2 Build 9200 x86) With perl 5.22.2 Mail::IMAPClient 3.38 $Id: imapsync,v 1.678 2016/01/21 19:47:02 gilles Exp gilles $ New imapsync release 1.684 available Homepage: http://imapsync.lamiral.info/</code> </pre> <br></div></div>  If everything is so, there are no errors, then the application is ready, you can use it. <br></li></ol><br><h3>  IMAP mail transfer between servers </h3><br><ol><li>  We copy our application \ W \ imapsync.exe in \ examples \ imapsync.exe.  In the <b>\ examples</b> folder we are interested in several files: <br><ul><li>  <b>imapsync_example.bat</b> - testing transfer settings and mail transfer for one mailbox </li><li>  <b>sync_loop_windows.bat</b> and <b>file.txt</b> - mail transfer for mailboxes </li></ul><br></li><li>  Preparation, testing, transfer of one box: <br>  Open the <b>imapsync_example.bat</b> file and prescribe our details and parameters: <br><pre> <code class="dos hljs">.\imapsync.exe ^ --host1 mx.example.ru --user1 user@example.ru --password1 "Pass123" ^ --host2 imap.yandex.ru --user2 user@example.biz --password2 "Pass123" ^ --ssl1 --ssl2 --sslargs1 SSL_verify_mode=<span class="hljs-number"><span class="hljs-number">0</span></span> --sslargs2 SSL_verify_mode=<span class="hljs-number"><span class="hljs-number">1</span></span> --skipheader "^(?!Message-Id)" --automap ^ --regextrans2 "s/^INBOX\.(.+)/$<span class="hljs-number"><span class="hljs-number">1</span></span>/" --justfolders --dry @<span class="hljs-built_in"><span class="hljs-built_in">PAUSE</span></span></code> </pre><div class="spoiler">  <b class="spoiler_title">A small description of the parameters</b> <div class="spoiler_text">  Source server, mailbox login, mailbox password: <br> <code>--host1 mx.example.ru --user1 user --password1 "Pass123" <br></code> <br>  Destination server, mailbox login, mailbox password: <br> <code>--host2 imap.yandex.ru --user2 user@example.biz --password2 "Pass123" <br></code> <br>  Using SSL for the source and destination server: <br> <code>--ssl1 --ssl2 <br></code> <br>  If SSL is enabled (--ssl1 --ssl2), then it is better to immediately configure the certificate verification mode. <br>  Accept any certificate (= 0), or authenticate (= 1). <br> <code>--sslargs1 SSL_verify_mode=0 --sslargs2 SSL_verify_mode=1 <br></code> <br>  I noticed that if you do not specify these settings, you may receive errors when transferring some letters, or the appearance of an error of this kind: <br> <code>Use of uninitialized value $sockargs[9] in join or string at Mail/IMAPClient.pm line 360. <br></code> <br>  Ignore all the headers in the letter, except those that contain a "Message-Id".  This parameter is useful in cases where different headers are generated for a single letter on different servers, in my case they are different.  Yandex added one extra line for each letter, which was why letters were duplicated with each subsequent mail transfer.  If you filter the headers by "Message-Id", then each time mail is transferred, only new messages are copied. <br> <code>--skipheader "^(?!Message-Id)" <br></code> <br>  Automatically identify and link folders on the source server to folders on the destination server.  It compares the names and creates bindings, maintains folders with Cyrillic in the names.  Inbox-&gt; Inbox.  Sent -&gt; Sent ... <br> <code>--automap <br></code> <br>  Removes from the name INBOX in all destination folders.  In my case, IDECO calls all folders starting with INBOX (INBOX.Sent, INBOX.Drafts, etc.).  To avoid creating duplicate names in the destination server for folders that were manually created by the user.  It is worth noting that it still depends on the server. <br> <code>--regextrans2 "s/^INBOX\.(.+)/$1/" <br></code> <br>  Perform operations only for folders.  Letters are not transferable. <br> <code>--justfolders <br></code> <br>  Emulation run.  The entire work plan will be shown, but nothing is physically transferred.  Convenient for testing. <br> <code>--dry <br></code> <br></div></div><br>  After reading the description, we launch and check how the binding of our folders occurred.  If everything is successful - great.  If not, you can use the manual binding options.  For example, the parameters below create a binding of the ‚ÄúINBOX.Junk‚Äù and ‚ÄúINBOX.Spam‚Äù folders to the ‚ÄúDeleted‚Äù folder. <br><pre> <code class="dos hljs">--f1f2 "INBOX.Junk"="&amp;BCMENAQwBDsENQQ9BD0ESwQ1-" --f1f2 "INBOX.Spam"="&amp;BCMENAQwBDsENQQ9BD0ESwQ1-"</code> </pre><br>  Here we are faced with the encoding.  To determine how the Cyrillic folders should be called, you need to look at the logs ( <b>LOG_imapsync \ *. Txt</b> ), which are created after each program execution. <br><pre> <code class="dos hljs">Folders mapping from --automap feature (use --f1f2 to override any mapping): [INBOX.Junk] -&gt; [&amp;BCEEPwQwBDw-] = [] [INBOX.Spam] -&gt; [&amp;BCEEPwQwBDw-] = [] [INBOX.Sent] -&gt; [&amp;BB4EQgQ,BEAEMAQyBDsENQQ9BD0ESwQ1-] = [] [INBOX.Drafts] -&gt; [&amp;BCcENQRABD0EPgQyBDgEOgQ4-] = [] [INBOX.Trash] -&gt; [&amp;BCMENAQwBDsENQQ9BD0ESwQ1-] = []</code> </pre><br>  Well, here everything is clear and understandable, and the program itself suggests that we create a manual binding, if necessary. <br>  After the run, making sure everything looks good, delete the parameter: <br><pre> <code class="dos hljs">--dry</code> </pre><br>  We start, and check how folders were created on our destination server.  For now we only check folders.  If required, make changes to the bindings.  If everything looks as we need, great, go to the letters.  Delete the parameter: <br><pre> <code class="dos hljs">--justfolders</code> </pre><br>  We launch and check how folders are created and letters are transferred to our destination server.  Also make the necessary changes if necessary.  If we needed to transfer only one box, then we‚Äôre done for this.  If you need to transfer more, then go to the next item. <br><br></li><li>  Migrate mail for multiple mailboxes. <br>  Open the file <b>file.txt</b> .  This file contains a good description and a real example to demonstrate the work.  With filling difficulties should arise.  Let's comment out all the examples in it, and write our data below.  We list all our boxes we want to transfer. <br><pre> <code class="dos hljs">mx.example.ru;user;Pass123;imap.yandex.ru;user@example.biz;Pass123 mx.example.ru;user2;Pass321;imap.yandex.ru;user2@example.biz;Pass321</code> </pre><br>  Open the <b>sync_loop_windows.bat</b> file for editing, and after the lines: <br><pre> <code class="dos hljs">imapsync ^ --host1 <span class="hljs-variable"><span class="hljs-variable">%%G</span></span> --user1 <span class="hljs-variable"><span class="hljs-variable">%%H</span></span> --password1 <span class="hljs-variable"><span class="hljs-variable">%%I</span></span> ^ --host2 <span class="hljs-variable"><span class="hljs-variable">%%J</span></span> --user2 <span class="hljs-variable"><span class="hljs-variable">%%K</span></span> --password2 <span class="hljs-variable"><span class="hljs-variable">%%L</span></span> <span class="hljs-variable"><span class="hljs-variable">%arguments%</span></span></code> </pre><br>  We add our parameters, not forgetting the ‚Äú^‚Äù character at the end of the line after% arguments%, we end up with: <br><pre> <code class="dos hljs">imapsync ^ --host1 <span class="hljs-variable"><span class="hljs-variable">%%G</span></span> --user1 <span class="hljs-variable"><span class="hljs-variable">%%H</span></span> --password1 <span class="hljs-variable"><span class="hljs-variable">%%I</span></span> ^ --host2 <span class="hljs-variable"><span class="hljs-variable">%%J</span></span> --user2 <span class="hljs-variable"><span class="hljs-variable">%%K</span></span> --password2 <span class="hljs-variable"><span class="hljs-variable">%%L</span></span> <span class="hljs-variable"><span class="hljs-variable">%arguments%</span></span> ^ --ssl1 --ssl2 --sslargs1 SSL_verify_mode=<span class="hljs-number"><span class="hljs-number">0</span></span> --sslargs2 SSL_verify_mode=<span class="hljs-number"><span class="hljs-number">1</span></span> --skipheader "^(?!Message-Id)" --automap ^ --regextrans2 "s/^INBOX\.(.+)/$<span class="hljs-number"><span class="hljs-number">1</span></span>/" --justfolders --dry</code> </pre><br>  Save and run.  We check how the processing went and delete the parameters <b>--justfolders --dry</b> to start the real transfer of all folders and letters. <br>  Now it only remains to wait for the completion of the mailbox transfer and check the logs.  For each mailbox will create its own log. <br></li></ol><br><h3>  Addition </h3><br>  A few key points that I highlighted for myself when studying the program and debugging errors: <br><ul><li>  In the <b>\ examples \ FAQ.d folder</b> there is an excellent FAQ with examples. </li><li>  When experimenting with headers, the "--debug" parameter will help.  This mode shows the contents of all the headers of each letter. </li><li>  You can use the same server as the source and destination server, for example, to remove duplicates. </li></ul><br>  Compilation and performance tested on Windows 10 64bit and Windows 7 64bit. <br><br>  UPD 2016.07.10: Rewrote the preparation and compilation section using the portable version of strawberry. <br>  Clarified the version on which the installation of packages and compilation takes place without errors. <br>  UPD 2016.07.11: Added commands to check and ignore SSL certificates. </div><p>Source: <a href="https://habr.com/ru/post/282916/">https://habr.com/ru/post/282916/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../282906/index.html">Administrators of groups in vk have always been in the public domain.</a></li>
<li><a href="../282908/index.html">Virtual IT Infrastructure: Pros and Cons</a></li>
<li><a href="../282910/index.html">NB-IoT: narrow band - broad prospects</a></li>
<li><a href="../282912/index.html">We send data from Arduino to Azure IoT Hub</a></li>
<li><a href="../282914/index.html">Writing the background process on Apache Cordova</a></li>
<li><a href="../282918/index.html">Performance Indicators: KVM vs. Xen</a></li>
<li><a href="../282922/index.html">Work with WAV files using PHP</a></li>
<li><a href="../282924/index.html">Test Gradle Plugins Correctly</a></li>
<li><a href="../282926/index.html">About Modbus and Intel Edison Protocol</a></li>
<li><a href="../282930/index.html">Smart or virtual hardware drivers</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>