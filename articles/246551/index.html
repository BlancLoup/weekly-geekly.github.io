<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Architectural design of mobile applications</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Sign of bad design number 1: 
 Presence of the ‚Äúgod‚Äù object with the name containing ‚ÄúManager‚Äù, ‚ÄúProcessor‚Äù or ‚ÄúAPI‚Äù 

 The lead iOS developer at Redm...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Architectural design of mobile applications</h1><div class="post__text post__text-html js-mediator-article">  <i>Sign of bad design number 1:</i> <i><br></i>  <i>Presence of the ‚Äúgod‚Äù object with the name containing ‚ÄúManager‚Äù, ‚ÄúProcessor‚Äù or ‚ÄúAPI‚Äù</i> <br><img src="https://habrastorage.org/files/ae4/c43/f33/ae4c43f3388a4b5493f1327daf984e94.png"><br>  The lead iOS developer at Redmadrobot, Egor <a href="http://habrahabr.ru/users/beptep/" class="user_link">BepTep</a> Taflanidi, on how to achieve a sleek architectural design of a mobile application using classic design patterns and logical separation of source code into modules. <br><br><a name="habracut"></a>  All the architects whom I met, in varying degrees, had the same professional deformation of character: in their speech they tried to avoid specifics.  Such an approach is easy to understand, because the essence of the flexibility of any system is to abstract from concrete solutions.  The longer the solution can be delayed - the more flexible the system.  If the UI is rather abstracted from the modules of the data retention level, then reading the file from the hard disk can easily be replaced by downloading the same information from the server API. <br><br>  And yet, let's try to sort through the architectural design of a typical iOS application. <br>  I will describe a global approach to the division of application logic into levels and layers, and also give specific participants in various processes, each with their own responsibility and interactions with the environment. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h4>  <b>Installation</b> </h4><br>  <b>TL; DR: PROGRAMMERS - ALSO SCIENTIFIC EMPLOYEES</b> <br><br>  Students of higher educational institutions study natural sciences, study management, acquire knowledge of applied psychology, etc. Each science carries the necessary baggage of accumulated information ‚Äî academic knowledge, without which the advancement of science itself would be difficult.  Without this foundation, there would be no practical benefit from science: it is much more profitable for a process engineer to use time-tested approaches that are guaranteed to produce results than to invent something of his own.  Naturally, this foundation itself is constantly evolving and is being completed with new information and practices. <br><br>  Behind the back of programming is exactly the same strict science as, for example, behind the process of producing aspirin.  Informatics, as a typical representative of the formal sciences, has the same set and structure of <a href="https://ru.wikipedia.org/wiki/%25D0%25A4%25D0%25BE%25D1%2580%25D0%25BC%25D0%25B0%25D0%25BB%25D1%258C%25D0%25BD%25D1%258B%25D0%25B5_%25D0%25BC%25D0%25B5%25D1%2582%25D0%25BE%25D0%25B4%25D1%258B">formal methods</a> , uses established, proven approaches to the study of the new, and, naturally, it has its own baggage of academic knowledge.  A scientific approach is guaranteed to lead to a high-quality result, and the knowledge and application of basic software design principles is guaranteed to facilitate product support. <br><br>  The book "Pattern Language" by Christopher Alexander, which gave impetus to the use of patterns in programming, was released in 1977, and the Model-View-Controller pattern was described in 1979. <br>  Armed with software development and wearing a white theoretician, we will try to build a typical application project for a mobile platform. <br><br><blockquote>  <i>NB Most likely, in real life (taking into account the business requirements for the system and taking into account the development timeframe) your project will look slightly different.</i>  <i>Nevertheless, it will be possible to say with confidence that behind the back of such a product is not just your invention, but an informed set of solutions.</i> </blockquote><br><img src="https://habrastorage.org/files/de4/f39/96f/de4f3996fe23454d8005f8bda472739e.jpg"><br><br><h4>  <b>Given</b> </h4><br>  <b>SPHERICAL SYSTEM IN VACUUM</b> <br><br>  So, we have: <br><ul><li>  server with documented API from several web services; </li><li>  client application and several types of devices that this application must support: tablets, phones, watches, etc. </li><li>  layouts of how the application interface should look like; </li><li>  a set of user stories declaring how the application should behave; </li><li>  list of non-functional requirements that the system must meet. </li></ul><br><h4>  <b>Hourglass model</b> </h4><br>  <b>SITHOV ALWAYS TWO: ONE BUILS SERVICES, OTHER EXPOSES THE UI</b> <br><br>  The first step is to separate the <i>model</i> from the <i>controller</i> and the <i>view</i> , thus highlighting two levels of the application: the ‚Äúbottom‚Äù side faces the server capacity, the ‚Äútop level‚Äù looks at the user. <br><br>  On mobile application projects, the layers of the <i>controller</i> and <i>presentation</i> are usually quite organically capable of being developed by one person, while the rest of the business logic regarding persistence and data processing can be safely transferred to the second developer.  Thus, we immediately parallelize the software manufacturing process into two independent streams. <br><br>  We will adhere to the classical principle, which states that application layers communicate with each other through <i>model objects</i> - classes with a ‚Äútransparent‚Äù implementation consisting exclusively of accessors and mutators (get and set methods; in fact, the class will include only properties).  Such classes do not carry with them any logic, and are intended only for storing and moving data. <br><img src="https://habrastorage.org/files/f81/6b2/9c4/f816b29c424148dc87578dac50d7eebb.jpg"><br>  The central essence of the application - the "neck" of the hourglass - will be the object, otherwise called the "dependency inverter".  It will become the <i>only</i> singleton class, and it will bear the sole responsibility - to provide services to the ‚Äútop‚Äù layers of the application. <br><br><h4>  <b>Services</b> </h4><br>  <b>HISTORY OF PLUG CONNECTION</b> <br><br>  How are normal server applications made?  Very simple.  There is always some kind of database (or there may be several of them) in which there are tables.  Tables are made up of records.  Each entry contains a set of fields in which information is stored. <br><br>  Records are represented as <i>model objects with fields</i> , thereby creating a logical distinction in the application according to data types: one table - one data type.  The ‚ÄúUsers‚Äù table is the ‚ÄúUser‚Äù data type (fields: ID, full name, address).  The ‚ÄúMessages‚Äù table is the ‚ÄúMessage‚Äù data type (fields: ID, Message Subject, Message Body, To, From, Date).  And so on. <br><br>  Thus, all logic revolves around tables and data types: <br><br>  1. A <i>model object</i> representing the data type. <br>  2. Serialization of the <i>model object</i> to save it to the table. <br>  3. Deserialization of the <i>model object</i> from the database. <br>  4. <i>Model object</i> transformations: calculation of some statistics, <br>  data sorting, data retrieval, etc. <br>  5. Serialization of the <i>model object</i> for transmission over the network. <br>  6. Deserialization of <i>model objects</i> coming through the network. <br>  7. Web-based web service corresponding to this type <br>  data. <br><br>  All this is built into a kind of <i>stack</i> , and the server application itself consists of several such independent <i>stacks</i> , each of which corresponds to some type of data. <br><br>  Roughly speaking, if, according to the API specification, you have the <a href="http://api.domain.com/1-0/messages">api.domain.com/1-0/messages</a> web service with a classic CRUD interface, this means that there is a ‚Äústack‚Äù for the ‚Äúmessage‚Äù data type behind it. <br><br>  <b>C</b> reate = POST; <br>  <b>R</b> ead = GET; <br>  <b>U</b> pdate = PUT; <br>  <b>D</b> elete = DELETE. <br><br><blockquote>  <i>NB There are various interpretations of the POST and PUT statements.</i>  <i>In some implementations, POST is responsible for creating entities, in others, for updating.</i>  <i>The canonical interpretation, alas, does not exist, but there is nothing terrible in it.</i> </blockquote><br>  As a rule, the server supports a standardized set of requests, differentiated by URL suffixes to the corresponding web service: <br><br>  {api} / messages / {id} - operations with an entity by the specified ID; <br>  {api} / messages / {id} / {property} - operations with the {property} field of an entity with ID = {id}. <br><br>  <b>TOTAL:</b> <b><br></b> <br>  All we have to do is make a plug to the outlet. <br>  Namely: <br><br>  1. Make <i>the</i> application <i>transport layer</i> an entity that will encapsulate an HTTP connection along with all its settings (including security, timeouts, etc.) <br>  ‚Ä¢ The entity interface must be exactly the same CRUD as the web service exposed on the Internet.  If you have access to the address {api} / messages - there must be four corresponding methods;  if you have access to GET {api} / messages / {id} / {property} - make a separate method that will receive data from this {property}. <br>  ‚Ä¢ Entity must be modular.  If at one point your wonderful web-service {api} / messages ceases to function, you will only need to implement a single entity that repeats the interface of the <i>transport level</i> , but takes data from <br>  file system. <br><br>  2. Design <i>parsers</i> and <i>serializers</i> that will generate model objects and, conversely, convert them into a form that is digestible for your <i>transport</i> layer. <br>  ‚Ä¢ <i>Parsers</i> and <i>serializers</i> carry knowledge about how to convert <i>model objects</i> into dictionaries a la JSON or XML.  Do not try to fasten this knowledge to the <i>model objects</i> themselves - they do not relate to other layers of the application. <br>  ‚Ä¢ There is a Russian-language term ‚Äútopographic converter‚Äù, which could replace the English-language ‚Äúparser‚Äù and ‚Äúserializer‚Äù, but the term itself somehow did not take root ... <br><br>  3. Design the entity that will be responsible for caching. <br>  ‚Ä¢ An entity should simply be able to provide data access to the data in a safe manner, rewrite and update this data with more recent data. <br><br>  4. Design the ‚Äúservice‚Äù itself - an entity that will be responsible for coordinating the <i>transport layer</i> , <i>parsers</i> , <i>serializers,</i> and <i>cache</i> . <br>  ‚Ä¢ The service interface must fully comply with the business requirements of the UI layer.  If for UI it is necessary to get some kind of entity, there must be a method to get this entity.  If the UI needs to save an entity with certain parameters, the service should have a method with these parameters.  If the UI requires an array of objects of this type, sorted by some criterion, the service must provide an appropriate method that will return the sorted array. <br>  ‚Ä¢ And yes, we do not forget the classical principle: application layers communicate with each other through <i>model objects</i> .  Using dictionaries / map for data transfer is unacceptable - only strict typing. <br><br>  Thus, we actually make our own stack, corresponding to the server, but acting in the opposite direction.  This is how the sequence of steps that the data needs to overcome to get from the central repository to the end user will look like: <br><img src="https://habrastorage.org/files/c24/359/295/c2435929552347ca9b326e4f3e941535.jpg"><br>  How many types of data - so many services.  This figure is quite simple to calculate from the API specification. <br><br><blockquote>  <i>NB ‚ÄúPure‚Äù services in nature are not as common.</i>  <i>It happens that a service serves several types of data at once.</i>  <i>This is due to the fact that model entities can be nested into each other: one entity can carry an array of objects of another type, or have a similar object as a property.</i> </blockquote><br>  There is nothing terrible in this, just your <i>parsers</i> and <i>serializers</i> should adequately perceive this kind of nesting, and generate objects of the appropriate types. <br><br>  Services must be as autonomous as possible, which does not prevent you from building logical dependencies between them.  For example, it is quite logical that the application has a service that is responsible for authorizing and maintaining the session with the server, and the rest of the services depend on it ‚Äî they use the token provided to them to form requests. <br><br><blockquote>  <i>NB Each of the services will somehow have a CRUD-like interface built around the type of data processed by this service.</i>  <i>This can serve as an excellent reason for separating an abstract service with an abstract CRUD interface for subsequent inheritance from it of other services, which will ensure a high degree of code reuse.</i> </blockquote><br>  Building the <i>model</i> level in this way is the essence of the implementation of the pattern of a <a href="http://en.wikipedia.org/wiki/Multilayered_architecture">layered architecture</a> with the imposition of the ideas of a <a href="http://en.wikipedia.org/wiki/Service-oriented_architecture">service-oriented architecture</a> . <br><br>  We have not invented anything new. <br><br><h4>  <b>UI level</b> </h4><br>  <b>TIME OF REMARKABLE STORIES</b> <br><br>  So, you came to the project, downloaded the source code of the developed application from the repository.  What is the easiest way to find out what this application does?  Right!  Run it!  Before you are familiar tables with cells, stylized buttons, drums with dates, navigation, screen names ... Now the task: how to relate it all to the source code, which is scattered over several hundred files, that loom in front of you in the IDE? <br><br>  We have already isolated one of the application levels - in fact, the <i>model</i> can now be a completely independent module that can be reconnected to some other project using the same back-end.  Or even reuse for another back-end, if you follow all the design principles and retain a certain level of abstraction. <br><br>  But here's the bad luck: we still have two (!) Layers, and the only sign of what and where in the source codes is located is the actual running application running on the device or in the emulator.  This is where <i>user stories</i> come to the rescue <i>.</i> <br><br>  If your application fits in any way to common sense, it will follow certain <i>user stories</i> that declare the scenarios necessary for the implementation of a particular action.  The most classic example is registration and authorization <i>history</i> .  During registration, the user enters some personal data, these data are checked for adequacy, logins and passwords are set, all this can be added with security measures in the form of SMS and so on.  Accordingly, in the application there is a whole <i>story</i> concerning registration.  Following the logic in order to facilitate your own life, the most obvious solution would be to follow these <i>user stories</i> when building a UI level structure. <br><br>  Moreover, the iOS application SDKs provide all the necessary tools for this: you just need to create your own Storyboard for each <i>story</i> - and divide the project structure in such a way that all classes are built around these <i>stories</i> .  Further, these Storyboards can even be dynamically connected to each other via <a href="https://github.com/rob-brown/RBStoryboardLink">simple libraries</a> , but these are implementation details. <br><br>  In the end, you will have a structure divided into modules by history, each module will have its own <b>views</b> and <i>controllers</i> with <i>utility</i> classes, and in this structure you can easily navigate based only on what is happening on your device / emulator screen . <br><br><blockquote>  <i>NB And yes, of course, do not forget the classical principles of design.</i>  <i><a href="https://ru.wikipedia.org/wiki/YAGNI">We apply</a> <a href="https://ru.wikipedia.org/wiki/SOLID_(%25D0%25BE%25D0%25B1%25D1%258A%25D0%25B5%25D0%25BA%25D1%2582%25D0%25BD%25D0%25BE-%25D0%25BE%25D1%2580%25D0%25B8%25D0%25B5%25D0%25BD%25D1%2582%25D0%25B8%25D1%2580%25D0%25BE%25D0%25B2%25D0%25B0%25D0%25BD%25D0%25BD%25D0%25BE%25D0%25B5_%25D0%25BF%25D1%2580%25D0%25BE%25D0%25B3%25D1%2580%25D0%25B0%25D0%25BC%25D0%25BC%25D0%25B8%25D1%2580%25D0%25BE%25D0%25B2%25D0%25B0%25D0%25BD%25D0%25B8%25D0%25B5)">SOLID</a> , <a href="https://ru.wikipedia.org/wiki/Don%25E2%2580%2599t_repeat_yourself">DRY</a> , <a href="https://ru.wikipedia.org/wiki/KISS_(%25D0%25BF%25D1%2580%25D0%25B8%25D0%25BD%25D1%2586%25D0%25B8%25D0%25BF)">KISS</a> and <a href="https://ru.wikipedia.org/wiki/YAGNI">YAGNI</a> in full, the main thing is not to be lazy and to separate entities in accordance with the responsibility they bear.</i>  <i>The rest will be prompted by experience.</i> </blockquote><br>  You can sketch a rough class diagram: <br> <a href=""><img src="https://habrastorage.org/files/bc7/36e/4a8/bc736e4a8efe4ecba7e19d97e909334d.jpg"></a> <br>  Naturally, there is no limit to perfection, and this approach does not claim to be a reference. <br><br><h4>  <b>Conclusion</b> </h4><br>  <b>RESULTS AND DISCUSSION</b> <br><br>  We briefly examined how to build a slim architectural design of a mobile application.  To do this, we applied a fusion of classical design patterns (MVC, SOA and Multilayered Architecture), having also resorted to a logical division of the source code into modules based on <i>user stories</i> . <br><br>  And now a small question for the community: <br>  Has anyone on combat projects used the <b>V</b> iew-Intractor- <b>P</b> resenter- <b>E</b> ntity- <b>R</b> outer architecture, and how was the reuse of the Router entity / template achieved?  How can you avoid the proliferation of Router'a? </div><p>Source: <a href="https://habr.com/ru/post/246551/">https://habr.com/ru/post/246551/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../246527/index.html">Redmine task requests. How we improved them and how we use them</a></li>
<li><a href="../246533/index.html">Trends iOS development 2014</a></li>
<li><a href="../246537/index.html">Announcement of new services and increased performance of the Azure cloud platform</a></li>
<li><a href="../246545/index.html">Interkassa: beware of hidden fees, PayPal conversion is now more attractive than conversion rates of many banks</a></li>
<li><a href="../246547/index.html">Experience coding for equity. Results for 8 years</a></li>
<li><a href="../246553/index.html">IT distribution in Europe or how we started our business - Part 1</a></li>
<li><a href="../246555/index.html">Arduino programming with ISP programmer</a></li>
<li><a href="../246557/index.html">Super powers chrome devtools</a></li>
<li><a href="../246563/index.html">Why do you need to support different payment systems</a></li>
<li><a href="../246565/index.html">How to make an analysis of a landing page in 10 minutes and return 1000 buyers. Part 1</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>