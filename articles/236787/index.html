<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Surrealism on javascript. NodeJS Development Tips</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hi, Habra! 

 Half a year ago, I thought, ‚ÄúCan a book be written?‚Äù, And I did write it. 



 All documents are drawn up, pages are laid out, and circu...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Surrealism on javascript. NodeJS Development Tips</h1><div class="post__text post__text-html js-mediator-article">  Hi, Habra! <br><br>  Half a year ago, I thought, ‚ÄúCan a book be written?‚Äù, And I did write it. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/9df/758/63f/9df75863f1c48cd7160aca06575cd067.jpg" title="Javascript surrealism">
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      All documents are drawn up, pages are laid out, and circulation is printed.  I will not beg for money from you on a kickstarter or offer to buy something, but instead try to intrigue with tips on developing at NodeJS for the purpose of public relations and drawing attention to the book. <br><a name="habracut"></a><br><h3>  Tip 1. SQL queries are best kept formatted. </h3><br>  SQL queries are best kept formatted, because  the code in this case is much easier to read and edit.  Since  SQL queries are usually quite long, it is better to split them into several lines, and lines in JavaScript look best in an array. <br><br>  <b>Before:</b> <br><pre><code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> query = <span class="hljs-string"><span class="hljs-string">"SELECT g.id, g.title, g.description, g.link, g.icon, t.id as tag_id, c.title as comment_title FROM games AS g LEFT JOIN tags AS t ON t.game_id = g.id LEFT JOIN comments AS c ON c.game_id = g.id WHERE g.id = $1"</span></span>;</code> </pre> <br>  <b>After:</b> <br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> query = [ <span class="hljs-string"><span class="hljs-string">"SELECT "</span></span>, <span class="hljs-string"><span class="hljs-string">" g.id, g.title, g.description, g.link, g.icon, "</span></span>, <span class="hljs-string"><span class="hljs-string">" t.id as tag_id, c.title as comment_title "</span></span>, <span class="hljs-string"><span class="hljs-string">" FROM games AS g "</span></span>, <span class="hljs-string"><span class="hljs-string">" LEFT JOIN tags AS t ON t.game_id = g.id "</span></span>, <span class="hljs-string"><span class="hljs-string">" LEFT JOIN comments AS c ON c.game_id = g.id "</span></span>, <span class="hljs-string"><span class="hljs-string">" WHERE "</span></span>, <span class="hljs-string"><span class="hljs-string">" g.id = $1"</span></span> ];</code> </pre> <br>  Agree that in the second case the request is much clearer for the reader.  In addition, if you before the request in the database output the request to the console, the array, prokinut in console.dir (), again much clearer than the string, prokinut in console.log (). <br><br><img src="https://habrastorage.org/getpro/habr/post_images/853/488/543/8534885431a7883bf004052129e7a189.png" title="Javascript surrealism"><br><br><h3>  Tip 2. Life becomes easier when the API of the various components takes as input any format. </h3><br>  Suppose we have created a client to the database and want to execute a certain SQL query.  At the entrance we expect a string and parameters.  Since  Using the previous advice, we decided to store long queries in arrays, we would like to forget about its conversion to a string on each query. <br><br>  <b>Before:</b> <br><pre> <code class="javascript hljs">dataBase(query.join(<span class="hljs-string"><span class="hljs-string">""</span></span>), parameters, callback);</code> </pre> <br>  <b>After:</b> <br><pre> <code class="javascript hljs">dataBase(query, parameters, callback);</code> </pre> <br>  The code becomes simpler when the database query function (in this case, dataBase) itself checks in what form the request is sent to it, and if it is an array, join () itself does it. <br><br><h3>  Tip 3. Paint the console and format the output. </h3><br>  Debugging programs on NodeJS is difficult, because  there is a very lack of a standard developer console with all the chips, such as ‚Äúbreakpoints‚Äù.  All data is written to the console, and I want to make it more understandable.  If your node is spinning somewhere on the server, and even in several instances, and even several different services hang on each instance, and you only have access via SSH, then the console can really make you suffer. <br><br>  If the NodeJS output to the console a string of the form ‚ÄúHello world!‚Äù With control ANSI characters, it will be colored in different colors.  An example of using ANSI control characters: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/832/295/363/8322953638bd6f57f63089efe5c5c306.png" title="Javascript surrealism"><br><br>  In order not to remember such hacks, you can connect the colors module and use the following syntax: <br><br><pre> <code class="javascript hljs"><span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(<span class="hljs-string"><span class="hljs-string">"Error! Parameter ID not found."</span></span>.red);</code> </pre> <br>  The string will be displayed in red.  When developing with this module, you can color the messages in the console in different colors: <br><ul><li>  Red (error). </li><li>  Yellow (warning). </li><li>  Green (all is well). </li><li>  Gray.  They can display any parameters (for example, query parameters) that you can ignore until you catch the error. </li></ul><br>  The console before the color selection (with fast viewing information is perceived with difficulty): <br><br><img src="https://habrastorage.org/getpro/habr/post_images/468/094/f86/468094f86c5666711af60ffbfff5e48a.png" title="Javascript surrealism"><br><br>  The console after the color selection (with quick viewing information is perceived quite quickly): <br><br><img src="https://habrastorage.org/getpro/habr/post_images/418/d6f/1d1/418d6f1d1720fce11665e58993dbbdff.png" title="Javascript surrealism"><br><br>  Thanks to the colored console, it will be much easier for you to monitor the status of the server.  In addition, if you have several services that work with different processes on one instance, you should also write separate methods in the modules for output to the console.  For example: <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> book = { <span class="hljs-attr"><span class="hljs-attr">console</span></span>: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">message, color</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log((<span class="hljs-string"><span class="hljs-string">"Book API: "</span></span> + (message || <span class="hljs-string"><span class="hljs-string">""</span></span>))[(color || white<span class="hljs-string"><span class="hljs-string">")]); } }</span></span></code> </pre> <br><br>  If all messages in the console are signed by the modules that send them, you can not only select a specific module, but also instantly find the source of the bug in a critical situation.  Text formatting also simplifies the perception of information: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/6bf/25c/e22/6bf25ce22b65a34027f12a42c05c6465.png" title="Javascript surrealism"><br><br>  Thus, all the information in the console will be signed, and you can easily understand what events are happening in various modules.  Again, color highlighting helps in stressful situations, when this or that system failed and an urgent need to be corrected, and there is no time to read the logs (I do not call you to debug in production, just anything happens).  In my projects I decided to rewrite the console module in order to be able to color not only strings, but also arrays and objects, as well as automatically sign all instances.  Therefore, when connecting a module, I give it the name of the package with which to sign messages.  An example of using a new console module: <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> <span class="hljs-built_in"><span class="hljs-built_in">console</span></span> = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">"./my_console"</span></span>)(<span class="hljs-string"><span class="hljs-string">"Scoring SDK"</span></span>); <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.green(<span class="hljs-string"><span class="hljs-string">"Request for DataBase."</span></span>); <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.grey([ <span class="hljs-string"><span class="hljs-string">"SELECT *"</span></span>, <span class="hljs-string"><span class="hljs-string">" FROM \"ScoringSDK__game_list\""</span></span>, <span class="hljs-string"><span class="hljs-string">" WHERE key = $1;"</span></span> ]);</code> </pre> <br>  Example of data output to the console: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/4e6/a69/7a9/4e6a697a90691933b544ab920b511855.png" title="Javascript surrealism"><br><br><h3>  Tip 4. Wrap all APIs in try / catch </h3><br>  Our work uses the express framework.  What was my surprise when I found out that there is no try / catch wrapper in the standard router object.  For example: <br><ol><li>  You wrote a curve module </li><li>  Someone tugged at his URL </li><li>  You have a server down </li><li>  WTF !? </li></ol><br><br>  Therefore, always wrap the external modules API in try / catch.  If something goes wrong, your curve module, at least, will not fill up the entire system.  The same situation on the client with the template "mediator" (it is also called "listeners and publishers").  For example: <br><ul><li>  Module A has posted a message. </li><li>  Modules B and C must hear it and respond. </li><li>  The system in the loop begins to sort through subscribers. </li><li>  Module B crashes. </li><li>  The loop terminates and the callback function of module B is not called. </li></ul><br><br>  It is much better to do a bust in try / catch and if module B really falls with an error, then at least it will not kill the system and module B will do its job after hearing the event. <br><br>  Since  when writing API modules, I had to separate private and public methods again and again, and after wrapping all public methods in try / catch, I decided to automate this business and wrote a small module for auto-generating APIs.  For example, we throw in it an object of the form: <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> a = { <span class="hljs-attr"><span class="hljs-attr">_b</span></span>: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ ... }, <span class="hljs-attr"><span class="hljs-attr">_c</span></span>: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ ... }, <span class="hljs-attr"><span class="hljs-attr">d</span></span>: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ ... } }</code> </pre> <br><br>  From the naming of methods it is clear that the first two are private, and the last is public.  The module will create a wrapper to call the latter, of the form: <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> api = { <span class="hljs-attr"><span class="hljs-attr">d</span></span>: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> ad(); } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span>(e) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">false</span></span>; } } };</code> </pre> <br>  Thus, I began to generate a wrapper for the API of all modules, which in the event of an error did not pass it further.  This made the code more stable, because  the error of an individual developer, merged into production, could not drop the entire server with all its functionality. <br><br>  API generation example: <br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> a = { <span class="hljs-attr"><span class="hljs-attr">_b</span></span>: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ ... }, <span class="hljs-attr"><span class="hljs-attr">_c</span></span>: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ ... }, <span class="hljs-attr"><span class="hljs-attr">d</span></span>: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ ... } } <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> api = api.create(a); api.d(); <span class="hljs-comment"><span class="hljs-comment">//  </span></span></code> </pre> <br><br><h3>  Advice 5. Collect requests in configs </h3><br>  I think every web developer had a situation where there was a fat client who needed a small API to work with the database on the server.  A couple of requests for reading, a couple for writing, and a few more for deleting information.  There is usually no logic in such a server, and it is simply a set of requests. <br><br>  In order not to write wrappers for such operations every time, I decided to put all the requests in JSON, and arrange the server in the form of a small module that provides me with an API for working with this JSON. <br><br>  An example of such a module under express: <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> fastQuery = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">"./fastQuery"</span></span>), API = fastQuery({ <span class="hljs-attr"><span class="hljs-attr">scoring</span></span>: { <span class="hljs-attr"><span class="hljs-attr">get</span></span>: { <span class="hljs-attr"><span class="hljs-attr">query</span></span>: <span class="hljs-string"><span class="hljs-string">"SELECT * FROM score LIMIT $1, $2;"</span></span> parameters: [ <span class="hljs-string"><span class="hljs-string">"limit"</span></span>, <span class="hljs-string"><span class="hljs-string">"offset"</span></span> ] }, <span class="hljs-attr"><span class="hljs-attr">set</span></span>: { <span class="hljs-attr"><span class="hljs-attr">query</span></span>: <span class="hljs-string"><span class="hljs-string">"INSERT INTO score (user_id, score, date) VALUES ..."</span></span>, <span class="hljs-attr"><span class="hljs-attr">parameters</span></span>: [ <span class="hljs-string"><span class="hljs-string">"id"</span></span>, <span class="hljs-string"><span class="hljs-string">"score"</span></span> ] } }, <span class="hljs-attr"><span class="hljs-attr">profile</span></span>: { <span class="hljs-attr"><span class="hljs-attr">get</span></span>: { <span class="hljs-attr"><span class="hljs-attr">query</span></span>: <span class="hljs-string"><span class="hljs-string">"SELECT * FROM users WHERE id = $1;"</span></span>, <span class="hljs-attr"><span class="hljs-attr">parameters</span></span>: [ <span class="hljs-string"><span class="hljs-string">"id"</span></span> ] } } });</code> </pre> <br>  Probably, you have already guessed that the module will run through JSON `and look for objects with properties of query and parameters.  If such objects are found, it will create a function for them that will check the parameters, go to the database with queries, and send the result to the client.  At the output, we get the following API: <br><br><pre> <code class="javascript hljs">API.scoring.get(); API.scoring.set(); API.profile.get();</code> </pre><br>  And we will tie it to the router object: <br><br><pre> <code class="javascript hljs">exports.initRoutes = <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">app</span></span></span><span class="hljs-function">) </span></span>{ app.get(<span class="hljs-string"><span class="hljs-string">"/scoring/get"</span></span>, API.scoring.get); app.put(<span class="hljs-string"><span class="hljs-string">"/scoring/set"</span></span>, API.scoring.set); app.get(<span class="hljs-string"><span class="hljs-string">"/profile/get"</span></span>, API.profile.get); }</code> </pre> <br>  I will not build my framework for this purpose, because  The technology stack on the server is different in different firms.  To work with such an object, in any case, you will need to write a small binding, on top of something, to process requests and work with the database.  In addition, it is possible that at the moment when you read these lines there will already be several ready-made frameworks for this task. <br><br>  Now imagine that you have two more server developers.  One writes in PHP, and the second in Java.  If you have all server-side logic limited to just such JSON, with a list of requests to the database, then you can instantly transfer / deploy a similar API not only on another machine, but in a completely different language (provided that communication with the client is standardized and all communicate via REST API). <br><br><h3>  Tip 6. Bring everything to configs </h3><br>  Since  I like to write configs, I have repeatedly had a situation where the system has standard settings, settings for a particular case and settings that occurred at a given point in time.  I had to do mix of different JSON objects.  I decided to select a separate module for these purposes, and at the same time I added the ability to take JSON objects from a file, since  storing the settings in a separate json file is also very convenient.  Thus, now, when I need to make settings for something, I write: <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> data = config.get(<span class="hljs-string"><span class="hljs-string">"config.json"</span></span>, <span class="hljs-string"><span class="hljs-string">"save.json"</span></span>, { <span class="hljs-attr"><span class="hljs-attr">name</span></span>: <span class="hljs-string"><span class="hljs-string">"Petr"</span></span>, <span class="hljs-attr"><span class="hljs-attr">age</span></span>: <span class="hljs-number"><span class="hljs-number">12</span></span> });</code> </pre> <br>  As you might have guessed, the module enumerates the arguments passed to it.  If it is a string, then it tries to open the file and read the settings from it, if it is an object, then it immediately tries to cross it with the previous ones. <br><br>  In the example above, we first take some standard settings from the config.json file, then overlay the saved settings from the save.json file on them, and then add the settings that are relevant at the time.  At the output we get a mix of three JSON objects.  The number of arguments passed to the module can be anything.  For example, we can ask to bring only the default settings: <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> data = config.get(<span class="hljs-string"><span class="hljs-string">"config.json"</span></span>);</code> </pre> <br><br><h3>  Tip 7. File Handling and Social Link Module for SEO </h3><br>  One of the main features that I like about NodeJS is the ability to work with files and write parsers in JavaScript.  While the API NodeJS provides many methods and ways to solve problems, but in practice - you need very little.  For half a year of active work with parsers, I used only two commands - read and write to a file.  Moreover, in order not to suffer with callback-functions and various problems of asynchrony, I always did all the work with files in synchronous mode.  This is how a small file handling module appeared, the API of which was very similar to localStorage: <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> file = requery(<span class="hljs-string"><span class="hljs-string">"./utils.file.js"</span></span>), <span class="hljs-comment"><span class="hljs-comment">//   text = file.get("text.txt); //     file.set("text.txt", "Hello world!"); //    </span></span></code> </pre> <br>  On the basis of this module of work with files, other modules will appear.  For example, a module for SEO.  In one of the past articles, I already wrote that there are a huge number of different meta tags related to SEO.  When I started writing a build system for HTML applications, I paid special attention to the CEO. <br><br>  The bottom line is that we have a small text file describing the site / application / game and directly the HTML file to parse.  The Social Link module should find all meta tags related to SEO in the HTML file and fill them out.  The external API of the module is waiting for text from the file.  This was done in order to be able to connect it to the assembly systems and run through it the text of several files without causing an extra read / write procedure to the file each time. <br><br>  For example, before the module: <br><pre> <code class="html hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">title</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">title</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">meta</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">property</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"og:title"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">content</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">""</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">meta</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"twitter:title"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">content</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">""</span></span></span><span class="hljs-tag">/&gt;</span></span></code> </pre> <br>  After the module: <br><pre> <code class="html hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">title</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">title</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">meta</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">property</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"og:title"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">content</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">" "</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">meta</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"twitter:title"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">content</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">" "</span></span></span><span class="hljs-tag">/&gt;</span></span></code> </pre> <br>  A list and description of all meta-tags for SEO and not only, you can see in the book <a href="http://bakhirev.biz/">http://bakhirev.biz/</a> . <br><br><h3>  Tip 8. Life is easier without callbacks. </h3>  Many developers complain about endless chains of callbacks when writing a server on NodeJS.  In fact, you are not always obliged to write them, and it is often possible to build an architecture in which such chains will be minimal.  Consider a small task. <br><br>  <b>Task:</b> <br>  Transfer files from server A to server B, get some information from the database, update this information, send data to server B. <br><br>  <b>Decision:</b> <br>  This is a rather routine procedure that I repeatedly had to perform to solve any sorting / processing tasks for content.  Usually, developers create a loop and some callback function with the nextFile () method.  When at the next iteration we call nextFile (), the callback mechanism starts from the beginning, and we process the next file.  As a rule, it is required to process only one file at a time and, if the procedure is completed successfully, proceed to processing the next file.  The code of the form will help us to simplify nesting: <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> locked = <span class="hljs-literal"><span class="hljs-literal">false</span></span>, index = <span class="hljs-number"><span class="hljs-number">0</span></span>, timer = setInterval(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(locked) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span>; locked = <span class="hljs-literal"><span class="hljs-literal">true</span></span>; nextFile(index++); }, <span class="hljs-number"><span class="hljs-number">1000</span></span>);</code> </pre> <br>  Now we will try once a second to start processing the file.  If the program is free, it will set locked to false and we will be able to launch the next file for processing.  Such constructions often help reduce nesting, distribute the load over time (since the next iteration of processing is started no more than once per second) and at least a little to slip from endless callbacks. <br><br>  <b>Total</b> <br>  Files with modules can be downloaded here: <a href="">http://bakhirev.biz/_node.zip</a> (now it's 2 am and I am too lazy to deal with GitHub and bring the code into a human view). <br>  Book here: <a href="http://bakhirev.biz/">http://bakhirev.biz/</a> <br>  In case of a habro effect <a href="https://yadi.sk/d/k3P9l-gPbUZEz">here</a> in PDF. <br><br>  If the tips above came to your taste, then I want to immediately warn you that the book is completely different.  And there is also at the end a list of various smart people who have made an invaluable contribution without knowing it, and which you should definitely find and read separately. </div><p>Source: <a href="https://habr.com/ru/post/236787/">https://habr.com/ru/post/236787/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../236777/index.html">A special look at the Android console: EXEQ Set 2</a></li>
<li><a href="../236779/index.html">Video demonstration of the Start menu from Windows 9</a></li>
<li><a href="../236781/index.html">Will the entrance through the social media account replace the usual login form?</a></li>
<li><a href="../236783/index.html">Canada Start-up Visa Program VS Ukrainian Entrepreneurs</a></li>
<li><a href="../236785/index.html">Principles of writing code</a></li>
<li><a href="../236789/index.html">140 characters each: American online stores can trade on Twitter</a></li>
<li><a href="../236791/index.html">Create skeleton animations in the Spriter</a></li>
<li><a href="../236793/index.html">Making an HTML5 Quest: Using the MVC Pattern in Construct 2</a></li>
<li><a href="../236795/index.html">Intersection of PVS-Studio and Cppcheck</a></li>
<li><a href="../236797/index.html">The new life of the old storage system - the magic iron Violin to speed up arrays</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>