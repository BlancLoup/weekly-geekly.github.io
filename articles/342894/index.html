<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>redux-refine - simple perfectionist joy</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Tell me, people, I alone experience a little mental itch 
 from the need to write something here such? : 


export const ADD_TODO = 'ADD_TODO' export ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>redux-refine - simple perfectionist joy</h1><div class="post__text post__text-html js-mediator-article"><p><img src="https://habrastorage.org/getpro/habr/post_images/ea6/427/53e/ea642753e53da9495e76c4261e31ed63.png" alt="image"></p><br><p>  Tell me, people, I alone experience a little mental itch <br>  from the need to write something here such?  : </p><br><pre><code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> ADD_TODO = <span class="hljs-string"><span class="hljs-string">'ADD_TODO'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> DELETE_TODO = <span class="hljs-string"><span class="hljs-string">'DELETE_TODO'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> EDIT_TODO = <span class="hljs-string"><span class="hljs-string">'EDIT_TODO'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> COMPLETE_TODO = <span class="hljs-string"><span class="hljs-string">'COMPLETE_TODO'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> COMPLETE_ALL = <span class="hljs-string"><span class="hljs-string">'COMPLETE_ALL'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> CLEAR_COMPLETED = <span class="hljs-string"><span class="hljs-string">'CLEAR_COMPLETED'</span></span></code> </pre> <br><p>  For some reason I think that there is not and sometimes meeting someone‚Äôs code </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (action.type === ADD_TODO) { <span class="hljs-comment"><span class="hljs-comment">// ... }</span></span></code> </pre> <br><p>  instead of a switch-case core, I understand that I‚Äôm not the only perfectionist in the world who suffers from this "a little bit wrong" in classic Redux </p><br><p>  If you, dear reader, know this pain, rejoice!  under the cut there is a medicine with only two lines of code :) </p><a name="habracut"></a><br><p>  The situation is especially sad when you try to sort out a large project with a complicated UI.  You see what action methods the component calls, open the file with these actions and it‚Äôs good if the constants are called intuitively there, but there are situations when you start looking in all the reducers where they go. </p><br><p>  In essence, dispatch is a Store method, similar in meaning to the emit method of the good old EventEmitter and in terms of the classic event model, in fact, the Store is subscribed to events whose names are called action types and which are usually given in the form of the aforementioned constants, due to than I constantly had a question, why should I keep it somewhere else, and besides, repeatedly resorting to such an absurd duplication of code?  The original idea is clear, we need to hedge against conflicts and provide some consistency between action and reductors, but is it not impossible to make it more elegant? </p><br><p>  I understand that people are different and if anyone has a reasoned objection to this light discomfort from working with the Redux code, I will be happy to hear any opinions in the comments, but let those who share this feeling, imagine <a href="https://github.com/ifElser/redux-refine">redux-refine</a> </p><br><p>  The basic idea is simple: </p><br><p>  I propose to use instead of a switch-case hash indexed by the type of actions, since the object cannot have the same properties, which eliminates conflicts within a single reducer, and also allows you to export types of actions for the module from which they are dispatched </p><br><p>  Also, this approach provides pure code connectivity, following the logic of one way binding and reflecting the direction of data flow in the application, namely: <br>  we see in the component what methods of the module with actions it uses, and in the module with actions we see how it sends the actions to the reducers. </p><br><p>  At the request of <a href="https://habrahabr.ru/users/tmnhy/" class="user_link">tmnhy I will explain</a> with a clear example: </p><br><p>  in action we do this: </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { actionTypes <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> types1 } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'reducers/reducer1'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { actionTypes <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> types2 } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'reducers/reducer2'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> { ACTION_1_1, ACTION_1_2, ACTION_1_3 } = types1 <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> { ACTION_2_1, ACTION_2_2, ACTION_2_3 } = types2</code> </pre> <br><p>  in rediresers like this: </p><br><p>  reducer1: </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { getActionTypes, connectReducers } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'redux-refine'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> initialState = { <span class="hljs-attr"><span class="hljs-attr">value1</span></span>: <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-attr"><span class="hljs-attr">value2</span></span>: <span class="hljs-string"><span class="hljs-string">''</span></span>, <span class="hljs-attr"><span class="hljs-attr">value3</span></span>: <span class="hljs-literal"><span class="hljs-literal">null</span></span>, } <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> reducers = { <span class="hljs-attr"><span class="hljs-attr">ACTION_1_1</span></span>: <span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">state, {value1}</span></span></span><span class="hljs-function">) =&gt;</span></span> ({...state, value1}), <span class="hljs-attr"><span class="hljs-attr">ACTION_1_2</span></span>: <span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">state, {value2}</span></span></span><span class="hljs-function">) =&gt;</span></span> ({...state, value2}), <span class="hljs-attr"><span class="hljs-attr">ACTION_1_3</span></span>: <span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">state, {value3}</span></span></span><span class="hljs-function">) =&gt;</span></span> ({...state, value3}), } <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> actionTypes = getActionTypes(reducers) <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-keyword"><span class="hljs-keyword">default</span></span> connectReducers(initialState, reducers)</code> </pre> <br><p>  reducer2: </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { getActionTypes, connectReducers } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'redux-refine'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> initialState = { <span class="hljs-attr"><span class="hljs-attr">value1</span></span>: <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-attr"><span class="hljs-attr">value2</span></span>: <span class="hljs-string"><span class="hljs-string">''</span></span>, <span class="hljs-attr"><span class="hljs-attr">value3</span></span>: <span class="hljs-literal"><span class="hljs-literal">null</span></span>, } <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> reducers = { <span class="hljs-attr"><span class="hljs-attr">ACTION_2_1</span></span>: <span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">state, {value1}</span></span></span><span class="hljs-function">) =&gt;</span></span> ({...state, value1}), <span class="hljs-attr"><span class="hljs-attr">ACTION_2_2</span></span>: <span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">state, {value2}</span></span></span><span class="hljs-function">) =&gt;</span></span> ({...state, value2}), <span class="hljs-attr"><span class="hljs-attr">ACTION_2_3</span></span>: <span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">state, {value3}</span></span></span><span class="hljs-function">) =&gt;</span></span> ({...state, value3}), } <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> actionTypes = getActionTypes(reducers) <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-keyword"><span class="hljs-keyword">default</span></span> connectReducers(initialState, reducers)</code> </pre> <br><p>  in the place where you prefer to combine the redusers everything is as before: </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { combineReducers } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'redux'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> reducer1, { initialState <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> stateSection1 } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'./reducer1'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> reducer2, { initialState <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> stateSection2 } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'./reducer2'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> intitialState = { stateSection1, stateSection2 } <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-keyword"><span class="hljs-keyword">default</span></span> combineReducers({ <span class="hljs-attr"><span class="hljs-attr">stateSection1</span></span>: reducer1, <span class="hljs-attr"><span class="hljs-attr">stateSection2</span></span>: reducer2 })</code> </pre><br><p>  Yes, of course, I understand that this is a very petty innovation, but it‚Äôs much more pleasant for me to work with the code from this style :) </p><br><p>  And please, do not judge strictly, if that - this is my first post on Habr√© </p><br><p>  UPD: </p><br><p>  Snatching a lot of comments, interesting, but expressed with varying degrees of misunderstanding about what it is - redux-refine, I decided to add an even more detailed explanation: </p><br><p>  Here is what I did: </p><br><p>  1 Replaced the switch-case structure with a choice of key in hash: </p><br><p>  this </p><br><pre> <code class="hljs kotlin">function reducer(state, {type, <span class="hljs-keyword"><span class="hljs-keyword">data</span></span>}){ switch(type) { case <span class="hljs-string"><span class="hljs-string">'one'</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> {...state, ...<span class="hljs-keyword"><span class="hljs-keyword">data</span></span>}; case <span class="hljs-string"><span class="hljs-string">'two'</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> {...state, ...<span class="hljs-keyword"><span class="hljs-keyword">data</span></span>}; case <span class="hljs-string"><span class="hljs-string">'three'</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> {...state, ...<span class="hljs-keyword"><span class="hljs-keyword">data</span></span>}; <span class="hljs-keyword"><span class="hljs-keyword">default</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> state; } }</code> </pre> <br><p>  replaced it </p><br><pre> <code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">reducer</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">state, {type, data}</span></span></span><span class="hljs-function">)</span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> ({ <span class="hljs-attr"><span class="hljs-attr">one</span></span>: {...state, ...data}, <span class="hljs-attr"><span class="hljs-attr">two</span></span>: {...state, ...data}, <span class="hljs-attr"><span class="hljs-attr">three</span></span>: {...state, ...data} })[type] || state; }</code> </pre> <br><p>  2 Brought a hash from the function osprey so as not to recreate it with each call, and each property of this hash made <del>  by method </del>  pure function, which passes the necessary data in the arguments. </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> reducers = { <span class="hljs-attr"><span class="hljs-attr">one</span></span>: <span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">state, data</span></span></span><span class="hljs-function">) =&gt;</span></span> ({...state, ...data}), <span class="hljs-attr"><span class="hljs-attr">two</span></span>: <span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">state, data</span></span></span><span class="hljs-function">) =&gt;</span></span> ({...state, ...data}), <span class="hljs-attr"><span class="hljs-attr">three</span></span>: <span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">state, data</span></span></span><span class="hljs-function">) =&gt;</span></span> ({...state, ...data}) } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">reducer</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">state, {type, data}</span></span></span><span class="hljs-function">)</span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> (redusers[type] || (<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">state</span></span></span><span class="hljs-function"> =&gt;</span></span> state))(state, data); }</code> </pre> <br><p>  3 Instead of declaring constants, I used the export of hash keys, since they are unique by definition, thus creating the ability to import these keys in actions from reducer, which allows you to visually show with what reducer this module works with actions. </p><br><p>  And please, do not fuss, because redux-refine works in exactly the same way as a classic reducer - just one to one, which is why I said that you can use it at the same time as the usual approach. </p><br><p>  This is not some kind of new architecture, not some kind of new bells and whistles - it's just an improvement in the code-type and ensuring the visibility of the links between the modules of the classic editor. </p></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <p>Source: <a href="https://habr.com/ru/post/342894/">https://habr.com/ru/post/342894/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../342884/index.html">The story of the creation of the second game on Unity (or how I found strength after the first failure)</a></li>
<li><a href="../342886/index.html">GitHub warns developers about vulnerabilities in their projects.</a></li>
<li><a href="../342888/index.html">Quad Saga and HPE Storage</a></li>
<li><a href="../342890/index.html">Report from the mini-conference. Using visual models in IT. Verified by experience</a></li>
<li><a href="../342892/index.html">Apache Kafka and millions of messages per second</a></li>
<li><a href="../342896/index.html">Vote for schooling computer science</a></li>
<li><a href="../342900/index.html">Open web interface for .NET (OWIN)</a></li>
<li><a href="../342902/index.html">New Juniper MX Series Routers</a></li>
<li><a href="../342904/index.html">What is the difference between JavaScript and ECMAScript?</a></li>
<li><a href="../342906/index.html">Perlin's noise</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>