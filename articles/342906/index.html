<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Perlin's noise</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="I used Perlin's noise to create a fog effect and the main screen in Under Construction . I tweeted about my efforts to optimize the algorithm , and se...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Perlin's noise</h1><div class="post__text post__text-html js-mediator-article"><p>  I used Perlin's noise to create a fog effect and the main screen in <a href="https://eev.ee/release/2016/05/25/under-construction-our-pico-8-game/">Under Construction</a> .  I <a href="https://twitter.com/eevee/status/731633681735917568">tweeted about my efforts to optimize the algorithm</a> , and several people responded that they did not understand how Perlin noise worked and what it really is. </p><br><p>  I admit that I (a little) understand Perlin‚Äôs noise primarily because I implemented it earlier, and it took me a few days to dive into the clumsy explanations of half a dozen developers more interested in showing their own demos than in a real explanation.  Several useful resources that I found often contained <i>errors</i> and did not give me an intuitive sense of understanding how and <i>why</i> it still works. </p><br><a name="habracut"></a><br><h2>  What is Perlin noise </h2><br><p>  In the domestic sense, "noise" is a random trash.  Here is some pixel noise. </p><br><p><img src="https://habrastorage.org/getpro/habr/post_images/7b9/261/ebe/7b9261ebe5905ef87036a7d1c6be5aa7.png" alt="image"></p><br><p>  This is <i>white</i> noise.  Roughly speaking, this means that all pixels are random and independent of each other.  The average color value for these pixels should be # 808080, gray color - for this picture it is equal to # 848484, which is pretty close. </p><br><p>  Noise is useful for generating random patterns, especially for unpredictable natural phenomena.  The image above can be a good starting point for creating, for example, gravel texture. </p><br><p>  However, most things are not purely random.  Smoke, clouds, the landscape may have some element of randomness, but they were created as a result of very complex interactions of many tiny particles.  White noise contains <i>independent</i> particles (or pixels).  To generate something more interesting than gravel, we need a different kind of noise. </p><br><p>  Often this noise is Perlin‚Äôs noise, which looks like this: </p><br><p><img src="https://habrastorage.org/getpro/habr/post_images/037/d41/497/037d41497b98a2661269168a95231314.png" alt="image"></p><br><p>  I hope that you are familiar with this picture, even if as a result of the corresponding filter in Photoshop.  (I created it in GIMP using the menu Filters ‚Üí Render ‚Üí Clouds ‚Üí Solid Noise.) </p><br><p>  The most obvious difference is that the picture looks "cloudy."  If we talk about technical details, it is <i>continuous</i> - if you greatly increase its scale, the gradient will always be smooth.  There are no abrupt transitions from black to white, so the algorithm works surprisingly well when something ‚Äúrandom‚Äù is needed, but not too much.  Here is the sky, which can be quickly made from the same picture: </p><br><p><img src="https://habrastorage.org/getpro/habr/post_images/646/2be/164/6462be164b57413e8e5fa1dfb2ce265b.png" alt="image"></p><br><p> All I did was add the bottom layer of blue and use the levels to cut out the darkest parts of the noise.  It could have been done better, but for ten seconds of work it will come down.  You can even tile the plane seamlessly with this image! </p><br><h2>  Perlin's noise from scratch </h2><br><p>  You can create Perlin noise in any number of measurements.  The image above is, of course, two-dimensional, but it is much easier to explain in one dimension, where there is only one input and one output.  You can easily illustrate the explanation on a regular chart. </p><br><p>  To begin, choose for each integer <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">x </font></font></span><span class="MJXp-mo" id="MJXp-Span-3" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">= </font></font></span><span class="MJXp-mn" id="MJXp-Span-4"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0 </font></font></span><span class="MJXp-mo" id="MJXp-Span-5" style="margin-left: 0em; margin-right: 0.222em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font></span><span class="MJXp-mn" id="MJXp-Span-6"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1 </font></font></span><span class="MJXp-mo" id="MJXp-Span-7" style="margin-left: 0em; margin-right: 0.222em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font></span><span class="MJXp-mn" id="MJXp-Span-8"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2 </font></font></span><span class="MJXp-mo" id="MJXp-Span-9" style="margin-left: 0em; margin-right: 0.222em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font></span><span class="MJXp-mn" id="MJXp-Span-10"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3 </font></font></span><span class="MJXp-mo" id="MJXp-Span-11" style="margin-left: 0em; margin-right: 0.222em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font></span><span class="MJXp-mo" id="MJXp-Span-12" style="margin-left: 0em; margin-right: 0.222em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font></span><span class="MJXp-mo" id="MJXp-Span-13" style="margin-left: 0em; margin-right: 0.222em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font></span><span class="MJXp-mo" id="MJXp-Span-14" style="margin-left: 0em; margin-right: 0.222em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font></span><span class="MJXp-mo" id="MJXp-Span-15" style="margin-left: 0em; margin-right: 0.222em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">,</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-1-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="16.962ex" height="2.298ex" viewBox="0 -728.2 7303.2 989.6" role="img" focusable="false" style="vertical-align: -0.607ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342906/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhj0VLysrRQdJWMeIww8-AEua7bJTw#MJMATHI-78" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342906/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhj0VLysrRQdJWMeIww8-AEua7bJTw#MJMAIN-3D" x="850" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342906/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhj0VLysrRQdJWMeIww8-AEua7bJTw#MJMAIN-30" x="1906" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342906/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhj0VLysrRQdJWMeIww8-AEua7bJTw#MJMAIN-2C" x="2407" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342906/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhj0VLysrRQdJWMeIww8-AEua7bJTw#MJMAIN-31" x="2852" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342906/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhj0VLysrRQdJWMeIww8-AEua7bJTw#MJMAIN-2C" x="3352" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342906/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhj0VLysrRQdJWMeIww8-AEua7bJTw#MJMAIN-32" x="3797" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342906/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhj0VLysrRQdJWMeIww8-AEua7bJTw#MJMAIN-2C" x="4298" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342906/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhj0VLysrRQdJWMeIww8-AEua7bJTw#MJMAIN-33" x="4743" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342906/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhj0VLysrRQdJWMeIww8-AEua7bJTw#MJMAIN-2C" x="5244" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342906/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhj0VLysrRQdJWMeIww8-AEua7bJTw#MJMAIN-2E" x="5689" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342906/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhj0VLysrRQdJWMeIww8-AEua7bJTw#MJMAIN-2E" x="6134" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342906/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhj0VLysrRQdJWMeIww8-AEua7bJTw#MJMAIN-2E" x="6579" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342906/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhj0VLysrRQdJWMeIww8-AEua7bJTw#MJMAIN-2C" x="7024" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-1"> x = 0, 1, 2, 3, ..., </script>  random real out of range <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-16"><span class="MJXp-mo" id="MJXp-Span-17" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[ </font></font></span><span class="MJXp-mo" id="MJXp-Span-18" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- </font></font></span><span class="MJXp-mn" id="MJXp-Span-19"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1 </font></font></span><span class="MJXp-mo" id="MJXp-Span-20" style="margin-left: 0em; margin-right: 0.222em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">; </font></font></span><span class="MJXp-mn" id="MJXp-Span-21"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1 </font></font></span><span class="MJXp-mo" id="MJXp-Span-22" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">]</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-2-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="6.461ex" height="2.66ex" viewBox="0 -832 2781.7 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342906/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhj0VLysrRQdJWMeIww8-AEua7bJTw#MJMAIN-5B" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342906/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhj0VLysrRQdJWMeIww8-AEua7bJTw#MJMAIN-2212" x="278" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342906/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhj0VLysrRQdJWMeIww8-AEua7bJTw#MJMAIN-31" x="1057" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342906/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhj0VLysrRQdJWMeIww8-AEua7bJTw#MJMAIN-3B" x="1557" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342906/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhj0VLysrRQdJWMeIww8-AEua7bJTw#MJMAIN-31" x="2002" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342906/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhj0VLysrRQdJWMeIww8-AEua7bJTw#MJMAIN-5D" x="2503" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-2"> [- 1; 1] </script>  .  This will be the slope (tangent of the angle of inclination) of a straight line passing through a given point on the number axis, which I drew in blue: </p><br><p><img src="https://habrastorage.org/getpro/habr/post_images/b7c/83b/9b3/b7c83b9b37a47a1cab8524fbf84bf75c.png"></p><br><p>  No matter how many points you choose.  Each segment ‚Äî the space between two serif points ‚Äî will be processed in the same way.  As long as you can memorize the angles of inclination of the straight lines, you can continue to set the notches on both sides of the number axis.  These lines are enough to create Perlin noise. </p><br><p>  Each <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-23"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-24"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">x</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-3-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.33ex" height="1.455ex" viewBox="0 -520.7 572.5 626.5" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342906/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhj0VLysrRQdJWMeIww8-AEua7bJTw#MJMATHI-78" x="0" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-3"> x </script>  lies between two serifs and, consequently, between two straight lines.  Let the straight lines have slopes <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-25"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-26"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">a</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-4-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.23ex" height="1.455ex" viewBox="0 -520.7 529.5 626.5" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342906/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhj0VLysrRQdJWMeIww8-AEua7bJTw#MJMATHI-61" x="0" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-4"> a </script>  and <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-27"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-28"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">b</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-5-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="0.998ex" height="2.057ex" viewBox="0 -780.1 429.5 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342906/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhj0VLysrRQdJWMeIww8-AEua7bJTw#MJMATHI-62" x="0" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-5"> b </script>  .  The equation of a line can be written as <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-29"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-30"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">y </font></font></span><span class="MJXp-mo" id="MJXp-Span-31" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">= </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-32"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">m </font></font></span><span class="MJXp-mo" id="MJXp-Span-33" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">( </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-34"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">x </font></font></span><span class="MJXp-mo" id="MJXp-Span-35" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- </font></font></span><span class="MJXp-msubsup" id="MJXp-Span-36"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-37" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">x </font></font></span><span class="MJXp-mn MJXp-script" id="MJXp-Span-38" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0</font></font></span></span><span class="MJXp-mo" id="MJXp-Span-39" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> )</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-6-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="14.658ex" height="2.66ex" viewBox="0 -832 6310.9 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342906/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhj0VLysrRQdJWMeIww8-AEua7bJTw#MJMATHI-79" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342906/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhj0VLysrRQdJWMeIww8-AEua7bJTw#MJMAIN-3D" x="775" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342906/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhj0VLysrRQdJWMeIww8-AEua7bJTw#MJMATHI-6D" x="1831" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342906/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhj0VLysrRQdJWMeIww8-AEua7bJTw#MJMAIN-28" x="2710" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342906/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhj0VLysrRQdJWMeIww8-AEua7bJTw#MJMATHI-78" x="3099" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342906/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhj0VLysrRQdJWMeIww8-AEua7bJTw#MJMAIN-2212" x="3894" y="0"></use><g transform="translate(4895,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342906/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhj0VLysrRQdJWMeIww8-AEua7bJTw#MJMATHI-78" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342906/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhj0VLysrRQdJWMeIww8-AEua7bJTw#MJMAIN-30" x="809" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342906/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhj0VLysrRQdJWMeIww8-AEua7bJTw#MJMAIN-29" x="5921" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-6"> y = m (x-x_0) </script>  where <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-40"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-41"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">m</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-7-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.04ex" height="1.455ex" viewBox="0 -520.7 878.5 626.5" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342906/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhj0VLysrRQdJWMeIww8-AEua7bJTw#MJMATHI-6D" x="0" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-7"> m </script>  - tilt <br><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-42"><span class="MJXp-msubsup" id="MJXp-Span-43"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-44" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">x </font></font></span><span class="MJXp-mn MJXp-script" id="MJXp-Span-45" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0</font></font></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-8-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.384ex" height="1.817ex" viewBox="0 -520.7 1026.4 782.1" role="img" focusable="false" style="vertical-align: -0.607ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342906/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhj0VLysrRQdJWMeIww8-AEua7bJTw#MJMATHI-78" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342906/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhj0VLysrRQdJWMeIww8-AEua7bJTw#MJMAIN-30" x="809" y="-213"></use></g></svg></span><script type="math/tex" id="MathJax-Element-8"> x_0 </script>  - meaning <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-46"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-47"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">x</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-9-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.33ex" height="1.455ex" viewBox="0 -520.7 572.5 626.5" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342906/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhj0VLysrRQdJWMeIww8-AEua7bJTw#MJMATHI-78" x="0" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-9"> x </script>  where the straight line intersects the x-axis. </p><br><p>  Armed with this knowledge, it is easy to find where these two straight lines intersect the given <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-48"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-49"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">x</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-10-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.33ex" height="1.455ex" viewBox="0 -520.7 572.5 626.5" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342906/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhj0VLysrRQdJWMeIww8-AEua7bJTw#MJMATHI-78" x="0" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-10"> x </script>  .  For simplicity, I will assume that the left serif is in <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-50"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-51"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">x </font></font></span><span class="MJXp-mo" id="MJXp-Span-52" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">= </font></font></span><span class="MJXp-mn" id="MJXp-Span-53"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-11-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.591ex" height="1.937ex" viewBox="0 -728.2 2407.1 834" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342906/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhj0VLysrRQdJWMeIww8-AEua7bJTw#MJMATHI-78" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342906/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhj0VLysrRQdJWMeIww8-AEua7bJTw#MJMAIN-3D" x="850" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342906/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhj0VLysrRQdJWMeIww8-AEua7bJTw#MJMAIN-30" x="1906" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-11"> x = 0 </script>  and right in <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-54"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-55"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">x </font></font></span><span class="MJXp-mo" id="MJXp-Span-56" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">= </font></font></span><span class="MJXp-mn" id="MJXp-Span-57"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-12-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.591ex" height="1.937ex" viewBox="0 -728.2 2407.1 834" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342906/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhj0VLysrRQdJWMeIww8-AEua7bJTw#MJMATHI-78" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342906/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhj0VLysrRQdJWMeIww8-AEua7bJTw#MJMAIN-3D" x="850" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342906/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhj0VLysrRQdJWMeIww8-AEua7bJTw#MJMAIN-31" x="1906" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-12"> x = 1 </script>  ;  it will give points <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-58"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-59"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">a </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-60"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">x</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-13-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.559ex" height="1.455ex" viewBox="0 -520.7 1102 626.5" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342906/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhj0VLysrRQdJWMeIww8-AEua7bJTw#MJMATHI-61" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342906/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhj0VLysrRQdJWMeIww8-AEua7bJTw#MJMATHI-78" x="529" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-13"> ax </script>  and <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-61"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-62"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">b </font></font></span><span class="MJXp-mo" id="MJXp-Span-63" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">( </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-64"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">x </font></font></span><span class="MJXp-mo" id="MJXp-Span-65" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- </font></font></span><span class="MJXp-mn" id="MJXp-Span-66"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1 </font></font></span><span class="MJXp-mo" id="MJXp-Span-67" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">)</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-14-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="8.139ex" height="2.66ex" viewBox="0 -832 3504.4 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342906/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhj0VLysrRQdJWMeIww8-AEua7bJTw#MJMATHI-62" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342906/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhj0VLysrRQdJWMeIww8-AEua7bJTw#MJMAIN-28" x="429" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342906/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhj0VLysrRQdJWMeIww8-AEua7bJTw#MJMATHI-78" x="819" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342906/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhj0VLysrRQdJWMeIww8-AEua7bJTw#MJMAIN-2212" x="1613" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342906/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhj0VLysrRQdJWMeIww8-AEua7bJTw#MJMAIN-31" x="2614" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342906/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhj0VLysrRQdJWMeIww8-AEua7bJTw#MJMAIN-29" x="3114" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-14"> b (x - 1) </script>  . </p><br><p>  I drew a pack of orange dots for example.  You can see how they continue two sloping lines on each side. </p><br><p><img src="https://habrastorage.org/getpro/habr/post_images/9fe/972/0df/9fe9720df1b420c1f723f0c8b9ca85f2.png"></p><br><p>  Now the question arises: how can these pairs of points for each <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-68"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-69"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">x</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-15-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.33ex" height="1.455ex" viewBox="0 -520.7 572.5 626.5" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342906/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhj0VLysrRQdJWMeIww8-AEua7bJTw#MJMATHI-78" x="0" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-15"> x </script>  turn into a smooth curve?  The most obvious answer is to average them, but a quick glance at the graph shows that this approach does not work.  The ‚Äúaverage‚Äù of two straight lines is simply a straight line with an average slope passing through the intersection point, and the segment of this straight line for each such segment will not even touch the same segment in the adjacent segment. </p><br><p>  We need a way to increase the contribution of the left end to the ‚Äúaverage‚Äù for points closer to it, and to reduce this contribution when we are closer to the right end.  The easiest way to do this is <a href="https://ru.wikipedia.org/wiki/%25D0%259B%25D0%25B8%25D0%25BD%25D0%25B5%25D0%25B9%25D0%25BD%25D0%25B0%25D1%258F_%25D0%25B8%25D0%25BD%25D1%2582%25D0%25B5%25D1%2580%25D0%25BF%25D0%25BE%25D0%25BB%25D1%258F%25D1%2586%25D0%25B8%25D1%258F">linear interpolation</a> . </p><br><p>  Linear interpolation is extremely simple: if you are at the point <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-70"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-71"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">t</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-16-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="0.84ex" height="1.937ex" viewBox="0 -728.2 361.5 834" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342906/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhj0VLysrRQdJWMeIww8-AEua7bJTw#MJMATHI-74" x="0" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-16"> t </script>  on the way out <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-72"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-73"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-17-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.743ex" height="2.057ex" viewBox="0 -780.1 750.5 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342906/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhj0VLysrRQdJWMeIww8-AEua7bJTw#MJMATHI-41" x="0" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-17"> A </script>  at <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-74"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-75"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">B</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-18-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.764ex" height="2.057ex" viewBox="0 -780.1 759.5 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342906/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhj0VLysrRQdJWMeIww8-AEua7bJTw#MJMATHI-42" x="0" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-18"> B </script>  , linear interpolation will be equal to <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-76"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-77"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A </font></font></span><span class="MJXp-mo" id="MJXp-Span-78" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">+ </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-79"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">t </font></font></span><span class="MJXp-mo" id="MJXp-Span-80" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">( </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-81"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">B </font></font></span><span class="MJXp-mo" id="MJXp-Span-82" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-83"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A </font></font></span><span class="MJXp-mo" id="MJXp-Span-84" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">)</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-19-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="13.58ex" height="2.66ex" viewBox="0 -832 5846.9 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342906/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhj0VLysrRQdJWMeIww8-AEua7bJTw#MJMATHI-41" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342906/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhj0VLysrRQdJWMeIww8-AEua7bJTw#MJMAIN-2B" x="972" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342906/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhj0VLysrRQdJWMeIww8-AEua7bJTw#MJMATHI-74" x="1973" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342906/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhj0VLysrRQdJWMeIww8-AEua7bJTw#MJMAIN-28" x="2334" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342906/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhj0VLysrRQdJWMeIww8-AEua7bJTw#MJMATHI-42" x="2724" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342906/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhj0VLysrRQdJWMeIww8-AEua7bJTw#MJMAIN-2212" x="3706" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342906/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhj0VLysrRQdJWMeIww8-AEua7bJTw#MJMATHI-41" x="4706" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342906/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhj0VLysrRQdJWMeIww8-AEua7bJTw#MJMAIN-29" x="5457" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-19"> A + t (B - A) </script>  equivalent to <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-85"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-86"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A </font></font></span><span class="MJXp-mo" id="MJXp-Span-87" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">( </font></font></span><span class="MJXp-mn" id="MJXp-Span-88"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1 </font></font></span><span class="MJXp-mo" id="MJXp-Span-89" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-90"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">t </font></font></span><span class="MJXp-mo" id="MJXp-Span-91" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) </font></font></span><span class="MJXp-mo" id="MJXp-Span-92" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">+ </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-93"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">B </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-94"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">t</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-20-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="13.839ex" height="2.66ex" viewBox="0 -832 5958.4 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342906/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhj0VLysrRQdJWMeIww8-AEua7bJTw#MJMATHI-41" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342906/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhj0VLysrRQdJWMeIww8-AEua7bJTw#MJMAIN-28" x="750" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342906/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhj0VLysrRQdJWMeIww8-AEua7bJTw#MJMAIN-31" x="1140" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342906/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhj0VLysrRQdJWMeIww8-AEua7bJTw#MJMAIN-2212" x="1862" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342906/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhj0VLysrRQdJWMeIww8-AEua7bJTw#MJMATHI-74" x="2863" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342906/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhj0VLysrRQdJWMeIww8-AEua7bJTw#MJMAIN-29" x="3224" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342906/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhj0VLysrRQdJWMeIww8-AEua7bJTw#MJMAIN-2B" x="3836" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342906/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhj0VLysrRQdJWMeIww8-AEua7bJTw#MJMATHI-42" x="4837" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342906/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhj0VLysrRQdJWMeIww8-AEua7bJTw#MJMATHI-74" x="5596" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-20"> A (1 - t) + Bt </script>  .  For <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-95"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-96"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">t </font></font></span><span class="MJXp-mo" id="MJXp-Span-97" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">= </font></font></span><span class="MJXp-mn" id="MJXp-Span-98"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-21-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.101ex" height="1.937ex" viewBox="0 -728.2 2196.1 834" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342906/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhj0VLysrRQdJWMeIww8-AEua7bJTw#MJMATHI-74" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342906/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhj0VLysrRQdJWMeIww8-AEua7bJTw#MJMAIN-3D" x="639" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342906/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhj0VLysrRQdJWMeIww8-AEua7bJTw#MJMAIN-30" x="1695" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-21"> t = 0 </script>  , You'll get <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-99"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-100"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-22-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.743ex" height="2.057ex" viewBox="0 -780.1 750.5 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342906/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhj0VLysrRQdJWMeIww8-AEua7bJTw#MJMATHI-41" x="0" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-22"> A </script>  ;  for <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-101"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-102">t</span><span class="MJXp-mo" id="MJXp-Span-103" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-104">1</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-23-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.101ex" height="1.937ex" viewBox="0 -728.2 2196.1 834" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342906/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhj0VLysrRQdJWMeIww8-AEua7bJTw#MJMATHI-74" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342906/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhj0VLysrRQdJWMeIww8-AEua7bJTw#MJMAIN-3D" x="639" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342906/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhj0VLysrRQdJWMeIww8-AEua7bJTw#MJMAIN-31" x="1695" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-23"> t = 1 </script>  , You'll get <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-105"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-106">B</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-24-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.764ex" height="2.057ex" viewBox="0 -780.1 759.5 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342906/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhj0VLysrRQdJWMeIww8-AEua7bJTw#MJMATHI-42" x="0" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-24"> B </script>  ;  for <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-107"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-108">t</span><span class="MJXp-mo" id="MJXp-Span-109" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-110">0.5</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-25-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="6.91ex" height="1.937ex" viewBox="0 -728.2 2975.1 834" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342906/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhj0VLysrRQdJWMeIww8-AEua7bJTw#MJMATHI-74" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342906/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhj0VLysrRQdJWMeIww8-AEua7bJTw#MJMAIN-3D" x="639" y="0"></use><g transform="translate(1695,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342906/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhj0VLysrRQdJWMeIww8-AEua7bJTw#MJMAIN-30"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342906/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhj0VLysrRQdJWMeIww8-AEua7bJTw#MJMAIN-2E" x="500" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342906/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhj0VLysrRQdJWMeIww8-AEua7bJTw#MJMAIN-35" x="779" y="0"></use></g></g></svg></span><script type="math/tex" id="MathJax-Element-25"> t = 0.5 </script>  , You'll get <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-111"><span class="MJXp-mn" id="MJXp-Span-112">0.5</span><span class="MJXp-mo" id="MJXp-Span-113" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-114">A</span><span class="MJXp-mo" id="MJXp-Span-115" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-116">B</span><span class="MJXp-mo" id="MJXp-Span-117" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-26-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="11.129ex" height="2.66ex" viewBox="0 -832 4791.4 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342906/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhj0VLysrRQdJWMeIww8-AEua7bJTw#MJMAIN-30"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342906/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhj0VLysrRQdJWMeIww8-AEua7bJTw#MJMAIN-2E" x="500" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342906/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhj0VLysrRQdJWMeIww8-AEua7bJTw#MJMAIN-35" x="779" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342906/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhj0VLysrRQdJWMeIww8-AEua7bJTw#MJMAIN-28" x="1279" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342906/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhj0VLysrRQdJWMeIww8-AEua7bJTw#MJMATHI-41" x="1669" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342906/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhj0VLysrRQdJWMeIww8-AEua7bJTw#MJMAIN-2B" x="2641" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342906/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhj0VLysrRQdJWMeIww8-AEua7bJTw#MJMATHI-42" x="3642" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342906/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhj0VLysrRQdJWMeIww8-AEua7bJTw#MJMAIN-29" x="4401" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-26"> 0.5 (A + B) </script>  , average. </p><br><p>  Let's try it.  I marked the interpolated points in red. </p><br><p><img src="https://habrastorage.org/getpro/habr/post_images/b00/c18/ec8/b00c18ec8b0d9a4bd70cc6c50b81db76.png"></p><br><p>  Not bad for a start.  This is not the noise of Perlin;  There is one small problem that may not immediately catch the eye at the sight of these points.  I can make it more visible if you forgive me for a brief digression. </p><br><p>  Each of these curves is a parabola given by the equation <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-118"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-119"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">y </font></font></span><span class="MJXp-mo" id="MJXp-Span-120" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">= </font></font></span><span class="MJXp-mo" id="MJXp-Span-121" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">( </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-122"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">a </font></font></span><span class="MJXp-mo" id="MJXp-Span-123" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-124"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">b </font></font></span><span class="MJXp-mo" id="MJXp-Span-125" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) </font></font></span><span class="MJXp-mo" id="MJXp-Span-126" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">( </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-127"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">x </font></font></span><span class="MJXp-mo" id="MJXp-Span-128" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-129"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">x </font></font></span><span class="MJXp-mrow" id="MJXp-Span-130"><span class="MJXp-mo" id="MJXp-Span-131" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">¬≤</font></font></span></span><span class="MJXp-mo" id="MJXp-Span-132" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> )</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-27-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-27"> y = (a - b) (x - x¬≤) </script>  .  I wanted to be able to draw the parabolas exactly, rather than approximate them with dots, that is, figure out how to portray the parabolas using Bezier curves. </p><br><p>  Bezier curves are the same curves that you use to draw paths in vector graphics editors like Inkscape, Illustrator or Flash.  (Or in the SVG vector format that I used to create all these illustrations.) You can select the start and end points, and the program will display additional ‚Äúhandles‚Äù attached to each point.  Dragging these ‚Äúhandles‚Äù changes the shape of the curve.  These are <i>cubic</i> Bezier curves, which are so called due to the fact that they are actually curves of the third order, but in principle it is possible to draw a Bezier curve of any order. </p><br><p>  When studying the mathematics of Bezier curves, I learned a few interesting things: </p><br><ol><li>  SVG supports quadratic Bezier curves!  This is convenient because I have quadratic functions. </li><li>  Bezier curves are set by repeated linear interpolation!  In fact, there is even such a thing as a linear Bezier "curve" - ‚Äã‚Äãa straight line between two given points.  The quadratic Bezier curve has three support points;  you interpolate linearly between the first / second and second / third points, then interpolate between these two new points.  A cubic Bezier curve has four control points and does one more iteration, and so on.  Amazing. </li><li>  Parabolas passing through red dots are very easy to draw with Bezier curves - in fact, Perlin noise has a striking resemblance to Bezier curves!  There is even some explanation.  In the first step, we get the values <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-133"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-134">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-135">x</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-28-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-28"> ax </script>  and <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-136"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-137">b</span><span class="MJXp-mo" id="MJXp-Span-138" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-139">x</span><span class="MJXp-mo" id="MJXp-Span-140" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mn" id="MJXp-Span-141">1</span><span class="MJXp-mo" id="MJXp-Span-142" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-29-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-29"> b (x - 1) </script>  that can be written as <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-143"><span class="MJXp-mo" id="MJXp-Span-144" style="margin-left: 0em; margin-right: 0.111em;">‚àí</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-145">b</span><span class="MJXp-mo" id="MJXp-Span-146" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-147">1</span><span class="MJXp-mo" id="MJXp-Span-148" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-149">x</span><span class="MJXp-mo" id="MJXp-Span-150" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-30-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-30"> -b (1 - x) </script>  and it resembles linear interpolation.  In the second step, the linear interpolation goes the most.  And two rounds of linear interpolation is, by definition, a second-order Bezier curve. </li></ol><br><p>  I think I have a geometric interpretation of what is actually happening. </p><br><p>  Consider a segment.  It has rays (halves of straight lines) that extend from its ends and are directed toward the center of the segment.  Reflect them relative to the middle of the segment, thus obtaining another beam at each end.  At each end, fold the slopes of the beams and get two new beams;  they are a mirror image of each other relative to the middle of the segment, since they are derived from the sum of the original beam and the reflection of the other.  Finally draw a curve between these rays. </p><br><p>  Below, I illustrated these steps.  Dotted lines - reflected rays;  blue - the rays received after summation;  the blue points are their intersections (and the third reference point of the quadratic Bezier curve);  The red arc is the exact curve that passes through the red dots.  If you know the basics of differential calculus, you can make sure that the slope of the left beam is equal to <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-151"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-152">a</span><span class="MJXp-mo" id="MJXp-Span-153" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-154">b</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-31-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-31"> a - b </script>  , the slope of the right beam is <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-155"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-156">b</span><span class="MJXp-mo" id="MJXp-Span-157" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-158">a</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-32-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-32"> b - a </script>  , and it does indicate their symmetry about the center of the segment. </p><br><p><img src="https://habrastorage.org/getpro/habr/post_images/6c5/d89/9e9/6c5d899e911fe6e7189e22c717473b1a.png"></p><br><p>  I hope, now the problem is more obvious: these curves do not transform into each other smoothly. <br>  In each serif a kink is clearly visible.  That break, where both curves look down, is especially bad. </p><br><p>  Linear interpolation, as it turns out, is insufficient.  Even if we are too close to one end, the other still has a significant effect, which protrudes the curve from the original random guide.  This effect should fade away more sharply at the ends of the segments. </p><br><p>  Fortunately, someone has already figured it out for us.  Before we do linear interpolation, <br>  we can shift <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-159"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-160">t</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-33-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-33"> t </script>  using the <a href="https://en.wikipedia.org/wiki/Smoothstep">smoothstep</a> function.  This is an s-shaped curve that looks like a diagonal line. <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-161"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-162">y</span><span class="MJXp-mo" id="MJXp-Span-163" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-164">x</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-34-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-34"> y = x </script>  but flattened at zero and one.  In the middle, it does not change very much - <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-165"><span class="MJXp-mn" id="MJXp-Span-166">0.5</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-35-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-35"> 0.5 </script>  remains <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-167"><span class="MJXp-mn" id="MJXp-Span-168">0.5</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-36-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-36"> 0.5 </script>  - but she strongly shifts the ends.  At the point <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-169"><span class="MJXp-mn" id="MJXp-Span-170">0.9</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-37-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-37"> 0.9 </script>  she is equal <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-171"><span class="MJXp-mn" id="MJXp-Span-172">0.972</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-38-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-38"> 0.972 </script>  . </p><br><p>  The resulting curve has a fourth degree, which does not allow it to be accurately drawn in the SVG using native Bezier curves, so the gray line is a rough approximation.  I compensated for this by adding a large number of dots that are black.  By the way, these points are derived from Ken Perlin's <a href="https://mrl.nyu.edu/~perlin/doc/oscar.html">original noise1</a> ;  This is the real noise of Perlin. </p><br><p><img src="https://habrastorage.org/getpro/habr/post_images/68a/d35/cdc/68ad35cdc6ed4a6338d9783d24c9ba4d.png"></p><br><p>  New points are close to the red quadratic curves, but in the serif area they are closer to the original blue guides.  Middle points exactly match because <i>smoothstep</i> doesn't change <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-173"><span class="MJXp-mn" id="MJXp-Span-174">0.5</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-39-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-39"> 0.5 </script>  . </p><br><p>  (Now the curve equation for each segment looks like <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-175"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-176">y</span><span class="MJXp-mo" id="MJXp-Span-177" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-178">2</span><span class="MJXp-mo" id="MJXp-Span-179" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-180">a</span><span class="MJXp-mo" id="MJXp-Span-181" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-182">b</span><span class="MJXp-mo" id="MJXp-Span-183" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-msubsup" id="MJXp-Span-184"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-185" style="margin-right: 0.05em;">x</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-186" style="vertical-align: 0.5em;">4</span></span><span class="MJXp-mo" id="MJXp-Span-187" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mo" id="MJXp-Span-188" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-189">3</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-190">a</span><span class="MJXp-mo" id="MJXp-Span-191" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mn" id="MJXp-Span-192">5</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-193">b</span><span class="MJXp-mo" id="MJXp-Span-194" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-msubsup" id="MJXp-Span-195"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-196" style="margin-right: 0.05em;">x</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-197" style="vertical-align: 0.5em;">3</span></span><span class="MJXp-mo" id="MJXp-Span-198" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mn" id="MJXp-Span-199">3</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-200">b</span><span class="MJXp-msubsup" id="MJXp-Span-201"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-202" style="margin-right: 0.05em;">x</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-203" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-204" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-205">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-206">x</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-40-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-40"> y = 2 (a - b) x ^ 4 - (3a - 5b) x ^ 3 - 3bx ^ 2 + ax </script>  fuck you will utter.  Feel free to take the derivative and make sure that at the end of the segment it is exactly equal <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-207"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-208">a</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-41-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-41"> a </script>  and <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-209"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-210">b</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-42-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-42"> b </script>  .) </p><br><p>  If you want to get a better intuitive understanding of what is happening, here is the same schedule, <a href="">only interactive</a> !  Click and drag to play around with the slopes. </p><br><br><h2>  Octave </h2><br><p>  You may have noticed that these smooth elevations and valleys are not so similar to the ‚Äúcloudy‚Äù noise that I advertised at the beginning of the article. </p><br><p>  Suddenly, ‚Äúcloudiness‚Äù is not part of Perlin‚Äôs noise.  This is a tricky thing to do <i>with it</i> . </p><br><p>  Create another Perlin curve (or reuse the same one), but double the resolution - now the random oblique lines will be in points <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-211"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-212">x</span><span class="MJXp-mo" id="MJXp-Span-213" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-214">0</span><span class="MJXp-mo" id="MJXp-Span-215" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-216">0.5</span><span class="MJXp-mo" id="MJXp-Span-217" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-218">1</span><span class="MJXp-mo" id="MJXp-Span-219" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-220" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-221" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-222" style="margin-left: 0em; margin-right: 0.222em;">.</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-43-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-43"> x = 0, 0.5, 1, ... </script>  .  Divide output values ‚Äã‚Äãby two and add to the original curve.  It turns out something like this: </p><br><p><img src="https://habrastorage.org/getpro/habr/post_images/144/50c/a0d/14450ca0db73ae8ded2c6eac97a9741d.png"></p><br><p>  The entire schedule has been reduced to half size and repeated twice. </p><br><p>  You can repeat it as many times as you like, making each new schedule half the size of the previous one.  Each separate graph is called <i>an octave</i> (as in music, where each octave has a frequency twice as large as the previous one), and the results are pleasant and rough after 4-5 octaves. </p><br><p><img src="https://habrastorage.org/getpro/habr/post_images/867/18d/696/86718d696fbdf35ee31158127216f0be.png"></p><br><h2>  Expand to 2D </h2><br><p>  The idea is the same, but instead of a numerical axis with oblique lines, we have a grid at the input. <br>  Also, to expand the concept of ‚Äúslope‚Äù in two changes, a <i>vector</i> appears at each grid node: </p><br><p><img src="https://habrastorage.org/getpro/habr/post_images/ab0/459/f30/ab0459f307901523bac267d62f53f4da.png"></p><br><p>  I shortened the arrows so that they fit into the picture and do not overlap each other, but I mean that <i>unit vectors</i> are depicted - that is, each vector actually has a length of 1, and only the information about the direction, not the length, is important to us.  About the generation of vectors, I will tell later. </p><br><p>  It looks like it, but there is an important difference.  Previously, the entrance was horizontal - the position on the x-axis - and the output was vertical.  Now the entrance is <i>two-dimensional</i> - where are we? </p><br><p>  A rough algorithm for what we did before: </p><br><ol><li>  Find the distance to the nearest point to the left and multiply it by the slope at that point. </li><li>  Do the same for the point on the right. </li><li>  Interpolate these values. </li></ol><br><p>  It requires a couple of big changes in order for the algorithm to work in two dimensions.  Each point now has <i>four</i> adjacent grid points, and some semblance of tilt and distance is still required. </p><br><p><img src="https://habrastorage.org/getpro/habr/post_images/f8c/be7/353/f8cbe7353e29424bab90f412bcadaf04.png"></p><br><p>  The solution is to use scalar products.  If you have two vectors <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-223"><span class="MJXp-mo" id="MJXp-Span-224" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-225">a</span><span class="MJXp-mo" id="MJXp-Span-226" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-227">b</span><span class="MJXp-mo" id="MJXp-Span-228" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-44-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-44"> (a, b) </script>  and <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-229"><span class="MJXp-mo" id="MJXp-Span-230" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-231">c</span><span class="MJXp-mo" id="MJXp-Span-232" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-233">d</span><span class="MJXp-mo" id="MJXp-Span-234" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-45-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-45"> (c, d) </script>  , their scalar product is equal to the sum of pairwise products of the corresponding components: <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-235"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-236">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-237">c</span><span class="MJXp-mo" id="MJXp-Span-238" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-239">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-240">d</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-46-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-46"> ac + bd </script>  .  In the diagram above, each grid point has two outgoing vectors: a random one and pointing to the current point.  The product of the slope by the distance can be replaced by the scalar product of these two vectors. </p><br><p>  But <i>why</i> ?  Good question. </p><br><p>  The geometrical explanation of the scalar product says that it is the product of the lengths of the vectors and the cosine of the angle between them.  This doesn‚Äôt really clarify anything for me, and it‚Äôs impossible to draw a graphic graph here, but let's think about it a little. </p><br><p>  All our random vectors are single, their length is 1. This does not contribute to the product.  Therefore, there remains a (scalar) distance from the current point to the grid point multiplied by the cosine of the angle between the vectors. </p><br><p>  Cosine tells you how small this angle is - or, in our case, how close the two vectors are.  If they point in one direction, the cosine is equal to one.  As they are removed, the cosine decreases: for a right angle, it vanishes (and the scalar product is zero), and if they point in opposite directions, the cosine will be ‚Äì1. </p><br><p>  To visualize what this means, I drew a single scalar product between the point and the grid node nearest to it.  This is the equivalent of the orange dots from the one-dimensional graph. </p><br><p><img src="https://habrastorage.org/getpro/habr/post_images/bea/acb/9de/beaacb9ded230cdf6add0f9a757899c2.png"></p><br><p>  It already looks interesting.  Remember, this is something like a three-dimensional graphics, which we look at from above.  Coordinates <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-241"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-242">x</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-47-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-47"> x </script>  and <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-243"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-244">y</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-48-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-48"> y </script>  - this is the input, the points we have selected, and the coordinate <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-245"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-246">z</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-49-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-49"> z </script>  - this is the way out.  It is usually painted in shades of gray, as I did here, but you can also display it as depth.  White dots come out of the screen in your direction, gray ones go deep into the screen. </p><br><p>  In this sense, each mesh node has an inclined <i>plane</i> attached to it, as opposed to inclined lines in the one-dimensional case.  The vector points towards the white end, the end that sticks out of the screen in your direction.  For points close to the grid node, the scalar product is close to zero, as in the one-dimensional graph;  for points farther from zero, the values ‚Äã‚Äãare closer to extremes. </p><br><p>  It may not be a surprise for you if I say that random vectors in this case are called <i>gradients</i> . </p><br><p>  Now, when at each point there are four scalar products, we need to somehow combine them.  Linear interpolation works only for two values, so we will do it in pairs.  One round of interpolation will leave us with two values, the second will give one value, which will be our output. </p><br><p>  I tried to make a diagram depicting an intermediate state, to show how to combine several gradients, but I couldn‚Äôt think of something meaningful. </p><br><p>  In return, take this <a href="">interactive mesh with Perlin noise</a> , where you can also shuffle the arrows and see how this affects the final pattern. </p><br><h2>  Three or more measurements </h2><br><p>  From this point on it is not at all difficult to expand the idea to an arbitrary number of measurements. <br>  Select more unit vectors in the required number of dimensions, calculate more scalar products, interpolate. </p><br><p>  Do not forget about one thing: each interpolation round must ‚Äúcollapse‚Äù one of the axes. </p><br><p>  Consider the plane where you need to calculate the scalar product for the four points: upper left, upper right, lower left, lower right.  Two measurements, two rounds of interpolation. </p><br><p>  You can interpolate between the two upper points and the lower two points;  this will ‚Äúcollapse‚Äù the horizontal axis and leave only two values, upper and lower.  Or you can do the opposite, ‚Äúcollapse‚Äù the left and right points, getting rid of the vertical axis and leaving the left and right points.  Both are good. </p><br><p>  But what exactly you can not do - crosswise interpolation.  You need to know with which coefficient to interpolate, that is, how far you are from each point.  Horizontal interpolation is good because we know the horizontal distance to the grid nodes.  Vertical interpolation is good because we know the vertical distance.  Interpolation on the diagonal?  What does it mean?  What value does it take <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-247"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-248">t</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-50-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-50"> t </script>  ?  Even if we succeed, how will we do the second round of interpolation? </p><br><p>  Three or more dimensions make it a little harder to keep track of such things, so be on your guard. </p><br><h2>  Variations </h2><br><p>  The idea of ‚Äã‚ÄãPerlin noise is quite simple, and almost any part of it can be changed to obtain different effects. </p><br><h3>  Gradient Selection </h3><br><p>  I know three ways to select gradients. </p><br><p>  The most obvious way is to choose <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-249"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-250">n</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-51-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-51"> n </script>  random numbers from range <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-251"><span class="MJXp-mo" id="MJXp-Span-252" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mo" id="MJXp-Span-253" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mn" id="MJXp-Span-254">1</span><span class="MJXp-mo" id="MJXp-Span-255" style="margin-left: 0em; margin-right: 0.222em;">;</span><span class="MJXp-mn" id="MJXp-Span-256">1</span><span class="MJXp-mo" id="MJXp-Span-257" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-52-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-52"> [- 1; 1] </script>  (for <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-258"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-259">n</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-53-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-53"> n </script>  measurements), use the Pythagorean theorem to find the length of the vector, normalize the vector to the length.  Voila, you have a unit vector.  This is done in the original Ken Perlin code. </p><br><p>  It works, but it gives more diagonal vectors than those directed along the axes, for the same reason as throwing two dice will most often give a sum of 7 points.  You need a random <i>angle</i> , not a coordinate. </p><br><p>  For two dimensions, this is easy: take a random angle!  Choose a random number from the range <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-260"><span class="MJXp-mo" id="MJXp-Span-261" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mn" id="MJXp-Span-262">0</span><span class="MJXp-mo" id="MJXp-Span-263" style="margin-left: 0em; margin-right: 0.222em;">;</span><span class="MJXp-mn" id="MJXp-Span-264">2</span><span class="MJXp-mtext" id="MJXp-Span-265">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-266">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-267">i</span><span class="MJXp-mo" id="MJXp-Span-268" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-54-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-54"> [0; 2 \ pi] </script>  .  Call it <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-269"><span class="MJXp-mtext" id="MJXp-Span-270">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-271">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-272">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-273">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-274">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-275">a</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-55-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-55"> \ theta </script>  .  Your vector <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-276"><span class="MJXp-mo" id="MJXp-Span-277" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-278">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-279">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-280">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-281">s</span><span class="MJXp-mtext" id="MJXp-Span-282">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-283">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-284">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-285">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-286">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-287">a</span><span class="MJXp-mo" id="MJXp-Span-288" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mtext" id="MJXp-Span-289">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-290">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-291">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-292">n</span><span class="MJXp-mtext" id="MJXp-Span-293">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-294">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-295">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-296">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-297">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-298">a</span><span class="MJXp-mo" id="MJXp-Span-299" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-56-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-56"> (\ cos \ theta, \ sin \ theta) </script>  .  Is done. </p><br><p>  For the three dimensions ... uh </p><br><p>  Well, I looked at MathWorld and found a <a href="http://mathworld.wolfram.com/SpherePointPicking.html">solution</a> that, I think, works in any dimension.  The principle is the same: take n random numbers and normalize the vector derived from them.  The difference is that the numbers are taken from the <i>normal</i> distribution - that is, the Gaussian distribution is used.  In Python, there is a <b>random.gauss ()</b> function for this;  in C, well, I think you can simulate this function by calculating the sum of a heap of numbers from a uniform distribution.  Anyway, the idea is to throw the dice many times. </p><br><p>  This does not work well for a single measurement, where normalization will always give 1 or ‚Äì1, and the result will look awful.  In this case, you just need to take one random number. </p><br><p>  The third method proposed by Ken Perlin in <a href="http://mrl.nyu.edu/~perlin/paper445.pdf">‚ÄúImproving Noise‚Äù</a> suggests not to choose random gradients at all!  Instead, use a fixed set of vectors and choose random ones. </p><br><p>  Why do so?  One of the reasons is to solve the problem of ‚Äústicking‚Äù, which, I believe, was partially due to a shift in the orientation of the gradients towards the diagonal ones.  But the other reason was ... </p><br><h3>  Optimization </h3><br><p>  I forgot to mention the key feature of Ken Perlin's original implementation.  She did not create a set of random gradients for each grid point;  she created a set of random gradients of a fixed size, then used a selection scheme from this set of gradients for each individual grid point.  This saved memory and worked very quickly, but still allowed points to have arbitrarily low or high values. </p><br><p>  The proposal for "improvement" has done away with random gradients for good, offering instead (for the three-dimensional case) a set of 16 gradients, in which one coordinate is zero and the other two take values <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-300"><span class="MJXp-mtext" id="MJXp-Span-301">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-302">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-303">m</span><span class="MJXp-mn" id="MJXp-Span-304">1</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-57-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-57"> \ pm1 </script>  .  These vectors are no longer single, but scalar products are much easier to read.  The element of randomness is provided by the gradient selection scheme at each particular grid point.  For the generation of large pieces of noise, it turned out that it works well. </p><br><p>  None of these optimizations are necessary for obtaining Perlin noise, but they may be useful to you if you are going to generate a lot of noise in real time. </p><br><h3>  Smootherstep </h3><br><p>  The choice of the function <i>smoothstep is</i> quite arbitrary;  You can use any function that flattens at zero and one. </p><br><p>  Improving Noise offers an alternative called <i>smootherstep</i> , which looks like this: <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-305"><span class="MJXp-mn" id="MJXp-Span-306">6</span><span class="MJXp-msubsup" id="MJXp-Span-307"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-308" style="margin-right: 0.05em;">x</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-309" style="vertical-align: 0.5em;">5</span></span><span class="MJXp-mo" id="MJXp-Span-310" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mn" id="MJXp-Span-311">15</span><span class="MJXp-msubsup" id="MJXp-Span-312"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-313" style="margin-right: 0.05em;">x</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-314" style="vertical-align: 0.5em;">4</span></span><span class="MJXp-mo" id="MJXp-Span-315" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-316">10</span><span class="MJXp-msubsup" id="MJXp-Span-317"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-318" style="margin-right: 0.05em;">x</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-319" style="vertical-align: 0.5em;">3</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-58-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-58"> 6x ^ 5 - 15x ^ 4 + 10x ^ 3 </script>  .  You can create similar polynomials of higher order, although they, of course, will increase the running time of the algorithm. </p><br><p>  There is no reason not to use, say, a sine wave interpolation: <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-320"><span class="MJXp-mn" id="MJXp-Span-321"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0.5 </font></font></span><font style="vertical-align: inherit;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-323"><font style="vertical-align: inherit;">s </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-324"><font style="vertical-align: inherit;">i </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-325"><font style="vertical-align: inherit;">n </font></span><span class="MJXp-mo" id="MJXp-Span-326" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;">( </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-328"><font style="vertical-align: inherit;">p </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-329"><font style="vertical-align: inherit;">i </font></span><span class="MJXp-mo" id="MJXp-Span-330" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;">( </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-331"><font style="vertical-align: inherit;">x </font></span><span class="MJXp-mo" id="MJXp-Span-332" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;">- </font></span><span class="MJXp-mn" id="MJXp-Span-333"><font style="vertical-align: inherit;">0.5 </font></span><span class="MJXp-mo" id="MJXp-Span-334" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;">) </font></span><span class="MJXp-mo" id="MJXp-Span-335" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;">) </font></span><span class="MJXp-mo" id="MJXp-Span-336" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;">+ </font></span><span class="MJXp-mn" id="MJXp-Span-337"><font style="vertical-align: inherit;">0.5</font></span></font><span class="MJXp-mtext" id="MJXp-Span-322">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-323"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-324"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-325"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mo" id="MJXp-Span-326" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mtext" id="MJXp-Span-327">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-328"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-329"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mo" id="MJXp-Span-330" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-331"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mo" id="MJXp-Span-332" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mn" id="MJXp-Span-333"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mo" id="MJXp-Span-334" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mo" id="MJXp-Span-335" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mo" id="MJXp-Span-336" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mn" id="MJXp-Span-337"><font style="vertical-align: inherit;"></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-59-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-59"> 0.5 \ sin (\ pi (x - 0.5)) + 0.5 </script>  .  Despite its impracticality and significantly lower speed compared to polynomials, this is quite a valid interpolation version. </p><br><p><img src="https://habrastorage.org/getpro/habr/post_images/c02/cdc/f0e/c02cdcf0e9bd01b00c4aa590dafaa7e0.png"></p><br><p>  For me, it's pretty similar.  smootherstep   ,    . </p><br><h3>  </h3><br><p>      ;     .           - . </p><br><p> <a href="http://www.noisemachine.com/talk1/">  </a>     ,            ,       . </p><br><p>     ,  .     ! </p><br><h3>  </h3><br><p>    ,    .  . </p><br><h3> - </h3><br><p>   ,         .        :   ,   ,   smoothstep. </p><br><p> <a href="https://en.wikipedia.org/wiki/Simplex_noise">-</a>  ,     .     ,    4   8.     5   16. </p><br><p>       ,        ,    -      . </p><br><h2>   </h2><br><p>             . </p><br><p>    ‚Äî    .      , ,    ,     ,     . </p><br><p>    ‚Äî     ! ‚Äî       <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-338"><span class="MJXp-mo" id="MJXp-Span-339" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[ </font></font></span><span class="MJXp-mo" id="MJXp-Span-340" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- </font></font></span><span class="MJXp-mn" id="MJXp-Span-341"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1 </font></font></span><span class="MJXp-mo" id="MJXp-Span-342" style="margin-left: 0em; margin-right: 0.222em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">; </font></font></span><span class="MJXp-mn" id="MJXp-Span-343"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1 </font></font></span><span class="MJXp-mo" id="MJXp-Span-344" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">]</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-60-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-60">[-1; 1]</script>  .   <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-345"><span class="MJXp-mo" id="MJXp-Span-346" style="margin-left: 0em; margin-right: 0.111em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">¬± </font></font></span><span class="MJXp-mn" id="MJXp-Span-347"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0.5 </font></font></span><span class="MJXp-msqrt" id="MJXp-Span-348"><span class="MJXp-surd"><span style="font-size: 134%; margin-top: 0.104em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚àö</font></font></span></span><span class="MJXp-root"><span class="MJXp-rule" style="border-top: 0.08em solid;"></span><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-349"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">n</font></font></span></span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-61-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-61">\pm0.5\sqrt{n}</script>  where <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-350"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-351"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">n</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-62-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-62"> n </script> ‚Äî  .       <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-352"><span class="MJXp-mo" id="MJXp-Span-353" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[ </font></font></span><span class="MJXp-mo" id="MJXp-Span-354" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- </font></font></span><span class="MJXp-mn" id="MJXp-Span-355"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0.5 </font></font></span><span class="MJXp-mo" id="MJXp-Span-356" style="margin-left: 0em; margin-right: 0.222em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">; </font></font></span><span class="MJXp-mn" id="MJXp-Span-357"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0.5 </font></font></span><span class="MJXp-mo" id="MJXp-Span-358" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">]</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-63-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-63">[-0.5; 0.5]</script> ( ,     ,   ),        <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-359"><span class="MJXp-mo" id="MJXp-Span-360" style="margin-left: 0em; margin-right: 0.111em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">¬± </font></font></span><span class="MJXp-mn" id="MJXp-Span-361"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0.5 </font></font></span><span class="MJXp-msqrt" id="MJXp-Span-362"><span class="MJXp-surd"><span style="font-size: 134%; margin-top: 0.104em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚àö</font></font></span></span><span class="MJXp-root"><span class="MJXp-rule" style="border-top: 0.08em solid;"></span><span class="MJXp-box"><span class="MJXp-mn" id="MJXp-Span-363"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2</font></font></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-364" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ‚âà</font></font></span><span class="MJXp-mo" id="MJXp-Span-365" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">¬±</font></font></span><span class="MJXp-mn" id="MJXp-Span-366"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0.707</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-64-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-64">\pm0.5\sqrt{2} \approx \pm0.707</script> (    ).       ,     ,    . </p><br><p> , ,   .      50%;  ‚Äî  75%;  ‚Äî  87.5%   . </p><br><p>      ,    .      ,   GIMP: </p><br><p><img src="https://habrastorage.org/getpro/habr/post_images/f33/f0e/c77/f33f0ec77bd67d41b771c3b314853461.png"></p><br><p>   ,    ;   .  , ,     ‚Öõ    .       ,   ,   :                ,   ‚Äî     .    . </p><br><p>       ,    ,      ‚Ä¶ , smoothstep.        <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-367"><span class="MJXp-mo" id="MJXp-Span-368" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[ </font></font></span><span class="MJXp-mn" id="MJXp-Span-369"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0 </font></font></span><span class="MJXp-mo" id="MJXp-Span-370" style="margin-left: 0em; margin-right: 0.222em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font></span><span class="MJXp-mn" id="MJXp-Span-371"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1 </font></font></span><span class="MJXp-mo" id="MJXp-Span-372" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">]</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-65-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-65">[0, 1]</script>  . </p><br><p> ,      ,       . </p><br><p>     .    ,      .        roguelike-.     ,     .   <a href="https://eev.ee/blog/2016/05/25/under-construction-our-pico-8-game/">Under Construction</a> ‚Äî   ,      ,   . </p><br><p>  ,     <i>   </i>   ,      .   ,    ‚Äî     ()  : </p><br><p><img src="https://habrastorage.org/getpro/habr/post_images/9c9/19f/808/9c919f808931d070f7d1d13f2abb3ff9.gif"></p><br><h2>     </h2><br><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Well, here you are, of course. </font></font><a href="https://gist.github.com/eevee/26f547457522755cb1fb8739d0ea89a1"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Here is the implementation in Python</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">I do not know if I can substantiate the selection in a separate module, and somehow it is too lazy.</font></font></p><br><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Some cool stuff: </font></font></p><br><ul><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Unlimited range </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Unlimited measurements </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Native octave support </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Native tiling support </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> A bunch of comments, some may even be true. </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Maybe too slow </font></font></li></ul><br><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Here is the code that creates the above animation: </font></font></p><br><pre><code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> perlin <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> PerlinNoiseFactory <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> PIL.Image size = <span class="hljs-number"><span class="hljs-number">200</span></span> res = <span class="hljs-number"><span class="hljs-number">40</span></span> frames = <span class="hljs-number"><span class="hljs-number">20</span></span> frameres = <span class="hljs-number"><span class="hljs-number">5</span></span> space_range = size//res frame_range = frames//frameres pnf = PerlinNoiseFactory(<span class="hljs-number"><span class="hljs-number">3</span></span>, octaves=<span class="hljs-number"><span class="hljs-number">4</span></span>, tile=(space_range, space_range, frame_range)) <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> t <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> range(frames): img = PIL.Image.new(<span class="hljs-string"><span class="hljs-string">'L'</span></span>, (size, size)) <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> x <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> range(size): <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> y <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> range(size): n = pnf(x/res, y/res, t/frameres) img.putpixel((x, y), int((n + <span class="hljs-number"><span class="hljs-number">1</span></span>) / <span class="hljs-number"><span class="hljs-number">2</span></span> * <span class="hljs-number"><span class="hljs-number">255</span></span> + <span class="hljs-number"><span class="hljs-number">0.5</span></span>)) img.save(<span class="hljs-string"><span class="hljs-string">"noiseframe{:03d}.png"</span></span>.format(t)) print(t)</code> </pre> <br><p>  Runs at 1:40 for PyPy 3. </p></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <p>Source: <a href="https://habr.com/ru/post/342906/">https://habr.com/ru/post/342906/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../342894/index.html">redux-refine - simple perfectionist joy</a></li>
<li><a href="../342896/index.html">Vote for schooling computer science</a></li>
<li><a href="../342900/index.html">Open web interface for .NET (OWIN)</a></li>
<li><a href="../342902/index.html">New Juniper MX Series Routers</a></li>
<li><a href="../342904/index.html">What is the difference between JavaScript and ECMAScript?</a></li>
<li><a href="../342914/index.html">Using buildSrc to implement additional logic in Gradle</a></li>
<li><a href="../342916/index.html">Biorobots of our time - we get rid of the routine with Telegram. Real case without fantasies</a></li>
<li><a href="../342918/index.html">Three, seven, joker - analysis of the solution of problems from the GridGain booklet at the Joker 2017 conference</a></li>
<li><a href="../342922/index.html">Stupid js. Make filters "beauty"</a></li>
<li><a href="../342924/index.html">Programming under ARM TrustZone. Secure monitor</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>