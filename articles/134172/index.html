<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>In the footsteps of myth destroyers or Why Android slows down, and% is not a mobile OS%?</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Good afternoon, Habr! 

 My previous translation of the article about hardware acceleration in Android caused a heated discussion in the comments, the...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>In the footsteps of myth destroyers or Why Android slows down, and% is not a mobile OS%?</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/storage1/1de512eb/fd4ccc8c/34f3fcc0/17ca7d15.png"><br><br>  Good afternoon, Habr! <br><br>  My previous translation of the article <a href="http://habrahabr.ru/blogs/android_development/134003/">about hardware acceleration in Android</a> caused a heated discussion in the comments, the main motive of which was the question ‚Äúso why does Android slow down?‚Äù.  A similar situation is observed throughout the Internet, and therefore I give below another very interesting and fresh translation (again from Google+), where the author Andrew Munn (about him below) analyzes the real causes of Android brakes.  I enjoyed reading this post myself and proud of the opportunity to be the first to share it with the habrasoobschestvom. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <a name="habracut"></a><br><br><h5>  Why Android slows down, while iOS, Windows Phone 7, QNX and WebOS are so smooth in their work? </h5><br><br>  This post is designed to answer this question. <br><br>  However, before moving on to the point, a few reservations.  First of all, I am a third-year student in the field of software engineering.  I was interned in the Android team, and Romain Guy, who was responsible for most of the hardware acceleration work in Honeycomb, reviewed some of the sections and my code, but I was not in the team developing the framework itself, and I never read the source code of the rendering code in Android.  I do not have any serious authority on the knowledge of Android and I can not guarantee that I speak here, be sure to be 100% accurate, but I did my best to argue my words. <br><br>  Secondly, I'm on an internship at the Windows Phone team starting in January, so it‚Äôs quite possible that this post could subconsciously turn me against Android, but if you ask any of my friends, it‚Äôs really difficult to ask me not to chat about Android  I have more Android T-shirts than days a week, and I would prefer to give away my Macbook than my Nexus S. Googlplex is like a second home.  In any case, my interests are probably biased in favor of Android. <br><br>  So let's proceed to the analysis of the previous article on myths (this is the full version of Diana Hackborn's post). <br><br>  Diana begins her post with an amazing revelation: <br><br>  ‚ÄúLooking at the rendering inside the window, we do not have to use hardware acceleration to achieve the full 60FPS.  It largely depends on the number of pixels in the display and the speed of your processor.  For example, the Nexus S has no problems with 60 frames per second for all the normal things you see on the Android UI, such as scrolling through lists on its 800x480 screen. ‚Äù <br><br>  Yah?  How can this be?  Anyone who has used the Nexus S knows that it slows down with everything except simple ListViews.  And forget about any kind of decent performance, if in the background, something happens, such as installing an application or updating the user interface from the internal drive.  On the other hand, iOS works 100% smoothly even when installing applications.  But we know Diana is not lying about the potential performance of the CPU, so what happens? <br><br><h5>  The main reason </h5><br><br>  This is not a pause due to the garbage collector.  This is not because Android works via bytecode, but iOS works on native code.  This is because in iOS, the rendering of the entire interface occurs in a separate user interface stream in real-time priority mode.  On the other hand, Android follows the traditional PC model, in which the main rendering takes place with normal priority. <br><br>  This is not an abstract or academic difference.  You can see it on your own.  Grab the nearest iPad or iPhone and open Safari.  Start downloading a complex webpage such as Facebook.  In the middle of loading, put your finger on the screen and move it around.  All rendering stops instantly.  The site simply will not load until you remove your finger.  This is because the UI thread intercepts all events and the UI is rendered in real time. <br><br>  If you repeat this exercise on Android, you will notice that the browser will try to both render the page and display the HTML, i.e.  do "perfectly well" both one and the other.  For Android, this is the case when an effective dual-core processor really helps, which is why the Galaxy S II is famous for its smoothness. <br><br>  On iOS, when the application is installed from the App Store, and you put your finger on the screen, the installation will instantly pause until rendering is complete.  Android tries to do both with the same priority, so the frame rate suffers.  As soon as you notice how this happens, you will see that it is everywhere on your Android phone.  Why is scrolling slow in the Movies app?  Because movie thumbnails are dynamically added to the movie list when you scroll down, but on iOS, they are quietly added only when the scrolling stops. <br><br>  Several people undertook to explain the mistakes I made in the simplified description of the drawing process in iOS.  In particular: <br><br>  1) Compositing and pre-tuning of animation - everything that includes Core Animation and rendering of accompanying layers really occurs in the background thread. <br><br>  2) Rendering of new content in the Core Animation layer and setting up their animation occurs in the main stream.  This is the same thread in which the user interface is drawn. <br><br>  3) In the native code, all the code created by the developer will occur in the main thread.  However, Apple offers a very simple API (Grand Central Dispatch and NSOperation) to move these things into system-managed background threads.  In iOS 5, you can even state that Core Data (object-relational databases) context cannot be used directly in the main thread. <br><br>  What do we notice?  The image is not rendered until you finish scrolling through the list, the page rendering in WebKit stops, when the system tracks the touch of the screen, this is the initially built-in mechanism that pauses the whole world while the finger is on the screen. <br>  (Actually, this is not quite true: the main thread is placed in a special mode while monitoring the sensor, and by default, certain callbacks are delayed in this mode. However, many other things, such as booting from disk or network activity, are stored completely in the background thread, without stopping, none of this automatically pauses at the time of scrolling. The developer must clearly indicate the delay for these things).  This deliberate behavior is carefully implemented by the developer of each individual application. <br><br>  This is not a technical difference, it is a cultural difference.  Good iOS developers do not release software until it works at about 60 frames per second when scrolling and tracks touches almost perfectly, as well as good Android developers do. <br><br><h5>  Other reasons </h5><br><br>  The main reason why Android slows down is the structure of UI threads and their priority, but this is not the only reason.  First, hardware acceleration, despite Diana‚Äôs reservations, still helps.  My Nexus S has never worked so smoothly since upgrading to ICS [note translation: Mine too!  :)].  Hardware acceleration makes a huge difference in applications such as the home screen and the Android Market.  Help provided by the GPU also increases battery life, because graphics processors are hardware with fixed functions, so they work with less power consumption. <br><br>  Secondly, contrary to what I stated earlier, garbage collection is still a problem, even when working part-time with GC in Dalvik.  For example, if you have ever used a photo gallery app in Honeycomb or ICS, you might wonder why the frame rate is so low.  It turns out that the frame rate is limited to 30 frames per second, and scrolling of photos is possible at 60 FPS in most cases, but sometimes the garbage collector pauses lead to a noticeable ‚Äústutter‚Äù.  Limiting the frame rate to 30 fixes "stuttering" and provides smooth animation all the time. <br><br>  Thirdly, there are problems with the equipment, which is also mentioned by Diana.  Tegra 2, despite the ambitious claims from the Nvidia marketing department, is detrimental to low memory bandwidth and does not support the NEON instruction set (the NEON instruction in ARM is the equivalent of Intel's SSE, which allow you to quickly calculate matrices per CPU).  Honeycomb tablets would be better with different GPUs, even if they were theoretically less powerful in some respects than Tegra 2. For example, Samsung Hummingbird in Nexus S or Apple A4.  This tells us that the fastest Honeycomb-released tablet, Tab Galaxy 7.7, runs on an Exynos processor with the Galaxy S II. <br><br>  Fourth, Android has a way to switch to more efficient user interface compositing.  in iOS, each type of user interface is displayed separately and stored in memory, so for many animations only a GPU is required to view the recomposition of the user interface.  GPUs are very good at this.  Unfortunately, on Android, the user interface hierarchy is flattened before rendering, so the animation requires redrawing every sector of the screen in which it occurs. <br><br>  Fifth, the Dalvik VM is not as advanced as the desktop JVM.  Java is notorious for the terrible performance of GUIs on desktops.  However, many issues are not transferred to the implementation of Dalvik.  Swing was terrible because it was a cross-platform layer on top of the native API.  It is interesting to note that Windows Phone 7 in the main user interface is built on native code, although the original plan was to be based entirely on Silverlight.  In the end, Microsoft decided that to give the interface the necessary performance, the code should be native.  It's easy to see the difference between native and bytecode on Windows Phone 7, since third-party applications written in Silverlight are inferior in performance (Nodo and Mango have mitigated this problem and Silverlight interfaces are usually very smooth now). <br><br>  Fortunately, each of the five questions listed above will be resolved without radical changes in Android.  Hardware acceleration will be on all Android ICS phones, Dalvik continues to improve the efficiency of its garbage collector, Tegra 2 will finally become obsolete, there are workarounds for existing interface composition problems, and Dalvik VM becomes faster with each release.  I recently asked Jason Kincaid with TechCrunch how smooth the Galaxy Nexus was and he responded: <br><br>  ‚ÄúIn general, I found the Galaxy Nexus ICS fairly smooth in operation.  There are random stutters - one place where I can get consistently scared on the Galaxy Nexus, this is when I press the multitasking button, where it will often be suspended for a quarter of a second.  However, I believe that the iPhone 4S also slowed down more than I expected, especially when I switched to accessing the general search for apps (where you swipe left from the main screen). ‚Äù <br><br>  So, let's go, the Android brake problem is basically solved, isn't it?  Not so fast. <br><br><h5>  Forward to the future </h5><br><br>  The Android UI will never be completely smooth due to the design constraints that we discussed at the very beginning: <br><br>  - Rendering of the interface occurs on the main flow of the application; <br>  - Rendering of the interface occurs with normal priority; <br><br>  Even with the Galaxy Nexus, or EeePad Transformer Prime quad-core processor, there is no way to ensure smoothness and an acceptable frame rate if these two design constraints remain in force.  This says that the power of the Galaxy Nexus will be enough to compare the smoothness of the work with the first iPhone three years ago.  So why did the Android team use just such a rendering structure? <br><br>  Work on Android began even before the release of the iPhone, and at that time the Android system was designed to be a competitor to the Blackberry.  The original Android prototype did not have a touch screen.  Android tradeoffs make sense of devices with a hardware keyboard and trackball.  And when the iPhone came out, the Android team rushed to release a competitor to this product, but, unfortunately, it was too late to rewrite the entire user interface of the system. <br><br>  This is the very reason why Windows Mobile 6.5, Blackberry OS, Symbian have terrible touchscreen performance.  Like Android, they were not designed to ‚Äúprioritize‚Äù the rendering of the user interface.  After the release of the iPhone, RIM, Microsoft, and Nokia abandoned their mobile operating systems and started developing from scratch.  Android is the only mobile OS that existed before the ‚ÄúiPhone era‚Äù. <br><br>  So why didn't the Android team change the status quo?  I will let Romain Guy explain: <br><br>  "... A lot of the work that we have to do today exists because of a certain choice made many years ago ........ The animation of the user interface is the biggest problem. We are working on other solutions to try to improve it (the ability to use a separate rendering stream, and etc.). A simple solution, of course, is the creation of a new graphical toolkit, but there are many drawbacks to this approach. " <br><br>  Romain does not specify what the disadvantages and disadvantages in this decision, but it is not difficult to assume: <br><br>  - All applications must be rewritten to support the new structure; <br>  - Android will have to provide support mode for older applications; <br>  - Work on other features of Android will be suspended until the new system is developed; <br><br>  However, I believe that writing from scratch should happen, despite these drawbacks and flaws.  As a novice manager, I think Android‚Äôs sluggishness is absolutely unacceptable.  You should make this question a priority number 1 for the Android team. <br><br>  When the topic of Android rises as a technically savvy and non-technically educated friends, I hear again and again that Android slows down and works slowly.  The reality is that Android can open applications and display web pages as quickly or even faster than iOS, but perception is everything.  Fixing a braking UI this will be the beginning of a long journey to restore the reputation and image of Android. <br><br>  The perception of a problem, a brake, is a violation of Google‚Äôs philosophy.  Google thinks everything should be fast.  Here is the leading philosophy of Google Search, Gmail, and Chrome.  That‚Äôs why Google created SPDY to improve HTTP.  That‚Äôs why Google creates tools to help optimize your site.  That‚Äôs why Google launches its own CDN.  That is why Google Maps is displayed using WebGL.  That is why buffering on Youtube is something that most of us remember well, but see less and less. <br><br>  But perhaps one of the most important reasons for the backlog in the Android interface unacceptably comes from the field of human-machine interaction (HCI).  Modern touch screens assume a one-to-one correspondence between the finger and the animation on the screen.  That is why the effect of re-scrolling in iOS (elastic) is so cool, fun, and intuitive.  And that's why Virgin America Flights airline touchscreens are so frustrating: they are incredibly slow and very inaccurate. <br><br>  The user interface brakes interrupt the connection between the person and the touchscreen.  Communication with the device ceases to be natural.  It loses magic.  The user is excluded from interaction with them and must unconditionally recognize that they use imperfect computer modeling.  I often ‚Äúget lost‚Äù in the iPad, but it distorts me even more when Xoom stutters between the screens.  200 million Android users deserve the best. <br><br>  And I know they will get it eventually.  The Android team is one of the most dedicated and talented development teams in the world.  With stars such as Diana Hackborn and Romain Guy Android is in good hands. <br><br>  I hope that this post will reduce confusion around the Android brakes. <br>  A bit of luck, and Android 5.0 will bring us the smooth Android we all dreamed about since the release of the HTC G1.  At the same time, I will be working in Redmond on a beautiful and smooth mobile OS, and try to give her some of the recognition she deserves. </div><p>Source: <a href="https://habr.com/ru/post/134172/">https://habr.com/ru/post/134172/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../134167/index.html">Automatic parsing of letters coming to tech support</a></li>
<li><a href="../134168/index.html">Public election control using cloud IT</a></li>
<li><a href="../134169/index.html">Changing the type of data output in LogCat</a></li>
<li><a href="../134170/index.html">ABBYY FineFoto: a fan from the camera</a></li>
<li><a href="../134171/index.html">What are optimizing compilers for?</a></li>
<li><a href="../134174/index.html">Processing the archive of video records in the LiveVideoArc virtual machine</a></li>
<li><a href="../134175/index.html">Cycling with turn signals</a></li>
<li><a href="../134176/index.html">The SETI program resumes operation with the detection of exoplanets Kepler-22b</a></li>
<li><a href="../134178/index.html">CD-ROM printer</a></li>
<li><a href="../134179/index.html">MySql -> Oracle Replication with Tungsten Replicator</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>