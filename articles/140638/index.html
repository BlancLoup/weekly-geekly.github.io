<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>DirectX Debugging - Easy.</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Understanding the processes occurring "under the hood" DirectX has always been fraught with difficulties and forced to use additional tools, such as f...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>DirectX Debugging - Easy.</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/storage2/a62/19e/78e/a6219e78ee1fa1b2987d78a8e66f6971.png" align="left">  Understanding the processes occurring "under the hood" DirectX has always been fraught with difficulties and forced to use additional tools, such as for example Pix.  But progress does not stand still, many ideas and ready-made solutions are now embedded in Visual Studio 11 beta.  This tool allows you to significantly simplify debugging DirectX applications and give the programmer the opportunity to thoroughly understand the processes that form the image.  Now each pixel can be thoroughly studied, and the whole story of his life is obtained. <br><a name="habracut"></a><br><h4>  New debug mode </h4><br>  In the debugging menu of Visual Studio 11 beta, a new item has appeared - <b>‚ÄúDebug / Graphics‚Äù</b> , and within the framework of this article I will explain the purpose of each item. <br><br><img src="https://habrastorage.org/storage2/b58/a52/64f/b58a5264f0f2c7b4540ba43310063348.png"><br><br>  It all starts with the item <b>"Start Diagnostics"</b> .  This is a special launch mode of your DirectX application, in which the debugging system allows you to take snapshots of current frames.  As you can see, in the corner of the application, an overlay is visible in which the current number of rendered frames is displayed, the time from the start of the application launch, as well as the amount of memory occupied by snapshots. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <img src="https://habrastorage.org/storage2/c5b/fe4/8d7/c5bfe48d78cc51f56125f62e3e65f90b.png"><br><br>  Pressing the ‚ÄúPrint Screen‚Äù button generates a complete dump of the frame state, which includes the generated image, as well as a lot of additional information, which further allows you to understand what processes led to what we see on the screen, as well as what resources for this were required. <br><br><img src="https://habrastorage.org/storage2/28b/410/bef/28b410bef9c252a4f44dc33d62e095a4.png"><br><br>  Calling the menu item <b>‚ÄúDebug / Graphics / Object Table‚Äù</b> will help you figure out what resources are currently used to form this screen, how much memory they occupy, when they were created (in which frame), their resolution and many other information.  Naturally, resources are not only textures, but also shaders, various buffers, states and views.  This information will allow further optimization steps.  For example, to be able to run your application on weaker hardware. <br><br><img src="https://habrastorage.org/storage2/d0b/ac3/1e2/d0bac31e20bb970f4063c4e8b2d12455.png"><br><br><h4>  More details </h4><br><br>  The <b>‚ÄúDebug / Graphics / Pixel History‚Äù</b> menu allows more detailed understanding of what was happening at the moment of image formation.  In order to see the history of the formation of a particular pixel, it must be indicated by a crosshair.  In the panel "Graphics Pixel History" will be presented the whole history of its creation. <br><br><img src="https://habrastorage.org/storage2/a6c/be7/015/a6cbe70155bd4e171ae4c0b90eb4f00d.png"><br><br>  The four draw calls that are visible in the panel are actually drawing: <br><ol><li>  Background </li><li>  Back of the globe </li><li>  Front of the globe with transparency </li><li>  Drawing rays reaching along the meridians </li></ol><br><img src="https://habrastorage.org/storage2/831/f41/26b/831f4126bf486766b8e5c45cab54d4c6.gif"><br><br>  Each Draw method, in turn, interacts with the graphics subsystem pipeline, and thanks to the <b>‚ÄúDebug / Graphics / Pipeline Stages‚Äù</b> menu item <b>,</b> you can see the details of this interaction. <br><br><img src="https://habrastorage.org/storage2/18b/899/2a4/18b8992a4e42fd4e4719eeb5d90a4908.png"><br><br>  Each of the four steps of the conveyor can be tested on phases <br><br><ol><li>  Acceptance of the original geometry. </li><li>  Geometric transformations with vertex shaders, usually in order to set the proportions and turns of the object on the screen, the direction of the camera. </li><li>  Geometry processing by pixel shaders, actually coloring on the basis of any lighting model and textures. </li><li>  The final formation of the image with the combination of for example the previous steps of the render. </li></ol><br><br><img src="https://habrastorage.org/storage2/acc/853/e5c/acc853e5c601a10da42299bc3f0118cd.gif"><br><br><h4>  Back to the code </h4><br>  From the panel ‚ÄúGraphics Pixel History‚Äù it is also easy to get to the code that is executed by our application at each step.  To do this, just use the <b>‚ÄúDebug / Graphics / Event Call Stack‚Äù</b> menu item and select the source file that was responsible for this call, after which the source file will be positioned on the line that made the call. <br><br><img src="https://habrastorage.org/storage2/7ef/93b/05e/7ef93b05e506aed5cfb3ccbc46d380af.png"><br><br>  In exactly the same way, by expanding the Draw call we are interested in, you can get the shader source code that handled this call in the pipeline.  We do not forget that all the current diagnostics is now in front of us for a completely specific pixel, and we can even get the values ‚Äã‚Äãof the variable innerColour for this frame, if desired.  For those who are not familiar with DirectX, I will explain some details.  The code that is presented on the screen is the HLSL firmware which, after compilation, is executed for each pixel of the image by the graphics accelerator.  These firmware may have parameters, one of which is highlighted in blue. <br><br><img src="https://habrastorage.org/storage2/d75/484/ee3/d75484ee34ed82076732ca79f70c5f03.png"><br><br>  The full state of the DirectX subsystem at the time of the Draw call for our pixel can be obtained as a report by clicking on the calls in the "Graphics Pixel History" panel.  The report is very voluminous. <br><br><img src="https://habrastorage.org/storage2/139/437/51d/13943751d370eb9d73b1692b817acd48.png"><br><br><br>  Having found in the report information about the state of the pixel shader, you can get data about the buffer of constants used for parameterization. <br><br><img src="https://habrastorage.org/storage2/9f3/875/55a/9f387555ac0cbf86d824d0179eeba835.png"><br><br>  By clicking on the link obj: 35 you can see the status of this buffer.  The values ‚Äã‚Äãof the first four cells of which are the color (R, G, B, Alpha) of the input parameter innerColour. <br><br><img src="https://habrastorage.org/storage2/598/15d/2d4/59815d2d4f851701b57e57cc1dc7a4cd.png"><br><br>  But this is certainly not all.  In the future, it is possible to get to the source code of the program that generated these values ‚Äã‚Äã(0.3 0.3 0.3 1.0).  To do this, you can use the menu item <b>"Debug / Graphics / Event List"</b> .  Selecting the Draw call we are interested in in the Graphics Pixel History panel, in the Graphics Event List panel we get the full list of DirectX API calls and look for the updateSubResource method for updating the shader parameters.  A suggestion that this is the method that interests us is also a reference to obj: 35.  And then using the panel "Graphics Call Stack" we find ourselves in a particular place in our program where this call was realized. <br><br><img src="https://habrastorage.org/storage2/826/481/039/82648103970b4c10630e2a325f933cd2.png"><br><br>  Now it is enough to use the usual menu item <b>‚ÄúFind All References‚Äù</b> to find the line with the task of the parameters that interested us. <br><br><img src="https://habrastorage.org/storage2/d5d/626/cf0/d5d626cf099a625c71508e573eea2667.png"><br><br><h4>  Shader Debugging </h4><br>  Debugging HLSL shaders is also not something extraordinary for Visual Studio 11 beta.  To do this, it is sufficient to enable the creation of debug information for the shader source file. <br><br><img src="https://habrastorage.org/storage2/911/543/9e6/9115439e616d29113d65207763737d69.png"><br><br>  It remains only to arrange the breakpoints in the usual for Visual Studio mode and with the same features (for example, Condition break points).  When a shader function containing a breakpoint is called, an interrupt will occur and it will be possible to examine the current values ‚Äã‚Äãof the variables. <br><br><img src="https://habrastorage.org/storage2/3f8/ad5/71f/3f8ad571f7ba20a11802b0485bd2b34e.png"><br><br><h4>  Conclusion </h4><br>  As it became clear from the article, debugging DirectX applications can be greatly simplified thanks to the tools included in Visual Studio 11 beta. <br><br>  Let me remind you that you can download Visual Studio 11 beta right now at <a href="http://www.microsoft.com/visualstudio/ru-ru">www.microsoft.com/visualstudio/ru-ru</a> </div><p>Source: <a href="https://habr.com/ru/post/140638/">https://habr.com/ru/post/140638/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../140631/index.html">FCGI :: ProcManager module development</a></li>
<li><a href="../140633/index.html">Rails-based REST providers: a nightmare with views</a></li>
<li><a href="../140634/index.html">Sony patents new fingerprint sensor for smartphone display</a></li>
<li><a href="../140635/index.html">Android: reader with synchronization between devices</a></li>
<li><a href="../140636/index.html">How to tell your game about an asshole</a></li>
<li><a href="../140639/index.html">Game Way: play with a stranger</a></li>
<li><a href="../140640/index.html">Casket with music lock</a></li>
<li><a href="../140641/index.html">Part number 5. Biochemistry on folding. One fundamental problem</a></li>
<li><a href="../140643/index.html">Installation of userscripts in Opera in general cases and for secure pages (https)</a></li>
<li><a href="../140644/index.html">Using mental maps for teaching with the example of Cisco CCNA Exploration</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>