<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Simple Time Manager for Android</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="I decided to write an article at my leisure on how to write applications for Android. Write will be a simple time manager. In this part, I will write ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Simple Time Manager for Android</h1><div class="post__text post__text-html js-mediator-article"><img src="http://nixan.org/habr/timetracker/4.png" align="left">  I decided to write an article at my leisure on how to write applications for Android.  Write will be a simple time manager.  In this part, I will write the program itself, attach the interface with animation to it, and in the next one, if interested, write a service to it, so that the program also works in the background. <br><br>  What will be considered: <br><ul><li>  RelativeLayout for implementing the program interface with overlapping images on each other. </li><li>  Timer to implement a time counting algorithm. </li><li>  Animation for <s>whistlers</s> beautiful applet interface. </li></ul><br><br>  For clarity, added a screencast how all this stuff works. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      So, we write a simple time manager for Android. <br><a name="habracut"></a><br>  Suppose that the SDK + Eclipse is already installed. <br><br><img src="http://nixan.org/habr/timetracker/1.png"><br>  Launch Eclipse, and go to File - New - Other. <br>  In the window that opens, select Android - Android Project. <br><br><img src="http://nixan.org/habr/timetracker/2.png"><br>  This window will open. <br>  We drive in parameters: <br>  <b>Project Name</b> is the name of the project, it must be unique in the current Workspace. <br>  <b>BuildTarget</b> - OS version for which the project is being built.  It should be remembered that when collecting a project for 1.5, it will run on both 1.6 and 2.1, and if you build for 1.6, then on 1.5 it will not. <br>  <b>Application Name</b> - the name of the application.  It will be displayed in the main menu, from where it can be launched. <br>  <b>Package Name</b> - com. &lt;Office name&gt;. &lt;Applet name&gt; <br>  <b>Create Activity</b> - the name of the Activity to launch the application. <br>  Since the screen was made after writing the project, you can notice the error ‚ÄúThere is already a file ...‚Äù on top of me because a project with that name has already been created. <br>  Click Finish. <br><br><h1>  Interface </h1><br><img src="http://nixan.org/habr/timetracker/3.png"><br>  This is the kind of view that should be brought to it, while the text size of the timers should be the same, increase / decrease due to Animation. <br>  To do this, use RelativeLayout with three children: ImageView, for the shadow at the top of the applet, and two LinearLayouts, one for the timers and one for the buttons at the bottom. <br>  If you have time and opportunity you can draw everything yourself, but for every fireman I attach an archivist with all the graphic elements. <br><br>  <a href="">TimeTracker.zip (194Kb)</a> <br>  Unpack and throw the <b>bg.png</b> , <b>* .9.png</b> , <b>icon.png</b> and <b>topshadow.png</b> files <b>into the</b> <b>drawable</b> <b>directory</b> . <br>  9.png is a 9-patch drawable.  You can read more about it at <a href="http://developer.android.com/guide/developing/tools/draw9patch.html">developer.android.com/guide/developing/tools/draw9patch.html</a> , I note only that these files have the ability to stretch only certain parts of the image if necessary.  So buttons work for me.  If the content text is larger than the original image, or the button has the layout_width / height = fill_parent attribute, then android will not stretch the entire bitmap, but only the marked areas. <br><br>  <i>When I started to do it I did not take into account, but for the future I will note that these images should have a minimum length and width, I have the same width - 100px, so I will not make the button a hundred pixels anymore.</i> <br><br>  Now you need to let the android know how to stretch the background image, header, and change the images from the button state. <br>  To do this, create in the folder <b>drawable</b> files: background.xml, greebutton.xml, redbutton.xml and header.xml. <br><br>  In the first file we write: <br><pre>
 &lt;bitmap xmlns: android = "http://schemas.android.com/apk/res/android"
 android: src = "@ drawable / bg"
 android: tileMode = "repeat" /&gt;

</pre><br>  src - the path to the bitmap, namely to the bg.png file, which is in the drawable folder. <br>  tileMode - how to draw the surface correctly. <br><br>  For greenbutton.xml: <br><pre>
 &lt;? xml version = "1.0" encoding = "utf-8"? # 62;
 &lt;selector xmlns: android = "http://schemas.android.com/apk/res/android"&gt;
	 &lt;item android: state_pressed = "true"
		 android: drawable = "@ drawable / greenbutton_dark" /&gt; &lt;! - pressed -&gt;
	 &lt;item android: state_focused = "true"
		 android: drawable = "@ drawable / greenbutton_dark" /&gt; &lt;! - focused -&gt;
	 &lt;item android: drawable = "@ drawable / greenbutton_light" /&gt; &lt;! - default -&gt;
  &lt;/ selector&gt;

</pre><br>  Specify bitmap for each button state.  You can, for example, add a picture for the state of focused. <br><br>  For redbutton.xml, everything is the same as in greenbutton.xml, with the exception of bitmaps.  At Habr√© people are smart, I think you will understand what you need to write there. <br>  For header.xml, too, everything is the same as in background.xml, only with a different bitmap. <br><br>  Moving to the daddy layout - there are xml files that describe the interface of the applet. <br>  In our case, there is a single file, open it and bring it to this form: <br><pre> &lt;? xml version = "1.0" encoding = "utf-8"?&gt;
 &lt;RelativeLayout xmlns: android = "http://schemas.android.com/apk/res/android"
     android: orientation = "vertical"
     android: layout_width = "fill_parent"
     android: layout_height = "fill_parent"
     android: background = "@ drawable / background"
     &gt;
 &lt;/ RelativeLayout&gt;
</pre><br>  RelativeLayout allows you to place elements relative to yourself or each other.  Thanks to this we will be able to impose timers on the header. <br>  I described the following parameters: <br>  <b>orientation</b> - orientation of the children of this layout. <br>  <i>For example, if you place two buttons in LinearLayout with the orientation = "vertical" parameter, then they will be under each other, and with the orientation = "horizontal" parameter, one after another.</i> <br>  <b>layout_width and layout_height</b> - width and height.  Three types of values ‚Äã‚Äãare accepted: fill_parent (accept the parent parameter), wrap_content (the minimum value where the content will not be truncated), or a numeric value. <br>  <b>background</b> - background.  A little bit higher we created background.xml in the drawable folder, so we are now turning to it. <br>  <i>I will explain, "@ &lt;folder in the folder res&gt; / &lt;file in this folder&gt;".</i>  <i>In the same way identifiers are set, but more on that later.</i> <br>  Then inside RelativeLayout, we create 3 more elements, which I mentioned just above. <br>  <b>ImageView</b> <br><pre> &lt;ImageView
	 android: src = "@ drawable / header"
	 android: layout_width = "fill_parent"
	 android: layout_height = "100px"
	 android: scaleType = "fitXY"
	 android: layout_alignParentTop = "true"
 /&gt;
</pre><br>  <b>src</b> is the path to header.xml that we created recently, which contains the parameters for the shadow at the top of the applet. <br>  <b>scaleType</b> - how to stretch it. <br>  <i>In principle, it was possible to do without header.xml, and immediately specify the path to topshadow.png.</i> <br>  <b>layout_alignParentTop</b> - each type of RelativeView has parameters of this type, and indicate where to place the element.  Specifically, this suggests that it is necessary to draw at the upper border of the parent, ie RelativeView. <br><br>  <b>LinearLayout with timers</b> <br><pre> &lt;LinearLayout
	 android: orientation = "vertical"
	 android: layout_width = "fill_parent"
	 android: layout_height = "200dip"
	 android: layout_centerVertical = "true"
	 android: layout_centerInParent = "true"
 &gt;
	 &lt;Textview
		 android: text = "00:00:00"
		 android: id = "@ + id / rest_timer"
		 android: textColor = "# AAFFAA"
		 android: textSize = "40dip"
		 android: gravity = "center_horizontal | bottom"
		 android: singleLine = "true"
		 android: layout_width = "fill_parent"
		 android: layout_height = "80dip"
	 /&gt;
	 &lt;Textview
		 android: text = "00:00:00"
		 android: id = "@ + id / work_timer"
		 android: textColor = "# FFAAAA"
		 android: textSize = "40dip"
		 android: gravity = "center_horizontal | top"
		 android: singleLine = "true"
		 android: layout_width = "fill_parent"
		 android: layout_height = "80dip"
	 /&gt;
 &lt;/ LinearLayout&gt;
</pre><br>  <b>id</b> - the id of the widget.  To create a new identifier, use the "@ + id / &lt;name&gt;", to access an existing one, for example, in the settings you need to make the item dependent on the choice of another item "@ id / &lt;name&gt;". <br>  <b>textColor</b> - text color.  It is set either as #RRGGBB or #AARRGGBB, where AA is the hex alpha channel (transparency), RR, GG and BB are the hex of each color. <br>  <b>singleLine</b> - text in one line. <br>  <b>gravity</b> - alignment of the text itself. <br>  <b>text</b> - try it yourself to guess XD. <br><br>  <b>LinearLayout with buttons</b> <br><pre> &lt;LinearLayout
	 android: layout_alignParentBottom = "true"
	 android: layout_width = "fill_parent"
	 android: layout_height = "wrap_content"
	 android: orientation = "horizontal"
	 &gt;
	 &lt;Button
		 android: id = "@ + id / rest"
		 android: layout_weight = "1"
		 android: text = "@ string / button_rest"
		 android: textSize = "18dip"
		 android: textColor = "# FFFFFF"
		 android: textStyle = "bold"
		 android: layout_height = "wrap_content"
		 android: layout_width = "fill_parent"
		 android: background = "@ drawable / greenbutton"
		 /&gt;
	 &lt;Button
		 android: id = "@ + id / work"
		 android: layout_weight = "1"
		 android: text = "@ string / button_work"
		 android: textSize = "18dip"
		 android: textColor = "# FFFFFF"
		 android: textStyle = "bold"
		 android: layout_height = "wrap_content"
		 android: layout_width = "fill_parent"
		 android: background = "@ drawable / redbutton"
		
		 /&gt;	
 &lt;/ LinearLayout&gt;
</pre><br>  Here, everything is clear in principle, I note only that the <b>text</b> is not set as a line, but as a link to a line in the file with lines ... some kind of taftalogy ... I will write about this a little later, for the time being, leave it like that. <br><br><h1>  Animation </h1><br>  The principle is as follows.  We press the button, one timer decreases, the other increases. <br>  Create an anim subfolder in the res folder.  We shove 4 xml files there: magnify_rest.xml, shrink_rest.xml, magnify_work.xml and shrink_work.xml. <br>  <b>magnify</b> - increase the timer. <br>  <b>shrink</b> - decrease the timer. <br><br>  Open magnify_rest.xml. <br><pre> &lt;? xml version = "1.0" encoding = "utf-8"?&gt;
 &lt;scale xmlns: android = "http://schemas.android.com/apk/res/android"
	 android: fromXScale = "1.0"
	 android: toXScale = "2.0"
	 android: fromYScale = "1.0"
	 android: toYScale = "2.0"
	 android: pivotX = "50%"
	 android: pivotY = "100%"
	 android: startOffset = "0"
	 android: duration = "400"
 /&gt;
</pre><br>  <b>fromXScale and fromYScale</b> - size values ‚Äã‚Äãbefore the animation begins.  If you put 2.0, then the text will first suddenly double, and from this value it will change its size. <br>  <b>toXScale and toYScale</b> are the size values ‚Äã‚Äãat the end of the animation.  I have 2.0, that is, the text will increase twice from the <u>initial</u> value specified in the layout, and not from fromXScale and fromYScale. <br>  <b>pivotX and pivotY</b> - the points from which the animation originates.  For example: if you put in both by 50%, then the text will be increased in all directions, if pivotX = 0%, then the text will increase to the right, 100% - to the left. <br>  <b>startOffset</b> - the gap before the start of the animation. <br>  <b>duration</b> - animation time in milliseconds. <br><br>  shrink_rest.xml: <br><pre> &lt;? xml version = "1.0" encoding = "utf-8"?&gt;
 &lt;scale xmlns: android = "http://schemas.android.com/apk/res/android"
	 android: fromXScale = "2.0"
	 android: toXScale = "1.0"
	 android: fromYScale = "2.0"
	 android: toYScale = "1.0"
	 android: pivotX = "50%"
	 android: pivotY = "100%"
	 android: startOffset = "0"
	 android: duration = "400"
 /&gt;
</pre><br>  It's all the same, except for the size. <br><br>  In the end, I want to get: <br><br><iframe width="420" height="315" src="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://www.youtube.com/embed/xPF4HsVNL8Y%3Ffeature%3Doembed&amp;xid=25657,15700023,15700186,15700190,15700253,15700256,15700259&amp;usg=ALkJrhgz7ceeRxw-gmobOH5agTX__bk6ww" frameborder="0" allowfullscreen=""></iframe><br><br>  two timers on top of each other, aligned to the vertical center of the parent.  I press the button, the top increases up, the bottom decreases too up.  I press on another, and they decrease and increase accordingly, only already down.  All this is done so that they do not overlap each other. <br>  Therefore, in the upper two pivot'y indicated as the lower center point.  In the other two files everything is the same, except for the fact that the pivots point to the upper center point, that is, 50% and 0%. <br><br><h1>  Strings and localization </h1><br>  Go to res / values ‚Äã‚Äã/ strings.xml and bring it to this form: <br><pre> &lt;? xml version = "1.0" encoding = "utf-8"?&gt;
 &lt;resources&gt;
     &lt;string name = "hello"&gt; Hello World, Main! &lt;/ string&gt;
     &lt;string name = "app_name"&gt; Time Manager &lt;/ string&gt;
    
     &lt;string name = "button_work"&gt; Work &lt;/ string&gt;
     &lt;string name = "button_rest"&gt; Rest &lt;/ string&gt;
 &lt;/ resources&gt;
</pre><br>  <b>name</b> - I mentioned it a little earlier, so the <a href="http://geektimes.ru/users/string/" class="user_link">string</a> / hello construction will give us Hello World, Main! <br>  This file contains all the lines for use in the program. <br><br>  For localization, create the values- &lt;locale&gt; directory, in our case, values-ru, and copy the strings.xml file there, then open it and translate the string values ‚Äã‚Äãinto Russian. <br><br><h1>  Program </h1><br>  Things are easy.  It remains to write the program itself in order for all this beauty to move, stop and enter. <br>  Open the java file in the src folder.  He should be there alone. <br>  At the top we see the name of the package, in my case, com.nixan.timetracker. <br>  Then there are imports of other classes. <br>  Then the declaration of the class itself: <br><br>  public class Main extends Activity <br><br>  Instead of Main, you can have something else, namely, what we asked in <b>create activity</b> when creating a project. <br>  <b>Activity</b> is ... an analogue of forms under Windows, let's say.  There is also a ListActivity - a list of some elements to be combed, PreferenceActivity - a window with settings, all of which are defined in a separate xml file and there is no need to invent a layout for all this beauty, but this is not the case. <br>  This class has an onCreate () method that is called when the window is created.  There are several such methods. For more details, see <a href="http://developer.android.com/guide/topics/fundamentals.html">developer.android.com/guide/topics/fundamentals.html#actlife</a> <br><br>  Before onCreate we set variables: <br><pre> Button rest_button;
 Button work_button;
 TextView rest_timer;
 TextView work_timer;
 Animation magnify_rest;
 Animation shrink_rest;
 Animation magnify_work;
 Animation shrink_work;
 TimerTask counter;
 Timer timer;
 boolean resting;
 boolean working;
 int rest_time;
 int work_time;
 SharedPreferences.Editor stats_editor;
</pre><br>  <b>rest_button and work_button</b> - work / rest switching buttons. <br>  <b>rest_timer and work_timer</b> - text that displays the current values ‚Äã‚Äãof the timer. <br>  <b>magnify_rest, shrink_rest, magnify_work and shrink_work</b> - animations that we asked in the xml file. <br>  <b>counter</b> - what the timer will do. <br>  <b>timer</b> - the timer itself. <br>  <b>resting and working</b> are variables in which current states are stored. <br>  <b>rest_time and work_time</b> - how many seconds actually worked and rested. <br>  <b>stats_editor</b> - settings, they store spent and rested seconds, in order to close the program, the timer is not reset. <br><br>  <b>So let's go!</b> <br><br>  First of all, we check if there is a parent onCreate call. <br><pre> super.onCreate (savedInstanceState);
</pre><br>  If not, then append. <br><br>  Then we say to this Activity which layout should be drawn. <br><pre> setContentView (R.layout.main);
</pre><br>  <b>R.layout.main</b> is an analogue of "@ layout / main", where main is main.xml in the layout folder.  If your layout is called not main, correct the call. <br>  <i>Before setContentView ();</i>  <i>You can add more requestWindowFeature ();, in which you can pass in parameters, for example Window.FEATURE_NO_TITLE, to remove the gray title at the top of the window.</i> <br><br>  Get the saved parameters of the timers: <br><pre> SharedPreferences saved_stats = PreferenceManager.getDefaultSharedPreferences (this);
 rest_time = saved_stats.getInt ("key_rest_time", 0);
 work_time = saved_stats.getInt ("key_work_time", 0);
</pre><br>  <b>getInt</b> - two parameters are passed to the method: a string indicating the name of the parameter and a default parameter if the string is not found. <br><br>  Initialize the variables: <br><pre> stats_editor = PreferenceManager.getDefaultSharedPreferences (this) .edit ();
 magnify_rest = AnimationUtils.loadAnimation (this, R.anim.magnify_rest);
 shrink_rest = AnimationUtils.loadAnimation (this, R.anim.shrink_rest);
 magnify_work = AnimationUtils.loadAnimation (this, R.anim.magnify_work);
 shrink_work = AnimationUtils.loadAnimation (this, R.anim.shrink_work);
 resting = false;
 working = false;
 rest_timer = (TextView) findViewById (R.id.rest_timer);
 work_timer = (TextView) findViewById (R.id.work_timer);
 rest_button = (Button) findViewById (R.id.rest);
 work_button = (Button) findViewById (R.id.work);
</pre><br><br>  In my case, I converted the seconds to the string HH: MM: SS in two different ways. <br>  Thank you in advance for my bad Java, but it seems to me that the first one eats less memory, but it works more slowly, and the other way around, so don‚Äôt scold me much. <br><pre> private String getTime (int time)
	 {
		 String result = "";
		 int hours = time / 3600;
		 int minutes = (time - (hours * 3600)) / 60;
		 int seconds = (time - (hours * 3600) - (minutes * 60));
		 result = String.valueOf (hours) + ":";
		 if (minutes &lt;10)
		 {
			 result + = "0" + String.valueOf (minutes) + ":";
		 }
		 else
		 {
			 result + = String.valueOf (minutes) + ":";
		 }
		 if (seconds &lt;10)
		 {
			 result + = "0" + String.valueOf (seconds);
		 }
		 else
		 {
			 result + = String.valueOf (seconds);
		 }
		 return result;
	 }
</pre><br>  I will say it again, I don‚Äôt know how correct and competent it is, but it seems to work. <br><br>  And right after the initialization of the variables, add: <br><pre> rest_timer.setText (getTime (rest_time));
 work_timer.setText (getTime (work_time));
</pre><br>  Thus we set the previously calculated seconds in the text of the timers. <br><br>  Create a task for the timer: <br><pre> counter = new TimerTask ()
	 {
		 @Override
		 public void run () {
		 }
	 };
</pre><br><br>  Before <a href="http://geektimes.ru/users/override/" class="user_link">Override</a> variables that are responsible for seconds, minutes and hours of the timer.  Since I have implemented the whole process in one timer, then by recruiting for rest and work: <br><pre> int seconds_r = 0;
 int hours_r = 0;
 int minutes_r = 0;
 String seconds_ind_r;
 String minutes_ind_r;
 String hours_ind_r;
 int seconds_w = 0;
 int hours_w = 0;
 int minutes_w = 0;
 String seconds_ind_w;
 String minutes_ind_w;
 String hours_ind_w;
</pre><br><br>  And the actual task of the account: <br><pre> if (resting)
	 {
		 if (seconds_r == 0 &amp;&amp; minutes_r == 0 &amp;&amp; hours_r == 0)
		 {
			 hours_r = rest_time / 3600;
			 minutes_r = (rest_time - (hours_r * 3600)) / 60;
			 seconds_r = (rest_time - (hours_r * 3600) - (minutes_r * 60));							
		 }
		 rest_time ++;
		 seconds_r ++;
		 if (seconds_r&gt; = 60)
		 {
			 seconds_r = 0;
			 minutes_r ++;
			 if (minutes_r&gt; = 60)
			 {
				 minutes_r = 0;
				 hours_r ++;
			 }
		 }
		 if (seconds_r &lt;10)
		 {
			 seconds_ind_r = "0" + String.valueOf (seconds_r);
		 }
		 else
		 {
			 seconds_ind_r = String.valueOf (seconds_r);
		 }
		 if (minutes_r &lt;10)
		 {
			 minutes_ind_r = "0" + String.valueOf (minutes_r);
		 }
		 else
		 {
			 minutes_ind_r = String.valueOf (minutes_r);
		 }
		 hours_ind_r = String.valueOf (hours_r);
		 runOnUiThread (new Runnable ()
		 {
			 public void run () {
			 // TODO Auto-generated method stub
			 rest_timer.setText (hours_ind_r + ":" + minutes_ind_r + ":" + seconds_ind_r);
			 }
		 });  
	 }
</pre><br>  <b>resting</b> is a <b>boolean</b> variable indicating that we are resting. <br>  <b>runOnUiThread ()</b> - executes a piece of code in a stream with an interface. <br>  Above - a piece of code for rest, for work just after that a similar code is added, only with a set of seconds, minutes and hours for work, the first if changes to if (working) and the text we set is not for rest_timer, but for work_timer 'but. <br><br>  Things are easy: handling button presses. <br><pre> rest_button.setOnClickListener (new OnClickListener ()
	 {
		 public void onClick (View v) {
		 if (! resting)
		 {
			 rest_timer.startAnimation (magnify_rest);
			 resting = true;
		 }
		 else
		 {
			 rest_timer.startAnimation (shrink_rest);
			 resting = false;
			 stats_editor.putInt ("key_rest_time", rest_time);
		 }
		 if (working)
		 {
			 work_timer.startAnimation (shrink_work);
			 working = false;
			 stats_editor.putInt ("key_work_time", work_time);
		 }
	 stats_editor.commit ();
	 }
 });       
</pre><br>  If at the moment we do not rest, then we begin to rest. <br>  If we rest, we stop to rest. <br>  If it works, then stop working. <br>  In this case, only the logical variables working and resting are changed, which are checked every second in the timer, and if they are turned on, the time begins to increase. <br><br>  Thus, by pressing the button twice, we can switch off the timer altogether, without switching on the operating mode. <br><br>  For the work button, everything is similar. <br><br>  Saving, connect the handset and run the application. <br><br>  And immediately find the first bug.  If the timer is running and we turn the screen, the timer stops. <br><br>  Find: <br><pre> resting = false;
 working = false;
</pre><br><br>  And change to: <br><pre> resting = saved_stats.getBoolean ("key_resting", false);
 working = saved_stats.getBoolean ("key_working", false);
 if (resting)
 {
	 rest_timer.startAnimation (magnify_rest);
 }
 if (working)
 {
	 work_timer.startAnimation (magnify_work);
 }
</pre><br><br>  We find in each handler button clicks: <br><pre> stats_editor.commit ();
</pre><br><br>  And append to him: <br><pre> stats_editor.putBoolean ("key_working", working);
 stats_editor.putBoolean ("key_resting", resting);
</pre><br>  That is, when the form is drawn, we will get the values ‚Äã‚Äãof the keys saved by pressing the buttons. <br><br>  Run, poke, like everything is ok. <br><br>  Shl <br>  If it does, I‚Äôll continue writing the service a little later so that the applet is in memory and there was no need to keep it running all the time. <br>  ZYY <br>  Sources, if anyone is interested - <a href="">nixan.org/habr/timetracker/TimeManager.zip</a> <br>  ZYYY <br>  <a href="">nixan.org/habr/timetracker/TimeManager.apk</a> - a package with a program, or in the pub: Nixan <br>  ZYYYY <br>  Added a video. <br>  ZYYYYY <br>  <a href="http://nixan.habrahabr.ru/blog/87657/">Simple Time Manager for Android.</a>  <a href="http://nixan.habrahabr.ru/blog/87657/">Part 2</a> </div><p>Source: <a href="https://habr.com/ru/post/87201/">https://habr.com/ru/post/87201/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../87194/index.html">Deal on a million</a></li>
<li><a href="../87196/index.html">New technology transfer of emotions on a mobile phone</a></li>
<li><a href="../87197/index.html">SSH VPN over Internet (SSH tun tunneling)</a></li>
<li><a href="../87198/index.html">Poison began to massively block accounts?</a></li>
<li><a href="../87199/index.html">Git on Windows in Technicolor</a></li>
<li><a href="../87202/index.html">Development by testing with Zend Framework and PHPUnit</a></li>
<li><a href="../87205/index.html">OOP with examples (part 2)</a></li>
<li><a href="../87206/index.html">Small (???) Youtube design changes</a></li>
<li><a href="../87208/index.html">Unlimited Detail is interesting, but I have very specific doubts ...</a></li>
<li><a href="../87209/index.html">Working days are a little more fun.</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>