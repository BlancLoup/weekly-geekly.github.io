<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Bash scripts interaction with user</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content=", , ( ) 
 
 A rare script is deprived of the need to communicate with the user. We expect that the program (utility) will do what we want from it. Con...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Bash scripts interaction with user</h1><div class="post__text post__text-html js-mediator-article"><code> ,     ,   ( ) <br></code> <br>  A rare script is deprived of the need to communicate with the user.  We expect that the program (utility) will do what we want from it.  Consequently, we need tools to influence them, and the program itself must explain how its work is progressing. <br>  With this topic, I want to consider several ways of interacting bash-scripts with the user.  The article is intended for beginners in scripting, but I hope experienced people will also find something interesting for themselves. <br><a name="habracut"></a><br>  The topic is also provided with primitive examples that do not carry a semantic load, but allow you to see some interesting pieces in the work. <br><br><h4>  Variables </h4><br>  The most common way to store initial data is variables.  At the very beginning of the program, several such variables are declared, in which the user writes some initial data. <br><blockquote><pre> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment">#!/bin/bash #      EMAIL=example@gmail.com echo "  : $EMAIL"</span></span></code> </pre></blockquote><br>  This method is good if there is not much data and the script is designed for automatic execution without user intervention.  It is necessary to clearly inform the user about what and where he needs to enter.  It is advisable to collect all this in one place - the <a href="http://ru.wikipedia.org/wiki/%25D0%25A4%25D0%25B0%25D0%25B9%25D0%25BB_%25D0%25BA%25D0%25BE%25D0%25BD%25D1%2584%25D0%25B8%25D0%25B3%25D1%2583%25D1%2580%25D0%25B0%25D1%2586%25D0%25B8%25D0%25B8" title="Wikipedia">configuration file</a> .  You can connect it with the <b>source</b> command.  For example, if the configuration file will be in the same directory as the script, we will get: <br><blockquote><pre> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment">#!/bin/bash source ./config.cfg echo "  : $EMAIL"</span></span></code> </pre></blockquote><br>  In the <b>config.cfg</b> file, do not forget to place the line <code>EMAIL=example@gmail.com</code> <br><br><h4>  Command line parameters </h4><br>  Another way to communicate data to a program is to specify it on the command line when starting.  These parameters are contained in variables with numbers.  For example: <strong>$ 0</strong> is the name of the script, <strong>$ 1</strong> is the first parameter, <strong>$ 2</strong> is the second parameter, and so on. There are also two auxiliary variables: <strong>$ #</strong> contains the number of arguments passed;  <strong>$ @</strong> contains all arguments passed to the script, separated by spaces. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <blockquote><pre> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment">#!/bin/bash #      for n in $@ do echo "$n" done</span></span></code> </pre></blockquote><br><img src="https://habrastorage.org/storage1/0e2fabc0/78bc7558/8c777633/61647eea.png"><br><br><h4>  Questions and confirmations </h4><br><img src="https://habrastorage.org/storage1/67bf67d5/357ce024/526843ba/1480496b.png"><br>  I think many people are familiar with the question from the screenshot above.  Such a dialogue can be used ... well, you yourself guessed where it can be used. <br><blockquote><pre> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment">#!/bin/bash echo -n "? (y/n) " read item case "$item" in y|Y) echo " ¬´y¬ª, ..." ;; n|N) echo " ¬´n¬ª, ..." exit 0 ;; *) echo "  .    ..." ;; esac</span></span></code> </pre></blockquote><br>  Please note that in the screenshot the letter ‚ÄúD‚Äù is big.  This means the default action, that is, if the user does not enter anything, then this will be equivalent to entering "D". <br><br><h4>  OK / FAIL </h4><br>  Another way a program communicates with a user is execution statuses.  Most likely they are familiar to you. <br><img src="https://habrastorage.org/storage1/246ab6e6/871f32da/62b51e3b/cc82b5c0.png"><br>  The implementation is also quite simple. <br><blockquote><pre> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment">#!/bin/bash SETCOLOR_SUCCESS="echo -en \\033[1;32m" SETCOLOR_FAILURE="echo -en \\033[1;31m" SETCOLOR_NORMAL="echo -en \\033[0;39m" echo -e " ..." # ,    rm test_file if [ $? -eq 0 ]; then $SETCOLOR_SUCCESS echo -n "$(tput hpa $(tput cols))$(tput cub 6)[OK]" $SETCOLOR_NORMAL echo else $SETCOLOR_FAILURE echo -n "$(tput hpa $(tput cols))$(tput cub 6)[fail]" $SETCOLOR_NORMAL echo fi</span></span></code> </pre></blockquote><br>  This is how the script works: <br><img src="https://habrastorage.org/storage1/60e61b1a/325142ec/6b6ba2f4/e7158195.png"><br>  Good people wrote an extended version of the script with logging and progress.  I will gladly share the <a href="http://linsovet.com/howto-bash-script-status">link</a> . <br><br>  Based on the above link, the code can be simplified. <br><blockquote><pre> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment">#!/bin/bash red=$(tput setf 4) green=$(tput setf 2) reset=$(tput sgr0) toend=$(tput hpa $(tput cols))$(tput cub 6) echo -e " ..." # ,    rm test_file if [ $? -eq 0 ]; then echo -n "${green}${toend}[OK]" else echo -n "${red}${toend}[fail]" fi echo -n "${reset}" echo</span></span></code> </pre></blockquote><br><br><h4>  Pseudography </h4><br>  For lovers of graphical representation, there is a handy tool: <strong>dialog</strong> .  By default it is not in the system, so fix the situation. <br><blockquote><pre> <code class="bash hljs">sudo apt-get install dialog</code> </pre></blockquote><br>  You can try it out with a simple command: <br><blockquote><pre> <code class="bash hljs">dialog --title <span class="hljs-string"><span class="hljs-string">"  "</span></span> --msgbox <span class="hljs-string"><span class="hljs-string">"\n  - !"</span></span> 6 50</code> </pre></blockquote><br>  Here is an example of a progress dialogue: <br><blockquote><pre> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment">#!/bin/sh ( c=10 while [ $c -ne 110 ] do echo $c ((c+=10)) sleep 1 done ) | dialog --title "    " --gauge "Please wait ...." 10 60 0 clear</span></span></code> </pre></blockquote><br>  Do not forget to insert <strong>clear</strong> to clear the screen so as not to leave a blue background.  This utility supports many more types of dialog boxes.  The main disadvantage is that by default it is not in the system. <br><br>  An alternative to <b>dialog</b> can be <b>whiptail</b> , which is even present on some systems by default. <br><br>  More information can be found on the links: <br>  <a href="http://unstableme.blogspot.com/2009/12/linux-dialog-utility-short-tutorial.html">http://unstableme.blogspot.com/2009/12/linux-dialog-utility-short-tutorial.html</a> <br>  <a href="http://www.cc-c.de/german/linux/linux-dialog.php">http://www.cc-c.de/german/linux/linux-dialog.php</a> <br><br><h4>  GUI </h4><br>  Although there are ardent opponents of the <a href="http://ru.wikipedia.org/wiki/GUI" title="graphical user interface">GUI</a> , but he clearly has a right to exist.  Such dialogs can be obtained using the <strong>kdialog command</strong> (if KDE is the graphical shell), or <strong>gdialog</strong> and <strong>zenity</strong> (for Gnome). <br><br>  For example, the form to enter a password: <br><blockquote><pre> <code class="bash hljs">kdialog --password <span class="hljs-string"><span class="hljs-string">",   :"</span></span></code> </pre></blockquote><br>  or <br><blockquote><pre> <code class="bash hljs">gdialog --password <span class="hljs-string"><span class="hljs-string">",   :"</span></span></code> </pre></blockquote><br>  Another example for KDE: <br><blockquote><pre> <code class="bash hljs">kdialog --question <span class="hljs-string"><span class="hljs-string">"  ?"</span></span> rc=$? <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> [ <span class="hljs-string"><span class="hljs-string">"</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">${rc}</span></span></span><span class="hljs-string">"</span></span> == <span class="hljs-string"><span class="hljs-string">"0"</span></span> ]; <span class="hljs-keyword"><span class="hljs-keyword">then</span></span> <span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> <span class="hljs-string"><span class="hljs-string">" yes"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> <span class="hljs-string"><span class="hljs-string">" no"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">fi</span></span></code> </pre></blockquote><br>  And for Gnome: <br><blockquote><pre> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment">#!/bin/bash name=$(gdialog --title " " --inputbox "  :" 50 60 2&gt;&amp;1) echo " : $name"</span></span></code> </pre></blockquote><br>  As you can see, an obvious disadvantage of this method is attachment to a specific desktop environment.  And indeed to a graphical environment, which may be absent.  But, nevertheless, it may come in handy someday. <br><br>  More information on the links: <br>  <a href="http://pwet.fr/man/linux/commandes/kdialog">http://pwet.fr/man/linux/commandes/kdialog</a> <br>  <a href="http://linux.about.com/library/cmd/blcmdl1_gdialog.htm">http://linux.about.com/library/cmd/blcmdl1_gdialog.htm</a> <br>  <a href="http://www.techrepublic.com/blog/opensource/gui-scripting-in-bash/1667">http://www.techrepublic.com/blog/opensource/gui-scripting-in-bash/1667</a> <br><br>  <strong>PS</strong> To be continued ... <br><br>  <b>UPD:</b> Added simplified code in the ‚ÄúOK / FAIL‚Äù section. <br>  <b>UPD2:</b> Added an example of connecting the configuration file to the "Variables" section. <br><br>  Published the <a href="http://habrahabr.ru/blogs/nix/127084/">second part</a> . </div><p>Source: <a href="https://habr.com/ru/post/126701/">https://habr.com/ru/post/126701/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../126687/index.html">RUSNANO Tablet in the Wild</a></li>
<li><a href="../126691/index.html">The second dimension: review of the search engine of air tickets Jizo.ru</a></li>
<li><a href="../126692/index.html">13-year-old schoolboy patents a solar battery "on Fibonacci numbers"</a></li>
<li><a href="../126693/index.html">Some Python-like functions in C ++ 11</a></li>
<li><a href="../126697/index.html">Amazon seriously took up the video</a></li>
<li><a href="../126703/index.html">Chrome with Yandex search</a></li>
<li><a href="../126704/index.html">Draw graphs (diagrams) in Django</a></li>
<li><a href="../126705/index.html">Parsing spamming your Exim accounts</a></li>
<li><a href="../126707/index.html">Forwarding COM Ports from Linux to Windows</a></li>
<li><a href="../126708/index.html">Silicon Valley Infrastructure Overview</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>