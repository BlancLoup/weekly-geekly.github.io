<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Sathurbot: Distributed Attack to WordPress Sites</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Search for movies and software on torrents carries some risk. There is a chance to get links to torrents posted on sites that have nothing to do with ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Sathurbot: Distributed Attack to WordPress Sites</h1><div class="post__text post__text-html js-mediator-article">  Search for movies and software on torrents carries some risk.  There is a chance to get links to torrents posted on sites that have nothing to do with file sharing.  They just work on WordPress and have been compromised. <br><br>  The report tells about the ecosystem of Sathurbot Trojan - spreading through torrents and brute-force attacks on WordPress sites. <br><br><img src="https://habrastorage.org/files/47d/3bc/2d6/47d3bc2d6f424bb990de1fe5e673db9a.png" alt="image">
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <a name="habracut"></a><h3>  Torrent </h3><br>  Sathurbot spreads through hidden torrent pages on compromised sites.  The user gets on these pages from the search results when trying to find a movie or software.  Some pages use https: <br><br><img src="https://habrastorage.org/files/718/d1b/879/718d1b8796764118909e648452465550.png" alt="image"><br><br><img src="https://habrastorage.org/files/cec/779/c10/cec779c100504b249548a345743d046c.png" alt="image"><br><br><img src="https://habrastorage.org/files/c4f/476/ae9/c4f476ae99eb4481b7e40704acdcca93.png" alt="image"><br><br>  Starting the download, you will find many distributors, downloaded torrents do not cause any special suspicions. <br><br>  A torrent with a movie contains a video file, a text document with instructions and an installer for a codec, a torrent with a software ‚Äî an installer and an instruction.  The problem in the installer - running this executable file loads the Sathurbot DLL library into the system. <br><br><img src="https://habrastorage.org/files/2e7/79d/54b/2e779d54b15646ea9f8758e1ccc07617.png" alt="image"><br><br>  After launching the executable file, the Trojan displays a fake error message (see below).  In fact, the download successfully runs in the background, and the computer is part of the Sathurbot botnet. <br><br><img src="https://habrastorage.org/files/eff/dce/99e/effdce99eb2a4491a29200bfa9bf1f17.png" alt="image"><br><br><img src="https://habrastorage.org/files/6b3/dda/058/6b3dda058f0d4cc5813c49ae9469f9df.png" alt="image"><br><br><h3>  Backdoor and bootloader </h3><br>  After installation, Sathurbot performs a DNS query to the C &amp; C manager.  Trojan can update, load and run other executable files.  During the study, we observed the installation of Boaxxe, Kovter and Fleercivet, but not the fact that the operators will be limited to these programs. <br><br><img src="https://habrastorage.org/files/7e6/7ed/968/7e67ed96868f4f3083f6d1cb5e7ac83d.png" alt="image"><br><br><img src="https://habrastorage.org/files/5d5/af2/e42/5d5af2e420054125be14b47f7d28730f.png" alt="image"><br><br>  Next, Sathurbot reports a successful installation on C &amp; C. <br><br><h3>  Data collection </h3><br>  Sathurbot receives a list of 5,000 commonly used words from the management server and uses them as search queries in Google, Bing and Yandex, combining them into phrases randomly.  Next, the Trojan selects 2-4 new words, which are most often found on sites that are on the first pages of the search results.  New, more meaningful phrases are used in the second round of searches. <br><br>  Next, Sathurbot examines the sites obtained in the second stage of the first three pages of search results.  Trojan selects sites running WordPress, referring to the <a href="http://xn--80ahdkubif5m/wp-login.php">domain name / wp-login.php</a> .  The attackers are also interested in Drupal, Joomla, PHP-NUKE, phpFox, DedeCMS. <br><br>  The collected domains are transferred to the second C &amp; C server. <br><br><img src="https://habrastorage.org/files/88d/7b4/551/88d7b4551a084e52996da95703e45210.png" alt="image"><br><br><h3>  WordPress Distributed Attack </h3><br>  The second C &amp; C transmits the credentials for authorization on the domains of interest to the infected computers in the botnet.  Each bot out of 20,000 makes only one login attempt - this avoids getting into the "black list" of IP addresses and blocking. <br><br><img src="https://habrastorage.org/files/1ce/863/ff2/1ce863ff2f0e4c5285a4afa4a8a8d437.png" alt="image"><br><br>  In the course of the study, a list of 10,000 domains was sent to the C &amp; C managing server for verification. <br><br><img src="https://habrastorage.org/files/a78/6e8/350/a786e83502064a1a890615c03c883da0.png" alt="image"><br><br>  The attacks use the XML-RPC API: <br><br><img src="https://habrastorage.org/files/691/ebb/9d8/691ebb9d8ee4444a9956a0fac59df81e.png" alt="image"><br><br><h3>  Distribution </h3><br>  Sathurbot is equipped with the libtorrent library.  After infection, computers in the botnet can also distribute malicious torrents. <br><br><img src="https://habrastorage.org/files/84f/e51/019/84fe510191ac48619502b2b154a026b7.png" alt="image"><br><br>  Bots have different tasks - some computers collect data, others attack the XML-RPC API, some perform both actions. <br><br><h3>  Results </h3><br>  According to our data, the Sathurbot botnet includes more than 20,000 infected computers and is valid from June 2016. <br><br>  Numerous attacks via /wp-login.php (even on sites that do not use WordPress) are a direct result of Sathurbot activity.  Operators also use wp.getUsersBlogs XMLRPC.  We have seen and spread links to malicious torrent in email. <br><br>  <i>Users of <a href="https://www.esetnod32.ru/buy/actions/business/50-mgnoveniy-vesny-/%3Futm_source%3Dhabrahabr%26utm_medium%3Darticle_23_03_2017%26utm_content%3Dfrom%26utm_campaign%3Dhabrahabr">ESET NOD32</a> anti-virus products are protected from this threat.</i> <br><br><h3>  Detection </h3><br>  Network administrators: check unknown sub-pages and / or directories on the server.  If they contain links to download torrents, check the logs for attacks. <br><br>  Users: run Wireshark with the http.request filter to see requests of the type GET / wp-login.php and / or POST /xmlrpc.php. <br><br>  Check the files or registry entries listed in the Infection Indicators section. <br><br><h3>  Deletion </h3><br>  Network administrators: change passwords, delete sub-pages that are not related to the site, (optionally) restore the site from a backup. <br><br>  Users: find a suspicious DLL using a third-party file manager, open the Process Explorer or Task Manager, terminate explorer.exe and / or rundll32.exe, delete (quarantine) the affected DLL, restart the computer. <br><br>  Note.  This will remove Sathurbot, but not other malware that it may have downloaded.  Alternatively, use a comprehensive anti-malware product or at least an online scanner. <br><br><h3>  Prevention </h3><br>  Network administrators: if the site does not require XML-RPC, disable it and use complex passwords. <br><br>  Users: Avoid running executable files besides those released by famous developers;  Do not download torrents from sites that are not intended for file sharing. <br><br><h3>  Infection indicators </h3><br>  We are currently seeing Sathurbot's installation: <br>  \ ProgramData \ Microsoft \ Performance \ Monitor \ PerformanceMonitor.dll <br>  \ ProgramData \ Microsoft \ Performance \ TheftProtection \ TheftProtection.dll <br>  \ ProgramData \ Microsoft \ Performance \ Monitor \ SecurityHelper.dll <br>  \ Users \ ***** \ AppData \ Local \ Microsoft \ Protect \ protecthost.dll <br>  Runs in the context of rundll32.exe or explorer.exe processes and blocks editing of files and registry keys.  There are 32 and 64-bit versions. <br><br>  Attached folders with torrent files downloaded: <br>  \ SecurityCache \ cache \ resume \ <br>  \ SecurityCache \ cache \ rules \ <br>  \ SecurityCache \ data \ <br>  \ SecurityCache \ zepplauncher.mif - contains DHT nodes <br>  \ temp \ <br>  % appdata% \ SYSHashTable \ - contains folders with hashes of visited domains% appdata% \ SYSHashTable \ SyshashInfo.db - a set of target domains, including information about the structure <br><br><h3>  Samples (SHA-1) </h3><br>  <b>Installers:</b> <br>  2D9AFB96EAFBCFCDD8E1CAFF492BFCF0488E6B8C <br>  3D08D416284E9C9C4FF36F474C9D46F3601652D5 <br>  512789C90D76785C061A88A0B92F5F5778E80BAA <br>  735C8A382400C985B85D27C67369EF4E7ED30135 <br>  798755794D124D00EAB65653442957614400D71D <br>  4F52A4A5BA897F055393174B3DFCA1D022416B88 <br>  8EDFE9667ECFE469BF88A5A5EBBB9A75334A48B9 <br>  5B45731C6BBA7359770D99124183E8D80548B64F <br>  C0F8C75110123BEE7DB5CA3503C3F5A50A1A055E <br>  C8A514B0309BCDE73F7E28EB72EB6CB3ABE24FDD <br>  AF1AE760F055120CA658D20A21E4B14244BC047D <br>  A1C515B965FB0DED176A0F38C811E6423D9FFD86 <br>  B9067085701B206D2AC180E82D5BC68EDD584A8B <br>  77625ADEA198F6756E5D7C613811A5864E9874EA <br><br>  <b>Sathurbot dll:</b> <br>  F3A265D4209F3E7E6013CA4524E02D19AAC951D9 <br>  0EA717E23D70040011BD8BD0BF1FFAAF071DA22C <br>  2381686708174BC5DE2F04704491B331EE9D630B <br>  2B942C57CEE7E2E984EE10F4173F472DB6C15256 <br>  2F4FAA5CB5703004CA68865D8D5DACBA35402DE4 <br>  4EBC55FDFB4A1DD22E7D329E6EF8C7F27E650B34 <br>  0EF3ECD8597CE799715233C8BA52D677E98ABDFD <br>  0307BBAC69C54488C124235449675A0F4B0CCEFA <br>  149518FB8DE56A34B1CA2D66731126CF197958C3 <br>  3809C52343A8F3A3597898C9106BA72DB7F6A3CB <br>  4A69B1B1191C9E4BC465F72D76FE45C77A5CB4B0 <br>  5CCDB41A34ADA906635CE2EE1AB4615A1AFCB2F2 <br>  6C03F7A9F826BB3A75C3946E3EF75BFC19E14683 <br>  8DA0DC48AFB8D2D1E9F485029D1800173774C837 <br>  AC7D8140A8527B8F7EE6788C128AFF4CA92E82C2 <br>  E1286F8AE85EB8BD1B6BE4684E3C9E4B88D300DB <br><br>  <b>Additional payload:</b> <br>  C439FC24CAFA3C8008FC01B6F4C39F6010CE32B6 <br>  ABA9578AB2588758AD34C3955C06CD2765BFDF68 <br>  DFB48B12823E23C52DAE03EE4F7B9B5C9E9FDF92 <br>  FAFF56D95F06FE4DA8ED433985FA2E91B94EE9AD <br>  B728EB975CF7FDD484FCBCFFE1D75E4F668F842F <br>  59189ABE0C6C73B66944795A2EF5A2884715772E <br>  C6BDB2DC6A48136E208279587EFA6A9DD70A3FAA <br>  BEAA3159DBE46172FC79E8732C00F286B120E720 <br>  5ED0DF92174B62002E6203801A58FE665EF17B76 <br>  70DFABA5F98B5EBC471896B792BBEF4DB4B07C53 <br>  10F92B962D76E938C154DC7CBD7DEFE97498AB1E <br>  426F9542D0DDA1C0FF8D2F4CB0D74A1594967636 <br>  AA2176834BA49B6A9901013645C84C64478AA931 <br>  1C274E18A8CAD814E0094C63405D461E815D736A <br>  61384C0F690036E808F5988B5F06FD2D07A87454 <br>  F32D42EF1E5ED221D478CFAA1A76BB2E9E93A0C1 <br>  594E098E9787EB8B7C13243D0EDF6812F34D0FBA <br>  1AAFEBAA11424B65ED48C68CDEED88F34136B8DC <br>  BA4F20D1C821B81BC324416324BA7605953D0605 <br>  E08C36B122C5E8E561A4DE733EBB8F6AE3172BF0 <br>  7748115AF04F9FD477041CB40B4C5048464CE43E <br>  3065C1098B5C3FC15C783CDDE38A14DFA2E005E4 <br>  FA25E212F77A06C0B7A62C6B7C86643660B24DDA <br>  FADADFFA8F5351794BC5DCABE301157A4A2EBBCF <br>  B0692A03D79CD2EA7622D3A784A1711ADAABEE8D <br>  9411991DCF1B4ED9002D9381083DE714866AEA00 <br><br><h3>  Domains: </h3><br>  <b>DNS:</b> <br>  zeusgreekmaster.xyz <br>  apollogreekmaster.xyz <br><br>  <b>C &amp; C:</b> <br>  jhkabmasdjm2asdu7gjaysgddasd.xyz <br>  boomboomboomway.xyz <br>  mrslavelemmiwinkstwo.xyz <br>  uromatalieslave.space <br>  newforceddomainisherenow.club <br>  justanotherforcedomain.xyz <br>  artemisoslave.xyz <br>  asxdq2saxadsdawdq2sasaddfsdfsf4ssfuckk.xyz <br>  kjaskdhkaudhsnkq3uhaksjndkud3asds.xyz <br>  badaboommail.xyz <br><br>  <b>Torrent trackers:</b> <br>  badaboomsharetracker.xyz <br>  webdatasourcetraffic.xyz <br>  sharetorrentsonlinetracker.xyz <br>  webtrafficsuccess.xyz <br><br><h3>  Registry settings </h3><br>  You may need a third-party tool, because Windows Regedit does not display this: <br>  HKLM \ SYSTEM \ CurrentControlSet \ services \ SharedAccess \ Parameters \ FirewallPolicy \ FirewallRules \ {variable GUID} = ‚Äúv2.10 | Action = Allow | Active = TRUE | Dir = In | Profile = Private | Profile = Public | App = C: \\ Windows \\ explorer.exe | Name = Windows Explorer | ‚Äù <br>  HKLM \ SYSTEM \ CurrentControlSet \ services \ SharedAccess \ Parameters \ FirewallPolicy \ FirewallRules \ {variable GUID} = ‚Äúv2.10 | Action = Allow | Active = TRUE | Dir = In | Profile = Private | Profile = Public | App = C: \\ Windows \\ system32 \\ rundll32.exe | Name = Windows host process (Rundll32) | ‚Äù <br>  HKLM \ SOFTWARE \ Microsoft \ Windows \ CurrentVersion \ Explorer \ ShellIconOverlayIdentifiers \ 0TheftProtectionDll = {GUID1} <br>  HKLM \ SOFTWARE \ Classes \ CLSID \ {GUID1} = ‚ÄúWindows Theft Protection‚Äù <br>  HKLM \ SOFTWARE \ Classes \ CLSID \ {GUID1} \ InprocServer32 = ‚ÄúC: \\ ProgramData \\ Microsoft \\ Performance \\ TheftProtection \\ TheftProtection.dll‚Äù <br>  HKLM \ SOFTWARE \ Classes \ CLSID \ {GUID1} \ InprocServer32 \ ThreadingModel = ‚ÄúApartment‚Äù <br>  HKLM \ SOFTWARE \ Classes \ CLSID \ {GUID2} <br><br>  {GUID2} records vary in all samples, contain six long subkeys, the content is binary type and is encrypted.  Used to store variables, temporary values ‚Äã‚Äãand IP, C &amp; C, UID settings. <br><br>  For example, {GUID2} looks like this: <br>  HKLM \ SOFTWARE \ Classes \ CLSID \ {8E577F7E-03C2-47D1-B4C0-BCE085F78F66} \ 00000003 <br>  HKLM \ SOFTWARE \ Classes \ CLSID \ {8E577F7E-03C2-47D1-B4C0-BCE085F78F66} \ 00000002 <br>  HKLM \ SOFTWARE \ Classes \ CLSID \ {8E577F7E-03C2-47D1-B4C0-BCE085F78F66} \ 00000001 <br>  HKLM \ SOFTWARE \ Classes \ CLSID \ {8E577F7E-03C2-47D1-B4C0-BCE085F78F66} \ 00000009 <br>  HKLM \ SOFTWARE \ Classes \ CLSID \ {8E577F7E-03C2-47D1-B4C0-BCE085F78F66} \ 00000011 <br>  HKLM \ SOFTWARE \ Classes \ CLSID \ {8E577F7E-03C2-47D1-B4C0-BCE085F78F66} \ 00010001 <br>  HKLM \ SOFTWARE \ Classes \ CLSID \ {8E577F7E-03C2-47D1-B4C0-BCE085F78F66} \ 00010002 <br>  HKLM \ SOFTWARE \ Classes \ CLSID \ {8E577F7E-03C2-47D1-B4C0-BCE085F78F66} \ 00000008 <br>  HKLM \ SOFTWARE \ Classes \ CLSID \ {8E577F7E-03C2-47D1-B4C0-BCE085F78F66} \ 00000007 <br>  HKLM \ SOFTWARE \ Classes \ CLSID \ {8E577F7E-03C2-47D1-B4C0-BCE085F78F66} \ 00000004 <br>  HKLM \ SOFTWARE \ Classes \ CLSID \ {8E577F7E-03C2-47D1-B4C0-BCE085F78F66} \ 00000010 <br>  HKLM \ SOFTWARE \ Classes \ CLSID \ {8E577F7E-03C2-47D1-B4C0-BCE085F78F66} \ 00020001 </div><p>Source: <a href="https://habr.com/ru/post/326198/">https://habr.com/ru/post/326198/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../326186/index.html">Spekfy - IT Project Management System</a></li>
<li><a href="../326188/index.html">‚ÄúYou're just a robot, imitation. Can a robot write a symphony? ‚Äù- interview about AI with Dmitry Soshnikov, Microsoft</a></li>
<li><a href="../326190/index.html">IntelliJ vs. Eclipse: JetBrains Toolbox or Yatta Launcher?</a></li>
<li><a href="../326194/index.html">django-tables2. Manual</a></li>
<li><a href="../326196/index.html">One task about cactus graph</a></li>
<li><a href="../326204/index.html">Millions of queries per second: a peaceful battle between PostgreSQL and MySQL with today's workload requirements</a></li>
<li><a href="../326206/index.html">10 ways to stand out from the crowd of faceless competitor outsourcers (with examples)</a></li>
<li><a href="../326208/index.html">Ossim. WMI plugins with a crisp. Recipe</a></li>
<li><a href="../326210/index.html">Startup School 2017 from Y Combinator: ‚ÄúWhy?‚Äù (Part two)</a></li>
<li><a href="../326212/index.html">Cloud-AI - cloud artificial intelligence found 10 LinkedIn vulnerabilities</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>