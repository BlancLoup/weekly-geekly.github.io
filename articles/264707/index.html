<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Writing a Telegram bot in Ruby in 10 lines</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="After the release of the Telegram Bot Platform, many thought about writing their own bot. This post describes the minimum steps required to write your...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Writing a Telegram bot in Ruby in 10 lines</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/files/914/1c2/d17/9141c2d17d074b8d8758a955f7fd575a.png"><br>  After the release of the Telegram Bot Platform, many thought about writing their own bot.  This post describes the minimum steps required to write your own Ruby bot.  All you need is a Telegram account and a machine with Ruby installed on it. <br><a name="habracut"></a><br>  I chose Ruby because of the convenient <a href="https://rubygems.org/gems/telegram-bot-ruby/">gem</a> for working with Telegram bot api. <br><br>  The first thing to do is to create a .rb file in which the bot's logic will be stored, for example, start_bot.rb, and add the minimum code necessary for the bot to work: <br><pre><code class="ruby hljs"><span class="hljs-keyword"><span class="hljs-keyword">require</span></span> <span class="hljs-string"><span class="hljs-string">'telegram/bot'</span></span> token = <span class="hljs-string"><span class="hljs-string">'YOUR_TELEGRAM_BOT_API_TOKEN'</span></span> Telegram::Bot::Client.run(token) <span class="hljs-keyword"><span class="hljs-keyword">do</span></span> <span class="hljs-params"><span class="hljs-params">|bot|</span></span> bot.listen <span class="hljs-keyword"><span class="hljs-keyword">do</span></span> <span class="hljs-params"><span class="hljs-params">|message|</span></span> <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> message.text <span class="hljs-keyword"><span class="hljs-keyword">when</span></span> <span class="hljs-string"><span class="hljs-string">'/start'</span></span> bot.api.sendMessage(<span class="hljs-symbol"><span class="hljs-symbol">chat_id:</span></span> message.chat.id, <span class="hljs-symbol"><span class="hljs-symbol">text:</span></span> <span class="hljs-string"><span class="hljs-string">"Hello, </span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">#{message.from.first_name}</span></span></span><span class="hljs-string">"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">end</span></span> <span class="hljs-keyword"><span class="hljs-keyword">end</span></span> <span class="hljs-keyword"><span class="hljs-keyword">end</span></span></code> </pre> <br>  For the server is missing only the installation of the <a href="https://rubygems.org/gems/telegram-bot-ruby/">gem</a> .  Installation can be done in two ways: <br>  1. Install the <a href="https://rubygems.org/gems/telegram-bot-ruby/">heme</a> directly on the machine: <br><pre> <code class="bash hljs">gem install telegram-bot-ruby</code> </pre><br>  2. Using a gemfile <br><pre> <code class="ruby hljs">gem <span class="hljs-string"><span class="hljs-string">'telegram-bot-ruby'</span></span></code> </pre><br>  followed by execution <br><pre> <code class="bash hljs">bundle</code> </pre><br>  For simplicity, I used the first method. <br><br>  Now you need to get a token for the bot. <br>  Go to Telegram, add the <a href="http://telegram.me/BotFather">@BotFather</a> bot, and create a bot: <br><img width="50%" src="https://habrastorage.org/files/b9a/a3e/c9e/b9aa3ec9e232403390042365cf89a7ad.png">
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Next, add the token to the file and get the ready server for the bot: <br><pre> <code class="ruby hljs"><span class="hljs-keyword"><span class="hljs-keyword">require</span></span> <span class="hljs-string"><span class="hljs-string">'telegram/bot'</span></span> token = <span class="hljs-string"><span class="hljs-string">'118997426:AAFVFtYa15Z7ckyDUIHb578NazgepL4kmU8'</span></span> Telegram::Bot::Client.run(token) <span class="hljs-keyword"><span class="hljs-keyword">do</span></span> <span class="hljs-params"><span class="hljs-params">|bot|</span></span> bot.listen <span class="hljs-keyword"><span class="hljs-keyword">do</span></span> <span class="hljs-params"><span class="hljs-params">|message|</span></span> <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> message.text <span class="hljs-keyword"><span class="hljs-keyword">when</span></span> <span class="hljs-string"><span class="hljs-string">'/start'</span></span> bot.api.sendMessage(<span class="hljs-symbol"><span class="hljs-symbol">chat_id:</span></span> message.chat.id, <span class="hljs-symbol"><span class="hljs-symbol">text:</span></span> <span class="hljs-string"><span class="hljs-string">"Hello, </span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">#{message.from.first_name}</span></span></span><span class="hljs-string">"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">end</span></span> <span class="hljs-keyword"><span class="hljs-keyword">end</span></span> <span class="hljs-keyword"><span class="hljs-keyword">end</span></span></code> </pre><br><br>  To check the operation of the bot at the beginning we start the server: <br><pre> <code class="bash hljs">ruby start_bot.rb</code> </pre><br>  And then we write the bot in Telegram: <br><img width="25%" src="https://habrastorage.org/files/fe7/d98/3e1/fe7d983e1e2745f9b1826d57e48fee2f.png"><br><br>  As you can see, everything works. <br><br>  PS: I deleted the bot after, so my token, like the bot, is inaccessible. <br><br>  UPD: <br><div class="spoiler">  <b class="spoiler_title">3 lines in ruby</b> <div class="spoiler_text"><pre> <code class="ruby hljs"><span class="hljs-keyword"><span class="hljs-keyword">require</span></span> <span class="hljs-string"><span class="hljs-string">'telegram/bot'</span></span> token = <span class="hljs-string"><span class="hljs-string">'&lt;&gt;'</span></span> Telegram::Bot::Client.run(token) { <span class="hljs-params"><span class="hljs-params">|bot|</span></span> bot.listen { <span class="hljs-params"><span class="hljs-params">|message|</span></span> bot.api.sendMessage(<span class="hljs-symbol"><span class="hljs-symbol">chat_id:</span></span> message.chat.id, <span class="hljs-symbol"><span class="hljs-symbol">text:</span></span> <span class="hljs-string"><span class="hljs-string">'Hi!'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> message.text == <span class="hljs-string"><span class="hljs-string">'/start'</span></span> } }</code> </pre><br></div></div><br>  Thanks for Python <a href="http://habrahabr.ru/users/lybin/" class="user_link">lybin</a> <br><div class="spoiler">  <b class="spoiler_title">3 lines in Python</b> <div class="spoiler_text"><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> twx.botapi <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> TelegramBot token = <span class="hljs-string"><span class="hljs-string">'&lt;&gt;'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> <span class="hljs-keyword"><span class="hljs-keyword">True</span></span>: [<span class="hljs-keyword"><span class="hljs-keyword">lambda</span></span> update: TelegramBot(token).send_message(update.message.chat.id, <span class="hljs-string"><span class="hljs-string">'test message body'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> update.message.text.startswith(<span class="hljs-string"><span class="hljs-string">'/start'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">None</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> update <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> TelegramBot(token).get_updates().wait()]</code> </pre><br></div></div></div><p>Source: <a href="https://habr.com/ru/post/264707/">https://habr.com/ru/post/264707/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../264695/index.html">Talking to FPConf speakers</a></li>
<li><a href="../264697/index.html">Using Pester for testing when developing PowerShell scripts</a></li>
<li><a href="../264699/index.html">Yandex added shortcuts for managing search results</a></li>
<li><a href="../264701/index.html">Work with Zip and 7z archives</a></li>
<li><a href="../264705/index.html">Glitches when drawing border-radius in Windows 10</a></li>
<li><a href="../264709/index.html">Preparing for publication post with formulas</a></li>
<li><a href="../264713/index.html">Microsoft released a set of updates for its products, August 2015</a></li>
<li><a href="../264717/index.html">Can I rely on data retrieved by the WMI classes?</a></li>
<li><a href="../264719/index.html">jQuery Video Extend - extending the capabilities of HTML5 video player</a></li>
<li><a href="../264723/index.html">Cryptocurrency developers - who are they? [Interview]</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>