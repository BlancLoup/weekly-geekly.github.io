<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>We write a simple RESTful service on kotlin and spring boot</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Introduction 
 In anticipation of the release of the Kotlin language from beta, I want to share my impression of its use. 

 Kotlin is a new wonderful...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>We write a simple RESTful service on kotlin and spring boot</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/files/323/251/d4d/323251d4df204cf4a5798e2148dcc6d5.png" alt="image"><br><br><h4>  Introduction </h4><br>  In anticipation of the release of the Kotlin language from beta, I want to share my impression of its use. <br><br>  <a href="https://kotlinlang.org/">Kotlin</a> is a new wonderful language from JetBrains (developers IntelliJ Idea) for JVM, Android and a browser that at first glance looks like an improved java (or a simplified scala).  But this is only at first glance, the language has not only absorbed many interesting solutions from other languages, but also presents its original ones: 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      - optional from swift, <a href="https://kotlinlang.org/docs/reference/null-safety.html">nullsafe to kotlin</a> <br>  - case classes from scala, <a href="https://kotlinlang.org/docs/reference/data-classes.html">data class in kotlin</a> <br>  - replacement of implicit methods from scala, <a href="https://kotlinlang.org/docs/reference/extensions.html">extension functions</a> <br>  - <a href="https://kotlinlang.org/docs/reference/delegation.html">delegates</a> <br>  - <a href="https://kotlinlang.org/docs/reference/null-safety.html">null safely</a> <br>  - <a href="https://kotlinlang.org/docs/reference/typecasts.html">smart cast</a> <br>  - and much more, more can be viewed on the official website <a href="https://kotlinlang.org/">kotlinlang</a> . <br><br>  For those who are familiar with java or scala, it will be interesting to compare <a href="https://kotlinlang.org/docs/reference/comparison-to-java.html">kotlin &amp; java</a> , <a href="https://kotlinlang.org/docs/reference/comparison-to-scala.html">kotlin &amp; scala</a> . <br><br>  The authors of the language strive to achieve two tasks: <br>  - make compilation speed comparable to java <br>  - the language must be sufficiently expressive, and at the same time be as simple as possible <br>  Therefore, it is worth making a reservation that if you are currently happy with scala, with its ‚Äúcomplexity‚Äù and compilation time, then you will most likely not need kotlin, for everyone else to read further: <br><a name="habracut"></a><br>  For those who are <s>in the tank</s> for the first time hears about the language, below are a few examples from the official site: <br><br><div class="spoiler">  <b class="spoiler_title">Hello world</b> <div class="spoiler_text"><pre><code class="java hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">package</span></span></span><span class="hljs-function"> hello fun </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">main</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(args: Array&lt;String&gt;)</span></span></span><span class="hljs-function"> </span></span>{ println(<span class="hljs-string"><span class="hljs-string">"Hello World!"</span></span>) }</code> </pre> <br></div></div><br><div class="spoiler">  <b class="spoiler_title">Reading arguments</b> <div class="spoiler_text"><pre> <code class="java hljs"><span class="hljs-function"><span class="hljs-function">fun </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">main</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(args: Array&lt;String&gt;)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (args.size() == <span class="hljs-number"><span class="hljs-number">0</span></span>) { println(<span class="hljs-string"><span class="hljs-string">"Provide a name"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> } println(<span class="hljs-string"><span class="hljs-string">"Hello, ${args[0]}!"</span></span>) }</code> </pre><br></div></div><br><div class="spoiler">  <b class="spoiler_title">hello world c OOP</b> <div class="spoiler_text"><pre> <code class="java hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Greeter</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">val</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">name</span></span></span><span class="hljs-class">: </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">String</span></span></span><span class="hljs-class">) </span></span>{ <span class="hljs-function"><span class="hljs-function">fun </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">greet</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ println(<span class="hljs-string"><span class="hljs-string">"Hello, $name"</span></span>) } } <span class="hljs-function"><span class="hljs-function">fun </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">main</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(args: Array&lt;String&gt;)</span></span></span><span class="hljs-function"> </span></span>{ Greeter(args[<span class="hljs-number"><span class="hljs-number">0</span></span>]).greet() }</code> </pre><br></div></div><br>  From the personal experience of using kotlin, I especially want to point out several advantages of the language: <br><br>  - the first is of course the simplicity of interacting with java.  All types and collections from java are converted to similar ones from kotlin, and vice versa.  This is especially encouraging after all the ‚Äúanarchy‚Äù that is going on in scala (yes there is scala.collection.JavaConversions._ and scala.collection.JavaConverters._, but still this does not compare with the completely transparent type conversion); <br>  - it also cannot but please excellent support from Intellij Idea studio, although the language is in Beta 4, already at the current moment the plug-in for the studio allows you to work comfortably; <br>  - and for fans of implicit methods from scala, kotlin presents a very convenient solution in the form of <a href="https://kotlinlang.org/docs/reference/extensions.html">extension functions</a> ; <br>  - among other things, language developers aim to achieve a <b>compile time comparable to java</b> (hello scala), for which they just want to shake hands!  This is especially pleasing after a long work in scala, when editing one line in a fairly small file is compiled at the same speed as a small java project; <br>  - <a href="https://kotlinlang.org/docs/reference/inline-functions.html">inline function</a> - a great innovation.  With their help, you can, for example, expand the current capabilities of the language, or in some situations achieve increased productivity; <br>  - convenient <a href="http://beust.com/weblog/2015/10/30/exploring-the-kotlin-standard-library/">functions of the</a> standard library. <br>  - comfortable lambda, in contrast to the same java 8. Very similar to the implementation of scala. <br><br>  Nevertheless, the language has its drawbacks: <br><br>  - there is a lack of <a href="http://docs.scala-lang.org/tutorials/tour/pattern-matching.html">pattern matching</a> from scala, but in some situations it saves <a href="https://kotlinlang.org/docs/reference/typecasts.html">smart cast</a> and <a href="https://kotlinlang.org/docs/reference/multi-declarations.html">Destructuring Declarations</a> , in others it is necessary to get it out by other means.  The lack of pattern matching is generally understandable, developers are trying to get as close as possible to the java compilation time, but its presence would significantly simplify the writing of some applications, so that we are content with what we have; <br>  - <a href="https://kotlinlang.org/docs/reference/idioms.html">try with resource</a> is not implemented very well yet.  But here the authors of the language promise to correct the situation in the near future.  In the meantime, you can either use the existing solution or use the language extension: <br><br><div class="spoiler">  <b class="spoiler_title">try-with-resources</b> <div class="spoiler_text"><pre> <code class="java hljs">internal <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ResourceHolder</span></span></span><span class="hljs-class"> : </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">AutoCloseable</span></span></span><span class="hljs-class"> </span></span>{ val resources = ArrayList&lt;AutoCloseable&gt;() fun &lt;T : AutoCloseable&gt; T.autoClose(): T { resources.add(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">this</span></span> } <span class="hljs-function"><span class="hljs-function">override fun </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">close</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ resources.reverse() resources.forEach { <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { it.close() } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> (e: Throwable) { e.printStackTrace() } } } } inline internal fun &lt;R&gt; using(block: ResourceHolder.() -&gt; R): R { val holder = ResourceHolder() <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> holder.block() } <span class="hljs-keyword"><span class="hljs-keyword">finally</span></span> { holder.close() } }</code> </pre><br></div></div><br><div class="spoiler">  <b class="spoiler_title">Usage example</b> <div class="spoiler_text"><pre> <code class="java hljs"><span class="hljs-function"><span class="hljs-function">fun </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">copy</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(from: Path, to: Path)</span></span></span><span class="hljs-function"> </span></span>{ using { val input = Files.newInputStream(from).autoClose() val output = Files.newOutputStream(to).autoClose() input.copyTo(output) } }</code> </pre><br></div></div><br>  - while there is no async and yield, but according to the authors, after the release of 1.0 you can expect them to appear in the very near future. <br><br>  <b>Update</b> In the comments, the most interesting is the comparison with scala, and in particular the advantage of kotlin: <br><div class="spoiler">  <b class="spoiler_title">Advantages of kotlin compared to scala</b> <div class="spoiler_text">  - interaction with java and back.  On kotlin, in general, you can forget about the fact that you call something from java, everything is extremely transparent and convenient.  The same is the opposite.  From java it is also convenient to work with kotlin.  Here even not only the similarity of types helps, as far as the orientation of kotlin itself to transparent work with java itself.  The easiest way to demonstrate this is with examples: <br><div class="spoiler">  <b class="spoiler_title">Examples</b> <div class="spoiler_text">  1. Using lambda instead of anonymous classes (in scala, however, it may soon appear too, but so far there is no such possibility). <br>  Code in java: <br><pre> <code class="java hljs">ExecutorService executor = Executors.newFixedThreadPool(<span class="hljs-number"><span class="hljs-number">1</span></span>); executor.execute(System.out::println);</code> </pre><br><br>  In scala, this will not turn out.  But with kotlin no problem: <br><pre> <code class="java hljs">val executor = Executors.newFixedThreadPool(<span class="hljs-number"><span class="hljs-number">1</span></span>) executor.execute { println() }</code> </pre><br><br>  2. There is the same try-with-resources (yes, you can make an extension to the language, but this is not out of the box, which means you have to pull the solution from one project to another) <br>  It is at least that the first comes to mind <br></div></div><br>  - lack of implicit.  By themselves, implicit is of course a powerful solution, but without a studio it is almost impossible to figure out someone else's code, which is to what.  Especially if the authors are "very enthusiastic."  And to add methods, kotlin allows you to write extensions, which in practice look much more convenient than similar solutions in scala.  Example: <br>  Scala: <br><pre> <code class="scala hljs"><span class="hljs-keyword"><span class="hljs-keyword">implicit</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">RichInt</span></span></span><span class="hljs-class">(</span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">val x: </span></span><span class="hljs-type"><span class="hljs-class"><span class="hljs-params"><span class="hljs-type">Int</span></span></span></span></span><span class="hljs-class">) </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">AnyVal</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">square</span></span></span></span>: <span class="hljs-type"><span class="hljs-type">Int</span></span> = x * x } <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">object</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">App</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">print</span></span></span></span>(): <span class="hljs-type"><span class="hljs-type">Unit</span></span> = { <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> two = <span class="hljs-number"><span class="hljs-number">2</span></span> println(<span class="hljs-string"><span class="hljs-string">s"The square of 2 is </span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">${two.square}</span></span></span><span class="hljs-string">"</span></span>) } }</code> </pre><br>  Kotlin: <br><pre> <code class="java hljs">fun Int.richInt(): Int = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span> * <span class="hljs-keyword"><span class="hljs-keyword">this</span></span> object App { <span class="hljs-function"><span class="hljs-function">fun </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">print</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">: Unit </span></span>{ val two = <span class="hljs-number"><span class="hljs-number">2</span></span> println(<span class="hljs-string"><span class="hljs-string">"The square of 2 is ${two.richInt()}"</span></span>) } }</code> </pre><br><br>  - nullable types instead of Option. <br><br>  - convenient <a href="http://beust.com/weblog/2015/10/30/exploring-the-kotlin-standard-library/">functions of the</a> standard library <br><br>  - and of course the compilation speed.  In practice, everything really compiles very quickly, especially compared to scala. <br><br>  - the resulting jar is less than the same in scala. <br><br>  - and not least, JetBrains promise <b>full backward compatibility</b> (hello again scala with libs under 2.10, 2.11, 2.12, etc.) <br></div></div><br><br>  Let us turn to an example in which a small RESTful application on a <a href="http://projects.spring.io/spring-boot/">spring boot</a> will be demonstrated, with an assembly through <a href="http://gradle.org/">gradle</a> . <br><br><h4>  Studio setup </h4><br>  To work, you need to install <a href="https://www.jetbrains.com/idea/">IntelliJ Idea Community</a> (but you can use Eclipse, there is also a plug-in for it), in which, after installation, update the kotlin plugin.  <b>It is necessary to update it manually, through settings -&gt; plugin</b> , even if you have previously chosen to update the plugin via a pop-up window (at least for now, while the language is in beta). <br><br>  It is also better to put a local gradle, and set it in the settings in the studio (settings -&gt; build, execution, deployment -&gt; gradle -&gt; user local gradle distribution. Then specify the path to gradle in gradle home). <br><br><h4>  Project Setup </h4><br>  Create a gradle kotlin project (new project -&gt; gradle -&gt; kotlin) and change the contents of build.gradle to the following: <br><br><div class="spoiler">  <b class="spoiler_title">Build.gradle content</b> <div class="spoiler_text"><pre> <code class="javascript hljs">buildscript { ext.kotlin_version = <span class="hljs-string"><span class="hljs-string">'1.0.0-beta-4584'</span></span> repositories { mavenCentral() maven { url <span class="hljs-string"><span class="hljs-string">"http://repo.spring.io/snapshot"</span></span> } maven { url <span class="hljs-string"><span class="hljs-string">"http://repo.spring.io/milestone"</span></span> } } dependencies { classpath(<span class="hljs-string"><span class="hljs-string">"org.springframework.boot:spring-boot-gradle-plugin:1.3.0.RELEASE"</span></span>) classpath(<span class="hljs-string"><span class="hljs-string">"org.jetbrains.kotlin:kotlin-gradle-plugin:$kotlin_version"</span></span>) } } apply plugin: <span class="hljs-string"><span class="hljs-string">'idea'</span></span> apply plugin: <span class="hljs-string"><span class="hljs-string">'spring-boot'</span></span> apply plugin: <span class="hljs-string"><span class="hljs-string">'kotlin'</span></span> jar { baseName = <span class="hljs-string"><span class="hljs-string">'test-spring-kotlin-project'</span></span> version = <span class="hljs-string"><span class="hljs-string">'0.1.0'</span></span> } repositories { mavenCentral() maven { url <span class="hljs-string"><span class="hljs-string">"http://repo.spring.io/snapshot"</span></span> } maven { url <span class="hljs-string"><span class="hljs-string">"http://repo.spring.io/milestone"</span></span> } maven { url <span class="hljs-string"><span class="hljs-string">"http://10.10.10.67:8081/nexus/content/groups/public"</span></span> } } dependencies { compile(<span class="hljs-string"><span class="hljs-string">"org.springframework.boot:spring-boot-starter-web:1.3.0.RELEASE"</span></span>) compile(<span class="hljs-string"><span class="hljs-string">"org.springframework:spring-jdbc:4.2.3.RELEASE"</span></span>) compile(<span class="hljs-string"><span class="hljs-string">"com.fasterxml.jackson.module:jackson-module-kotlin:2.6.4"</span></span>) compile(<span class="hljs-string"><span class="hljs-string">"org.jetbrains.kotlin:kotlin-stdlib:$kotlin_version"</span></span>) }</code> </pre><br></div></div><br>  Create an application.properties file in the src / main / resources folder, where we specify the port to start spring boot: <br><br><div class="spoiler">  <b class="spoiler_title">application.properties</b> <div class="spoiler_text"><pre> <code class="javascript hljs">server.port = <span class="hljs-number"><span class="hljs-number">8080</span></span></code> </pre><br></div></div><br>  Create an Application.kt file in the src / main / kotlin / test.kotlin.spring.project folder.  It will be the main settings for running spring boot: <br><br><div class="spoiler">  <b class="spoiler_title">Application.kt</b> <div class="spoiler_text"><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> test.kotlin.spring.project <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> com.fasterxml.jackson.annotation.JsonInclude <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> com.fasterxml.jackson.databind.DeserializationFeature <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> com.fasterxml.jackson.databind.ObjectMapper <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> com.fasterxml.jackson.<span class="hljs-keyword"><span class="hljs-keyword">module</span></span>.kotlin.registerKotlinModule <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.springframework.boot.SpringApplication <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.springframework.boot.autoconfigure.EnableAutoConfiguration <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.springframework.boot.autoconfigure.SpringBootApplication <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.springframework.boot.autoconfigure.jdbc.DataSourceAutoConfiguration <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.springframework.boot.builder.SpringApplicationBuilder <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.springframework.boot.context.web.SpringBootServletInitializer <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.springframework.context.annotation.Bean <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.springframework.http.converter.json.MappingJackson2HttpMessageConverter <span class="hljs-meta"><span class="hljs-meta">@SpringBootApplication</span></span> <span class="hljs-meta"><span class="hljs-meta">@EnableAutoConfiguration</span></span>(exclude = arrayOf(DataSourceAutoConfiguration::<span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class">)) </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">open</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Application</span></span></span><span class="hljs-class"> : </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">SpringBootServletInitializer</span></span></span><span class="hljs-class">() </span></span>{ <span class="hljs-meta"><span class="hljs-meta">@Bean</span></span> <span class="hljs-function"><span class="hljs-function">open fun </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">mapperForKotlinTypes</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">: MappingJackson2HttpMessageConverter </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> MappingJackson2HttpMessageConverter().apply { objectMapper = jacksonMapper } } <span class="hljs-function"><span class="hljs-function">override fun </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">configure</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(application: SpringApplicationBuilder)</span></span></span><span class="hljs-function">: SpringApplicationBuilder </span></span>= application.sources(Application::<span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">java</span></span></span><span class="hljs-class">) </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">companion</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">object</span></span></span><span class="hljs-class"> </span></span>{ val jacksonMapper = ObjectMapper().registerKotlinModule() .setSerializationInclusion(JsonInclude.Include.NON_ABSENT) .enable(DeserializationFeature.FAIL_ON_NULL_FOR_PRIMITIVES) <span class="hljs-meta"><span class="hljs-meta">@Throws</span></span>(Exception::<span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class">) @</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">JvmStatic</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">fun</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">main</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">args</span></span></span><span class="hljs-class">: </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Array</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">String</span></span></span><span class="hljs-class">&gt;) </span></span>{ println(<span class="hljs-string"><span class="hljs-string">"starting application..."</span></span>) SpringApplication.run(Application::<span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">java</span></span></span><span class="hljs-class">, *</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">args</span></span></span><span class="hljs-class">) } } }</span></span></code> </pre><br></div></div><br><br>  You will also need to create a file with the settings of the rest service methods.  There will be several methods: <br><br>  - the method will issue an AckResponse to the first and last data entered with the query. <br>  - method, the input is an array of strings, from which the smallest string is selected by length, which is then broken down by '_', sorted and assembled into a string already with the character ',' (demonstrates the capabilities of the language) <br><br>  Create a file ServiceController.kt in the src / main / kotlin / test.kotlin.spring.project folder. <br><br><div class="spoiler">  <b class="spoiler_title">ServiceController.kt</b> <div class="spoiler_text"><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> test.kotlin.spring.project <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.springframework.http.MediaType <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.springframework.web.bind.annotation.RequestMapping <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.springframework.web.bind.annotation.RequestMethod <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.springframework.web.bind.annotation.RequestParam <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.springframework.web.bind.annotation.<span class="hljs-function"><span class="hljs-function">RestController data class </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">AckResponse</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(val status: Boolean, val result: String, val message: String? = </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">null</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function"> @RestController class ServiceController </span></span>{ <span class="hljs-meta"><span class="hljs-meta">@RequestMapping</span></span>( path = arrayOf(<span class="hljs-string"><span class="hljs-string">"/request"</span></span>), method = arrayOf(RequestMethod.GET), produces = arrayOf(MediaType.APPLICATION_JSON_UTF8_VALUE)) <span class="hljs-function"><span class="hljs-function">fun </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">nameRequest</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">( @RequestParam(value = </span></span><span class="hljs-string"><span class="hljs-function"><span class="hljs-params"><span class="hljs-string">"name"</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function"> name: String, @</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">RequestParam</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(value = </span></span><span class="hljs-string"><span class="hljs-function"><span class="hljs-params"><span class="hljs-string">"surname"</span></span></span></span><span class="hljs-function"><span class="hljs-params">, required = </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">false</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function"> surname: String?): AckResponse </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (surname == <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>) AckResponse(status = <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>, result = <span class="hljs-string"><span class="hljs-string">"Hi $name"</span></span>, message = <span class="hljs-string"><span class="hljs-string">"surname is empty"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> AckResponse(status = <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>, result = <span class="hljs-string"><span class="hljs-string">"Hi $surname,$name"</span></span>) } <span class="hljs-meta"><span class="hljs-meta">@RequestMapping</span></span>( path = arrayOf(<span class="hljs-string"><span class="hljs-string">"/sort_request"</span></span>), method = arrayOf(RequestMethod.GET), produces = arrayOf(MediaType.APPLICATION_JSON_UTF8_VALUE)) <span class="hljs-function"><span class="hljs-function">fun </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">findMinimum</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">( @RequestParam(value = </span></span><span class="hljs-string"><span class="hljs-function"><span class="hljs-params"><span class="hljs-string">"values"</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function"> values: Array&lt;String&gt;): AckResponse </span></span>{ println(<span class="hljs-string"><span class="hljs-string">"values:"</span></span>) values.forEach { println(it) } val minValue = values.apply { sortBy { it.length } } .firstOrNull() ?.split(<span class="hljs-string"><span class="hljs-string">"_"</span></span>) ?.sorted() ?.joinToString(<span class="hljs-string"><span class="hljs-string">","</span></span>) ?: <span class="hljs-string"><span class="hljs-string">""</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> AckResponse(status = <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>, result = minValue) } }</code> </pre><br></div></div><br><h4>  Running and testing </h4><br>  We start application from Application.kt.  In the case of a successful launch in the log will be something like: <br><br><div class="spoiler">  <b class="spoiler_title">Application logs</b> <div class="spoiler_text"><pre>  starting application ...<font></font>
<font></font>
   .  ____ _ __ _ _
  / \\ / ___'_ __ _ _ (_) _ __ __ _ \ \ \ \
 (() \ ___ | '_ |' _ | | '_ \ / _` | \ \ \ \
  \\ / ___) |  | _) |  |  |  |  |  ||  (_ | |))))
   '| ____ |  .__ | _ |  | _ | _ |  | _ \ __, |  / / / /
  ========= | _ | ============== | ___ / = / _ / _ / _ /
  :: Spring Boot :: (v1.3.0.RELEASE)<font></font>
<font></font>
 2016-01-12 12: 47: 48.242 INFO 88 --- [main] tksproject.Application $ Companion: Starting Application.Companion on Lenovo-PC with PID 88 (D: \ IDA_Projects \ test \ build \ classes \ main started by admin in D: \ IDA_Projects \ test)
 2016-01-12 12: 47: 48.247 INFO 88 --- [main] tksproject.Application $ Companion: No profiles are active
 2016-01-12 12: 47: 48.413 INFO 88 --- [main] ationConfigEmbeddedWebApplicationContext: Refreshing org.springframework.boot.context.embeddedWebApplicationContext@dbf57b3: startup date [Tue Jan 12 12:47:48 MSK 2016]]  root of context hierarchy
 2016-01-12 12: 47: 50.522 INFO 88 --- [main] osbfsDefaultListableBeanFactory: Overriding bean for beanNameViewResolver with a different definition: replacing [Root bean: class [null];  scope =;  abstract = false;  lazyInit = false;  autowireMode = 3;  dependencyCheck = 0;  autowireCandidate = true;  primary = false;  factoryBeanName = org.springframework.boot.autoconfigure.web.ErrorMvcAutoConfiguration $ WhitelabelErrorViewConfiguration;  factoryMethodName = beanNameViewResolver;  initMethodName = null;  destroyMethodName = (inferred);  [org / springframework / boot / autoconfigure / web / ErrorMvcAutoConfiguration $ WhitelabelErrorViewConfiguration.class]] [Root bean: class [null];  scope =;  abstract = false;  lazyInit = false;  autowireMode = 3;  dependencyCheck = 0;  autowireCandidate = true;  primary = false;  factoryBeanName = org.springframework.boot.autoconfigure.web.WebMvcAutoConfiguration $ WebMvcAutoConfigurationAdapter;  factoryMethodName = beanNameViewResolver;  initMethodName = null;  destroyMethodName = (inferred);  defined in class path resource [org / springframework / boot / autoconfigure / web / WebMvcAutoConfiguration $ WebMvcAutoConfigurationAdapter.class]]
 2016-01-12 12: 47: 51.066 INFO 88 --- [main] trationDelegate $ BeanPostProcessorChecker: Bean 'org.springframework.transaction.annotation.ProxyTransactionManagementConfiguration' of type [class org.springframework.transaction.annotation.ProxyTransactManthramathrantMathr.AffraTeanMatery.transferamework.transaction.annotation. $$ ede1977c] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
 2016-01-12 12: 47: 51.902 INFO 88 --- [main] sbcetTomcatEmbeddedServletContainer: Tomcat initialized with port (s): 8080 (http)
 2016-01-12 12: 47: 51.930 INFO 88 --- [main] o.apache.catalina.core.StandardService: Starting service Tomcat
 2016-01-12 12: 47: 51.937 INFO 88 --- [main] org.apache.catalina.core.StandardEngine: Starting Servlet Engine: Apache Tomcat / 8.0.28
 2016-01-12 12: 47: 52.095 INFO 88 --- [ost-startStop-1] oaccC [Tomcat]. [Localhost]. [/]: Initializing Spring embedded WebApplicationContext
 2016-01-12 12: 47: 52.095 INFO 88 --- [ost-startStop-1] osweb.context.ContextLoader: Root WebApplicationContext: initialization completed 3688 ms
 2016-01-12 12: 47: 52.546 INFO 88 --- [ost-startStop-1] osbceServletRegistrationBean: Mapping servlet: 'dispatcherServlet' to [/]
 2016-01-12 12: 47: 52.556 INFO 88 --- [ost-startStop-1] osbcembedded.FilterRegistrationBean: Mapping filter: 'characterEncodingFilter' to: [/ *]
 2016-01-12 12: 47: 52.557 INFO 88 --- [ost-startStop-1] osbcembedded.FilterRegistrationBean: Mapping filter: 'hiddenHttpMethodFilter' to: [/ *]
 2016-01-12 12: 47: 52.559 INFO 88 --- [ost-startStop-1] osbcembedded.FilterRegistrationBean: Mapping filter: 'httpPutFormContentFilter' to: [/ *]
 2016-01-12 12: 47: 52.559 INFO 88 --- [ost-startStop-1] osbcembedded.FilterRegistrationBean: Mapping filter: 'requestContextFilter' to: [/ *]
 2016-01-12 12: 47: 52.985 INFO 88 --- [main] swsmmaRequestMappingHandlerAdapter: Looking for @ControllerAdvice: org.springframework.boot.context.embedded.AnnotationConfigEmbeddedWebApplicationContext@dbf57b3: launch date [Tue Jan 12 12 MSK 2016];  root of context hierarchy
 2016-01-12 12: 47: 53.089 INFO 88 --- [main] swsmmaRequestMappingHandlerMapping: Mapped "{[/ request], methods = [GET], produces = [application / json; charset = UTF-8]}" " public final test.kotlin.spring.project.AckResponse test.kotlin.spring.project.ServiceController.pullUpdate (java.lang.String, java.lang.String)
 2016-01-12 12: 47: 53.094 INFO 88 --- [main] swsmmaRequestMappingHandlerMapping: Mapped "{[/ error]}": java.util.Map &lt;java.lang.String: public org.springframework.http.ResponseEntity &lt;java.util.Map &lt;java.lang.String , java.lang.Object &gt;&gt; org.springframework.boot.autoconfigure.web.BasicErrorController.error (javax.servlet.http.HttpServletRequest)
 2016-01-12 12: 47: 53.094 INFO 88 --- [main] swsmmaRequestMappingHandlerMapping: Mapped "{[/ error], produces = [text / html]}" is public org.springframework.web.servlet.ModelAndView org. springframework.boot.autoconfigure.web.BasicErrorController.errorHtml (javax.servlet.http.HttpServletRequest)
 2016-01-12 12: 47: 53.138 INFO 88 --- [main] oswshandler.SimpleUrlHandlerMapping: Mapped URL path [/ webjars / **] for class of [class org.springframework.web.servlet.resource.ResourceHttpRequestHandler]
 2016-01-12 12: 47: 53.139 INFO 88 --- [main] oswshandler.SimpleUrlHandlerMapping: Mapped URL path [/ **] for handler type [class org.springframework.web.servlet.resource.ResourceHttpRequestHandler]
 2016-01-12 12: 47: 53.195 INFO 88 --- [main] oswshandler.SimpleUrlHandlerMapping: Mapped URL path [/**/favicon.ico] [class org.springframework.web.servlet.resource. ResourceHttpRequestHandler]
 2016-01-12 12: 47: 53.512 INFO 88 --- [main] osjeaAnnotationMBeanExporter: Registering beans for JMX exposure on startup
 2016-01-12 12: 47: 53.612 INFO 88 --- [main] sbcetTomcatEmbeddedServletContainer: Tomcat started on port (s): 8080 (http)
 2016-01-12 12: 47: 53.620 INFO 88 --- [main] tksproject.Application $ Companion: Started Application.Companion in 6.076 seconds (JVM running for 7.177)
 2016-01-12 12: 47: 57.874 INFO 88 --- [nio-8080-exec-1] oaccC [Tomcat]. [Localhost]. [/]: Initializing Spring Framework Framework 'dispatcherServlet'
 2016-01-12 12: 47: 57.874 INFO 88 --- [nio-8080-exec-1] osweb.servlet.DispatcherServlet: FrameworkServlet 'dispatcherServlet': initialization started
 2016-01-12 12: 47: 57.897 INFO 88 --- [nio-8080-exec-1] osweb.servlet.DispatcherServlet: FrameworkServlet 'dispatcherServlet': initialization completed in 23 ms </pre><br></div></div><br>  After a successful launch, try to open the <a href="http://localhost:8080/request%3Fname%3DKris">Request</a> page <a href="http://localhost:8080/request%3Fname%3DKris">with the name</a> .  The answer should look like this: <br><pre> <code class="javascript hljs">{ <span class="hljs-attr"><span class="hljs-attr">status</span></span>: <span class="hljs-literal"><span class="hljs-literal">true</span></span>, <span class="hljs-attr"><span class="hljs-attr">result</span></span>: <span class="hljs-string"><span class="hljs-string">"Hi Kris"</span></span>, <span class="hljs-attr"><span class="hljs-attr">message</span></span>: <span class="hljs-string"><span class="hljs-string">"surname is empty"</span></span> }</code> </pre><br>  And the <a href="http://localhost:8080/request%3Fname%3DKris%26surname%3DEagle">request with the name and surname</a> , then the answer will be slightly different: <br><br><pre> <code class="javascript hljs">{ <span class="hljs-attr"><span class="hljs-attr">status</span></span>: <span class="hljs-literal"><span class="hljs-literal">true</span></span>, <span class="hljs-attr"><span class="hljs-attr">result</span></span>: <span class="hljs-string"><span class="hljs-string">"Hi Eagle, Kris"</span></span> }</code> </pre><br>  Call to check data sorting: <a href="http://localhost:8080/sort_request%3Fvalues%3Dvirst_value_1_3,second_value_2_5_6">Sort</a> .  The result should be: <br><br><pre> <code class="javascript hljs">{ <span class="hljs-attr"><span class="hljs-attr">status</span></span>: <span class="hljs-literal"><span class="hljs-literal">true</span></span>, <span class="hljs-attr"><span class="hljs-attr">result</span></span>: <span class="hljs-string"><span class="hljs-string">"1,3,value,virst"</span></span> }</code> </pre><br>  The same call, but with an empty array: <a href="http://localhost:8080/sort_request%3Fvalues">Call</a> <br><pre> <code class="javascript hljs">{ <span class="hljs-attr"><span class="hljs-attr">status</span></span>: <span class="hljs-literal"><span class="hljs-literal">true</span></span>, <span class="hljs-attr"><span class="hljs-attr">result</span></span>: <span class="hljs-string"><span class="hljs-string">""</span></span> }</code> </pre><br>  If necessary, you can build the entire project into one runnable jar, with the command: gradle build.  As a result, the project will be compiled into one archive containing all dependencies without unpacking.  With this approach, the project build time is significantly increased, compared to the same assemble, when a project is assembled into one archive with unpacking of all dependencies. <br><br><h4>  Conclusion </h4><br>  In conclusion, I would like to note that kotlin turned out to be a very convenient language for working on any project that uses java as its replacement.  The ecosystem of the language is not as extensive as the same scala, but now you can use it in the same big data, where there is a java api.  In addition, from kotlin it is very easy to interact with java, so everything that is in java can be used in kotlin.  In addition, from the studio there is the possibility of easy conversion of java files to similar ones on kotlin (although you will need to tweak the file a bit with hands after the conversion).  JetBrains have done a wonderful job in creating an ideal language to replace java and scala.  And I hope in the future the trend towards the use of kotlin will only grow. <br><br>  Sources are available on <a href="">github</a> . <br><br>  Thank you all for your attention. </div><p>Source: <a href="https://habr.com/ru/post/274997/">https://habr.com/ru/post/274997/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../274983/index.html">Making a wireless network bridge for 2 Mikrotik</a></li>
<li><a href="../274985/index.html">I knew how to validate an email address. Not yet read the RFC</a></li>
<li><a href="../274987/index.html">By the year 2060, programmers will not be needed</a></li>
<li><a href="../274989/index.html">IBM Watson improves its cognitive abilities and offers new opportunities for developers.</a></li>
<li><a href="../274995/index.html">My approach to Class Based Views</a></li>
<li><a href="../274999/index.html">Photo Encryption on Google Drive</a></li>
<li><a href="../275001/index.html">How to design for people with color blindness</a></li>
<li><a href="../275005/index.html">Initialization of flight data in the AIRCOM Server system</a></li>
<li><a href="../275009/index.html">Server in your pocket: deploy ONLYOFFICE on Intel NUCs</a></li>
<li><a href="../275011/index.html">Module loader for node js with support for local modules and load modules on demand</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>