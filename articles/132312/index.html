<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>About unnecessary Spanning Tree</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Immediately make a reservation, do not take the title too literally. If the stars are lit ... and so on. 

 Nevertheless, the Spannning Tree protocol ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>About unnecessary Spanning Tree</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/storage1/615a4ecb/37cd9b95/88ca70cf/1a2c33eb.jpg"><br><br>  <i>Immediately make a reservation, do not take the title too literally.</i>  <i>If the stars are lit ... and so on.</i> <br><br>  Nevertheless, the Spannning Tree protocol family, if it does not outlive its age as the main backup tool in ethernet networks, then at least smoothly flows into narrow and specific niches (of course, their discussion goes beyond any framework of this article, but is welcomed in comments). 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      And yes, of course, no one has canceled Spanning Tree as a technology to protect against human error. <br><a name="habracut"></a><br><h4>  Why is it needed </h4><br>  First, allow yourself a couple of platitudes.  Of course, they can be learned from Wikipedia, but we can not resist. <br><br>  Since the BOC model (also known as ISO / OSI, if you like it more) forgot to endow the channel layer with the functions of selecting the optimal transmission path and excluding hooks, which put it on the network layer, Ethernet does not have such functions.  Instead of a hassle with a preliminary calculation of the path to the destination address, the ethernet switch, if it does not know where to send the frame, sends it to all ports, except the port through which the transmitted frame was received.  And there, you see, there is an addressee capable of comprehending by content that this is a frame for him.  (When we talk about flooding to all ports, except in very special cases, we are talking only about the ports of one VLAN.) <br><br><div style="text-align:center;"><img src="https://habrastorage.org/storage1/3d21cbfe/0a538bf4/3d48e7c6/37d5e838.png"></div><br><br><blockquote>  <i>The switch would not be a switch, if it were limited to this.</i>  <i>Still, he is not so stupid, and in order not to send everything to everyone at all times, he looks at the source addresses and writes them to himself in a label: the MAC address of such and such is located behind such and such port.</i>  <i>The process is called learning MAC addresses (‚Äúmacroning‚Äù).</i>  <i>Having formed such a table (switching table), the switch sends frames only to the necessary ports.</i> </blockquote><br>  If, on top of Ethernet, IP traffic is transmitted, and most often it is, then frames with unknown destination MAC addresses should not occur in a good scenario (and direct hands), but there is no way to do without special frames with a destination address ‚ÄúSend to all‚Äù, the transfer of which boils down to the same. <br><br>  Total, in ethernet-networks flooding, that is, copying the frame to all possible output ports is an integral part of the switching process. <br><br>  Now imagine what happens if a loopback is found in the network topology.  One of the copies of the frame will return to the switch that failed it, which will again elucidate it, and so on until all the devices on the network have a processor load of one hundred percent.  The situation described is called a Broadcast storm.  Who ever observed - will not lie, the spectacle is not for the faint of heart. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/storage1/da6b08b3/26e73113/a7601eb4/601f6c5b.png"></div><br><br><blockquote>  <i>If you and your neighbor agreed to forget about home lokalku, buying a pair of plastic switches in the store, do not try for greater speed and greater reliability to connect them with two wires instead of one: it will not be better, that's at least.</i> </blockquote><br>  On the one hand - what is easier?  - Do not stick extra wires, and that's all.  But not so easy.  After all, I want the network to be fault-tolerant, with redundant connections, redundant nodes and automatic failover.  In other words, so that the L2 network was like L3.  To achieve the desired and, at the same time, to protect themselves from the horror of broadcasted storms, people came up with special technologies to search for cycles in the topology and force them to break by blocking individual links.  These technologies are called the word Spanning Tree. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/storage1/b1b7c420/7c594bad/a4272f49/18250623.png"></div><br><br><blockquote>  <i>It is technology, in the plural.</i>  <i>After all, it‚Äôs not enough to say ‚Äúblock‚Äù, it is still important to understand which link to block, after what period of time to check, whether it‚Äôs time to unblock, how to do it, which ports you can not check for hooking, which VLANs should be sent via which links, how quickly it all happens, etc. Different views on these and many other issues have created a whole heap of protocols with the common name Spanning Tree: STP, RSTP, PVST, PVST +, PVRST, MSTP, VSTP, and there must be more.</i> </blockquote><br>  Readers, who have seriously studied any of the above, are probably familiar with the sensation, similar to the combination of drowsiness and toothache, which occurs in the process of studying all these endless port states, weights forming mechanisms, root switch selection algorithms, and other skukoteni, which is inferior to boring except anatomy textbook.  Those who have successfully coped with the introduction, operation, troubleshooting and network development of at least a dozen switches, built on the basis of a spanning tree, can safely serve <del>  sportlotto </del>  IEEE petition for submission to a reward.  They do not need to read further. <br><br><blockquote>  <i>Spanning Tree in English means "branching tree."</i>  <i>And a tree is, in turn, a ‚Äúconnected acyclic graph,‚Äù that is, a graph without cycles (hooks), between which two vertices there exists at least one path.</i> </blockquote><br><h4>  Why it is not necessary </h4><br>  Now, finally, about why Spanning Tree is rapidly losing its relevance. <br><br>  You, of course, have already heard that in the bright future, everything will be, firstly, common, secondly virtual, <s>thirdly free</s> .  So, in some way, a bright future has already arrived. <br><br>  Linking technology into aggregated LAG aka EtherChannel groups did not appear yesterday. <br><br><blockquote>  <i>By the way, the linking in LAG and the LACP protocol should not be confused in itself, which helps to make this union (semi) automatically, but because of the inept handling in life, it has more problems than good.</i> </blockquote><br>  The idea is simple.  Two switches ‚Äî however, not necessarily switches, any devices operating at the second and higher levels ‚Äî are connected for reliability by two wires, not just one.  At the same time, the switches are configured (manually or by means of LACP) in such a way that for them the two wires are one link.  We will not go into details too much, there are plenty of articles for every taste, we just say that aggregation can be done in one of two ways: ‚Äúactive ‚Äì active‚Äù (most popular): traffic is transmitted over two wires at once with load balancing;  and ‚Äúactive ‚Äì passive‚Äù: while one link is in ‚Äúan‚Äù, the second is in ‚Äúdown‚Äù, when the main one drops, it switches to the backup one. <br><br>  In essence, the above is the easiest way to get rid of Spanning Tree on the ‚Äúone-generation‚Äù level.  However, this method generally requires that both links on each side be connected to the same switch.  Otherwise, the same hooks or complications associated with the constant updating of the table of MAC addresses are possible. <br><br>  But here comes a relatively (relatively) modern invention to the aid - switch clustering.  With its help, several physical devices can be combined into one logical one.  Traditionally, this function is considered to be ‚Äúbeautiful‚Äù, designed primarily to simplify management.  However, the main advantages of clustering switches are quite different.  In addition to <a href="http://senetsy.livejournal.com/2543.html">some technical and commercial aspects</a> , clustering is also a reduction in the number of nodes in the topology while maintaining redundancy of physical devices. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/storage1/50748a03/c852f5dd/8021af28/5f5510b8.png"></div><br><br>  Today, the main driver of the growing popularity of clustered switches is precisely the possibility of combining ports on different physical devices in a cluster into LAG.  Thus, we are able to connect one access switch (in which user links are stuck) to two switch aggregations without any spanning tree.  Similarly, if there are more levels, the aggregators can be connected via a LAG group to the core (if you have one) or backbone. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/storage1/5e2b9479/23f18929/c9f9383b/86ac65ff.png"></div><br><br><h4>  Word about scale </h4><br>  Initially, clustering appeared on 24/48 √ó 1GE (+ 2 √ó 10GE) format switches, that is, devices of relatively small scale.  Depending on the manufacturer and model, such switches can be clustered in a cluster either using special interfaces (PCI Express, InfiniBand, etc.), which are limited in length to a few meters, or via regular ports 1 or 10 Gigabit Ethernet, incl. optical.  In the latter cases, it is possible to build geographically distributed switches and even <a href="http://www.juniper.net/us/en/local/pdf/implementation-guides/8010045-en.pdf">small metro-ethernet networks</a> .  Depending on the specific implementation and model, it is usually possible to combine from two to ten devices into one cluster. <br><br>  After some time, manufacturers began to implement clustering on large modular switches.  They typically use several 10 Gigabit Ethernet interfaces for intra-cluster links.  The maximum number of such devices per cluster is usually substantially less (2‚Äì4), however, there is no particular crime in this. <br><br>  In addition to modular switches, clustering is also found on the full hardware routers of the older lines of individual manufacturers.  From a theoretical point of view, this function is less relevant for routers due to the presence of native routing mechanisms, load balancing, and traffic engineering in IP / MPLS networks.  But since such devices are often used to perform L2 functions (PE for L2VPN / VPLS services or combining L3 and L2 in one box), clustering support on them is also important and is used primarily for the same: combining different LAG interfaces physical devices to back up second level connections. <br><br>  And yet the bright future will not be free.  In some aspects, a switch cluster is worse than many individual switches.  For example, the table of MAC addresses on all devices is usually one.  Accordingly, the top bar of the maximum number of entries in it applies to the entire cluster.  For a network of 10 devices of a small city scale, a limit of 10‚Äì15 thousand MAC addresses may be a significant limitation;  Some implementations, for example, require the simultaneous reboot of all cluster devices when updating software.  This kind of nuances depending on the specific model of devices can be quite a lot.  All this makes clustering a questionable approach to building carrier networks. <br><br><h4>  Total </h4><br>  The combination of clustering switches and aggregating the interfaces of different devices into LAG groups is the most efficient way to build fault-tolerant L2 networks of enterprises, campuses (several buildings of a single administrative office located next to each other), data centers, and individual providers' network nodes.  For most of the parameters: switching speed, stability, reliability, ease of setup operation and troubleshooting, load balancing - this approach greatly exceeds the variations on the Spanning Tree theme. <br><br>  However, this technology is not a panacea, you should not take it as a mechanism for building real L2-carrier-scale networks. <br><br>  In addition, Spanning Tree, although losing its relevance as a mechanism for building a fault-tolerant topology and balancing, but, as already mentioned, remains an important way to protect against human error.  Therefore, if, for example, RSTP or PVST + is enabled by default on the switch, you should not turn it off unless you are sure that you know exactly why.  It is also desirable that one switch be used on all switches, but this is a completely different story. </div><p>Source: <a href="https://habr.com/ru/post/132312/">https://habr.com/ru/post/132312/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../132302/index.html">LAMP + Nginx on VPS is stable and without any extra headache</a></li>
<li><a href="../132306/index.html">Seven reasons why your colleagues do not trust you</a></li>
<li><a href="../132307/index.html">Russian rock in the Android Market</a></li>
<li><a href="../132308/index.html">Implementing the DEEP IDLE power saving mode in the Linux kernel</a></li>
<li><a href="../132309/index.html">TELESAR V - robot for telebeeting</a></li>
<li><a href="../132313/index.html">Cmake - we collect portable applications for Mac Os X and Windows</a></li>
<li><a href="../132314/index.html">Observable.Generate and list listings</a></li>
<li><a href="../132315/index.html">Automatic collection and archiving of photo / video surveillance</a></li>
<li><a href="../132317/index.html">Fluent Interface Organization in Python</a></li>
<li><a href="../132318/index.html">Facebook flight search app</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>