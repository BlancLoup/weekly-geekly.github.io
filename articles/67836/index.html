<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>C # + WPF + third-party builds -> one .exe-shnik</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Sometimes you have to develop a small application in C # and WPF, but as a result of using third-party builds (for example, SharpZipLib, Unity), it tu...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>C # + WPF + third-party builds -> one .exe-shnik</h1><div class="post__text post__text-html js-mediator-article">  Sometimes you have to develop a small application in C # and WPF, but as a result of using third-party builds (for example, SharpZipLib, Unity), it turns out that at the output, in addition to our little .exe file, we also get a bunch of .dll-ok, and we need to there was just one .exe-shnik. <br><a name="habracut"></a><br>  Few knowledgeable people here will remember the utility <a href="http://research.microsoft.com/en-us/people/mbarnett/ilmerge.aspx">ILMerge</a> from Microsoft, but unfortunately there are <a href="http://social.msdn.microsoft.com/Forums/en-US/wpf/thread/1ba71aba-9ab2-4d66-8722-b94eca29d0b4">problems with WPF-applications</a> due to the peculiarities of compiling XAML-files. <br>  There are also problems with tricky assemblies, which were walked by decent obfuscators. <br><br>  I suggest another way that I use in some of my products - to include all third-party assemblies as embedded resources, and in App.xaml.cs, do this: <br><br><blockquote><code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black"><font color="#0000ff">public</font> <font color="#0000ff">partial</font> <font color="#0000ff">class</font> App : Application { <font color="#008000">//   </font> <font color="#0000ff">private</font> <font color="#0000ff">void</font> OnStartup( <font color="#0000ff">object</font> sender, StartupEventArgs e) { <font color="#008000">//              </font> AppDomain.CurrentDomain.AssemblyResolve += ResolveAssembly; } <font color="#008000">//    </font> <font color="#0000ff">static</font> <font color="#2B91AF">Assembly</font> ResolveAssembly( <font color="#0000ff">object</font> sender, ResolveEventArgs args) { <font color="#008000">//    (    )</font> <font color="#2B91AF">Assembly</font> thisAssembly = <font color="#2B91AF">Assembly</font> .GetExecutingAssembly(); <font color="#008000">//  </font> <font color="#0000ff">var</font> name = args.Name.Substring(0, args.Name.IndexOf( <font color="#A31515">','</font> )) + <font color="#A31515">".dll"</font> ; <font color="#008000">//   </font> <font color="#0000ff">var</font> resourceName = thisAssembly.GetManifestResourceNames().First(s =&gt; s.EndsWith(name)); <font color="#0000ff">using</font> ( <font color="#2B91AF">Stream</font> stream = thisAssembly.GetManifestResourceStream(resourceName)) { <font color="#008000">//    </font> <font color="#0000ff">byte</font> [] block = <font color="#0000ff">new</font> <font color="#0000ff">byte</font> [stream.Length]; stream.Read(block, 0, block.Length); <font color="#008000">//           </font> <font color="#0000ff">return</font> <font color="#2B91AF">Assembly</font> .Load(block); } } }</font> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> <ol><li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">public</font> <font color="#0000ff">partial</font> <font color="#0000ff">class</font> App : Application { <font color="#008000">//   </font> <font color="#0000ff">private</font> <font color="#0000ff">void</font> OnStartup( <font color="#0000ff">object</font> sender, StartupEventArgs e) { <font color="#008000">//              </font> AppDomain.CurrentDomain.AssemblyResolve += ResolveAssembly; } <font color="#008000">//    </font> <font color="#0000ff">static</font> <font color="#2B91AF">Assembly</font> ResolveAssembly( <font color="#0000ff">object</font> sender, ResolveEventArgs args) { <font color="#008000">//    (    )</font> <font color="#2B91AF">Assembly</font> thisAssembly = <font color="#2B91AF">Assembly</font> .GetExecutingAssembly(); <font color="#008000">//  </font> <font color="#0000ff">var</font> name = args.Name.Substring(0, args.Name.IndexOf( <font color="#A31515">','</font> )) + <font color="#A31515">".dll"</font> ; <font color="#008000">//   </font> <font color="#0000ff">var</font> resourceName = thisAssembly.GetManifestResourceNames().First(s =&gt; s.EndsWith(name)); <font color="#0000ff">using</font> ( <font color="#2B91AF">Stream</font> stream = thisAssembly.GetManifestResourceStream(resourceName)) { <font color="#008000">//    </font> <font color="#0000ff">byte</font> [] block = <font color="#0000ff">new</font> <font color="#0000ff">byte</font> [stream.Length]; stream.Read(block, 0, block.Length); <font color="#008000">//           </font> <font color="#0000ff">return</font> <font color="#2B91AF">Assembly</font> .Load(block); } } } <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">public</font> <font color="#0000ff">partial</font> <font color="#0000ff">class</font> App : Application { <font color="#008000">//   </font> <font color="#0000ff">private</font> <font color="#0000ff">void</font> OnStartup( <font color="#0000ff">object</font> sender, StartupEventArgs e) { <font color="#008000">//              </font> AppDomain.CurrentDomain.AssemblyResolve += ResolveAssembly; } <font color="#008000">//    </font> <font color="#0000ff">static</font> <font color="#2B91AF">Assembly</font> ResolveAssembly( <font color="#0000ff">object</font> sender, ResolveEventArgs args) { <font color="#008000">//    (    )</font> <font color="#2B91AF">Assembly</font> thisAssembly = <font color="#2B91AF">Assembly</font> .GetExecutingAssembly(); <font color="#008000">//  </font> <font color="#0000ff">var</font> name = args.Name.Substring(0, args.Name.IndexOf( <font color="#A31515">','</font> )) + <font color="#A31515">".dll"</font> ; <font color="#008000">//   </font> <font color="#0000ff">var</font> resourceName = thisAssembly.GetManifestResourceNames().First(s =&gt; s.EndsWith(name)); <font color="#0000ff">using</font> ( <font color="#2B91AF">Stream</font> stream = thisAssembly.GetManifestResourceStream(resourceName)) { <font color="#008000">//    </font> <font color="#0000ff">byte</font> [] block = <font color="#0000ff">new</font> <font color="#0000ff">byte</font> [stream.Length]; stream.Read(block, 0, block.Length); <font color="#008000">//           </font> <font color="#0000ff">return</font> <font color="#2B91AF">Assembly</font> .Load(block); } } } <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li> <code><font color="black"><font color="#008000"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">public</font> <font color="#0000ff">partial</font> <font color="#0000ff">class</font> App : Application { //    <font color="#0000ff">private</font> <font color="#0000ff">void</font> OnStartup( <font color="#0000ff">object</font> sender, StartupEventArgs e) { <font color="#008000">//              </font> AppDomain.CurrentDomain.AssemblyResolve += ResolveAssembly; } <font color="#008000">//    </font> <font color="#0000ff">static</font> <font color="#2B91AF">Assembly</font> ResolveAssembly( <font color="#0000ff">object</font> sender, ResolveEventArgs args) { <font color="#008000">//    (    )</font> <font color="#2B91AF">Assembly</font> thisAssembly = <font color="#2B91AF">Assembly</font> .GetExecutingAssembly(); <font color="#008000">//  </font> <font color="#0000ff">var</font> name = args.Name.Substring(0, args.Name.IndexOf( <font color="#A31515">','</font> )) + <font color="#A31515">".dll"</font> ; <font color="#008000">//   </font> <font color="#0000ff">var</font> resourceName = thisAssembly.GetManifestResourceNames().First(s =&gt; s.EndsWith(name)); <font color="#0000ff">using</font> ( <font color="#2B91AF">Stream</font> stream = thisAssembly.GetManifestResourceStream(resourceName)) { <font color="#008000">//    </font> <font color="#0000ff">byte</font> [] block = <font color="#0000ff">new</font> <font color="#0000ff">byte</font> [stream.Length]; stream.Read(block, 0, block.Length); <font color="#008000">//           </font> <font color="#0000ff">return</font> <font color="#2B91AF">Assembly</font> .Load(block); } } } <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></font></code> </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">public</font> <font color="#0000ff">partial</font> <font color="#0000ff">class</font> App : Application { <font color="#008000">//   </font> <font color="#0000ff">private</font> <font color="#0000ff">void</font> OnStartup( <font color="#0000ff">object</font> sender, StartupEventArgs e) { <font color="#008000">//              </font> AppDomain.CurrentDomain.AssemblyResolve += ResolveAssembly; } <font color="#008000">//    </font> <font color="#0000ff">static</font> <font color="#2B91AF">Assembly</font> ResolveAssembly( <font color="#0000ff">object</font> sender, ResolveEventArgs args) { <font color="#008000">//    (    )</font> <font color="#2B91AF">Assembly</font> thisAssembly = <font color="#2B91AF">Assembly</font> .GetExecutingAssembly(); <font color="#008000">//  </font> <font color="#0000ff">var</font> name = args.Name.Substring(0, args.Name.IndexOf( <font color="#A31515">','</font> )) + <font color="#A31515">".dll"</font> ; <font color="#008000">//   </font> <font color="#0000ff">var</font> resourceName = thisAssembly.GetManifestResourceNames().First(s =&gt; s.EndsWith(name)); <font color="#0000ff">using</font> ( <font color="#2B91AF">Stream</font> stream = thisAssembly.GetManifestResourceStream(resourceName)) { <font color="#008000">//    </font> <font color="#0000ff">byte</font> [] block = <font color="#0000ff">new</font> <font color="#0000ff">byte</font> [stream.Length]; stream.Read(block, 0, block.Length); <font color="#008000">//           </font> <font color="#0000ff">return</font> <font color="#2B91AF">Assembly</font> .Load(block); } } } <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">public</font> <font color="#0000ff">partial</font> <font color="#0000ff">class</font> App : Application { <font color="#008000">//   </font> <font color="#0000ff">private</font> <font color="#0000ff">void</font> OnStartup( <font color="#0000ff">object</font> sender, StartupEventArgs e) { <font color="#008000">//              </font> AppDomain.CurrentDomain.AssemblyResolve += ResolveAssembly; } <font color="#008000">//    </font> <font color="#0000ff">static</font> <font color="#2B91AF">Assembly</font> ResolveAssembly( <font color="#0000ff">object</font> sender, ResolveEventArgs args) { <font color="#008000">//    (    )</font> <font color="#2B91AF">Assembly</font> thisAssembly = <font color="#2B91AF">Assembly</font> .GetExecutingAssembly(); <font color="#008000">//  </font> <font color="#0000ff">var</font> name = args.Name.Substring(0, args.Name.IndexOf( <font color="#A31515">','</font> )) + <font color="#A31515">".dll"</font> ; <font color="#008000">//   </font> <font color="#0000ff">var</font> resourceName = thisAssembly.GetManifestResourceNames().First(s =&gt; s.EndsWith(name)); <font color="#0000ff">using</font> ( <font color="#2B91AF">Stream</font> stream = thisAssembly.GetManifestResourceStream(resourceName)) { <font color="#008000">//    </font> <font color="#0000ff">byte</font> [] block = <font color="#0000ff">new</font> <font color="#0000ff">byte</font> [stream.Length]; stream.Read(block, 0, block.Length); <font color="#008000">//           </font> <font color="#0000ff">return</font> <font color="#2B91AF">Assembly</font> .Load(block); } } } <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li> <code><font color="black"><font color="#008000"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">public</font> <font color="#0000ff">partial</font> <font color="#0000ff">class</font> App : Application { <font color="#008000">//   </font> <font color="#0000ff">private</font> <font color="#0000ff">void</font> OnStartup( <font color="#0000ff">object</font> sender, StartupEventArgs e) { //               AppDomain.CurrentDomain.AssemblyResolve += ResolveAssembly; } <font color="#008000">//    </font> <font color="#0000ff">static</font> <font color="#2B91AF">Assembly</font> ResolveAssembly( <font color="#0000ff">object</font> sender, ResolveEventArgs args) { <font color="#008000">//    (    )</font> <font color="#2B91AF">Assembly</font> thisAssembly = <font color="#2B91AF">Assembly</font> .GetExecutingAssembly(); <font color="#008000">//  </font> <font color="#0000ff">var</font> name = args.Name.Substring(0, args.Name.IndexOf( <font color="#A31515">','</font> )) + <font color="#A31515">".dll"</font> ; <font color="#008000">//   </font> <font color="#0000ff">var</font> resourceName = thisAssembly.GetManifestResourceNames().First(s =&gt; s.EndsWith(name)); <font color="#0000ff">using</font> ( <font color="#2B91AF">Stream</font> stream = thisAssembly.GetManifestResourceStream(resourceName)) { <font color="#008000">//    </font> <font color="#0000ff">byte</font> [] block = <font color="#0000ff">new</font> <font color="#0000ff">byte</font> [stream.Length]; stream.Read(block, 0, block.Length); <font color="#008000">//           </font> <font color="#0000ff">return</font> <font color="#2B91AF">Assembly</font> .Load(block); } } } <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></font></code> </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">public</font> <font color="#0000ff">partial</font> <font color="#0000ff">class</font> App : Application { <font color="#008000">//   </font> <font color="#0000ff">private</font> <font color="#0000ff">void</font> OnStartup( <font color="#0000ff">object</font> sender, StartupEventArgs e) { <font color="#008000">//              </font> AppDomain.CurrentDomain.AssemblyResolve += ResolveAssembly; } <font color="#008000">//    </font> <font color="#0000ff">static</font> <font color="#2B91AF">Assembly</font> ResolveAssembly( <font color="#0000ff">object</font> sender, ResolveEventArgs args) { <font color="#008000">//    (    )</font> <font color="#2B91AF">Assembly</font> thisAssembly = <font color="#2B91AF">Assembly</font> .GetExecutingAssembly(); <font color="#008000">//  </font> <font color="#0000ff">var</font> name = args.Name.Substring(0, args.Name.IndexOf( <font color="#A31515">','</font> )) + <font color="#A31515">".dll"</font> ; <font color="#008000">//   </font> <font color="#0000ff">var</font> resourceName = thisAssembly.GetManifestResourceNames().First(s =&gt; s.EndsWith(name)); <font color="#0000ff">using</font> ( <font color="#2B91AF">Stream</font> stream = thisAssembly.GetManifestResourceStream(resourceName)) { <font color="#008000">//    </font> <font color="#0000ff">byte</font> [] block = <font color="#0000ff">new</font> <font color="#0000ff">byte</font> [stream.Length]; stream.Read(block, 0, block.Length); <font color="#008000">//           </font> <font color="#0000ff">return</font> <font color="#2B91AF">Assembly</font> .Load(block); } } } <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">public</font> <font color="#0000ff">partial</font> <font color="#0000ff">class</font> App : Application { <font color="#008000">//   </font> <font color="#0000ff">private</font> <font color="#0000ff">void</font> OnStartup( <font color="#0000ff">object</font> sender, StartupEventArgs e) { <font color="#008000">//              </font> AppDomain.CurrentDomain.AssemblyResolve += ResolveAssembly; } <font color="#008000">//    </font> <font color="#0000ff">static</font> <font color="#2B91AF">Assembly</font> ResolveAssembly( <font color="#0000ff">object</font> sender, ResolveEventArgs args) { <font color="#008000">//    (    )</font> <font color="#2B91AF">Assembly</font> thisAssembly = <font color="#2B91AF">Assembly</font> .GetExecutingAssembly(); <font color="#008000">//  </font> <font color="#0000ff">var</font> name = args.Name.Substring(0, args.Name.IndexOf( <font color="#A31515">','</font> )) + <font color="#A31515">".dll"</font> ; <font color="#008000">//   </font> <font color="#0000ff">var</font> resourceName = thisAssembly.GetManifestResourceNames().First(s =&gt; s.EndsWith(name)); <font color="#0000ff">using</font> ( <font color="#2B91AF">Stream</font> stream = thisAssembly.GetManifestResourceStream(resourceName)) { <font color="#008000">//    </font> <font color="#0000ff">byte</font> [] block = <font color="#0000ff">new</font> <font color="#0000ff">byte</font> [stream.Length]; stream.Read(block, 0, block.Length); <font color="#008000">//           </font> <font color="#0000ff">return</font> <font color="#2B91AF">Assembly</font> .Load(block); } } } <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li></li><li> <code><font color="black"><font color="#008000"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">public</font> <font color="#0000ff">partial</font> <font color="#0000ff">class</font> App : Application { <font color="#008000">//   </font> <font color="#0000ff">private</font> <font color="#0000ff">void</font> OnStartup( <font color="#0000ff">object</font> sender, StartupEventArgs e) { <font color="#008000">//              </font> AppDomain.CurrentDomain.AssemblyResolve += ResolveAssembly; } //     <font color="#0000ff">static</font> <font color="#2B91AF">Assembly</font> ResolveAssembly( <font color="#0000ff">object</font> sender, ResolveEventArgs args) { <font color="#008000">//    (    )</font> <font color="#2B91AF">Assembly</font> thisAssembly = <font color="#2B91AF">Assembly</font> .GetExecutingAssembly(); <font color="#008000">//  </font> <font color="#0000ff">var</font> name = args.Name.Substring(0, args.Name.IndexOf( <font color="#A31515">','</font> )) + <font color="#A31515">".dll"</font> ; <font color="#008000">//   </font> <font color="#0000ff">var</font> resourceName = thisAssembly.GetManifestResourceNames().First(s =&gt; s.EndsWith(name)); <font color="#0000ff">using</font> ( <font color="#2B91AF">Stream</font> stream = thisAssembly.GetManifestResourceStream(resourceName)) { <font color="#008000">//    </font> <font color="#0000ff">byte</font> [] block = <font color="#0000ff">new</font> <font color="#0000ff">byte</font> [stream.Length]; stream.Read(block, 0, block.Length); <font color="#008000">//           </font> <font color="#0000ff">return</font> <font color="#2B91AF">Assembly</font> .Load(block); } } } <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></font></code> </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">public</font> <font color="#0000ff">partial</font> <font color="#0000ff">class</font> App : Application { <font color="#008000">//   </font> <font color="#0000ff">private</font> <font color="#0000ff">void</font> OnStartup( <font color="#0000ff">object</font> sender, StartupEventArgs e) { <font color="#008000">//              </font> AppDomain.CurrentDomain.AssemblyResolve += ResolveAssembly; } <font color="#008000">//    </font> <font color="#0000ff">static</font> <font color="#2B91AF">Assembly</font> ResolveAssembly( <font color="#0000ff">object</font> sender, ResolveEventArgs args) { <font color="#008000">//    (    )</font> <font color="#2B91AF">Assembly</font> thisAssembly = <font color="#2B91AF">Assembly</font> .GetExecutingAssembly(); <font color="#008000">//  </font> <font color="#0000ff">var</font> name = args.Name.Substring(0, args.Name.IndexOf( <font color="#A31515">','</font> )) + <font color="#A31515">".dll"</font> ; <font color="#008000">//   </font> <font color="#0000ff">var</font> resourceName = thisAssembly.GetManifestResourceNames().First(s =&gt; s.EndsWith(name)); <font color="#0000ff">using</font> ( <font color="#2B91AF">Stream</font> stream = thisAssembly.GetManifestResourceStream(resourceName)) { <font color="#008000">//    </font> <font color="#0000ff">byte</font> [] block = <font color="#0000ff">new</font> <font color="#0000ff">byte</font> [stream.Length]; stream.Read(block, 0, block.Length); <font color="#008000">//           </font> <font color="#0000ff">return</font> <font color="#2B91AF">Assembly</font> .Load(block); } } } <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">public</font> <font color="#0000ff">partial</font> <font color="#0000ff">class</font> App : Application { <font color="#008000">//   </font> <font color="#0000ff">private</font> <font color="#0000ff">void</font> OnStartup( <font color="#0000ff">object</font> sender, StartupEventArgs e) { <font color="#008000">//              </font> AppDomain.CurrentDomain.AssemblyResolve += ResolveAssembly; } <font color="#008000">//    </font> <font color="#0000ff">static</font> <font color="#2B91AF">Assembly</font> ResolveAssembly( <font color="#0000ff">object</font> sender, ResolveEventArgs args) { <font color="#008000">//    (    )</font> <font color="#2B91AF">Assembly</font> thisAssembly = <font color="#2B91AF">Assembly</font> .GetExecutingAssembly(); <font color="#008000">//  </font> <font color="#0000ff">var</font> name = args.Name.Substring(0, args.Name.IndexOf( <font color="#A31515">','</font> )) + <font color="#A31515">".dll"</font> ; <font color="#008000">//   </font> <font color="#0000ff">var</font> resourceName = thisAssembly.GetManifestResourceNames().First(s =&gt; s.EndsWith(name)); <font color="#0000ff">using</font> ( <font color="#2B91AF">Stream</font> stream = thisAssembly.GetManifestResourceStream(resourceName)) { <font color="#008000">//    </font> <font color="#0000ff">byte</font> [] block = <font color="#0000ff">new</font> <font color="#0000ff">byte</font> [stream.Length]; stream.Read(block, 0, block.Length); <font color="#008000">//           </font> <font color="#0000ff">return</font> <font color="#2B91AF">Assembly</font> .Load(block); } } } <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li> <code><font color="black"><font color="#008000"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">public</font> <font color="#0000ff">partial</font> <font color="#0000ff">class</font> App : Application { <font color="#008000">//   </font> <font color="#0000ff">private</font> <font color="#0000ff">void</font> OnStartup( <font color="#0000ff">object</font> sender, StartupEventArgs e) { <font color="#008000">//              </font> AppDomain.CurrentDomain.AssemblyResolve += ResolveAssembly; } <font color="#008000">//    </font> <font color="#0000ff">static</font> <font color="#2B91AF">Assembly</font> ResolveAssembly( <font color="#0000ff">object</font> sender, ResolveEventArgs args) { //    (    ) <font color="#2B91AF">Assembly</font> thisAssembly = <font color="#2B91AF">Assembly</font> .GetExecutingAssembly(); <font color="#008000">//  </font> <font color="#0000ff">var</font> name = args.Name.Substring(0, args.Name.IndexOf( <font color="#A31515">','</font> )) + <font color="#A31515">".dll"</font> ; <font color="#008000">//   </font> <font color="#0000ff">var</font> resourceName = thisAssembly.GetManifestResourceNames().First(s =&gt; s.EndsWith(name)); <font color="#0000ff">using</font> ( <font color="#2B91AF">Stream</font> stream = thisAssembly.GetManifestResourceStream(resourceName)) { <font color="#008000">//    </font> <font color="#0000ff">byte</font> [] block = <font color="#0000ff">new</font> <font color="#0000ff">byte</font> [stream.Length]; stream.Read(block, 0, block.Length); <font color="#008000">//           </font> <font color="#0000ff">return</font> <font color="#2B91AF">Assembly</font> .Load(block); } } } <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></font></code> </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">public</font> <font color="#0000ff">partial</font> <font color="#0000ff">class</font> App : Application { <font color="#008000">//   </font> <font color="#0000ff">private</font> <font color="#0000ff">void</font> OnStartup( <font color="#0000ff">object</font> sender, StartupEventArgs e) { <font color="#008000">//              </font> AppDomain.CurrentDomain.AssemblyResolve += ResolveAssembly; } <font color="#008000">//    </font> <font color="#0000ff">static</font> <font color="#2B91AF">Assembly</font> ResolveAssembly( <font color="#0000ff">object</font> sender, ResolveEventArgs args) { <font color="#008000">//    (    )</font> <font color="#2B91AF">Assembly</font> thisAssembly = <font color="#2B91AF">Assembly</font> .GetExecutingAssembly(); <font color="#008000">//  </font> <font color="#0000ff">var</font> name = args.Name.Substring(0, args.Name.IndexOf( <font color="#A31515">','</font> )) + <font color="#A31515">".dll"</font> ; <font color="#008000">//   </font> <font color="#0000ff">var</font> resourceName = thisAssembly.GetManifestResourceNames().First(s =&gt; s.EndsWith(name)); <font color="#0000ff">using</font> ( <font color="#2B91AF">Stream</font> stream = thisAssembly.GetManifestResourceStream(resourceName)) { <font color="#008000">//    </font> <font color="#0000ff">byte</font> [] block = <font color="#0000ff">new</font> <font color="#0000ff">byte</font> [stream.Length]; stream.Read(block, 0, block.Length); <font color="#008000">//           </font> <font color="#0000ff">return</font> <font color="#2B91AF">Assembly</font> .Load(block); } } } <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li> <code><font color="black"><font color="#008000"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">public</font> <font color="#0000ff">partial</font> <font color="#0000ff">class</font> App : Application { <font color="#008000">//   </font> <font color="#0000ff">private</font> <font color="#0000ff">void</font> OnStartup( <font color="#0000ff">object</font> sender, StartupEventArgs e) { <font color="#008000">//              </font> AppDomain.CurrentDomain.AssemblyResolve += ResolveAssembly; } <font color="#008000">//    </font> <font color="#0000ff">static</font> <font color="#2B91AF">Assembly</font> ResolveAssembly( <font color="#0000ff">object</font> sender, ResolveEventArgs args) { <font color="#008000">//    (    )</font> <font color="#2B91AF">Assembly</font> thisAssembly = <font color="#2B91AF">Assembly</font> .GetExecutingAssembly(); //   <font color="#0000ff">var</font> name = args.Name.Substring(0, args.Name.IndexOf( <font color="#A31515">','</font> )) + <font color="#A31515">".dll"</font> ; <font color="#008000">//   </font> <font color="#0000ff">var</font> resourceName = thisAssembly.GetManifestResourceNames().First(s =&gt; s.EndsWith(name)); <font color="#0000ff">using</font> ( <font color="#2B91AF">Stream</font> stream = thisAssembly.GetManifestResourceStream(resourceName)) { <font color="#008000">//    </font> <font color="#0000ff">byte</font> [] block = <font color="#0000ff">new</font> <font color="#0000ff">byte</font> [stream.Length]; stream.Read(block, 0, block.Length); <font color="#008000">//           </font> <font color="#0000ff">return</font> <font color="#2B91AF">Assembly</font> .Load(block); } } } <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></font></code> </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">public</font> <font color="#0000ff">partial</font> <font color="#0000ff">class</font> App : Application { <font color="#008000">//   </font> <font color="#0000ff">private</font> <font color="#0000ff">void</font> OnStartup( <font color="#0000ff">object</font> sender, StartupEventArgs e) { <font color="#008000">//              </font> AppDomain.CurrentDomain.AssemblyResolve += ResolveAssembly; } <font color="#008000">//    </font> <font color="#0000ff">static</font> <font color="#2B91AF">Assembly</font> ResolveAssembly( <font color="#0000ff">object</font> sender, ResolveEventArgs args) { <font color="#008000">//    (    )</font> <font color="#2B91AF">Assembly</font> thisAssembly = <font color="#2B91AF">Assembly</font> .GetExecutingAssembly(); <font color="#008000">//  </font> <font color="#0000ff">var</font> name = args.Name.Substring(0, args.Name.IndexOf( <font color="#A31515">','</font> )) + <font color="#A31515">".dll"</font> ; <font color="#008000">//   </font> <font color="#0000ff">var</font> resourceName = thisAssembly.GetManifestResourceNames().First(s =&gt; s.EndsWith(name)); <font color="#0000ff">using</font> ( <font color="#2B91AF">Stream</font> stream = thisAssembly.GetManifestResourceStream(resourceName)) { <font color="#008000">//    </font> <font color="#0000ff">byte</font> [] block = <font color="#0000ff">new</font> <font color="#0000ff">byte</font> [stream.Length]; stream.Read(block, 0, block.Length); <font color="#008000">//           </font> <font color="#0000ff">return</font> <font color="#2B91AF">Assembly</font> .Load(block); } } } <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li> <code><font color="black"><font color="#008000"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">public</font> <font color="#0000ff">partial</font> <font color="#0000ff">class</font> App : Application { <font color="#008000">//   </font> <font color="#0000ff">private</font> <font color="#0000ff">void</font> OnStartup( <font color="#0000ff">object</font> sender, StartupEventArgs e) { <font color="#008000">//              </font> AppDomain.CurrentDomain.AssemblyResolve += ResolveAssembly; } <font color="#008000">//    </font> <font color="#0000ff">static</font> <font color="#2B91AF">Assembly</font> ResolveAssembly( <font color="#0000ff">object</font> sender, ResolveEventArgs args) { <font color="#008000">//    (    )</font> <font color="#2B91AF">Assembly</font> thisAssembly = <font color="#2B91AF">Assembly</font> .GetExecutingAssembly(); <font color="#008000">//  </font> <font color="#0000ff">var</font> name = args.Name.Substring(0, args.Name.IndexOf( <font color="#A31515">','</font> )) + <font color="#A31515">".dll"</font> ; //    <font color="#0000ff">var</font> resourceName = thisAssembly.GetManifestResourceNames().First(s =&gt; s.EndsWith(name)); <font color="#0000ff">using</font> ( <font color="#2B91AF">Stream</font> stream = thisAssembly.GetManifestResourceStream(resourceName)) { <font color="#008000">//    </font> <font color="#0000ff">byte</font> [] block = <font color="#0000ff">new</font> <font color="#0000ff">byte</font> [stream.Length]; stream.Read(block, 0, block.Length); <font color="#008000">//           </font> <font color="#0000ff">return</font> <font color="#2B91AF">Assembly</font> .Load(block); } } } <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></font></code> </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">public</font> <font color="#0000ff">partial</font> <font color="#0000ff">class</font> App : Application { <font color="#008000">//   </font> <font color="#0000ff">private</font> <font color="#0000ff">void</font> OnStartup( <font color="#0000ff">object</font> sender, StartupEventArgs e) { <font color="#008000">//              </font> AppDomain.CurrentDomain.AssemblyResolve += ResolveAssembly; } <font color="#008000">//    </font> <font color="#0000ff">static</font> <font color="#2B91AF">Assembly</font> ResolveAssembly( <font color="#0000ff">object</font> sender, ResolveEventArgs args) { <font color="#008000">//    (    )</font> <font color="#2B91AF">Assembly</font> thisAssembly = <font color="#2B91AF">Assembly</font> .GetExecutingAssembly(); <font color="#008000">//  </font> <font color="#0000ff">var</font> name = args.Name.Substring(0, args.Name.IndexOf( <font color="#A31515">','</font> )) + <font color="#A31515">".dll"</font> ; <font color="#008000">//   </font> <font color="#0000ff">var</font> resourceName = thisAssembly.GetManifestResourceNames().First(s =&gt; s.EndsWith(name)); <font color="#0000ff">using</font> ( <font color="#2B91AF">Stream</font> stream = thisAssembly.GetManifestResourceStream(resourceName)) { <font color="#008000">//    </font> <font color="#0000ff">byte</font> [] block = <font color="#0000ff">new</font> <font color="#0000ff">byte</font> [stream.Length]; stream.Read(block, 0, block.Length); <font color="#008000">//           </font> <font color="#0000ff">return</font> <font color="#2B91AF">Assembly</font> .Load(block); } } } <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li></li><li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">public</font> <font color="#0000ff">partial</font> <font color="#0000ff">class</font> App : Application { <font color="#008000">//   </font> <font color="#0000ff">private</font> <font color="#0000ff">void</font> OnStartup( <font color="#0000ff">object</font> sender, StartupEventArgs e) { <font color="#008000">//              </font> AppDomain.CurrentDomain.AssemblyResolve += ResolveAssembly; } <font color="#008000">//    </font> <font color="#0000ff">static</font> <font color="#2B91AF">Assembly</font> ResolveAssembly( <font color="#0000ff">object</font> sender, ResolveEventArgs args) { <font color="#008000">//    (    )</font> <font color="#2B91AF">Assembly</font> thisAssembly = <font color="#2B91AF">Assembly</font> .GetExecutingAssembly(); <font color="#008000">//  </font> <font color="#0000ff">var</font> name = args.Name.Substring(0, args.Name.IndexOf( <font color="#A31515">','</font> )) + <font color="#A31515">".dll"</font> ; <font color="#008000">//   </font> <font color="#0000ff">var</font> resourceName = thisAssembly.GetManifestResourceNames().First(s =&gt; s.EndsWith(name)); <font color="#0000ff">using</font> ( <font color="#2B91AF">Stream</font> stream = thisAssembly.GetManifestResourceStream(resourceName)) { <font color="#008000">//    </font> <font color="#0000ff">byte</font> [] block = <font color="#0000ff">new</font> <font color="#0000ff">byte</font> [stream.Length]; stream.Read(block, 0, block.Length); <font color="#008000">//           </font> <font color="#0000ff">return</font> <font color="#2B91AF">Assembly</font> .Load(block); } } } <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">public</font> <font color="#0000ff">partial</font> <font color="#0000ff">class</font> App : Application { <font color="#008000">//   </font> <font color="#0000ff">private</font> <font color="#0000ff">void</font> OnStartup( <font color="#0000ff">object</font> sender, StartupEventArgs e) { <font color="#008000">//              </font> AppDomain.CurrentDomain.AssemblyResolve += ResolveAssembly; } <font color="#008000">//    </font> <font color="#0000ff">static</font> <font color="#2B91AF">Assembly</font> ResolveAssembly( <font color="#0000ff">object</font> sender, ResolveEventArgs args) { <font color="#008000">//    (    )</font> <font color="#2B91AF">Assembly</font> thisAssembly = <font color="#2B91AF">Assembly</font> .GetExecutingAssembly(); <font color="#008000">//  </font> <font color="#0000ff">var</font> name = args.Name.Substring(0, args.Name.IndexOf( <font color="#A31515">','</font> )) + <font color="#A31515">".dll"</font> ; <font color="#008000">//   </font> <font color="#0000ff">var</font> resourceName = thisAssembly.GetManifestResourceNames().First(s =&gt; s.EndsWith(name)); <font color="#0000ff">using</font> ( <font color="#2B91AF">Stream</font> stream = thisAssembly.GetManifestResourceStream(resourceName)) { <font color="#008000">//    </font> <font color="#0000ff">byte</font> [] block = <font color="#0000ff">new</font> <font color="#0000ff">byte</font> [stream.Length]; stream.Read(block, 0, block.Length); <font color="#008000">//           </font> <font color="#0000ff">return</font> <font color="#2B91AF">Assembly</font> .Load(block); } } } <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li> <code><font color="black"><font color="#008000"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">public</font> <font color="#0000ff">partial</font> <font color="#0000ff">class</font> App : Application { <font color="#008000">//   </font> <font color="#0000ff">private</font> <font color="#0000ff">void</font> OnStartup( <font color="#0000ff">object</font> sender, StartupEventArgs e) { <font color="#008000">//              </font> AppDomain.CurrentDomain.AssemblyResolve += ResolveAssembly; } <font color="#008000">//    </font> <font color="#0000ff">static</font> <font color="#2B91AF">Assembly</font> ResolveAssembly( <font color="#0000ff">object</font> sender, ResolveEventArgs args) { <font color="#008000">//    (    )</font> <font color="#2B91AF">Assembly</font> thisAssembly = <font color="#2B91AF">Assembly</font> .GetExecutingAssembly(); <font color="#008000">//  </font> <font color="#0000ff">var</font> name = args.Name.Substring(0, args.Name.IndexOf( <font color="#A31515">','</font> )) + <font color="#A31515">".dll"</font> ; <font color="#008000">//   </font> <font color="#0000ff">var</font> resourceName = thisAssembly.GetManifestResourceNames().First(s =&gt; s.EndsWith(name)); <font color="#0000ff">using</font> ( <font color="#2B91AF">Stream</font> stream = thisAssembly.GetManifestResourceStream(resourceName)) { //     <font color="#0000ff">byte</font> [] block = <font color="#0000ff">new</font> <font color="#0000ff">byte</font> [stream.Length]; stream.Read(block, 0, block.Length); <font color="#008000">//           </font> <font color="#0000ff">return</font> <font color="#2B91AF">Assembly</font> .Load(block); } } } <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></font></code> </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">public</font> <font color="#0000ff">partial</font> <font color="#0000ff">class</font> App : Application { <font color="#008000">//   </font> <font color="#0000ff">private</font> <font color="#0000ff">void</font> OnStartup( <font color="#0000ff">object</font> sender, StartupEventArgs e) { <font color="#008000">//              </font> AppDomain.CurrentDomain.AssemblyResolve += ResolveAssembly; } <font color="#008000">//    </font> <font color="#0000ff">static</font> <font color="#2B91AF">Assembly</font> ResolveAssembly( <font color="#0000ff">object</font> sender, ResolveEventArgs args) { <font color="#008000">//    (    )</font> <font color="#2B91AF">Assembly</font> thisAssembly = <font color="#2B91AF">Assembly</font> .GetExecutingAssembly(); <font color="#008000">//  </font> <font color="#0000ff">var</font> name = args.Name.Substring(0, args.Name.IndexOf( <font color="#A31515">','</font> )) + <font color="#A31515">".dll"</font> ; <font color="#008000">//   </font> <font color="#0000ff">var</font> resourceName = thisAssembly.GetManifestResourceNames().First(s =&gt; s.EndsWith(name)); <font color="#0000ff">using</font> ( <font color="#2B91AF">Stream</font> stream = thisAssembly.GetManifestResourceStream(resourceName)) { <font color="#008000">//    </font> <font color="#0000ff">byte</font> [] block = <font color="#0000ff">new</font> <font color="#0000ff">byte</font> [stream.Length]; stream.Read(block, 0, block.Length); <font color="#008000">//           </font> <font color="#0000ff">return</font> <font color="#2B91AF">Assembly</font> .Load(block); } } } <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">public</font> <font color="#0000ff">partial</font> <font color="#0000ff">class</font> App : Application { <font color="#008000">//   </font> <font color="#0000ff">private</font> <font color="#0000ff">void</font> OnStartup( <font color="#0000ff">object</font> sender, StartupEventArgs e) { <font color="#008000">//              </font> AppDomain.CurrentDomain.AssemblyResolve += ResolveAssembly; } <font color="#008000">//    </font> <font color="#0000ff">static</font> <font color="#2B91AF">Assembly</font> ResolveAssembly( <font color="#0000ff">object</font> sender, ResolveEventArgs args) { <font color="#008000">//    (    )</font> <font color="#2B91AF">Assembly</font> thisAssembly = <font color="#2B91AF">Assembly</font> .GetExecutingAssembly(); <font color="#008000">//  </font> <font color="#0000ff">var</font> name = args.Name.Substring(0, args.Name.IndexOf( <font color="#A31515">','</font> )) + <font color="#A31515">".dll"</font> ; <font color="#008000">//   </font> <font color="#0000ff">var</font> resourceName = thisAssembly.GetManifestResourceNames().First(s =&gt; s.EndsWith(name)); <font color="#0000ff">using</font> ( <font color="#2B91AF">Stream</font> stream = thisAssembly.GetManifestResourceStream(resourceName)) { <font color="#008000">//    </font> <font color="#0000ff">byte</font> [] block = <font color="#0000ff">new</font> <font color="#0000ff">byte</font> [stream.Length]; stream.Read(block, 0, block.Length); <font color="#008000">//           </font> <font color="#0000ff">return</font> <font color="#2B91AF">Assembly</font> .Load(block); } } } <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li> <code><font color="black"><font color="#008000"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">public</font> <font color="#0000ff">partial</font> <font color="#0000ff">class</font> App : Application { <font color="#008000">//   </font> <font color="#0000ff">private</font> <font color="#0000ff">void</font> OnStartup( <font color="#0000ff">object</font> sender, StartupEventArgs e) { <font color="#008000">//              </font> AppDomain.CurrentDomain.AssemblyResolve += ResolveAssembly; } <font color="#008000">//    </font> <font color="#0000ff">static</font> <font color="#2B91AF">Assembly</font> ResolveAssembly( <font color="#0000ff">object</font> sender, ResolveEventArgs args) { <font color="#008000">//    (    )</font> <font color="#2B91AF">Assembly</font> thisAssembly = <font color="#2B91AF">Assembly</font> .GetExecutingAssembly(); <font color="#008000">//  </font> <font color="#0000ff">var</font> name = args.Name.Substring(0, args.Name.IndexOf( <font color="#A31515">','</font> )) + <font color="#A31515">".dll"</font> ; <font color="#008000">//   </font> <font color="#0000ff">var</font> resourceName = thisAssembly.GetManifestResourceNames().First(s =&gt; s.EndsWith(name)); <font color="#0000ff">using</font> ( <font color="#2B91AF">Stream</font> stream = thisAssembly.GetManifestResourceStream(resourceName)) { <font color="#008000">//    </font> <font color="#0000ff">byte</font> [] block = <font color="#0000ff">new</font> <font color="#0000ff">byte</font> [stream.Length]; stream.Read(block, 0, block.Length); //            <font color="#0000ff">return</font> <font color="#2B91AF">Assembly</font> .Load(block); } } } <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></font></code> </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">public</font> <font color="#0000ff">partial</font> <font color="#0000ff">class</font> App : Application { <font color="#008000">//   </font> <font color="#0000ff">private</font> <font color="#0000ff">void</font> OnStartup( <font color="#0000ff">object</font> sender, StartupEventArgs e) { <font color="#008000">//              </font> AppDomain.CurrentDomain.AssemblyResolve += ResolveAssembly; } <font color="#008000">//    </font> <font color="#0000ff">static</font> <font color="#2B91AF">Assembly</font> ResolveAssembly( <font color="#0000ff">object</font> sender, ResolveEventArgs args) { <font color="#008000">//    (    )</font> <font color="#2B91AF">Assembly</font> thisAssembly = <font color="#2B91AF">Assembly</font> .GetExecutingAssembly(); <font color="#008000">//  </font> <font color="#0000ff">var</font> name = args.Name.Substring(0, args.Name.IndexOf( <font color="#A31515">','</font> )) + <font color="#A31515">".dll"</font> ; <font color="#008000">//   </font> <font color="#0000ff">var</font> resourceName = thisAssembly.GetManifestResourceNames().First(s =&gt; s.EndsWith(name)); <font color="#0000ff">using</font> ( <font color="#2B91AF">Stream</font> stream = thisAssembly.GetManifestResourceStream(resourceName)) { <font color="#008000">//    </font> <font color="#0000ff">byte</font> [] block = <font color="#0000ff">new</font> <font color="#0000ff">byte</font> [stream.Length]; stream.Read(block, 0, block.Length); <font color="#008000">//           </font> <font color="#0000ff">return</font> <font color="#2B91AF">Assembly</font> .Load(block); } } } <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">public</font> <font color="#0000ff">partial</font> <font color="#0000ff">class</font> App : Application { <font color="#008000">//   </font> <font color="#0000ff">private</font> <font color="#0000ff">void</font> OnStartup( <font color="#0000ff">object</font> sender, StartupEventArgs e) { <font color="#008000">//              </font> AppDomain.CurrentDomain.AssemblyResolve += ResolveAssembly; } <font color="#008000">//    </font> <font color="#0000ff">static</font> <font color="#2B91AF">Assembly</font> ResolveAssembly( <font color="#0000ff">object</font> sender, ResolveEventArgs args) { <font color="#008000">//    (    )</font> <font color="#2B91AF">Assembly</font> thisAssembly = <font color="#2B91AF">Assembly</font> .GetExecutingAssembly(); <font color="#008000">//  </font> <font color="#0000ff">var</font> name = args.Name.Substring(0, args.Name.IndexOf( <font color="#A31515">','</font> )) + <font color="#A31515">".dll"</font> ; <font color="#008000">//   </font> <font color="#0000ff">var</font> resourceName = thisAssembly.GetManifestResourceNames().First(s =&gt; s.EndsWith(name)); <font color="#0000ff">using</font> ( <font color="#2B91AF">Stream</font> stream = thisAssembly.GetManifestResourceStream(resourceName)) { <font color="#008000">//    </font> <font color="#0000ff">byte</font> [] block = <font color="#0000ff">new</font> <font color="#0000ff">byte</font> [stream.Length]; stream.Read(block, 0, block.Length); <font color="#008000">//           </font> <font color="#0000ff">return</font> <font color="#2B91AF">Assembly</font> .Load(block); } } } <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">public</font> <font color="#0000ff">partial</font> <font color="#0000ff">class</font> App : Application { <font color="#008000">//   </font> <font color="#0000ff">private</font> <font color="#0000ff">void</font> OnStartup( <font color="#0000ff">object</font> sender, StartupEventArgs e) { <font color="#008000">//              </font> AppDomain.CurrentDomain.AssemblyResolve += ResolveAssembly; } <font color="#008000">//    </font> <font color="#0000ff">static</font> <font color="#2B91AF">Assembly</font> ResolveAssembly( <font color="#0000ff">object</font> sender, ResolveEventArgs args) { <font color="#008000">//    (    )</font> <font color="#2B91AF">Assembly</font> thisAssembly = <font color="#2B91AF">Assembly</font> .GetExecutingAssembly(); <font color="#008000">//  </font> <font color="#0000ff">var</font> name = args.Name.Substring(0, args.Name.IndexOf( <font color="#A31515">','</font> )) + <font color="#A31515">".dll"</font> ; <font color="#008000">//   </font> <font color="#0000ff">var</font> resourceName = thisAssembly.GetManifestResourceNames().First(s =&gt; s.EndsWith(name)); <font color="#0000ff">using</font> ( <font color="#2B91AF">Stream</font> stream = thisAssembly.GetManifestResourceStream(resourceName)) { <font color="#008000">//    </font> <font color="#0000ff">byte</font> [] block = <font color="#0000ff">new</font> <font color="#0000ff">byte</font> [stream.Length]; stream.Read(block, 0, block.Length); <font color="#008000">//           </font> <font color="#0000ff">return</font> <font color="#2B91AF">Assembly</font> .Load(block); } } } <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">public</font> <font color="#0000ff">partial</font> <font color="#0000ff">class</font> App : Application { <font color="#008000">//   </font> <font color="#0000ff">private</font> <font color="#0000ff">void</font> OnStartup( <font color="#0000ff">object</font> sender, StartupEventArgs e) { <font color="#008000">//              </font> AppDomain.CurrentDomain.AssemblyResolve += ResolveAssembly; } <font color="#008000">//    </font> <font color="#0000ff">static</font> <font color="#2B91AF">Assembly</font> ResolveAssembly( <font color="#0000ff">object</font> sender, ResolveEventArgs args) { <font color="#008000">//    (    )</font> <font color="#2B91AF">Assembly</font> thisAssembly = <font color="#2B91AF">Assembly</font> .GetExecutingAssembly(); <font color="#008000">//  </font> <font color="#0000ff">var</font> name = args.Name.Substring(0, args.Name.IndexOf( <font color="#A31515">','</font> )) + <font color="#A31515">".dll"</font> ; <font color="#008000">//   </font> <font color="#0000ff">var</font> resourceName = thisAssembly.GetManifestResourceNames().First(s =&gt; s.EndsWith(name)); <font color="#0000ff">using</font> ( <font color="#2B91AF">Stream</font> stream = thisAssembly.GetManifestResourceStream(resourceName)) { <font color="#008000">//    </font> <font color="#0000ff">byte</font> [] block = <font color="#0000ff">new</font> <font color="#0000ff">byte</font> [stream.Length]; stream.Read(block, 0, block.Length); <font color="#008000">//           </font> <font color="#0000ff">return</font> <font color="#2B91AF">Assembly</font> .Load(block); } } } <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> </ol> <code><font color="gray"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black"><font color="#0000ff">public</font> <font color="#0000ff">partial</font> <font color="#0000ff">class</font> App : Application { <font color="#008000">//   </font> <font color="#0000ff">private</font> <font color="#0000ff">void</font> OnStartup( <font color="#0000ff">object</font> sender, StartupEventArgs e) { <font color="#008000">//              </font> AppDomain.CurrentDomain.AssemblyResolve += ResolveAssembly; } <font color="#008000">//    </font> <font color="#0000ff">static</font> <font color="#2B91AF">Assembly</font> ResolveAssembly( <font color="#0000ff">object</font> sender, ResolveEventArgs args) { <font color="#008000">//    (    )</font> <font color="#2B91AF">Assembly</font> thisAssembly = <font color="#2B91AF">Assembly</font> .GetExecutingAssembly(); <font color="#008000">//  </font> <font color="#0000ff">var</font> name = args.Name.Substring(0, args.Name.IndexOf( <font color="#A31515">','</font> )) + <font color="#A31515">".dll"</font> ; <font color="#008000">//   </font> <font color="#0000ff">var</font> resourceName = thisAssembly.GetManifestResourceNames().First(s =&gt; s.EndsWith(name)); <font color="#0000ff">using</font> ( <font color="#2B91AF">Stream</font> stream = thisAssembly.GetManifestResourceStream(resourceName)) { <font color="#008000">//    </font> <font color="#0000ff">byte</font> [] block = <font color="#0000ff">new</font> <font color="#0000ff">byte</font> [stream.Length]; stream.Read(block, 0, block.Length); <font color="#008000">//           </font> <font color="#0000ff">return</font> <font color="#2B91AF">Assembly</font> .Load(block); } } }</font> * This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote> 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Accordingly, with such an approach, we mean that we normally call assembly files. <br><br>  It is important to remember that with this method I just show the idea, there are no handlers for possible errors, or much more. <br><br>  What else can be improved - you can reduce the size of the output .exe file, keeping the assemblies compressed via the DeflateStream and reading them out respectively by unpacking through it.  You can periodically check to see if the build has been updated, and if it has been updated, to load it from the network (especially if this is something fine). <br><br>  And yes, the important point is that it most likely <b>will not</b> work - with such an assembly, assemblies with native methods will most likely not work, i.e.  written in C ++ / CLI.  Correct me if I'm wrong, but they didn't work for me. <br><br>  [update] <br>  About C ++ / CLI - according to MSDN - a BadImageFormatException exception is thrown if the C ++ compiler deletes the .reloc section from the .exe file.  If you compile an assembly on C ++ / CLI with / fixed: no, then maybe it will load successfully </div><p>Source: <a href="https://habr.com/ru/post/67836/">https://habr.com/ru/post/67836/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../67831/index.html">When Photoshop displays something completely different.</a></li>
<li><a href="../67832/index.html">Yii: device ActiveRecord and Sharding</a></li>
<li><a href="../67833/index.html">PHPConf and HiLoad ++ - are we going?</a></li>
<li><a href="../67834/index.html">Questions to Dmitry Grishin (Mail.ru)</a></li>
<li><a href="../67835/index.html">Offline lead tracking</a></li>
<li><a href="../67837/index.html">Nokia Booklet 3G</a></li>
<li><a href="../67838/index.html">Fast robots juggling phones</a></li>
<li><a href="../67839/index.html">Software Configuration Management // Configurations and baselines</a></li>
<li><a href="../67841/index.html">In Moscow and Chukotka the most expensive cellular communications</a></li>
<li><a href="../67844/index.html">A fascinating journey into the world of sports. Start</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>