<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Backup and encryption while protecting confidential information in the Russian Federation</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="The purpose of this article is to show how to properly back up encrypted folders so that the files in them remain encrypted. 



 Introduction 
 Imagi...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Backup and encryption while protecting confidential information in the Russian Federation</h1><div class="post__text post__text-html js-mediator-article">  The purpose of this article is to show how to properly back up encrypted folders so that the files in them remain encrypted. <br><br><img src="https://habrastorage.org/files/aa8/24e/be6/aa824ebe6328431caafd24ae51be4ed6.jpg"><br><a name="habracut"></a><br><h4>  Introduction </h4><br>  Imagine that we have a typical enterprise (Fig. 1).  As in many similar organizations, our organization uses the well-known 1C: Enterprise, the database of which is stored on the server shown in the illustration. <br><br><img src="https://habrastorage.org/files/6ea/44d/c4f/6ea44dc4f17845bb8e39f2edafb02ed2.jpg"><br>  Fig.  1. Scheme of a fictional enterprise 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Since the 1C: Enterprise database contains the confidential information being processed, it is necessary to protect it from unauthorized access.  For this, we decided to encrypt the 1C database. <br>  After encryption, the 1C database files on the server will be stored in an encrypted state.  Encryption will be implemented by means of the <a href="http://cybersafesoft.com/rus/products/topsecret/">CyberSafe Top Secret</a> program.  It is clear that once there is data, you need to back them up.  That's just the data we will have is not simple, but encrypted. <br>  Further in this article will be told: <br><ul><li>  How to organize transparent encryption of the network folder with the database 1C. </li><li>  How to properly back up encrypted data using Acronis Backup &amp; Recovery, so that they remain encrypted in the backup. </li><li>  Why is it impossible to use EFS to solve our problem? </li></ul><br><br><h4>  Letter of the law </h4><br>  The bundle of software we use (CyberSafe Top Secret and Acronis Backup &amp; Recovery programs) was chosen for a reason.  We implement the requirements of the legislation on the protection of confidential information (which includes personal data).  If you have ever been interested in the protection of personal data, then you are probably familiar with two main regulations: <br><ul><li>  Government Decree of 01.11.2012 N 1119 ‚ÄúOn the approval of requirements for the protection of personal data when they are processed in personal data information systems‚Äù. </li><li>  Order of the FSTEC of Russia of February 18, 2013 N 21. </li></ul><br>  We complied with the requirements of the legislation regarding the periodic backup of processed data, as well as their protection from unauthorized access. <br><br>  Backups are performed using Acronis Backup &amp; Recovery 11 Advanced Server software, which has FSTEC certificate No. 2677 dated July 16, 2012. <br><br>  Protection against unauthorized access is implemented through the use of CyberSafe Top Secret, which, together with the use of a certified CryptoPro CSP crypto-provider and a GOST algorithm for data encryption, is also considered to be a certified tool. <br><br>  By the way, whatever TrueCrypt fans say, it‚Äôs still impossible to use it to protect personal data, since it is not a certified encryption tool.  She has no FSTEC certificate and will never have it.  As for EFS, it is considered certified only in a special version of Windows, which has a certificate of FSTEC. <br><br>  If we go beyond the scope of TrueCrypt, then not only this program, but any other program that uses cryptodisks, will not be suitable for solving our task.  Even if this program is certified.  Earlier we wrote about the <a href="http://habrahabr.ru/company/cybersafe/blog/208824/">vulnerabilities of cryptodisks</a> and if the task is solved through cryptodisks, then the cryptodisk should be protected by means of an operating system (network authentication) that is not certified (or do you have a certified version of Windows?).  In addition, data from the cryptodisk over the network are transmitted in unencrypted form.  To encrypt the data transmitted between the client and the server on which the cryptodisk is ‚Äúshared‚Äù, you need to configure a VPN (of course, you need to use a certified solution).  Consequently, the scheme based on the use of cryptodisks will be an order of magnitude more expensive than that given in this article. <br><br><h4>  Setting up transparent network folder encryption </h4><br>  For greater clarity, let's call our server, which stores the 1C database, briefly and clearly: SERVER.  On the logical drive H: there is a folder 1C (H: \ 1C), in which the database 1C is stored.  The folder is shared, the network path looks like this: \\ SERVER \ 1C.  We need to encrypt this folder. <br><br>  CyberSafe program must be installed on all computers that need to work with an encrypted folder, that is, on the administrator's computer and on the computer of all users who work with 1C. <br>  Run the CyberSafe Top Secret program and go to the <b>Transparent Encryption</b> section, click the <b>Add</b> button <b>.</b>  <b>folder</b> and add our network folder (Fig. 2). <br><br><img src="https://habrastorage.org/files/513/4c5/f54/5134c5f540b843faa37cc19c26a23d16.png"><br>  Fig.  2. CyberSafe Top Secret Program <br><br>  Click the <b>Apply</b> button.  The <b>Transparent Encryption</b> window will appear, in which you need to click the <b>Yes</b> or <b>Yes</b> button <b>for everyone</b> if you are going to encrypt several folders at once.  Next, you need to select certificates of users who will have access to the folder (you can create your own certificate in the <b>Private Keys</b> section, import the keys of other users in the <b>All Keys</b> section).  Usually you need to select certificates of administrators and backup operators.  In fig.  3 shows the certificate selection window.  Since the program is used in a real enterprise, the email addresses of users are hidden. <br><br><img src="https://habrastorage.org/files/655/f4c/434/655f4c434eb14f7c8e5d5f86df773317.png"><br>  Fig.  3. Choosing a certificate <br><br>  After clicking the <b>Apply</b> button, you will be prompted to add an administrator key, click <b>Yes</b> .  Everything, the folder is protected. <br><br>  <b>Note</b>  In the CyberSafe Top Secret program, you can add both an empty folder and a folder with files.  No difference.  You can encrypt an empty folder and add files to it later. <br><br><h4>  Work with an encrypted folder </h4><br>  To make the encrypted folder available, you need to start the CyberSafe Top Secret program, select the folder and click the <b>Enable</b> button.  Then the password entry window will appear.  You need to enter the password of your certificate (if, of course, it was specified when encrypting the folder).  When you finish working with the folder, you need to turn it off by clicking the <b>Shut Down</b> button. <br>  If someone tries to open files located in an encrypted network folder from another computer (or from a computer on which the encrypted folder itself is stored), he will find that these files are encrypted. <br><br><h4>  Backup Setup </h4><br>  So, the folder is encrypted.  The 1C: Enterprise program can work with it as with the most ordinary folder, with the exception of a slight performance loss.  The backup tool is Acronis Backup &amp; Recovery, which is installed on our server. <br><br>  This program was not chosen randomly, because Acronis during backup saves file streams, in which they store information about the keys with which the folder with the 1C database was encrypted.  In addition, when using Acronis, it is not even necessary to complete the 1C process, which is required by some other backup tools. <br>  The Acronis setting itself is simple - you need to specify what you are copying (Fig. 4) and where to copy (Fig. 5). <br><br><img src="https://habrastorage.org/files/ceb/875/331/ceb87533103745549ee7f1ea475bdea7.png"><br>  Fig.  4. What we copy <br><br><img src="https://habrastorage.org/files/c49/574/056/c4957405686041338026aab16224c7b1.png"><br>  Fig.  5. Where to copy <br><br>  Pay attention to exactly where the backup is performed: the backup is stored on the D-Link network storage. <br>  If you are not using Acronis and another backup tool, make sure that it supports saving file streams.  Even some archivers (if you do not use backup software, but create a backup manually) support file streams.  For example, in WinRAR, when creating an archive, on the <b>Advanced</b> tab (Fig. 6), you must enable the <b>Save file streams</b> check <b>box</b> . <br><br><img src="https://habrastorage.org/files/dff/5b2/eec/dff5b2eec09f4007a7624080d7ac63a2.png"><br>  Fig.  6. Creating an archive <br><br>  After that, the archive with the encrypted folder can be unpacked on another computer or on another hard disk.  If desired, such an archive can be transferred to the addressee.  For decryption, you need the destination certificate to be specified when encrypting a folder. <br><br><h4>  Why not use EFS? </h4><br>  Why do we need all these dances with a tambourine and using the CyberSafe Top Secret program?  After all, you can encrypt using the EFS folder H: \ 1C on the server and our database will also be encrypted. <br><br>  And now the most important thing: everything is correct, if you perform transparent encryption of the folder with the database, the database will be encrypted, but the backup copies will not.  After all, when using EFS, all programs on the server, including Acronis, will see all files encrypted using EFS decrypted.  When using CyberSafe, other programs, including Acronis, see the database files initially encrypted.  It is very important.  I think it is not necessary to say what happens if the backup falls into the wrong hands.  Files in the backup will not be encrypted, therefore, anyone can read them. <br><br><h4>  Other features of our solution </h4><br>  So, you already know that when using CyberSafe, the backup tool will ‚Äúsee‚Äù the originally encrypted files.  This is the main feature of our solution.  However, it should be noted and others: <br><ul><li>  <i>Data encryption and decryption occurs on the client, and not on the server</i> - unlike EFS, the encryption and decryption process does not occur on the server, as already noted.  Therefore, if the attacker gains access to the server, there is neither encryption software nor the keys on it.  Yes, CyberSafe Top Secret is not installed on the server.  It is needed only on the computers of users who need to work with an encrypted folder. </li><li>  <i>Data encryption during transmission over the network</i> - EFS, alas, does not support data encryption over the network.  This means that the data between the database server 1C and the client are transmitted in decrypted form.  When using transparent CyberSafe encryption, encryption and decryption occur on clients, that is, on users' computers working with 1C.  Consequently, data is transmitted over the network in encrypted form. </li><li>  <i>Access restriction</i> - not everyone can work with a transparent network folder, but only those whose certificates are specified when encrypting the folder - this is an additional level of data protection.  Yes, access control also occurs at the system level ‚Äî by setting access rights, but using certificates makes data protection even more reliable. </li><li>  We cannot <i>back up</i> files to network storage ‚Äî we cannot encrypt a folder on the network storage (due to the lack of support for NTFS, the hard disk on the network storage is formatted as ext3), but we can back up the encrypted folder with Acronis. </li><li>  <i>Incremental copying capability</i> - TrueCrypt fans can argue, they say, you can create a virtual encrypted disk container, ‚Äúshare‚Äù it and store the 1C database in it (however, the shortcomings of this solution have already been considered earlier), and Acronis will copy the same virtual hard disk file.  Such a file can easily occupy several gigabytes and every day you will have to copy it completely, even if only one file of several kilobytes in size has changed in the folder.  It is possible to use such a solution, but there is no talk about any rationality, both in terms of system load and disk space usage.  In the case of our solution, you can perform incremental backups, that is, copy only new and modified files.  You do not need to copy the entire folder every day.  An incremental solution saves disk space and reduces the overall load on the system, including the network, because it uses network storage. </li></ul><br><br><h4>  Links </h4><br><ul><li>  <a href="http://fstec.ru/tekhnicheskaya-zashchita-informatsii/dokumenty-po-sertifikatsii/153-sistema-sertifikatsii/591-gosudarstvennyj-reestr-sertifitsirovannykh-sredstv-zashchity-informatsii-n-ross-ru-0001-01bi00">State register of certified information security tools</a> </li><li>  <a href="http://fstec.ru/normotvorcheskaya/akty/53-prikazy/691-prikaz-fstek-rossii-ot-18-fevralya-2013-g-n-21">Order of the FSTEC of Russia of February 18, 2013 N 21</a> </li><li>  <a href="http://www.consultant.ru/document/cons_doc_LAW_137356/">Government Decree of 01.11.2012 N 1119 ‚ÄúOn approval of requirements for the protection of personal data when processing them in personal data information systems‚Äù</a> </li><li>  <a href="http://cybersafesoft.com/rus/products/topsecret/">CyberSafe Top Secret Program</a> </li><li>  <a href="http://cybersafesoft.com/rus/blogs/%25D0%25BF%25D1%2580%25D0%25BE%25D0%25B7%25D1%2580%25D0%25B0%25D1%2587%25D0%25BD%25D0%25BE%25D0%25B5-%25D1%2588%25D0%25B8%25D1%2584%25D1%2580%25D0%25BE%25D0%25B2%25D0%25B0%25D0%25BD%25D0%25B8%25D0%25B5-%25D0%25BF%25D1%2580%25D0%25B5%25D0%25B8%25D0%25BC%25D1%2583%25D1%2589%25D0%25B5%25D1%2581%25D1%2582%25D0%25B2%25D0%25B0/">Transparent encryption: advantages and disadvantages</a> </li></ul></div><p>Source: <a href="https://habr.com/ru/post/259323/">https://habr.com/ru/post/259323/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../259309/index.html">Web Application Security Audit Methodology</a></li>
<li><a href="../259311/index.html">AngularJS vs. Backbone.js vs. Ember.js</a></li>
<li><a href="../259315/index.html">HL7: one day in the operating room</a></li>
<li><a href="../259317/index.html">My top 100 books on Programming, Computers and Science: part 1</a></li>
<li><a href="../259321/index.html">Your questions about Data Science</a></li>
<li><a href="../259325/index.html">Do not rely on employees to protect yourself from data leakage.</a></li>
<li><a href="../259327/index.html">A new bug from Apple, a game from Zynga and a report from App Annie in the news of the week for a mobile developer</a></li>
<li><a href="../259329/index.html">App Store style customizable download button</a></li>
<li><a href="../259331/index.html">Secure computer inside Micro SD card</a></li>
<li><a href="../259333/index.html">Simplicity design: How to make effective plain-text letters</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>