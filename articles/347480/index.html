<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Object in a case or Optional in Java 8 and Java 9. Part 1: ‚ÄúHow to live without it?‚Äù</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Perhaps you have already had to deal with objects that change their structure according to the laws of their internal development or depending on exte...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Object in a case or Optional in Java 8 and Java 9. Part 1: ‚ÄúHow to live without it?‚Äù</h1><div class="post__text post__text-html js-mediator-article"> <a href="https://habrahabr.ru/post/347480/"><img src="https://habrastorage.org/webt/ys/0h/kg/ys0hkgszo0x804sxkfr0q6svqcm.jpeg" alt="Object in the case"></a> <br><br>  Perhaps you have already had to deal with objects that change their structure according to the laws of their internal development or depending on external conditions.  In practice, this means that parts of an object for the outside world can sometimes be available, and sometimes not. <br>  What kind of objects can it be?  Many service companies, commercial enterprises and banks provide various types of services depending on the time of day.  Different devices may or may not perform certain actions depending on their state.  If you read this text from the screen of a smartphone or laptop, it may stop showing it if the battery charge drops below a certain limit. <br>  In this and subsequent articles of this tutorial, we will look at simple objects with dynamic structure, methods of modeling them and using them in Java using the methods of the Optional class. <br>  Much has been written about the use of the methods of this class, including in Russian, including on Habr√©.  In this series of articles, I will try to look at the problem more broadly, to consider the advantages and disadvantages of the chosen solution to the problem, as well as alternative approaches. <br>  In this first article in the series, we‚Äôll talk about how you can do without NullPointerException without using Optional in Java.  I hope you will see that you can live without an Optional, but life should become more pleasant with it.  <a href="https://habrahabr.ru/post/347576/">The second article in</a> this series describes the methods of the Optional class as it appeared in Java 8, and the <a href="https://habrahabr.ru/post/347748/">third</a> describes the methods of the class added in Java 9. <a href="https://habrahabr.ru/post/347836/">The fourth article</a> deals with the necessary (from the author‚Äôs point of view) addition to this class.  Well, in the <a href="https://habrahabr.ru/post/350904/">fifth article</a> I tell about where the Optional should be used inside the class, summarize and give every reader who has read the series to the end, a valuable gift. <br><a name="habracut"></a><br>  So, let's discuss how to use Java to access elements with a dynamic structure, for example, our first device: a simple coffee machine. <br>  It should immediately make a reservation that the physical structure of the device does not change with time.  Speaking about the dynamics of the structure, we look at the device through the user's eyes.  If for some reason the device cannot make coffee to the user, then this functionality for the user is practically not present at the moment. <br>  How can I express this with Java? <br>  Suppose we were asked to write a control unit for such an instrument and we need a function like <br><pre><code class="java hljs">device.getCoffeePortion()</code> </pre> <br>  What type of item should this method return?  After all, sometimes the device may be able to give the user coffee, and sometimes not. <br>  There are not many ways to solve this problem (at least known to me). <br><br><h3>  We return either object or null </h3><br>  The most common solution is to return some object in a positive case and null in a negative one.  The user must therefore always check the return value and use it only if it is not null. <br>  The problem is that the user of your object must somehow know or guess about the possibility of returning a zero object.  A programmer who calls your method in his code can pass it as a parameter in a chain of calls to other functions, check the list, and so on. This means that payment in the form of a NullPointerException can come much later and in a substantially remote function call place <br>  NullPointerException is a notorious champ among Java programmer errors, both in number and in terms of time and nerves spent on finding and eliminating them. <br>  It is interesting to note that this catastrophe has an author who called it his ‚Äúbillion-dollar mistake‚Äù.  Null appeared much earlier than Java in 1965 when developing the ALGOL language. <br>  After 44 years, Tony Hoare, the creator of this monster (but also a wonderful scientist) wrote in his article <a href="https://www.infoq.com/presentations/Null-References-The-Billion-Dollar-Mistake-Tony-Hoare">‚ÄúNull References: The Billion Dollar Mistake‚Äù (QCon, August 25, 2009)</a> , <br><blockquote>  I‚Äôm calling you a ballman for the compiler.  But I couldn‚Äôt have been able to implement it.  This has led to innumerable errors, health problems, and system crashes. </blockquote><br>  As an object creator, you can somewhat mitigate the situation using an annotated return result, for example: <br><pre> <code class="java hljs"><span class="hljs-meta"><span class="hljs-meta">@Nullabble</span></span> <span class="hljs-function"><span class="hljs-function">CoffeePortion </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getCoffeePortion</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span></code> </pre> <br>  If a programmer uses a modern IDE, then in certain situations it will tell him to check for a null object.  But this does not always happen and you should not count on it especially. <br>  So, returning null as the result of an operation is bad.  So this should be avoided.  But as? 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h3>  First ask well </h3><br>  One solution is to supply each get ... method with a partner has ... The object user must somehow be warned that before the get request ... he must ask if there is a value to return.  In our case, the pair would look like this: <br><pre> <code class="java hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">boolean</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">hasCofeePortion</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> CoffeePortion </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getCoffeePortion</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span></code> </pre> <br>  If the first function returns true, it thus gives the go-ahead to the function of the steamer function.  The user can theoretically try not to call the first has ... function.  If the value at the time of the call is not available, the function get ... returns not null, as it was in the first variant, but throws Exception. <br>  Thus, the problem of transferring a ‚Äúdangerous‚Äù object along the call chain is eliminated.  This is the advantage of the approach.  But the approach has two significant drawbacks.  First, the number of functions is multiplied.  Secondly, there is no guarantee that at the time of the has ... call, the object was available, and at the time of get ... it was no longer available.  (In our simple example, this is impossible, but in complex systems, where the state of objects depends on time or external influences, and other operations are required to prepare the get ... call, this danger is real. <br>  So, first ask, and then take - not a good strategy.  Can't the other way around?  It is this idea that uses the following approach. <br><br><h3>  The object is always issued, but not always alive. </h3><br>  In this approach, the object is always returned, but contains an additional feature.  This sign tells us, roughly speaking, whether it is in fact or not.  Sharpening to the extreme, you can formulate this approach as follows: you get either a living object or its corpse.  But even if it is a corpse, he speaks a little. <br>  Namely, the approach says that you can always call a method like isActive () or isPresent ().  Even the ‚Äúdead‚Äù object.  And with a positive response to work with the object further. <br>  An obvious disadvantage of this approach is the hanging on the object of a technical feature, which cannot be explained from the point of view of its own functioning (business logic).  In certain situations, this feature may conflict with this logic.  For example, imagine that an object is associated with two other objects.  From the point of view of one object, it can be active or ‚Äúalive‚Äù, and from the point of view of another ‚Äúdead‚Äù. <br>  However, from a technical point of view, this approach may have its own, sometimes unexpected, advantages.  For example, if we need to save or forward a compound object as JSON or XML, it is wise to send it completely, including its currently deactivated parts.  After all, it may be that after restoring an object (reading from a file or stream), the deactivated parts sometime have to be activated. <br>  So, this approach is good because it does not lead to a NullPointerException, but is ‚Äúunnatural‚Äù.  Is it possible to find something similar, but without the shortcomings described? <br><br><h3>  Sheet returned, possibly empty </h3><br>  One of the most recommended approaches by experts before the Java 8 Optional approach was the approach described below. <br>  His idea is extremely simple.  Instead of an object, we return an array or a list of objects.  This array or list can either be empty or contain exactly one object. <br>  In fact, we are thus forcing the users of our method on the spot, immediately after calling the function, deal with the list.  It is unlikely that he will pass on this list further as a parameter of other methods. <br>  The disadvantage of the method is its obvious pretentiousness. The situations when the get ... method returns an elementary value, for example int, a known object and a conditionally existing object, start to differ very much. <br>  And in order to overcome this contradiction, as well as for other reasons, the developers of the Java language decided to introduce Optional.  We will talk about the advantages and disadvantages of this class in the next articles in this series. <br><br>  Go to the <a href="https://habrahabr.ru/post/347576/">next</a> article. <br><br>  Illustration: <a href="https://pixabay.com/de/k%25C3%25A4tzchen-tier-haustiere-katze-491013/">ThePixelman</a> </div><p>Source: <a href="https://habr.com/ru/post/347480/">https://habr.com/ru/post/347480/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../347470/index.html">Numphp - library for working with numeric arrays</a></li>
<li><a href="../347472/index.html">Satisfaction JET or how we manage customer satisfaction</a></li>
<li><a href="../347474/index.html">Cost of games</a></li>
<li><a href="../347476/index.html">Video recordings of speeches from the lecture day on the gaming industry at VSBI</a></li>
<li><a href="../347478/index.html">How to make a website accessible to the blind and visually impaired?</a></li>
<li><a href="../347482/index.html">Interactive telegram bot in PHP</a></li>
<li><a href="../347488/index.html">Incident management in IT can be not only about IT</a></li>
<li><a href="../347490/index.html">Method of progressive Heisenbag</a></li>
<li><a href="../347492/index.html">How to bargain about wages in the United States. American Conversation Etiquette</a></li>
<li><a href="../347494/index.html">The first user with a million on stack overflow</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>