<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Online thermometer on TP-Link MR3020</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Historically, my ‚Äúnative‚Äù operating system is Windows. In a previous article, I tried to show the Internet thermometer or telemetry of a country house...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Online thermometer on TP-Link MR3020</h1><div class="post__text post__text-html js-mediator-article">  Historically, my ‚Äúnative‚Äù operating system is Windows.  In a previous article, I tried to show the <a href="http://habrahabr.ru/post/155869/">Internet thermometer or telemetry of a country house</a> ‚Äúwhat we are not horses with,‚Äù ‚Äúwe can also‚Äù or ‚Äúa monkey can also be taught‚Äù and easily.  But the time has come "X" - moving to linux.  I have associated this move with forced migration - the ice age. <br><img src="https://habrastorage.org/getpro/habr/post_images/381/7f9/a23/3817f9a23909ce3087e3f7e61c2df054.jpg" alt="image"><br><a name="habracut"></a><br>  The debut idea was a simple replacement of windows "server" similar but on linux.  Since this brainwashing was originally planned, then on windows server there were php and mysql. <br>  Moving the web server turned out to be extremely simple: copy the files of the home directory, raise the database from the backup and then the frontend moved.  Working with the mp707 device is also simple, the developer provides the <a href="http://devphp.org.ua/dload.php%3Ffree%3D5">bmcontrol</a> utility. <br><br>  bash temperature transfer script in mysql <br><pre><code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment">#!/bin/bash RES=`/home/tarasii/bin/bmcontrol temp d5000002a8cbed28` user="usr" pass="pwd" db="main" mysql -u "$user" -p"$pass" "$db" &lt;&lt;EOF INSERT INTO bashtest (val,dt) VALUES ('$RES',NOW()) ; EOF</span></span></code> </pre> <br>  d5000002a8cbed28 is the 64-bit identifier of the sensor DS18B20 <br><br>  Add a schedule to crontab <br><pre> <code class="bash hljs">*/10 * * * * root /etc/tempscr</code> </pre>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      We are under linux.  The goal is all well and happy.  Special thanks to ASM and ANDY for their educational work. <br>  Yes, but no.  The idea comes to place our frontend frontending.  Again, copying, some struggle with restrictions, with the subsequent optimization of the code, and now <a href="http://tarasii.zz.mu/">tarasii.zz.mu</a> .  The code had to be changed a little.  The reason for this was the restriction on the number of simultaneous connections from one ip-address on freehosting.  For this very reason, my winXP site stopped responding to external requests.  In winXP there are restrictions on the number of tcp connections. These graphs were loaded with 5 parallel open connections.  Login of one user to the start page occupied 6 connections.  The same effect was also on the frihosting, 3 compounds still lived, the next ones were cut off by the provider.  Redid it. <br>  Another feature added to the comparison with the previous year. <br><br>  Now the system is divided into separate parts of the hardware and web interface.  I really liked this structure of the system.  Again there was a reason to throw everything in the table. <br><br>  But no, I read about tp-link mr3020 (Thanks to Holoborodko).  Nice device.  Subconsciously buy it, flashing OpenWrt. <br><img src="http://habrastorage.org/storage2/569/6d1/5a3/5696d15a3e2a974ed1a1dbfae64f3068.jpg"><br>  Thanks ANDY he did bmcontrol under Atheros - <a href="https://sites.google.com/site/tarasiivaniv/Home/proekty/tptemp%3Fattredirects%3D0%26d%3D1">tptemp</a> .  The <a href="">bmcontrol sources</a> are now available.  The peculiarity of the MR3020 is, the fact that, USB-hid devices connected directly to it at the port are not visible at all, and work through any 2.0 USB-hub.  <u>Attention!</u>  (Thanks <a href="http://habrahabr.ru/users/SSar/">SSar</a> ) USB hub should be 2.0 !.  Further along the trodden path: the task to the scheduler, the script to send to the frontend ... <br><br>  The total cost of the Internet thermometer has dropped to $ 60.  TP-Link MR3020 + MP707 + freehosting <br><br>  Plans to connect the <a href="http://habrahabr.ru/post/153395/">weather station</a> to the MR2030 and get the pressure and humidity graphically. <br><br>  <a href="http://usbsergdev.narod.ru/BM1707/BM1707.html">Master Kit - MP707 - USB Thermometer</a> <br>  <a href="http://devphp.org.ua/%3Fmenu%3Dscripts%26sub%3D%26sshow%3D5">BMcontrol at PhP Developer</a> <br>  <a href="http://robocraft.ru/blog/electronics/1053.html">Research Wi-Fi router TP-LINK TL-MR3020</a> <br>  <a href="http://habrahabr.ru/post/159745/">We assemble a wi-fi device for controlling electrical appliances with a web server and a JS frontend</a> <br>  <a href="http://wiki.openwrt.org/toh/tp-link/tl-mr3020">OpenWrt TP-Link TL-MR3020</a> </div><p>Source: <a href="https://habr.com/ru/post/164399/">https://habr.com/ru/post/164399/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../164383/index.html">Microsoft Reporting Services tips for beginners. Part 2</a></li>
<li><a href="../164385/index.html">LED Christmas tree on the Arduino in one evening</a></li>
<li><a href="../164391/index.html">Logic - weekly selection of gaming and IT industry news ‚Ññ7</a></li>
<li><a href="../164393/index.html">About torrent and seeders</a></li>
<li><a href="../164397/index.html">Easyweb: New Year Update</a></li>
<li><a href="../164401/index.html">Nginx + php-fpm + perl under Debian Squeeze</a></li>
<li><a href="../164403/index.html">How do you feel about New Year's mailing lists?</a></li>
<li><a href="../164409/index.html">Hover effect CSS masks</a></li>
<li><a href="../164411/index.html">XIAOMI will open the source code MIUI in 2013</a></li>
<li><a href="../164413/index.html">Android application distribution points</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>