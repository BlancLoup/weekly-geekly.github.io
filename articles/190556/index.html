<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Localization of projects on .NET with an interpreter of functions</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Prologue 
 To begin with, over many years of work as a programmer, I have repeatedly come across the task of introducing into a localization project i...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Localization of projects on .NET with an interpreter of functions</h1><div class="post__text post__text-html js-mediator-article"><h4>  Prologue </h4><br>  To begin with, over many years of work as a programmer, I have repeatedly come across the task of introducing into a localization project in one form or another, but usually these were solutions that work on the basis of a loadable dictionary with key-value pairs.  This approach is fully justified for small projects, but it has several significant drawbacks: <br><br><ol><li>  The complexity of the implementation of an existing project. </li><li>  Lack of formatting tools for localized messages (except for standard string.Format). </li><li>  The impossibility of embedding culturally-dependent functions.  For example, a typical task ‚Äî the substitution of the desired form of a word depending on the meaning of a number ‚Äî cannot be resolved by dictionaries alone. </li></ol><br><br>  After analyzing these problems, I came to the conclusion that it was necessary to create my own library for localizing projects, which would be deprived of the above disadvantages.  In this article I will talk about the principles of its work with examples of code in C #. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h4>  Library composition </h4><br>  Link to SourceForge project: <a href="https://sourceforge.net/projects/open-genesis/%3Fsource%3Dnavbar">https://sourceforge.net/projects/open-genesis/?source=navbar</a> <br><br>  Example: <a href="http://sourceforge.net/projects/open-genesis/files/LocalizationViewer.zip/download">LocalizationViewer</a> <br><br>  The assembly includes the following projects: <br><br><ul><li>  <b>Genesis.Localization</b> is the main localization library. </li><li>  <b>Ru</b> - the implementation of Russian localization (example). </li><li>  <b>En</b> - the implementation of the English localization (example). </li><li>  <b>LocalizationViewer</b> - a program to demonstrate the capabilities of the library with the ability to edit localizations. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/578/712/ca0/578712ca0951d461cf7d804f3a08d8e2.png" alt="image"><br><a name="habracut"></a><br></li></ul><br><br><h4>  Basic principles </h4><br><img src="https://habrastorage.org/getpro/habr/post_images/d9b/02b/4db/d9b02b4db9d6ccf900f3decea2711caf.png" alt="image"><br><br><h5>  Localization Manager </h5><br>  The library is built on the basis of plug-ins and works as follows: when the application is started, a localization manager ( <b>LocalizationManager</b> ) is created, which specifies the path to the directory where it will search for available localization packages ( <b>LocalizationPackage</b> ), each of which is responsible for a certain culture (Russian localization package, English, etc.).  After that, a command is given to search and download descriptors of all packages, all initialization code looks like this: <br><br><pre><code class="cs hljs"><span class="hljs-comment"><span class="hljs-comment">//    LocalizationManager = new LocalizationManager(); LocalizationManager.BasePath = Path.Combine(AppDomain.CurrentDomain.BaseDirectory, "Localization"); LocalizationManager.Initialize(); try { LocalizationManager.DetectAllLocalizations(); } catch (LocalizationException ex) { MessageBox.Show(ex.Message, " ", MessageBoxButtons.OK, MessageBoxIcon.Error); return; }</span></span></code> </pre> <br>  If everything went smoothly, a list of available localizations will appear in the manager in the form of their brief descriptions (descriptors, <b>LocalizationDescriptor</b> ).  These descriptors do not contain any logic, but serve only as a description of a package that can be downloaded and started to be applied in the program. <br><br>  A list of all localizations can be obtained from the manager: <br><br><pre> <code class="cs hljs">manager.Localizations</code> </pre><br>  For example, we wanted to connect the Russian localization, for this you need to load it directly into the manager: <br><br><pre> <code class="cs hljs">LocalizationPackage package = manager.Load(<span class="hljs-string"><span class="hljs-string">"ru"</span></span>);</code> </pre><br>  After loading, you can work with localization ‚Äî get strings, resources, etc. from it, and if it is no longer needed, you can unload it: <br><br><pre> <code class="cs hljs">manager.Unload(<span class="hljs-string"><span class="hljs-string">"ru"</span></span>);</code> </pre><br>  <b>Important!</b>  You can download and upload an unlimited number of localizations, because  they are all created in their own domains (AppDomain). <br><br><h5>  Localization package </h5><br>  Each localization is a set of files in a separate directory, the root for all is the one that was selected when the localization manager was loaded.  In the example above, this will be the <u>[ProjectDir] \ Localization</u> directory, and the localization packages will be located in the <u>[ProjectDir] \ Localization \ ru</u> , <u>[ProjectDir] \ Localization \ en directories</u> , etc ... <br><br>  Each standard package must contain the following files: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/273/f55/a81/273f55a81e60ffaa182af4452e694f5c.png" alt="image"><br><br><ul><li>  <b>localization.info</b> is an xml file with a brief description of the package; these are the files that the localization manager initially loads. <br><br>  Example for Russian localization: <br><br><pre> <code class="xml hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?xml version="1.0"?&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">LocalizationInfo</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:xsd</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://www.w3.org/2001/XMLSchema"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:xsi</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Name</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Name</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Culture</span></span></span><span class="hljs-tag">&gt;</span></span>ru<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Culture</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">LocalizationInfo</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br>  As you can see, there are only two fields here, maybe later new fields will be added to identify one or another package. </li><li>  <b>flag.png</b> - image symbolizing localization.  In my examples, these are 16x16 pixel state flags. </li><li>  <b>strings.xml</b> - an xml file containing localized strings.  When redefining the package logic, you can create your own source of strings, for example, a binary or database. </li><li>  <b>package.dll</b> - the executable module of the package is a small library in which there must be a class inherited from <b>LocalizationPackage</b> . <br><br>  An example of executable code for Russian localization: <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> Genesis.Localization; <span class="hljs-keyword"><span class="hljs-keyword">namespace</span></span> <span class="hljs-title"><span class="hljs-title">Ru</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">Package</span></span> : <span class="hljs-title"><span class="hljs-title">LocalizationPackage</span></span> { <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">protected</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">override</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">object</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Plural</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> count, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">params</span></span></span></span><span class="hljs-function"><span class="hljs-params"> </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">object</span></span></span></span><span class="hljs-function"><span class="hljs-params">[] forms</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> m10 = count % <span class="hljs-number"><span class="hljs-number">10</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> m100 = count % <span class="hljs-number"><span class="hljs-number">100</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (m10 == <span class="hljs-number"><span class="hljs-number">1</span></span> &amp;&amp; m100 != <span class="hljs-number"><span class="hljs-number">11</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> forms[<span class="hljs-number"><span class="hljs-number">0</span></span>]; } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (m10 &gt;= <span class="hljs-number"><span class="hljs-number">2</span></span> &amp;&amp; m10 &lt;= <span class="hljs-number"><span class="hljs-number">4</span></span> &amp;&amp; (m100 &lt; <span class="hljs-number"><span class="hljs-number">10</span></span> || m100 &gt;= <span class="hljs-number"><span class="hljs-number">20</span></span>)) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> forms[<span class="hljs-number"><span class="hljs-number">1</span></span>]; } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> forms[<span class="hljs-number"><span class="hljs-number">2</span></span>]; } } } }</code> </pre><br>  The following will explain what the Plural method is. <br></li></ul><br><br><h5>  Application of localization packages </h5><br>  So, we created a localization manager and uploaded the package with the translation into it.  Now it can be used in the program in three ways: <br><br><ol><li>  Getting a specific string by its key (classic method).  The key can be a string or an Int32 type number. <br><br>  Usage example: <br><pre> <code class="cs hljs">LocalizationPackage package = manager.Load(culture); <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> strByName = package[<span class="hljs-string"><span class="hljs-string">"name"</span></span>]; <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> strByID = package[<span class="hljs-number"><span class="hljs-number">150</span></span>];</code> </pre><br></li><li>  Receiving a formatted string with passing arguments.  This is the method for which the library was created. <br><br>  Usage example: <br><pre> <code class="cs hljs">LocalizationPackage package = manager.Load(culture); <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> formattedString = package[<span class="hljs-string"><span class="hljs-string">"name"</span></span>, arg1, args2, ...];</code> </pre><br>  As arguments any objects can be used.  More on this method will be described below. <br><br></li><li>  Getting the path to a localized resource.  To do this, use the GetResourceFilePath (string filename) method to get the path to an arbitrary file in the localization directory or the GetImage (string filename) method to load an image from there. </li></ol><br><br><h4>  String interpreter </h4><br>  The power of the library lies in its string interpreter.  What is he like? <br>  In short, this is a set of instructions included in localized strings, with which you can adapt a translation for a particular culture. <br><br>  The string interpreter is called by the method described above to get a string with the specified arguments (during normal key access, the localized string is returned in ‚Äúpure‚Äù form) or by the special GetFormattedString (string format, params object [] args) method, which works in the same way, but An arbitrary format string is passed as the first argument. <br><br>  Now more about these instructions.  There are two of them: <br><br><ol><li>  Include argument in string. <br><br>  Instruction format: <pre> <code class="bash hljs">%index%</code> </pre><br>  Result: embedding the argument under the index number <br><br>  Usage example: <br><pre> <code class="cs hljs">package.GetFormattedString(<span class="hljs-string"><span class="hljs-string">"%1% = %0%%%"</span></span>, <span class="hljs-number"><span class="hljs-number">80</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>);</code> </pre><br>  Result: <br><pre> <code class="bash hljs"> = 80%</code> </pre><br>  Please note that the <b>%</b> symbol, being a service one, must be escaped by another same symbol as in this example. <br><br></li><li>  Enable features <br><br>  Instruction format: <br><pre> <code class="bash hljs">%Func(arg1, arg2, ..., argN)%</code> </pre><br><br>  Arguments can be <u>numbers</u> , <u>strings in double quotes</u> ( <u>quotes</u> themselves are escaped, like%, double repetition), <u>string arguments</u> by their number (% index), or <u>calls to other functions</u> . <br><br>  Usage example: <br><pre> <code class="cs hljs">package.GetFormattedString(<span class="hljs-string"><span class="hljs-string">" %1%    %Upper(Random(\"\", \"\", \"\"))% ,  %0% %Plural(%0, \"\", \"\", \"\")% ."</span></span>, <span class="hljs-number"><span class="hljs-number">55</span></span>, <span class="hljs-string"><span class="hljs-string">"MegaDeath2000"</span></span>);</code> </pre><br>  Result: <br><pre> <code class="bash hljs"> MegaDeath2000     ,  55  .</code> </pre><br></li></ol><br><h4>  Built-in functions and integration </h4><br>  The <b>LocalizationPackage</b> class has several ‚Äústandard‚Äù functions built in, a part was used in the example above: <br><br><ul><li>  Plural (int, var1, var2, ..., varN) - embedding the form of the word depending on the number, this method is unique for each culture and must be redefined.  In particular, in Russian there are three forms of number (for example: "1 unit", "2 units", "8 units"). </li><li>  Random (var1, var2, ..., varN) - selection of a random value among the specified ones. </li><li>  Upper (string) - coercion to upper case. </li><li>  Lower (string) - reduction to lower case. </li><li>  UpperF (string) - coercion to uppercase only the first letter ("word" =&gt; "Word"). </li><li>  LowerF (string) - lowercase the first letter only. </li></ul><br>  If you need to add new features, you can do this in two ways. <br><br><ol><li>  In the redefined package class, you can declare new functions and mark them with the [Function] attribute, then they will be automatically included in the interpreter for a specific localization.  The built-in functions are defined in this way, for example, the functions Plural and Random look like: <br><br><pre> <code class="cs hljs">[<span class="hljs-meta"><span class="hljs-meta">Function(</span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"P"</span></span></span><span class="hljs-meta">)</span></span>] <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">protected</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">abstract</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">object</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Plural</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> count, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">params</span></span></span></span><span class="hljs-function"><span class="hljs-params"> </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">object</span></span></span></span><span class="hljs-function"><span class="hljs-params">[] forms</span></span></span><span class="hljs-function">)</span></span>; [Function] <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">protected</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">virtual</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">object</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Random</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">params</span></span></span></span><span class="hljs-function"><span class="hljs-params"> </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">object</span></span></span></span><span class="hljs-function"><span class="hljs-params">[] variants</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (variants.Length == <span class="hljs-number"><span class="hljs-number">0</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> variants[_rnd.Next(variants.Length)]; } }</code> </pre><br>  Please note that it is permissible for a function to specify a list of its aliases (for short entry), for example, Plural can be called either via the main name ( <u>Plural</u> ) or through an alias ( <u>P</u> ), and the register in the function names does not matter. <br><br></li><li>  Integration of eigenfunctions, for this purpose, the <b>InjectFormatterFunction</b> method is <b>used</b> , example of use: <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> package = LocalizationManager.Load(<span class="hljs-string"><span class="hljs-string">"ru"</span></span>); package.InjectFormatterFunction(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Func&lt;<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">int</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">int</span></span>&gt;((a, b) =&gt; Math.Min(a, b)), <span class="hljs-string"><span class="hljs-string">"Min"</span></span>); package.InjectFormatterFunction(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Func&lt;<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">int</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">int</span></span>&gt;((a, b) =&gt; Math.Max(a, b)), <span class="hljs-string"><span class="hljs-string">"Max"</span></span>); package.GetFormattedString(<span class="hljs-string"><span class="hljs-string">"%min(%0, max(%1, %2))%"</span></span>, <span class="hljs-number"><span class="hljs-number">10</span></span>, <span class="hljs-number"><span class="hljs-number">8</span></span>, <span class="hljs-number"><span class="hljs-number">5</span></span>);</code> </pre><br>  Result: <br><pre> <code class="bash hljs">8</code> </pre><br>  As an argument for the <b>InjectFormatterFunction, a</b> method (MethodInfo) or a delegate can be passed (in the example above, delegates are passed). </li></ol><br><h4>  Additional features </h4><br>  In addition to the basic functions, the library provides two more additions. <br><br><h5>  Debug mode </h5><br>  The Debug-version of the library includes the ability not only to get localized strings using the methods described above, but also to write them directly: <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> package = LocalizationManager.Load(<span class="hljs-string"><span class="hljs-string">"ru"</span></span>); package[<span class="hljs-string"><span class="hljs-string">"New Key"</span></span>] = <span class="hljs-string"><span class="hljs-string">" "</span></span>; package.Save();</code> </pre><br>  In this case, a new localized string will be created with the specified key and value (or the existing one will be overwritten), and the package itself will be saved to disk.  Also in debug mode, if you try to read a line with a missing key, an empty value will be returned, but a new record will be created.  This is convenient at the initial stage of development - we do not need to worry about filling the dictionary - it will be filled with empty values, which we then fill with data. <br><br>  In the release, recording functions are not available, which is quite logical - an industrial program should not be able to replenish its localization dictionary. <br><br><h5>  Mappings </h5><br>  This is our dessert.  Purpose - rapid localization of forms, controls and other complex objects. <br>  This feature is used in the demo project <b>LocalizationViewer</b> . <br><br>  I will give an excerpt of the description of the main form: <br><br><pre> <code class="cs hljs">[<span class="hljs-meta"><span class="hljs-meta">LocalizableClass(</span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"Text"</span></span></span><span class="hljs-meta">, </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"CAPTION"</span></span></span><span class="hljs-meta">)</span></span>] <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">partial</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">frmMain</span></span> : <span class="hljs-title"><span class="hljs-title">Form</span></span> { ... [LocalizableClass] <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> System.Windows.Forms.ToolStripButton cmdExit; [LocalizableClass] <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> System.Windows.Forms.ToolStripButton cmdSave; [LocalizableClass] <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> System.Windows.Forms.ToolStripLabel lblSearch; ... <span class="hljs-comment"><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">///</span></span></span><span class="hljs-comment"> </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">&lt;summary&gt;</span></span></span><span class="hljs-comment"> </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">///</span></span></span><span class="hljs-comment">   </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">///</span></span></span><span class="hljs-comment"> </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">&lt;/summary&gt;</span></span></span><span class="hljs-comment"> private void Localize() { LocalizationMapper mapper = new LocalizationMapper(); mapper.Current = manager["ru"]; mapper.Localize(this); } ... }</span></span></code> </pre><br>  <b>LocalizationMapper</b> , allows you to localize any object passed to it in the <b>Localize</b> function, using the [Localizable] and [LocalizableClass] attributes in the fields and properties of the object being localized (in this case, the form).  For example, the attribute [LocalizableClass] without parameters means that the default property (Text) should be localized, and an automatic key of the form &lt;class&gt;. &lt;Subclass&gt;. &lt;Field&gt; will be used.  For the Text field of the cmdExit button, the key will be as follows: <br><br><pre> <code class="bash hljs">LocalizationViewer.frmMain.cmdExit_Text</code> </pre><br><br><h4>  Conclusion </h4><br>  The library will soon be tested in one of my projects, so there will most likely be some improvements, mainly aimed at expanding the basic functionality of the packages.  Stay tuned for updates on SourceForge and write your comments and thoughts on the further development of the library. <br><br><h4>  PS </h4><br>  You might say that I reinvent the wheel.  Let it be so, but reinventing bicycles is my hobby ... <br>  In addition, it is much more interesting and useful in terms of self-improvement in programming. <br>  For the same reason, there will be no references to literature and other sources of information - everything was written from scratch. <br><br><h3>  My other publications </h3><br><br><ol><li>  <a href="http://habrahabr.ru/post/251765/">Filling text templates with model-based data.</a>  <a href="http://habrahabr.ru/post/251765/">Implementing on .NET using dynamic functions in bytecode (IL)</a> </li></ol></div><p>Source: <a href="https://habr.com/ru/post/190556/">https://habr.com/ru/post/190556/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../190544/index.html">Data Center Risks: Engineering System Redundancy</a></li>
<li><a href="../190546/index.html">Creating a patch on Wix with PatchWiz</a></li>
<li><a href="../190548/index.html">We write our synchronous / asynchronous client-server</a></li>
<li><a href="../190550/index.html">Choosing a Voice VoIP Gateway</a></li>
<li><a href="../190552/index.html">Fluid Dynamics Simulation: Lattice Boltzmann Method</a></li>
<li><a href="../190560/index.html">Apportable SDK - Objective-C / Cocoa Touch for Android</a></li>
<li><a href="../190562/index.html">Meetings of the Meet Magento Russia 2013 Conference</a></li>
<li><a href="../190564/index.html">Support for Advanced Format - optimal work with high-capacity disks</a></li>
<li><a href="../190566/index.html">HHVM: testing performance and compatibility with Joomla, Bitrix and Wordpress</a></li>
<li><a href="../190572/index.html">The process of developing and rolling out releases in Badoo. Automatic testing. Developer Environment</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>