<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Active analytics for your project</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="We take the task of an e-commerce project (an online store or another b2c internet service) as a condition. We will equip this store with a cool team:...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Active analytics for your project</h1><div class="post__text post__text-html js-mediator-article">  We take the task of an e-commerce project (an online store or another b2c internet service) as a condition.  We will equip this store with a cool team: clear guidance, quick on honest decisions by marketers, agile development (ready to respond quickly to changing requirements).  We will give him some level of quantitative success (let it be from 1000 orders per day).  Suppose that this project is still a startup (or recently was).  And he will ever take over the world.  But so far, he has not been able to introduce an ERP / CRM discharge system for working with large orders / customers. <br><br>  What usually happens in the active stage of development of such a business?  Marketing by all means is seeking ways: <br><br><ul><li>  to expand the audience and channels to attract customers; </li><li>  increase the quality of services; </li><li>  implement loyalty programs to retain good customers; </li><li>  develop partner networks. </li></ul>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      And he reads and invents other world-wide business models. <br><br><img src="https://habrastorage.org/files/b3d/533/220/b3d53322021b4e62b9870d3b6a815940.png"><br><br><a name="habracut"></a><br><br>  And in the development we get a line of ingenious and not very (but necessarily urgent) tasks.  Affecting all processes from the landing of the client to the service, to his repeated maintenance.  The software part of the business is quickly brewed with the noodles from the logic of registering new clients, placing orders, calculating values ‚Äã‚Äã/ tariffs, ways of paying for orders / services, forming personal mailings, individual and group discount offers, holding promotions and so on. <br><br>  Marketing, which at the start of business was content with reports such as ‚Äúaverage order amount per month‚Äù now wants ‚Äúthe average amount of the order without special offers compared to two weeks in January and the same two weeks of September for a group of customers who have made more than one order in the last six months and registered more than 2 years ago, and even separately please customers of this and that gender, and even better so that they never call the call center, but also divide it all separately for each channel to attract customers and by moon phases  Auger "... <br><br>  From haste and hopelessness, the base is actively overgrown with <s>garbage</s> auxiliary tables and fields that are not needed by anyone (except for marketers).  Happy marketing develops successful and discards unsuccessful business models.  Fields and whole tables remain forever.  The whipped up reports, with the growth of the client and commercial base, soon cease to fit within reasonable limits of the load on the system, require rendering to background tasks (if not to a separate server), and want to replicate the base.  Or even more fun: the marketer ‚Äúlearned the sql‚Äù and sits in your server directly, periodically running to the admin asking him to ‚Äúdo not know why a long-running query‚Äù. <br><br>  And the structure of the base looks like this (not the worst option): <br><br><img src="https://habrastorage.org/files/18c/d07/806/18cd07806afd4351bfd93a1c3de06879.png"><br><br>  Why is that bad"?  Because a bunch of users-orders-payments should solve the problem of getting the service by the client and its payment.  As soon as we give these entities any extraneous tasks, we increase the dangerous connectivity through the entire workflow. <br><br><h5>  <b>Life example</b> </h5><br><br>  To begin with, let us imagine a simplified direct sales cycle in e-commerce (from the point of view of its most important part, the client): <br><br><img src="https://habrastorage.org/files/bea/627/0ff/bea6270ff6534a968fc03aefbf006335.png"><br><br>  In order for this process to be performed qualitatively, quickly and with the minimum amount of logical errors (the client must have a ‚Äútype-top‚Äù when ordering, otherwise it will fall off the marketing hook), there should not be anything extra in it (and the probability of filling bugs - minimal). <br><br>  But marketing comes and says: <br><br><ul><li>  After registration, you need to send a letter to the client. </li><li>  And if the client came from the action, then replace ‚Äúhello‚Äù with ‚Äúhello‚Äù in it. </li><li>  Or maybe it is from an order for a trial period of service - then a completely different pattern. </li><li>  If the client did not arrive for a long time, then send him a reminder letter. </li><li>  If the client came, but quickly left, then send-letter-ask-why. </li><li>  If he came and trampled N minutes, without putting anything in the basket, offer a discount. </li><li>  And prokinut track-id from partners, then to share the percentage on request. </li></ul><br><br>  And this is just one piece of the whole chain.  It will only be ‚Äúworse‚Äù.  Do you agree that the client himself is not involved in these tasks and his need does not satisfy these secret intrigues?  And when you program all these conditions right in your class (component / controller), which handles visits and customer registrations, the code of this class will be increasingly thick, and the dependencies in it will be more and more.  And this class is no longer registering customers!  More precisely, he not only registers: he sends letters and makes difficult decisions (and even learns to play the guitar - guaranteed).  Well done, if you selected letters in a separate component, but this component constantly risks starting to refer to the customer base and their order history to decide which letter to send and eventually learn to play the piano (I'm sure, I once taught). <br><br>  And now everything works somehow (and this is just the beginning): <br><br><img src="https://habrastorage.org/files/a60/7af/e56/a607afe5624b413a812774b073531a09.png"><br><br>  To continue, I hope that the problem is clear and even familiar. <br><br>  But suddenly the intelligible leadership not only heard about this problem, nor provided the ‚Äúgreen light‚Äù on its solution.  Attraction of generosity: the whole developer, a specialist in mailings, generating reports with charts and Excel uploads.  Or you are a happy owner of an offer to develop a project from scratch.  What would now be TK to make up in order to ‚Äúforget‚Äù about the influence of marketing activity on the main (clear and stable) business process? <br><br><h5>  <b>The solution is, you can not eat</b> </h5><br><br>  I propose one of the solutions that will satisfy the developers supporting the principles of SOLID, design patterns, TDD and DDD, and other beautiful terms.  This decision was born out of the confidence that you can always just take ... and put the marketing functionality behind the door of your important client process (and never let it in). <br><br>  And of course to make it happen.  We take marketing, we ask it to move away from our simple system into a corner, and we begin to rush information there: <br><br><img src="https://habrastorage.org/files/2e5/ec8/e3c/2e5ec8e3c496490e8014009d967c3557.png"><br><br>  Now all tasks from the list ‚ÄúBut marketing comes and speaks‚Äù can be solved separately.  Your main system is pristine marketing; it can solve its problems by itself, send letters and decide when to do it.  It has much more basic data than in the ‚Äúclean‚Äù database of the project.  Because when receiving event data, the analytic module can decompose them into detailed lists and even perform all related actions (send a letter, in our case): <br><br><ul><li>  save in separate fields year-month-day to facilitate future reports / cuts; </li><li>  accumulate history counters (for example, which account of the product was looked at by this customer?); </li><li>  trace in detail the behavioral chain of a particular client; </li><li>  whether he did it in one session or if the chain of actions needs to be interrupted; </li><li>  send all necessary information to external analytics; </li><li>  on the basis of the client‚Äôs behavior history and the source of its appearance, form the correct letter; </li><li>  create a list of popular products / services, ‚Äúoften buy with this product‚Äù; </li><li>  and so on and so forth. </li></ul><br><br>  Imagine if all these nuances are calculated on the fly (or later in the reporting scripts) and stored in the main database? <br><br>  In our scheme, the conditional task ‚Äúto send a letter‚Äù becomes separated and does not threaten the main process.  It turns out quite a CRM module (and analysis, decision making, and their execution), which can even be outrageous curves, with a terrible (for its tasks) denormalized base, a bunch of all sorts of different auxiliary fields in the tables, brakes, poorly written code ... But this is not important, because it is far away in the ‚Äúmarketing corner‚Äù (ideally, physically on another server) and does not concern the client process. <br><br><img src="https://habrastorage.org/files/839/6d7/e5e/8396d7e5e80345229bcb8d69c0b3e44f.png"><br><br>  And there is nothing special about this decision.  The result was a familiar ‚Äúobserver‚Äù pattern with throwing events and listening to them.  But in our case, it is impossible to implement the pattern ‚Äúon the spot‚Äù, when events are heard and executed by the same process that accepted the request from the client, since  if we mingle in the ‚Äúlistener‚Äù, then the 500th errors will come back from it just like without any patterns. <br><br>  Therefore, the approach will be good only when: <br><br><ul><li>  you make it asynchronous and fast; </li><li>  and on a separate server resource code + database (a separate project); </li><li>  you will also need a database with backup copies (this is in addition to the main database of the analytical module itself); </li><li>  and the support of this structure will be needed as a whole project ... </li></ul><br><br>  Ha!  - you think.  Is the game worth the candle?  We try to evaluate the pros and cons of implementing a separate ‚Äúanalytical project‚Äù: <br><br><img src="https://habrastorage.org/files/0cc/b3b/706/0ccb3b70646d4af197df4766b168cc04.png"><br><br>  Interestingly it turns out.  All the disadvantages of a ‚Äúseparate project‚Äù are only in the need to complicate the server-software infrastructure and implement the project‚Äôs core for analytics, which will provide interfaces for reading events and storing them in their database (from a week to a month in especially neglected cases of this kernel).  About minus synchronization - just below. <br><br>  The fact that the decision to ‚Äúdo so‚Äù depends on the project and its business models.  And the fact that it is not for nothing that projects are more serious are purchasing very expensive (in implementation and support) customer / order / warehouse management systems and so on.  And in no case do not trust this work online site.  In this way, we also separate ‚Äúprimary‚Äù marketing with all its frantic (sometimes disposable) ideas and complex reports. <br><br>  And this is the most separate project: <br><br><img src="https://habrastorage.org/files/b15/e1c/973/b15e1c973bef42e6946f9d5d3848a768.png"><br><br>  Instead of implementing complex analytics and indirect processes in the main project, we transfer this responsibility to the analytical project, realizing only reliable transport for events (red legend).  This will need to be done once and sometimes maintained.  The support will include the tasks of emitting new events from the main project and reading them on the analytical project.  But agree: in the case of programming these actions within the main project there will be no less work, and the risks of breaking something in it are much more. <br><br><h5>  <b>A pair of dessert spoons of high quality tar</b> </h5><br><br>  There is a significant disadvantage in this approach.  The main project does not need to know anything about the existence of an analytical project (otherwise the point?).  But with the analytical situation the opposite.  He will most likely need to know all the processes of the main one (since he was invented to solve all the tasks that he did not want to solve). <br><br>  Therefore, in the development process, firstly, it will be difficult (and often impossible) to solve problems simultaneously on both.  In the main project, new events will appear - and in the analytical one they will be processed much later.  Secondly, a software error or insufficient denormalization may occur in parsing data from the queue on the analytic server, and the tasks have already been read ... ‚Äúthe train has left‚Äù. <br><br>  To solve this problem, an ‚Äúevent database‚Äù is conceived, which stores them (events) everything from the beginning of time, including (importantly) the photographic context (in which these events occurred).  This is necessary both for peace of mind and then, so as a last resort, you can always perform a full reload of the created matrix: <br><br><ul><li>  On the analytical project errors are corrected and necessary corrections are made (before deployment) </li><li>  Next, the deployment script runs: </li><li><ul><li>  We stop reading data from the queue (let it be accumulated). </li><li>  Fully clean analytical database </li><li>  We post all the necessary fixes </li><li>  We launch a special script, which in a separate queue (constantly read) will send all previously occurring events. </li><li>  The reading of data from the main queue is turned on again. </li></ul><br></li><li>  As a result, the analytical ‚Äúworker‚Äù takes data from the queue as if nothing had happened. </li></ul><br><br>  There is another obvious disadvantage - it is the complexity of implementation.  If you decide to do so, and you have everything ‚Äúvery long and bad,‚Äù there are few options and you will have to think a lot about them: <br><br><ul><li>  Refuse analytics in the past tense (events are accumulated only since the launch of the analytical project). </li><li>  Implement the proposed scheme in parallel with the current analytical developments (general analytics - they continue to live in the main project, new things in the new one). </li><li>  Load the data into the ‚Äúevent database‚Äù with one-time scripts for all of the previously past time (we imitate the life cycle of sending events in hindsight). </li></ul><br><br><h5>  <b>But there are six bonuses too.</b> </h5><br><br>  Based on reading the flow of events from the main system, you can implement <br><br><ul><li>  and convenient process logs (for technical / customer support operators - notice / warning / error); </li><li>  asynchronous distribution of events by project personnel (notification, reminders; need to call the client, check the order, etc.); </li><li>  asynchronous distribution of commercial notifications (sms, emails, push) to customers; </li><li>  generation of streams of ‚Äúsecondary‚Äù events according to the conditions of analytics (the 99th client in this quarter with a check of more than 1000 - send a ‚Äúletter of happiness‚Äù); </li><li>  simple data overload into existing OLAP analysis systems (QlikView, MS Business Solutions) anytime and any number of times - and no pain in generating interfaces for marketing and business analysis; </li><li>  simple garter and aggregation of external sources of events and data into a single database (Yandex-metric, etc.); </li><li>  simply issuing access to external partners (to the same call center, they will not ‚Äúsit‚Äù in the core of your project); </li><li>  and so on. </li></ul></div><p>Source: <a href="https://habr.com/ru/post/236943/">https://habr.com/ru/post/236943/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../236927/index.html">Developer Adventures in the Marketing World</a></li>
<li><a href="../236929/index.html">New PhpStorm 8: developing together. Blade, Behat, WordPress support, remote PHP interpreters, and more</a></li>
<li><a href="../236935/index.html">New update for Nokia X2 has been released</a></li>
<li><a href="../236939/index.html">We export comments and ratings from Google Play for analysis.</a></li>
<li><a href="../236941/index.html">Mailing lists: civilized collection and cleaning lists</a></li>
<li><a href="../236945/index.html">Brain Training and Its Gamification</a></li>
<li><a href="../236947/index.html">Luminous BT Smart Bulb: What's Inside the Smart Bulb? Review + disassembly for parts</a></li>
<li><a href="../236949/index.html">What is sponsorship?</a></li>
<li><a href="../236951/index.html">Sensoritorik, or the difficulties of creating a "smart home"</a></li>
<li><a href="../236953/index.html">The right bag for the right boom</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>