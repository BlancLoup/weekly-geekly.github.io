<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Overview of new features in NDepend 6</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="What is NDepend has already been discussed in Habr√© - this is a static code analyzer on .NET. Recently a new version has been released - the 6th versi...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Overview of new features in NDepend 6</h1><div class="post__text post__text-html js-mediator-article">  What is NDepend has already been <a href="http://habrahabr.ru/post/70387/">discussed</a> in Habr√© - this is a static code analyzer on .NET.  Recently a new version has been released - the 6th version of this wonderful utility, about which new features are described below.  This is a translation, the original article is <a href="http://blog.ndepend.com/ndepend-version-6-insights/">here</a> . <br><a name="habracut"></a><br><h4>  The right choice of new features </h4><br>  Recently <a href="http://www.ndepend.com/ndepend-v6">released NDepend 6</a> .  Until now, the release of major releases was scheduled for a while after the release of Visual Studio, and now Visual Studio 2015 is in the pre-release state.  NDepend 6 is the result of hard work for 18 months.  After <a href="http://www.ndepend.com/release-notes">11 years of development,</a> NDepend has reached a certain level of maturity, but there are still many possibilities and improvements that can be made.  And for version 6, the most sensitive issue was the choice of new features and improvements for users.  Since version 5 was released in 2013, ideas have been received with <a href="https://visualstudio.uservoice.com/forums/121579-visual-studio/filters/top">Visual Studio User Voices</a> and <a href="http://ndepend.uservoice.com/forums/226344-ndepend-user-voice/filters/top">NDepend User Voices</a> .  As a matter of fact, the <a href="http://www.ndepend.com/ndepend-v6">new features of the 6th version</a> well reflect the <a href="http://ndepend.uservoice.com/forums/226344-ndepend-user-voice/status/1106390">most requested features</a> that have been completed. <br><br><h4>  Integration into the assembly process </h4><br>  Users asked for greater integration of NDepend into the auto build process.  They ran <a href="http://www.ndepend.com/docs/ndepend-console">NDepend.Console.exe</a> to collect information and <a href="http://www.ndepend.com/sample-reports/">report</a> on whether the <a href="http://www.ndepend.com/docs/critical-cqlinq-rule">important rules</a> that the build process is considered unsuccessful are violated (this information can be obtained by return code from NDepend.Console.exe).  Users requested to show more information directly in the build tools.  There are many build technologies, the most requested of which are <a href="http://www.ndepend.com/docs/tfs-integration-ndepend">TFS</a> , <a href="http://www.ndepend.com/docs/teamcity-integration-ndepend">TeamCity</a> and <a href="http://www.ndepend.com/docs/sonarqube-integration-ndepend">SonarQube</a> .  As a result, the developers collaborated with the high-class experts of these technologies to make embedded integration, which presumably includes the majority of usage scenarios, and which will be supported for future versions and receive new features. <br><br><h4>  Improved integration with Visual Studio </h4><br>  Since  Since users wanted more integration with the build process, over the past year, efforts have mostly been focused on tools for Visual Studio.  NDepend was integrated into Visual Studio using VS Addin technology - this decision was made by the development team in 2009.  At that time, VSIX (another stop of developing extensions for the studio) was raw, and VS2008 and VS2005 also had to be supported, so VS Addin was the right choice.  Over the years, VS Addin has become less and less relevant, has not received improvements from Microsoft, and led to crashes, but most importantly, it was not possible to remember the location of the NDepend windows during execution.  This gave users great inconvenience and ended with requests for <a href="https://ndepend.uservoice.com/forums/226344-ndepend-user-voice/suggestions/5564192-remember-window-layouts">User Voice to remember the location of the windows</a> . 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Starting with version 6, NDepend is based on VSIX technology for integration into VS 2015, 2013, 2012 and 2010. In addition, Microsoft has banned the use of VS Addin in 2015 studios.  In any case, thanks to VSIX, it became possible to make a more smooth and reliable integration with Visual Studio, with remembering windows, new features (for example, attaching the NDepend project to .suo (and not just to .sln), and full support for hot keys). <br><br>  Also, there were three features provided by free studio extensions that were included in NDepend so that they were always at hand. <br><br><img src="https://habrastorage.org/files/73c/17d/871/73c17d8710a947cebd5405ae5c7bbe39.png"><br><br><h4>  Rule improvements </h4><br>  Rules for .NET code are the main features of NDepend.  Users have left a lot of feedback on how to improve existing rules, mostly to reduce false positives.  Therefore, about a third of the default rules were redone in accordance with their recommendations. <br><br>  It's great that the code rules are mutable <a href="http://www.ndepend.com/features/cqlinq">C # LINQ requests</a> that contain few comments.  But for many users, they were not informative enough about why the rule creates a warning, why compliance with a particular rule will improve the code, and how to fix a violation of the rule.  Therefore, the ability to add 2 formatted text to the source code of the NDepend rule through the <code>&lt;Description&gt;</code> and <code>&lt;HowToFix&gt;</code> .  This is a good opportunity to describe each rule by default and explain it in more detail to the user.  Both in the interface and in the report the user can choose what to watch - Description / HowToFix or the source code of the rule in C # LINQ. <br><br><img src="https://habrastorage.org/files/420/7df/2f5/4207df2f5ba94788a66150531d125a4a.png"><br><br>  Another user need was to make the rules available between several NDepend projects.  Typically, a company has several projects analyzed with NDepend, and users want to manage them all at once.  And taking into account that on NDepend it is easier to write your own rules for .NET code than anywhere else, users wanted the ability to use one profile for different projects.  Therefore, in NDepend 6 it is possible to define a list of rules that can be used together in NDepend projects. <br><br><img src="https://habrastorage.org/files/64b/51f/b47/64b51fb477a446d5a6ddb0b2d0fb188b.png"><br><br><h4>  Visualization of code metrics </h4><br>  In NDepend, the visualization of code metrics using <a href="https://en.wikipedia.org/wiki/Treemapping">treemap</a> was already <a href="https://en.wikipedia.org/wiki/Treemapping">done</a> , and it was decided to add a coloring.  The idea is that you can show two code metrics.  One is represented by a rectangular area, and the other by the color of the rectangle.  For example, the following picture shows the coverage of the NDepend code with 6 tests in a specific but convenient and accurate way. <br><br><ul><li>  Rectangles are methods </li><li>  Rectangular areas are proportional to the number of lines of code, </li><li>  The color of the rectangle - the percentage of code coverage tests. </li></ul><br><img src="https://habrastorage.org/files/6db/beb/006/6dbbeb006912471fb6221df79bbf44b0.png"><br><br>  Having looked, it is immediately clear that a colored treemap can help to understand information that would be difficult to understand in another way.  Despite the fact that the NDepend code is covered with tests for 82%, you can see clusters of red rectangles that show code that is not sufficiently covered with tests.  Probably there is no longer a tool that can show it with such precision. <br><br>  NDepend developers are trying to make product capabilities coherent.  Therefore, you can visualize not only any two of the many <a href="http://www.ndepend.com/docs/code-metrics">NDepend'a metrics</a> , but also your own code metrics, <a href="http://www.ndepend.com/docs/treemap-visualization-of-code-metrics">described via LINQ queries in C #</a> , and you can also highlight the final code of the rule or query.  As a result, if you request complex methods, you can display them on a color treemap: <br><br><img src="https://habrastorage.org/files/cee/5cd/a1f/cee5cda1fc5a41f8845d24331f4fe13b.jpg"><br><br>  It is worth noting that  code coverage with tests is one of the most important quality indicators, a separate interface was also added for this in the results of the query code: <br><br><img src="https://habrastorage.org/files/71d/6df/c95/71d6dfc95432416c88f9a4c6292cdd3a.png"><br><br><h4>  What else had to be done </h4><br>  The product is in a constantly changing environment.  This means that some features that work well before should be revised.  Some of these needed improvements were made in NDepend version 6. <br><br>  <b>Supporting code generated by the C # and VB.NET compiler:</b> More and more sugar appeared from version to version in C # and VB.NET.  It started with anonymous methods and iterators in C # 2.0.  Then came the lambdas and anonymous types in C # 3.0, and then async / await in C # 5.0.  These constructs force the compiler to generate additional methods and types.  And since  these constructs are quite often used, these generated elements accumulate in the IL code.  And <a href="http://www.ndepend.com/docs/ndepend-analysis-inputs-explanation">NDepend mainly relies on IL code to get information about the code</a> .  Therefore, the NDepend code model includes all the generated methods and types, and this annoys the user, who is mostly interested only in his code.  Now NDepend fixes this.  Just getting rid of all these generated elements is not an option, because  they actually contain some custom code.  Therefore, some heuristics have been developed to combine these generated elements with custom classes and methods that contain the code for which it is generated by the compiler.  Thus, there was no need to compromise - all code model data was saved, including code metrics (number of lines, percentage of coverage, cyclomatic complexity, ...), dependencies, and differences. <br><br>  <b>Improved async support:</b> Asynchronous constructs have specificity, which caused some difficulties with NDepend.  Custom code, in fact, is embedded by the compiler in the generated method, which overrides the virtual method <a href="https://msdn.microsoft.com/en-us/library/system.runtime.compilerservices.iasyncstatemachine.movenext(v%3Dvs.110).aspx">IAsyncStateMachine.MoveNext ()</a> .  Therefore, the IL code that calls this generated MoveNext () method is associated with the abstract interface method, and not with the implementation.  Calls to the asynchronous method are lost in the IL code ... and, therefore, in the NDepend code model.  Thanks to the heuristics written for the preceding paragraph, NDepend is now able to analyze and identify the correct calling asynchronous methods. <br><br>  <b>High-resolution support:</b> Now <b>high-resolution</b> monitors (such as 4K) are becoming available and, as a result, more and more developers are working with the appropriate Windows settings.  This means that the pixel density is higher and, therefore, more pixels are used to display the graphic element (text, picture).  NDepend's interface is mainly based on the Windows Form and GDI +, and these technologies by default do not scale well when Windows is configured for high resolution.  When users started reporting this problem, it was decided to remake the entire NDepend interface so that it could work with resolution settings from 100% to 250%.  It was an opportunity to improve some graphical elements and learn some ways to work with Windows Form and GDI + at high resolution.  The results of this will be described in a future article on the NDepend blog, because  On the Internet, it is clear that this is a problem for many developers. <br><br>  <b>Topics in Visual Studio:</b> Statistics show that most users use NDepend from Visual Studio.  Therefore, the themes of the NDepend interface are not very well combined with standard Visual Studio themes, such as Light, Dark, Blue, and VS2010 Standard Theme.  Fortunately, in NDepend menu items, panels, bindings ... are based on the <a href="https://www.devexpress.com/Products/NET/Controls/WinForms/">DevExpress WinForm</a> library and their latest version includes these themes (and not only).  Therefore, a simple update to the latest version helped. <br><br>  <b>Analysis Improvement:</b> Some improvements should have been made regarding the analysis.  The NDepend project references some directories and assembly names (without a file extension).  During the analysis, the location of the assemblies for analysis was in the following two ways.  If many copies of the assembly are found, then if they are all the same, then NDepend took one of them, and if they were different, then NDepend reported an error, because  This situation is considered a serious problem of deploying a solution.  But over time, new technologies, such as Windows Phone or Portable Class Libraries, appeared, and they led to this situation during proper operation.  Therefore, when such a situation is detected, NDepend 6 now uses heuristic analysis to find the correct build based on its version, dependencies, and file size. </div><p>Source: <a href="https://habr.com/ru/post/261265/">https://habr.com/ru/post/261265/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../261253/index.html">"Programming a mouse" for microcontrollers</a></li>
<li><a href="../261255/index.html">Sberbank Security Online</a></li>
<li><a href="../261257/index.html">220 Volt AC Voltage Regulator</a></li>
<li><a href="../261259/index.html">Yandex-Transfer in the terminal via Java</a></li>
<li><a href="../261263/index.html">"Pip -t" is a simple alternative to virtualenv</a></li>
<li><a href="../261267/index.html">Microservice design</a></li>
<li><a href="../261271/index.html">Setting up security sites on VPS / VDS</a></li>
<li><a href="../261273/index.html">Such amazing semaphores</a></li>
<li><a href="../261275/index.html">Key trends in the development of mobile applications, which is worth remembering in 2015</a></li>
<li><a href="../261277/index.html">Detailed App Store Optimization Guide for 2015 - Part 2: Google Play Store</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>