<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Conceptual sorting in C ++ 20</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="It is better to prepare for changes in advance, so I suggest looking at what will be included in the C ++ 20 standard, namely, on concepts . 
 Concept...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Conceptual sorting in C ++ 20</h1><div class="post__text post__text-html js-mediator-article"><p>  It is better to prepare for changes in advance, so I suggest looking at what will be included in the C ++ 20 standard, namely, on <strong>concepts</strong> . </p><a name="habracut"></a><br><h4 id="status-koncepciy">  Concept Status </h4><br><p>  Now concepts have the status of a technical specification ( <em>TS: technical specification</em> ): a document describing <a href="http://www.iso.org/standard/64031.html">ISO / IEC TS 19217: 2015</a> .  Such documents are needed so that before adopting innovations in the language standard, these innovations are tested and adjusted by the C ++ community.  The gcc compiler has been supporting experimental concept technical specifications since 2015. </p><br><p>  It is worth noting that the concepts from the technical specifications and the concepts from the current draft C ++ 20 are different, but not much.  The article discusses the option of technical specifications. </p><br><h4 id="teoriya">  Theory </h4><br><p>  Class and function templates may be subject to <strong>restrictions</strong> .  Restrictions impose requirements on template arguments.  Concepts are named sets of such constraints.  Each concept is a Boolean function ( <em>predicate</em> ) that tests these constraints.  The check is performed at the compilation stage when the template associated with the concept or constraint is installed.  If such a check fails, the compiler will indicate which template argument failed to check which constraint. </p><br><h4 id="praktika">  Practice </h4><br><p>  Now that the meaning and purpose of the concepts are clear, we can consider the syntax.  Concept definitions have two forms: variable and function.  We will be interested in the form of the variable.  It is very similar to the definition of a regular template variable, but with the <strong>concept</strong> keyword. </p><br><pre><code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">template</span></span>&lt;<span class="hljs-keyword"><span class="hljs-keyword">typename</span></span> T&gt; concept <span class="hljs-keyword"><span class="hljs-keyword">bool</span></span> MyConcept = <span class="hljs-comment"><span class="hljs-comment">/* ... */</span></span>;</code> </pre> <br><p>  Instead of a comment, you need to write constexpr expression, which is given to bool.  This expression is a constraint on the template argument.  To limit a template to a concept, you need to use its name instead of typename (or class). </p><br><p>  For example, for integers: </p><br><pre> <code class="cpp hljs"><span class="hljs-comment"><span class="hljs-comment">// (         //     ) #include &lt;type_traits&gt; template&lt;typename T&gt; //    concept bool MyIntegral = std::is_integral&lt;T&gt;::value; //template &lt;typename T&gt; template&lt;MyIntegral T&gt; bool compare (T a, T b) { return a &lt; b; } void foo () { compare (123u, 321u); /// OK compare (1.0, 2.0); /** :    MyIntegral (std::is_integral&lt;double&gt;::value = false) */ }</span></span></code> </pre> <br><p>  You can set more complex restrictions using the requirement-expression ( <em>requires-expression</em> ).  An expression request can verify the correctness ( <em>well-formed</em> ) of an expression, the return value of an expression, the presence of types.  The syntax is well understood <a href="http://en.cppreference.com/w/cpp/language/constraints">here</a> . </p><br><pre> <code class="cpp hljs"><span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">&lt;unordered_set&gt; #include &lt;vector&gt; template&lt;typename T&gt; concept bool MyComparable = requires (T a, T b) { a &lt; b; /// ,     { a &lt; b } -&gt; bool; /// ,      bool }; template&lt;MyComparable T&gt; bool compare (T a, T b) { return a &lt; b; } void foo () { std::vector&lt;int&gt; vecA = {1, 2, 3}, vecB = {1, 2, 4}; std::unordered_set&lt;int&gt; setA = {1, 2, 3}, setB = {1, 2, 4}; compare (vecA, vecB); /// OK compare (setA, setB); /**    MyComparable std::unordered_set    .  ( a &lt; b )  . */ }</span></span></span></span></code> </pre> <br><h4 id="sortirovka">  Sorting </h4><br><p>  How can concepts help in writing sorting?  The algorithm itself will remain unchanged, but the sorting pattern can be enhanced with concepts.  Consider this example: </p><br><pre> <code class="cpp hljs"><span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">&lt;algorithm&gt; struct NonComparable {}; int main () { std::vector&lt;NonComparable&gt; vector = {{}, {}, {}, {}, {}, {}, {}, {}}; std::sort (vector.begin(), vector.end()); //  }</span></span></span></span></code> </pre> <br><p>  The error is that the NonComparable structure does not have a comparison operation.  Imagine what a compiler error will look like?  If not, look under the spoiler. </p><br><div class="spoiler">  <b class="spoiler_title">gcc (7.2.1) CentOS</b> <div class="spoiler_text"><pre> <code class="hljs pgsql">[username@localhost concepts]$ g++ -std=c++<span class="hljs-number"><span class="hljs-number">17</span></span> main.cpp <span class="hljs-keyword"><span class="hljs-keyword">In</span></span> file included <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> /opt/rh/devtoolset<span class="hljs-number"><span class="hljs-number">-7</span></span>/root/usr/<span class="hljs-keyword"><span class="hljs-keyword">include</span></span>/c++/<span class="hljs-number"><span class="hljs-number">7</span></span>/bits/stl_algobase.h:<span class="hljs-number"><span class="hljs-number">71</span></span>:<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> /opt/rh/devtoolset<span class="hljs-number"><span class="hljs-number">-7</span></span>/root/usr/<span class="hljs-keyword"><span class="hljs-keyword">include</span></span>/c++/<span class="hljs-number"><span class="hljs-number">7</span></span>/vector:<span class="hljs-number"><span class="hljs-number">60</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> main.cpp:<span class="hljs-number"><span class="hljs-number">1</span></span>: /opt/rh/devtoolset<span class="hljs-number"><span class="hljs-number">-7</span></span>/root/usr/<span class="hljs-keyword"><span class="hljs-keyword">include</span></span>/c++/<span class="hljs-number"><span class="hljs-number">7</span></span>/bits/predefined_ops.h: <span class="hljs-keyword"><span class="hljs-keyword">In</span></span> instantiation <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> <span class="hljs-string"><span class="hljs-string">'constexpr bool __gnu_cxx::__ops::_Iter_less_iter::operator()(_Iterator1, _Iterator2) const [with _Iterator1 = __gnu_cxx::__normal_iterator&lt;NonComparable*, std::vector&lt;NonComparable&gt; &gt;; _Iterator2 = __gnu_cxx::__normal_iterator&lt;NonComparable*, std::vector&lt;NonComparable&gt; &gt;]'</span></span>: /opt/rh/devtoolset<span class="hljs-number"><span class="hljs-number">-7</span></span>/root/usr/<span class="hljs-keyword"><span class="hljs-keyword">include</span></span>/c++/<span class="hljs-number"><span class="hljs-number">7</span></span>/bits/stl_algo.h:<span class="hljs-number"><span class="hljs-number">81</span></span>:<span class="hljs-number"><span class="hljs-number">17</span></span>: required <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'void std::__move_median_to_first(_Iterator, _Iterator, _Iterator, _Iterator, _Compare) [with _Iterator = __gnu_cxx::__normal_iterator&lt;NonComparable*, std::vector&lt;NonComparable&gt; &gt;; _Compare = __gnu_cxx::__ops::_Iter_less_iter]'</span></span> /opt/rh/devtoolset<span class="hljs-number"><span class="hljs-number">-7</span></span>/root/usr/<span class="hljs-keyword"><span class="hljs-keyword">include</span></span>/c++/<span class="hljs-number"><span class="hljs-number">7</span></span>/bits/stl_algo.h:<span class="hljs-number"><span class="hljs-number">1921</span></span>:<span class="hljs-number"><span class="hljs-number">34</span></span>: required <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'_RandomAccessIterator std::__unguarded_partition_pivot(_RandomAccessIterator, _RandomAccessIterator, _Compare) [with _RandomAccessIterator = __gnu_cxx::__normal_iterator&lt;NonComparable*, std::vector&lt;NonComparable&gt; &gt;; _Compare = __gnu_cxx::__ops::_Iter_less_iter]'</span></span> /opt/rh/devtoolset<span class="hljs-number"><span class="hljs-number">-7</span></span>/root/usr/<span class="hljs-keyword"><span class="hljs-keyword">include</span></span>/c++/<span class="hljs-number"><span class="hljs-number">7</span></span>/bits/stl_algo.h:<span class="hljs-number"><span class="hljs-number">1953</span></span>:<span class="hljs-number"><span class="hljs-number">38</span></span>: required <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'void std::__introsort_loop(_RandomAccessIterator, _RandomAccessIterator, _Size, _Compare) [with _RandomAccessIterator = __gnu_cxx::__normal_iterator&lt;NonComparable*, std::vector&lt;NonComparable&gt; &gt;; _Size = long int; _Compare = __gnu_cxx::__ops::_Iter_less_iter]'</span></span> /opt/rh/devtoolset<span class="hljs-number"><span class="hljs-number">-7</span></span>/root/usr/<span class="hljs-keyword"><span class="hljs-keyword">include</span></span>/c++/<span class="hljs-number"><span class="hljs-number">7</span></span>/bits/stl_algo.h:<span class="hljs-number"><span class="hljs-number">1968</span></span>:<span class="hljs-number"><span class="hljs-number">25</span></span>: required <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'void std::__sort(_RandomAccessIterator, _RandomAccessIterator, _Compare) [with _RandomAccessIterator = __gnu_cxx::__normal_iterator&lt;NonComparable*, std::vector&lt;NonComparable&gt; &gt;; _Compare = __gnu_cxx::__ops::_Iter_less_iter]'</span></span> /opt/rh/devtoolset<span class="hljs-number"><span class="hljs-number">-7</span></span>/root/usr/<span class="hljs-keyword"><span class="hljs-keyword">include</span></span>/c++/<span class="hljs-number"><span class="hljs-number">7</span></span>/bits/stl_algo.h:<span class="hljs-number"><span class="hljs-number">4836</span></span>:<span class="hljs-number"><span class="hljs-number">18</span></span>: required <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'void std::sort(_RAIter, _RAIter) [with _RAIter = __gnu_cxx::__normal_iterator&lt;NonComparable*, std::vector&lt;NonComparable&gt; &gt;]'</span></span> main.cpp:<span class="hljs-number"><span class="hljs-number">6</span></span>:<span class="hljs-number"><span class="hljs-number">44</span></span>: required <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> here /opt/rh/devtoolset<span class="hljs-number"><span class="hljs-number">-7</span></span>/root/usr/<span class="hljs-keyword"><span class="hljs-keyword">include</span></span>/c++/<span class="hljs-number"><span class="hljs-number">7</span></span>/bits/predefined_ops.h:<span class="hljs-number"><span class="hljs-number">43</span></span>:<span class="hljs-number"><span class="hljs-number">23</span></span>: error: <span class="hljs-keyword"><span class="hljs-keyword">no</span></span> match <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> <span class="hljs-string"><span class="hljs-string">'operator&lt;'</span></span> (operand <span class="hljs-keyword"><span class="hljs-keyword">types</span></span> are <span class="hljs-string"><span class="hljs-string">'NonComparable'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> <span class="hljs-string"><span class="hljs-string">'NonComparable'</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> *__it1 &lt; *__it2; } ~~~~~~~^~~~~~~~ <span class="hljs-keyword"><span class="hljs-keyword">In</span></span> file included <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> /opt/rh/devtoolset<span class="hljs-number"><span class="hljs-number">-7</span></span>/root/usr/<span class="hljs-keyword"><span class="hljs-keyword">include</span></span>/c++/<span class="hljs-number"><span class="hljs-number">7</span></span>/bits/stl_algobase.h:<span class="hljs-number"><span class="hljs-number">67</span></span>:<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> /opt/rh/devtoolset<span class="hljs-number"><span class="hljs-number">-7</span></span>/root/usr/<span class="hljs-keyword"><span class="hljs-keyword">include</span></span>/c++/<span class="hljs-number"><span class="hljs-number">7</span></span>/vector:<span class="hljs-number"><span class="hljs-number">60</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> main.cpp:<span class="hljs-number"><span class="hljs-number">1</span></span>: /opt/rh/devtoolset<span class="hljs-number"><span class="hljs-number">-7</span></span>/root/usr/<span class="hljs-keyword"><span class="hljs-keyword">include</span></span>/c++/<span class="hljs-number"><span class="hljs-number">7</span></span>/bits/stl_iterator.h:<span class="hljs-number"><span class="hljs-number">888</span></span>:<span class="hljs-number"><span class="hljs-number">5</span></span>: note: candidate: <span class="hljs-keyword"><span class="hljs-keyword">template</span></span>&lt;<span class="hljs-keyword"><span class="hljs-keyword">class</span></span> _IteratorL, <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> _IteratorR, <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> _Container&gt; <span class="hljs-type"><span class="hljs-type">bool</span></span> __gnu_cxx::<span class="hljs-keyword"><span class="hljs-keyword">operator</span></span>&lt;(const __gnu_cxx::__normal_iterator&lt;_IteratorL, _Container&gt;&amp;, const __gnu_cxx::__normal_iterator&lt;_IteratorR, _Container&gt;&amp;) <span class="hljs-keyword"><span class="hljs-keyword">operator</span></span>&lt;(const __normal_iterator&lt;_IteratorL, _Container&gt;&amp; __lhs, ^~~~~~~~ /opt/rh/devtoolset<span class="hljs-number"><span class="hljs-number">-7</span></span>/root/usr/<span class="hljs-keyword"><span class="hljs-keyword">include</span></span>/c++/<span class="hljs-number"><span class="hljs-number">7</span></span>/bits/stl_iterator.h:<span class="hljs-number"><span class="hljs-number">888</span></span>:<span class="hljs-number"><span class="hljs-number">5</span></span>: note: <span class="hljs-keyword"><span class="hljs-keyword">template</span></span> argument deduction/substitution failed: <span class="hljs-keyword"><span class="hljs-keyword">In</span></span> file included <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> /opt/rh/devtoolset<span class="hljs-number"><span class="hljs-number">-7</span></span>/root/usr/<span class="hljs-keyword"><span class="hljs-keyword">include</span></span>/c++/<span class="hljs-number"><span class="hljs-number">7</span></span>/bits/stl_algobase.h:<span class="hljs-number"><span class="hljs-number">71</span></span>:<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> /opt/rh/devtoolset<span class="hljs-number"><span class="hljs-number">-7</span></span>/root/usr/<span class="hljs-keyword"><span class="hljs-keyword">include</span></span>/c++/<span class="hljs-number"><span class="hljs-number">7</span></span>/vector:<span class="hljs-number"><span class="hljs-number">60</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> main.cpp:<span class="hljs-number"><span class="hljs-number">1</span></span>: /opt/rh/devtoolset<span class="hljs-number"><span class="hljs-number">-7</span></span>/root/usr/<span class="hljs-keyword"><span class="hljs-keyword">include</span></span>/c++/<span class="hljs-number"><span class="hljs-number">7</span></span>/bits/predefined_ops.h:<span class="hljs-number"><span class="hljs-number">43</span></span>:<span class="hljs-number"><span class="hljs-number">23</span></span>: note: <span class="hljs-string"><span class="hljs-string">'NonComparable'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> derived <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'const __gnu_cxx::__normal_iterator&lt;_IteratorL, _Container&gt;'</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> *__it1 &lt; *__it2; } ~~~~~~~^~~~~~~~  ..</code> </pre> <br><p>  Such a small error in the code and such a big compiler. <del>  Abyd, yes!? </del></p></div></div><br><p>  Such errors can be reduced using concepts, for this we write a wrapper using them.  Sorting takes iterators, so you need to write the concept of an sortable iterator.  For such an iterator, you need a few smaller concepts.  For example, a comparable object (shown above), an exchangeable object: </p><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">template</span></span>&lt;<span class="hljs-keyword"><span class="hljs-keyword">typename</span></span> T&gt; concept <span class="hljs-keyword"><span class="hljs-keyword">bool</span></span> MySwappable = requires (T a, T b) { <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::swap(a, b); <span class="hljs-comment"><span class="hljs-comment">//   };</span></span></code> </pre> <br><p>  moving object </p><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">template</span></span>&lt;<span class="hljs-keyword"><span class="hljs-keyword">typename</span></span> T&gt; concept <span class="hljs-keyword"><span class="hljs-keyword">bool</span></span> MyMovable = requires (T a) { T (<span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::move(a)); <span class="hljs-comment"><span class="hljs-comment">//    a = std::move(a); //    };</span></span></code> </pre> <br><p>  random access iterator </p><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">template</span></span>&lt;<span class="hljs-keyword"><span class="hljs-keyword">typename</span></span> T&gt; concept <span class="hljs-keyword"><span class="hljs-keyword">bool</span></span> MyRAIterator = requires (T it) { <span class="hljs-keyword"><span class="hljs-keyword">typename</span></span> T::value_type; <span class="hljs-comment"><span class="hljs-comment">//       it++; //     Random Access  it--; it += 2; it -= 2; it = it + 2; it = it - 2; { *it } -&gt; typename T::value_type; //   };</span></span></code> </pre> <br><p>  When all the simple concepts are ready, you can define the composite concept of the Sortable Iterator: </p><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">template</span></span>&lt;<span class="hljs-keyword"><span class="hljs-keyword">typename</span></span> T&gt; concept <span class="hljs-keyword"><span class="hljs-keyword">bool</span></span> MySortableIterator = MyRAIterator&lt;T&gt; &amp;&amp; <span class="hljs-comment"><span class="hljs-comment">//    MyMovable&lt;typename T::value_type&gt; &amp;&amp; //   MyComparable&lt;typename T::value_type&gt; &amp;&amp; //   MySwappable&lt;typename T::value_type&gt;; //  </span></span></code> </pre> <br><p>  With it, a wrapper is written: </p><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">template</span></span>&lt;MySortableIterator T&gt; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">conceptualSort</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(T begin, T end)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::sort (begin, end); }</code> </pre> <br><p>  If you call a "conceptual" sort with an incomparable object, </p><br><pre> <code class="cpp hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">NonComparable</span></span></span><span class="hljs-class"> {</span></span>}; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">int</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">main</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::<span class="hljs-built_in"><span class="hljs-built_in">vector</span></span>&lt;NonComparable&gt; <span class="hljs-built_in"><span class="hljs-built_in">vector</span></span> = {{}, {}, {}, {}, {}, {}, {}, {}}; conceptualSort (<span class="hljs-built_in"><span class="hljs-built_in">vector</span></span>.begin(), <span class="hljs-built_in"><span class="hljs-built_in">vector</span></span>.end()); <span class="hljs-comment"><span class="hljs-comment">//  }</span></span></code> </pre> <br><p>  then the compilation error will take only 16 lines: </p><br><div class="spoiler">  <b class="spoiler_title">gcc (7.2.1) CentOS</b> <div class="spoiler_text"><pre> <code class="hljs pgsql">[markgrin@localhost concepts]$ g++ -std=c++<span class="hljs-number"><span class="hljs-number">17</span></span> -fconcepts main.cpp main.cpp: <span class="hljs-keyword"><span class="hljs-keyword">In</span></span> <span class="hljs-keyword"><span class="hljs-keyword">function</span></span> <span class="hljs-string"><span class="hljs-string">'int main()'</span></span>: main.cpp:<span class="hljs-number"><span class="hljs-number">49</span></span>:<span class="hljs-number"><span class="hljs-number">49</span></span>: error: cannot <span class="hljs-keyword"><span class="hljs-keyword">call</span></span> <span class="hljs-keyword"><span class="hljs-keyword">function</span></span> <span class="hljs-string"><span class="hljs-string">'void conceptualSort(T, T) [with T = __gnu_cxx::__normal_iterator&lt;NonComparable*, std::vector&lt;NonComparable&gt; &gt;]'</span></span> conceptualSort (vector.<span class="hljs-keyword"><span class="hljs-keyword">begin</span></span>(), vector.<span class="hljs-keyword"><span class="hljs-keyword">end</span></span>()); ^ main.cpp:<span class="hljs-number"><span class="hljs-number">41</span></span>:<span class="hljs-number"><span class="hljs-number">6</span></span>: note: constraints <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> satisfied <span class="hljs-type"><span class="hljs-type">void</span></span> conceptualSort (T <span class="hljs-keyword"><span class="hljs-keyword">begin</span></span>, T <span class="hljs-keyword"><span class="hljs-keyword">end</span></span>) { ^~~~~~~~~~~~~~ main.cpp:<span class="hljs-number"><span class="hljs-number">36</span></span>:<span class="hljs-number"><span class="hljs-number">14</span></span>: note: <span class="hljs-keyword"><span class="hljs-keyword">within</span></span> <span class="hljs-string"><span class="hljs-string">'template&lt;class T&gt; concept const bool MySortableIterator&lt;T&gt; [with T = __gnu_cxx::__normal_iterator&lt;NonComparable*, std::vector&lt;NonComparable&gt; &gt;]'</span></span> concept <span class="hljs-type"><span class="hljs-type">bool</span></span> MySortableIterator = MyRAIterator&lt;T&gt; &amp;&amp; MyMovable&lt;typename T::value_type&gt; &amp;&amp; ^~~~~~~~~~~~~~~~~~ main.cpp:<span class="hljs-number"><span class="hljs-number">12</span></span>:<span class="hljs-number"><span class="hljs-number">14</span></span>: note: <span class="hljs-keyword"><span class="hljs-keyword">within</span></span> <span class="hljs-string"><span class="hljs-string">'template&lt;class T&gt; concept const bool MyComparable&lt;T&gt; [with T = NonComparable]'</span></span> concept <span class="hljs-type"><span class="hljs-type">bool</span></span> MyComparable = requires (T a, T b) { ^~~~~~~~~~~~ main.cpp:<span class="hljs-number"><span class="hljs-number">12</span></span>:<span class="hljs-number"><span class="hljs-number">14</span></span>: note: <span class="hljs-keyword"><span class="hljs-keyword">with</span></span> <span class="hljs-string"><span class="hljs-string">'NonComparable a'</span></span> main.cpp:<span class="hljs-number"><span class="hljs-number">12</span></span>:<span class="hljs-number"><span class="hljs-number">14</span></span>: note: <span class="hljs-keyword"><span class="hljs-keyword">with</span></span> <span class="hljs-string"><span class="hljs-string">'NonComparable b'</span></span> main.cpp:<span class="hljs-number"><span class="hljs-number">12</span></span>:<span class="hljs-number"><span class="hljs-number">14</span></span>: note: the required expression <span class="hljs-string"><span class="hljs-string">'(a &lt; b)'</span></span> would be ill-formed</code> </pre> </div></div><br><p>  Of course, the first times it is still not very easy to understand what the error is, but after several "conceptual" errors, they begin to be read in a few seconds. </p><br><h4 id="zaklyuchenie">  Conclusion </h4><br><p>  Of course, <strong>reducing the length of errors is</strong> not the only advantage of innovation.  Patterns will be safer due to <strong>limitations</strong> .  The code will become more readable thanks to the <strong>named</strong> concepts (the most frequently used ones will be included in the <a href="http://en.cppreference.com/w/cpp/concept">library</a> ).  In general, C ++ will expand in its functional (template) part. </p></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <p>Source: <a href="https://habr.com/ru/post/348400/">https://habr.com/ru/post/348400/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../348390/index.html">Web typography: create tables for reading, not for beauty</a></li>
<li><a href="../348392/index.html">The obvious benefit: how and why to use the service approach beyond IT (Part 2)</a></li>
<li><a href="../348394/index.html">Notes on deploying Ruby on Rails Deployment on Google Cloud Kubernetes Engine</a></li>
<li><a href="../348396/index.html">How I hacked the bitcoin mining pool</a></li>
<li><a href="../348398/index.html">Product Design Digest, January 2018</a></li>
<li><a href="../348402/index.html">Nemesida WAF: intellectual protection against brute-force attacks</a></li>
<li><a href="../348404/index.html">How zadolbat all colleagues: collect requirements for CRM</a></li>
<li><a href="../348406/index.html">The most dangerous word in software development</a></li>
<li><a href="../348410/index.html">The book "Reactive design patterns"</a></li>
<li><a href="../348414/index.html">Threats of the past and future protocols</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>