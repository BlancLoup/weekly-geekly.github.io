<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>A brief overview of the innovations in Laravel 5.4</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Today was the entrance of the new version of the PHP framework Laravel - 5.4! The new version added features such as support for Markdown markup for g...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>A brief overview of the innovations in Laravel 5.4</h1><div class="post__text post__text-html js-mediator-article"><p><img src="https://habrastorage.org/files/4b2/3e8/d6c/4b23e8d6c08a45f4ac2d3263cb482b9e.png" alt="image"></p><br><p>  Today was the entrance of the new version of the PHP framework Laravel - 5.4!  The new version added features such as support for Markdown markup for generating emails and notifications, improved support for Redis, added new features for Blade template engine, and many others.  But first things first. </p><br><a name="habracut"></a><br><h3 id="markdown-razmetka-dlya-elektronnyh-pisem-i-uvedomleniy">  Markdown markup for emails and notifications </h3><br><p>  With Markdown support, Laravel can now generate beautiful and responsive HTML templates for emails, as well as generate a plain text version.  For example, now your code for generating a letter might look like this: </p><br><pre><code class="hljs kotlin"><span class="hljs-meta"><span class="hljs-meta">@component(</span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">'mail::message'</span></span></span><span class="hljs-meta">)</span></span> # Order Shipped Your order has been shipped! <span class="hljs-meta"><span class="hljs-meta">@component(</span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">'mail::button'</span></span></span><span class="hljs-meta">, [</span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">'url'</span></span></span><span class="hljs-meta"> =&gt; $url])</span></span> View Order <span class="hljs-meta"><span class="hljs-meta">@endcomponent</span></span> Next Steps: - Track Your Order On Our Website - Pre-Sign For Delivery Thanks,&lt;br&gt; {{ config(<span class="hljs-string"><span class="hljs-string">'app.name'</span></span>) }} <span class="hljs-meta"><span class="hljs-meta">@endcomponent</span></span></code> </pre> <br><p>  It will look like this: </p><br><p><img src="https://habrastorage.org/files/134/715/9f3/1347159f3a194d30a0699fd31bc01d2a.png" alt="image"></p><br><h3 id="laravel-dusk">  Laravel dusk </h3><br><p>  <strong>Laravel Dusk</strong> is a new utility for end-to-end application testing.  By default, to use it does not require the installation of JDK or Selenium.  Instead, Dusk uses the standalone version of ChromeDrive, but you can also use any other driver that is compatible with Selenium. </p><br><p>  Since Dusk uses a real browser for testing, you can easily test and interact with applications that use JavaScript: </p><br><pre> <code class="php hljs"><span class="hljs-comment"><span class="hljs-comment">/** * A basic browser test example. * * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@return</span></span></span><span class="hljs-comment"> void */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">testBasicExample</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ $user = factory(User::class)-&gt;create([ <span class="hljs-string"><span class="hljs-string">'email'</span></span> =&gt; <span class="hljs-string"><span class="hljs-string">'taylor@laravel.com'</span></span>, ]); <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;browse(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">($browser)</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">use</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">($user)</span></span></span><span class="hljs-function"> </span></span>{ $browser-&gt;loginAs($user) -&gt;visit(<span class="hljs-string"><span class="hljs-string">'/home'</span></span>) -&gt;press(<span class="hljs-string"><span class="hljs-string">'Create Playlist'</span></span>) -&gt;whenAvailable(<span class="hljs-string"><span class="hljs-string">'.playlist-modal'</span></span>, <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">($modal)</span></span></span><span class="hljs-function"> </span></span>{ $modal-&gt;type(<span class="hljs-string"><span class="hljs-string">'name'</span></span>, <span class="hljs-string"><span class="hljs-string">'My Playlist'</span></span>) -&gt;press(<span class="hljs-string"><span class="hljs-string">'Create'</span></span>); }); $browser-&gt;waitForText(<span class="hljs-string"><span class="hljs-string">'Playlist Created'</span></span>); }); }</code> </pre> <br><h3 id="komponenty-i-sloty-dlya-blade-shablonizatora">  Components and Slots for Blade Template Engine </h3><br><p>  Using the new features of the Blade template engine - components and slots - allows you to do everything that you used to do with sections and templates.  However, for some developers, the component-slot model may seem much easier to understand.  To begin with, imagine that we have an "alert" component that we want to use in our application in all templates: </p><br><pre> <code class="hljs django"><span class="xml"><span class="hljs-comment"><span class="xml"><span class="hljs-comment">&lt;!-- /resources/views/alert.blade.php --&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">div</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"alert alert-danger"</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span></span><span class="hljs-template-variable"><span class="hljs-template-variable">{{ $slot }}</span></span><span class="xml"><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">div</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span></span></code> </pre> <br><p>  The variable <code>{{ $slot }}</code> will contain the content that we want to pass to the component.  To declare this component, we use the new @component <code>@component</code> : </p><br><pre> <code class="hljs kotlin"><span class="hljs-meta"><span class="hljs-meta">@component(</span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">'alert'</span></span></span><span class="hljs-meta">)</span></span> &lt;strong&gt;Whoops!&lt;/strong&gt; Something went wrong! <span class="hljs-meta"><span class="hljs-meta">@endcomponent</span></span></code> </pre> <br><p>  Named slots allow you to use multiple slots in one component: </p><br><pre> <code class="hljs django"><span class="xml"><span class="hljs-comment"><span class="xml"><span class="hljs-comment">&lt;!-- /resources/views/alert.blade.php --&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">div</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"alert alert-danger"</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">div</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"alert-title"</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span></span><span class="hljs-template-variable"><span class="hljs-template-variable">{{ $title }}</span></span><span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">div</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span></span><span class="hljs-template-variable"><span class="hljs-template-variable">{{ $slot }}</span></span><span class="xml"><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">div</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span></span></code> </pre> <br><p>  They are passed to the component using the <code>@slot</code> directive.  Any content outside this directive will be passed to the component as <code>$slot</code> variable: </p><br><pre> <code class="hljs kotlin"><span class="hljs-meta"><span class="hljs-meta">@component(</span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">'alert'</span></span></span><span class="hljs-meta">)</span></span> <span class="hljs-meta"><span class="hljs-meta">@slot(</span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">'title'</span></span></span><span class="hljs-meta">)</span></span> Forbidden <span class="hljs-meta"><span class="hljs-meta">@endslot</span></span> You are not allowed to access <span class="hljs-keyword"><span class="hljs-keyword">this</span></span> resource! <span class="hljs-meta"><span class="hljs-meta">@endcomponent</span></span></code> </pre> <br><h3 id="broadcast-model-binding">  Broadcast Model Binding </h3><br><p>  As well as HTTP routes, routes for channels of wiretapping of events can now also use implicit binding to the model.  For example, instead of a string or numeric ID, you can pass an instance of the Order model (class): </p><br><pre> <code class="hljs php"><span class="hljs-keyword"><span class="hljs-keyword">use</span></span> <span class="hljs-title"><span class="hljs-title">App</span></span>\<span class="hljs-title"><span class="hljs-title">Order</span></span>; Broadcast::channel(<span class="hljs-string"><span class="hljs-string">'order.{order}'</span></span>, <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">($user, Order $order)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> $user-&gt;id === $order-&gt;user_id; });</code> </pre> <br><h3 id="soobscheniya-vysshego-poryadka-v-kollekciyah-higher-order-messages-hom">  Higher order messages, HOM </h3><br><p>  The collection now supports higher order messages that allow you to perform common operations with collections.  The following messages are now available: </p><br><ul><li>  contains </li><li>  each </li><li>  every </li><li>  filter </li><li>  first </li><li>  map </li><li>  partition </li><li>  reject </li><li>  sortBy </li><li>  sortByDesc </li><li>  sum </li></ul><br><p>  Each message can be accessed as a dynamic property of a collection instance.  For example, use the message <code>each</code> to apply a method to each object within the collection: </p><br><pre> <code class="hljs php">$users = User::where(<span class="hljs-string"><span class="hljs-string">'votes'</span></span>, <span class="hljs-string"><span class="hljs-string">'&gt;'</span></span>, <span class="hljs-number"><span class="hljs-number">500</span></span>)-&gt;get(); $users-&gt;each-&gt;markAsVip();</code> </pre> <br><p>  Similarly, you can use <code>sum</code> to, for example, count the number of votes in a collection with users: </p><br><pre> <code class="hljs php">$users = User::where(<span class="hljs-string"><span class="hljs-string">'group'</span></span>, <span class="hljs-string"><span class="hljs-string">'Development'</span></span>)-&gt;get(); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> $users-&gt;sum-&gt;votes;</code> </pre> <br><h3 id="polzovatelskie-obrabotchiki-sobytiy-eloquent">  Eloquent Custom Event Handlers </h3><br><p>  Event handlers in Eloquent can now be bound to event objects.  This makes it much easier to handle Eloquent events, and also makes testing these events easier.  To use this innovation, you need to declare the <code>$events</code> property in the class of your model, which will allow you to use your own classes to handle basic Eloquent events: </p><br><pre> <code class="hljs xml"><span class="php"><span class="hljs-meta"><span class="php"><span class="hljs-meta">&lt;?php</span></span></span><span class="php"> </span><span class="hljs-keyword"><span class="php"><span class="hljs-keyword">namespace</span></span></span><span class="php"> </span><span class="hljs-title"><span class="php"><span class="hljs-title">App</span></span></span><span class="php">; </span><span class="hljs-keyword"><span class="php"><span class="hljs-keyword">use</span></span></span><span class="php"> </span><span class="hljs-title"><span class="php"><span class="hljs-title">App</span></span></span><span class="php">\</span><span class="hljs-title"><span class="php"><span class="hljs-title">Events</span></span></span><span class="php">\</span><span class="hljs-title"><span class="php"><span class="hljs-title">UserSaved</span></span></span><span class="php">; </span><span class="hljs-keyword"><span class="php"><span class="hljs-keyword">use</span></span></span><span class="php"> </span><span class="hljs-title"><span class="php"><span class="hljs-title">App</span></span></span><span class="php">\</span><span class="hljs-title"><span class="php"><span class="hljs-title">Events</span></span></span><span class="php">\</span><span class="hljs-title"><span class="php"><span class="hljs-title">UserDeleted</span></span></span><span class="php">; </span><span class="hljs-keyword"><span class="php"><span class="hljs-keyword">use</span></span></span><span class="php"> </span><span class="hljs-title"><span class="php"><span class="hljs-title">Illuminate</span></span></span><span class="php">\</span><span class="hljs-title"><span class="php"><span class="hljs-title">Notifications</span></span></span><span class="php">\</span><span class="hljs-title"><span class="php"><span class="hljs-title">Notifiable</span></span></span><span class="php">; </span><span class="hljs-keyword"><span class="php"><span class="hljs-keyword">use</span></span></span><span class="php"> </span><span class="hljs-title"><span class="php"><span class="hljs-title">Illuminate</span></span></span><span class="php">\</span><span class="hljs-title"><span class="php"><span class="hljs-title">Foundation</span></span></span><span class="php">\</span><span class="hljs-title"><span class="php"><span class="hljs-title">Auth</span></span></span><span class="php">\</span><span class="hljs-title"><span class="php"><span class="hljs-title">User</span></span></span><span class="php"> </span><span class="hljs-title"><span class="php"><span class="hljs-title">as</span></span></span><span class="php"> </span><span class="hljs-title"><span class="php"><span class="hljs-title">Authenticatable</span></span></span><span class="php">; </span><span class="hljs-class"><span class="hljs-keyword"><span class="php"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span></span><span class="php"><span class="hljs-class"> </span></span><span class="hljs-title"><span class="php"><span class="hljs-class"><span class="hljs-title">User</span></span></span></span><span class="php"><span class="hljs-class"> </span></span><span class="hljs-keyword"><span class="php"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span></span><span class="php"><span class="hljs-class"> </span></span><span class="hljs-title"><span class="php"><span class="hljs-class"><span class="hljs-title">Authenticatable</span></span></span></span><span class="php"><span class="hljs-class"> </span></span></span><span class="php">{ </span><span class="hljs-keyword"><span class="php"><span class="hljs-keyword">use</span></span></span><span class="php"> </span><span class="hljs-title"><span class="php"><span class="hljs-title">Notifiable</span></span></span><span class="php">; </span><span class="hljs-comment"><span class="php"><span class="hljs-comment">/** * The event map for the model. * * </span></span><span class="hljs-doctag"><span class="php"><span class="hljs-comment"><span class="hljs-doctag">@var</span></span></span></span><span class="php"><span class="hljs-comment"> array */</span></span></span><span class="php"> </span><span class="hljs-keyword"><span class="php"><span class="hljs-keyword">protected</span></span></span><span class="php"> $events = [ </span><span class="hljs-string"><span class="php"><span class="hljs-string">'saved'</span></span></span><span class="php"> =&gt; UserSaved::class, </span><span class="hljs-string"><span class="php"><span class="hljs-string">'deleted'</span></span></span><span class="php"> =&gt; UserDeleted::class, ]; }</span></span></code> </pre> <br><h3 id="retry--timeout-dlya-kazhdogo-processa">  Retry &amp; Timeout for each process </h3><br><p>  Previously, the "retry" and "timeout" settings were set globally for all command line processes.  In Laravel 5.4, these settings can now be set for each process individually, by defining them directly in the process class: </p><br><pre> <code class="hljs xml"><span class="php"><span class="hljs-meta"><span class="php"><span class="hljs-meta">&lt;?php</span></span></span><span class="php"> </span><span class="hljs-keyword"><span class="php"><span class="hljs-keyword">namespace</span></span></span><span class="php"> </span><span class="hljs-title"><span class="php"><span class="hljs-title">App</span></span></span><span class="php">\</span><span class="hljs-title"><span class="php"><span class="hljs-title">Jobs</span></span></span><span class="php">; </span><span class="hljs-class"><span class="hljs-keyword"><span class="php"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span></span><span class="php"><span class="hljs-class"> </span></span><span class="hljs-title"><span class="php"><span class="hljs-class"><span class="hljs-title">ProcessPodcast</span></span></span></span><span class="php"><span class="hljs-class"> </span></span><span class="hljs-keyword"><span class="php"><span class="hljs-class"><span class="hljs-keyword">implements</span></span></span></span><span class="php"><span class="hljs-class"> </span></span><span class="hljs-title"><span class="php"><span class="hljs-class"><span class="hljs-title">ShouldQueue</span></span></span></span><span class="php"><span class="hljs-class"> </span></span></span><span class="php">{ </span><span class="hljs-comment"><span class="php"><span class="hljs-comment">/** * The number of times the job may be attempted. * * </span></span><span class="hljs-doctag"><span class="php"><span class="hljs-comment"><span class="hljs-doctag">@var</span></span></span></span><span class="php"><span class="hljs-comment"> int */</span></span></span><span class="php"> </span><span class="hljs-keyword"><span class="php"><span class="hljs-keyword">public</span></span></span><span class="php"> $tries = </span><span class="hljs-number"><span class="php"><span class="hljs-number">5</span></span></span><span class="php">; </span><span class="hljs-comment"><span class="php"><span class="hljs-comment">/** * The number of seconds the job can run before timing out. * * </span></span><span class="hljs-doctag"><span class="php"><span class="hljs-comment"><span class="hljs-doctag">@var</span></span></span></span><span class="php"><span class="hljs-comment"> int */</span></span></span><span class="php"> </span><span class="hljs-keyword"><span class="php"><span class="hljs-keyword">public</span></span></span><span class="php"> $timeout = </span><span class="hljs-number"><span class="php"><span class="hljs-number">120</span></span></span><span class="php">; }</span></span></code> </pre> <br><h3 id="middleware-dlya-ochistki-zaprosov">  Middleware for cleaning queries </h3><br><p>  In Laravel 5.4, two new middlewares (query filters) appeared: <code>TrimStrings</code> and <code>TrimStrings</code> </p><br><pre> <code class="hljs tex">/** * The application's global HTTP middleware stack. * * These middleware are run during every request to your application. * * @var array */ protected <span class="hljs-formula"><span class="hljs-formula">$middleware = [ </span><span class="hljs-tag"><span class="hljs-formula"><span class="hljs-tag">\</span></span><span class="hljs-name"><span class="hljs-formula"><span class="hljs-tag"><span class="hljs-name">Illuminate</span></span></span></span></span><span class="hljs-tag"><span class="hljs-formula"><span class="hljs-tag">\</span></span><span class="hljs-name"><span class="hljs-formula"><span class="hljs-tag"><span class="hljs-name">Foundation</span></span></span></span></span><span class="hljs-tag"><span class="hljs-formula"><span class="hljs-tag">\</span></span><span class="hljs-name"><span class="hljs-formula"><span class="hljs-tag"><span class="hljs-name">Http</span></span></span></span></span><span class="hljs-tag"><span class="hljs-formula"><span class="hljs-tag">\</span></span><span class="hljs-name"><span class="hljs-formula"><span class="hljs-tag"><span class="hljs-name">Middleware</span></span></span></span></span><span class="hljs-tag"><span class="hljs-formula"><span class="hljs-tag">\</span></span><span class="hljs-name"><span class="hljs-formula"><span class="hljs-tag"><span class="hljs-name">CheckForMaintenanceMode</span></span></span></span></span><span class="hljs-formula">::class, </span><span class="hljs-tag"><span class="hljs-formula"><span class="hljs-tag">\</span></span><span class="hljs-name"><span class="hljs-formula"><span class="hljs-tag"><span class="hljs-name">Illuminate</span></span></span></span></span><span class="hljs-tag"><span class="hljs-formula"><span class="hljs-tag">\</span></span><span class="hljs-name"><span class="hljs-formula"><span class="hljs-tag"><span class="hljs-name">Foundation</span></span></span></span></span><span class="hljs-tag"><span class="hljs-formula"><span class="hljs-tag">\</span></span><span class="hljs-name"><span class="hljs-formula"><span class="hljs-tag"><span class="hljs-name">Http</span></span></span></span></span><span class="hljs-tag"><span class="hljs-formula"><span class="hljs-tag">\</span></span><span class="hljs-name"><span class="hljs-formula"><span class="hljs-tag"><span class="hljs-name">Middleware</span></span></span></span></span><span class="hljs-tag"><span class="hljs-formula"><span class="hljs-tag">\</span></span><span class="hljs-name"><span class="hljs-formula"><span class="hljs-tag"><span class="hljs-name">ValidatePostSize</span></span></span></span></span><span class="hljs-formula">::class, </span><span class="hljs-tag"><span class="hljs-formula"><span class="hljs-tag">\</span></span><span class="hljs-name"><span class="hljs-formula"><span class="hljs-tag"><span class="hljs-name">App</span></span></span></span></span><span class="hljs-tag"><span class="hljs-formula"><span class="hljs-tag">\</span></span><span class="hljs-name"><span class="hljs-formula"><span class="hljs-tag"><span class="hljs-name">Http</span></span></span></span></span><span class="hljs-tag"><span class="hljs-formula"><span class="hljs-tag">\</span></span><span class="hljs-name"><span class="hljs-formula"><span class="hljs-tag"><span class="hljs-name">Middleware</span></span></span></span></span><span class="hljs-tag"><span class="hljs-formula"><span class="hljs-tag">\</span></span><span class="hljs-name"><span class="hljs-formula"><span class="hljs-tag"><span class="hljs-name">TrimStrings</span></span></span></span></span><span class="hljs-formula">::class, </span><span class="hljs-tag"><span class="hljs-formula"><span class="hljs-tag">\</span></span><span class="hljs-name"><span class="hljs-formula"><span class="hljs-tag"><span class="hljs-name">Illuminate</span></span></span></span></span><span class="hljs-tag"><span class="hljs-formula"><span class="hljs-tag">\</span></span><span class="hljs-name"><span class="hljs-formula"><span class="hljs-tag"><span class="hljs-name">Foundation</span></span></span></span></span><span class="hljs-tag"><span class="hljs-formula"><span class="hljs-tag">\</span></span><span class="hljs-name"><span class="hljs-formula"><span class="hljs-tag"><span class="hljs-name">Http</span></span></span></span></span><span class="hljs-tag"><span class="hljs-formula"><span class="hljs-tag">\</span></span><span class="hljs-name"><span class="hljs-formula"><span class="hljs-tag"><span class="hljs-name">Middleware</span></span></span></span></span><span class="hljs-tag"><span class="hljs-formula"><span class="hljs-tag">\</span></span><span class="hljs-name"><span class="hljs-formula"><span class="hljs-tag"><span class="hljs-name">ConvertEmptyStringsToNull</span></span></span></span></span><span class="hljs-formula">::class, ];</span></span></code> </pre> <br><p>  These two filters automatically remove spaces at the beginning and end of values, and also convert empty lines to <code>null</code> , which allows you to normalize the data of each query and forget about the constant use of the <code>trim</code> function in your code. </p><br><h3 id="realtime-fasady">  "Realtime" Facades </h3><br><p>  Previously, only Laravel services supplied by default provided facades that made it possible to quickly and succinctly use their methods through the service container.  In Laravel 5.4, it was possible to easily convert any of your classes into a facade in real time.  Imagine that we have the following class: </p><br><pre> <code class="hljs xml"><span class="php"><span class="hljs-meta"><span class="php"><span class="hljs-meta">&lt;?php</span></span></span><span class="php"> </span><span class="hljs-keyword"><span class="php"><span class="hljs-keyword">namespace</span></span></span><span class="php"> </span><span class="hljs-title"><span class="php"><span class="hljs-title">App</span></span></span><span class="php">\</span><span class="hljs-title"><span class="php"><span class="hljs-title">Services</span></span></span><span class="php">; </span><span class="hljs-class"><span class="hljs-keyword"><span class="php"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span></span><span class="php"><span class="hljs-class"> </span></span><span class="hljs-title"><span class="php"><span class="hljs-class"><span class="hljs-title">PaymentGateway</span></span></span></span><span class="php"><span class="hljs-class"> </span></span></span><span class="php">{ </span><span class="hljs-keyword"><span class="php"><span class="hljs-keyword">protected</span></span></span><span class="php"> $tax; </span><span class="hljs-comment"><span class="php"><span class="hljs-comment">/** * Create a new payment gateway instance. * * </span></span><span class="hljs-doctag"><span class="php"><span class="hljs-comment"><span class="hljs-doctag">@param</span></span></span></span><span class="php"><span class="hljs-comment"> TaxCalculator $tax * </span></span><span class="hljs-doctag"><span class="php"><span class="hljs-comment"><span class="hljs-doctag">@return</span></span></span></span><span class="php"><span class="hljs-comment"> void */</span></span></span><span class="php"> </span><span class="hljs-keyword"><span class="php"><span class="hljs-keyword">public</span></span></span><span class="php"> </span><span class="hljs-function"><span class="hljs-keyword"><span class="php"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span></span><span class="php"><span class="hljs-function"> </span></span><span class="hljs-title"><span class="php"><span class="hljs-function"><span class="hljs-title">__construct</span></span></span></span><span class="hljs-params"><span class="php"><span class="hljs-function"><span class="hljs-params">(TaxCalculator $tax)</span></span></span></span><span class="php"><span class="hljs-function"> </span></span></span><span class="php">{ </span><span class="hljs-keyword"><span class="php"><span class="hljs-keyword">$this</span></span></span><span class="php">-&gt;tax = $tax; } </span><span class="hljs-comment"><span class="php"><span class="hljs-comment">/** * Pay the given amount. * * </span></span><span class="hljs-doctag"><span class="php"><span class="hljs-comment"><span class="hljs-doctag">@param</span></span></span></span><span class="php"><span class="hljs-comment"> int $amount * </span></span><span class="hljs-doctag"><span class="php"><span class="hljs-comment"><span class="hljs-doctag">@return</span></span></span></span><span class="php"><span class="hljs-comment"> void */</span></span></span><span class="php"> </span><span class="hljs-keyword"><span class="php"><span class="hljs-keyword">public</span></span></span><span class="php"> </span><span class="hljs-function"><span class="hljs-keyword"><span class="php"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span></span><span class="php"><span class="hljs-function"> </span></span><span class="hljs-title"><span class="php"><span class="hljs-function"><span class="hljs-title">pay</span></span></span></span><span class="hljs-params"><span class="php"><span class="hljs-function"><span class="hljs-params">($amount)</span></span></span></span><span class="php"><span class="hljs-function"> </span></span></span><span class="php">{ </span><span class="hljs-comment"><span class="php"><span class="hljs-comment">// Pay an amount... } }</span></span></span></span></code> </pre> <br><p>  To make it a facade, you just need to add the Facades prefix: </p><br><pre> <code class="hljs php"><span class="hljs-keyword"><span class="hljs-keyword">use</span></span> <span class="hljs-title"><span class="hljs-title">Facades</span></span>\ { <span class="hljs-title"><span class="hljs-title">App</span></span>\<span class="hljs-title"><span class="hljs-title">Services</span></span>\<span class="hljs-title"><span class="hljs-title">PaymentGateway</span></span> }; Route::get(<span class="hljs-string"><span class="hljs-string">'/pay/{amount}'</span></span>, <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">($amount)</span></span></span><span class="hljs-function"> </span></span>{ PaymentGateway::pay($amount); });</code> </pre> <br><p>  You can also write interaction tests using the facade simulation function: </p><br><pre> <code class="hljs php">PaymentGateway::shouldReceive(<span class="hljs-string"><span class="hljs-string">'pay'</span></span>)-&gt;with(<span class="hljs-string"><span class="hljs-string">'100'</span></span>);</code> </pre> <br><h3 id="polzovatelskie-modeli-dlya-svyazuyuschih-tablic">  Custom models for spanning tables </h3><br><p>  In Laravel 5.3, all the models of the "connecting" tables for the "many-to-many" links used the same instance of the built-in <code>Pivot</code> model.  In Laravel 5.4, you can define your model for a pivot table after a link is declared as follows: </p><br><pre> <code class="hljs xml"><span class="php"><span class="hljs-meta"><span class="php"><span class="hljs-meta">&lt;?php</span></span></span><span class="php"> </span><span class="hljs-keyword"><span class="php"><span class="hljs-keyword">namespace</span></span></span><span class="php"> </span><span class="hljs-title"><span class="php"><span class="hljs-title">App</span></span></span><span class="php">; </span><span class="hljs-keyword"><span class="php"><span class="hljs-keyword">use</span></span></span><span class="php"> </span><span class="hljs-title"><span class="php"><span class="hljs-title">Illuminate</span></span></span><span class="php">\</span><span class="hljs-title"><span class="php"><span class="hljs-title">Database</span></span></span><span class="php">\</span><span class="hljs-title"><span class="php"><span class="hljs-title">Eloquent</span></span></span><span class="php">\</span><span class="hljs-title"><span class="php"><span class="hljs-title">Model</span></span></span><span class="php">; </span><span class="hljs-class"><span class="hljs-keyword"><span class="php"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span></span><span class="php"><span class="hljs-class"> </span></span><span class="hljs-title"><span class="php"><span class="hljs-class"><span class="hljs-title">Role</span></span></span></span><span class="php"><span class="hljs-class"> </span></span><span class="hljs-keyword"><span class="php"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span></span><span class="php"><span class="hljs-class"> </span></span><span class="hljs-title"><span class="php"><span class="hljs-class"><span class="hljs-title">Model</span></span></span></span><span class="php"><span class="hljs-class"> </span></span></span><span class="php">{ </span><span class="hljs-comment"><span class="php"><span class="hljs-comment">/** * The users that belong to the role. */</span></span></span><span class="php"> </span><span class="hljs-keyword"><span class="php"><span class="hljs-keyword">public</span></span></span><span class="php"> </span><span class="hljs-function"><span class="hljs-keyword"><span class="php"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span></span><span class="php"><span class="hljs-function"> </span></span><span class="hljs-title"><span class="php"><span class="hljs-function"><span class="hljs-title">users</span></span></span></span><span class="hljs-params"><span class="php"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span><span class="php"><span class="hljs-function"> </span></span></span><span class="php">{ </span><span class="hljs-keyword"><span class="php"><span class="hljs-keyword">return</span></span></span><span class="php"> </span><span class="hljs-keyword"><span class="php"><span class="hljs-keyword">$this</span></span></span><span class="php">-&gt;belongsToMany(</span><span class="hljs-string"><span class="php"><span class="hljs-string">'App\User'</span></span></span><span class="php">)-&gt;using(</span><span class="hljs-string"><span class="php"><span class="hljs-string">'App\UserRole'</span></span></span><span class="php">); } }</span></span></code> </pre> <br><h3 id="uluchshena-podderzhka-klasterov-redis">  Improved Redis Cluster Support </h3><br><p>  Previously, it was not possible to define Redis connections to the same host and clusters in the same application.  With Laravel 5.4, you can define multiple connections to hosts and clusters.  More information in the <a href="https://laravel.com/docs/5.4/redis">documentation for Redis</a> . </p><br><h3 id="dlinna-strok-po-umolchaniyu-v-migraciyah">  Length of lines by default in migrations </h3><br><p>  In Laravel 5.4, utf8mb4 is used as the default encoding that supports emoji storage in the database.  If you are upgrading from Laravel 5.3, you do not need to change the encoding. </p><br><p>  If you still manually change it or use MySQL versions earlier than 5.7.7, you need to manually configure the default string lengths that generate migrations using the <code>Schema::defaultStringLength</code> in your <code>AppServiceProvider</code> : </p><br><pre> <code class="hljs php"><span class="hljs-keyword"><span class="hljs-keyword">use</span></span> <span class="hljs-title"><span class="hljs-title">Illuminate</span></span>\<span class="hljs-title"><span class="hljs-title">Support</span></span>\<span class="hljs-title"><span class="hljs-title">Facades</span></span>\<span class="hljs-title"><span class="hljs-title">Schema</span></span>; <span class="hljs-comment"><span class="hljs-comment">/** * Bootstrap any application services. * * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@return</span></span></span><span class="hljs-comment"> void */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">boot</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ Schema::defaultStringLength(<span class="hljs-number"><span class="hljs-number">191</span></span>); }</code> </pre> <br><h3 id="podderzhka-json-formata-v-yazykovyh-faylah">  JSON format support in language files </h3><br><p>  In version 5.4, the ability to use JSON format for compiling language files in applications was added.  They are still stored in the <code>resources/lang</code> directory. <br>  For example, if you have a Russian translation of your project, you can create <code>ru.json</code> in the <code>resources/lang</code> directory, and its contents might look something like this: </p><br><pre> <code class="hljs json">{ <span class="hljs-attr"><span class="hljs-attr">"I love Laravel!"</span></span>: <span class="hljs-string"><span class="hljs-string">"  Laravel!"</span></span> }</code> </pre></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <p>Source: <a href="https://habr.com/ru/post/320010/">https://habr.com/ru/post/320010/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../319996/index.html">OdataToEntity is an easy way to create .Net Core OData services</a></li>
<li><a href="../319998/index.html">Containers and virtualization: faster, more efficient, more reliable</a></li>
<li><a href="../320000/index.html">A fresh selection of resources for a mobile application marketer: books and blogs</a></li>
<li><a href="../320002/index.html">Linux-2017: the most promising distributions</a></li>
<li><a href="../320006/index.html">ESP8266 + PCA9685 + LUA</a></li>
<li><a href="../320012/index.html">Hearst Shkulev Media: ‚ÄúWe need to make content for people, not for search engines‚Äù</a></li>
<li><a href="../320014/index.html">AngularJS vs Angular 2: key differences</a></li>
<li><a href="../320016/index.html">How I hid 1C base in Germany</a></li>
<li><a href="../320018/index.html">Customization in 1C</a></li>
<li><a href="../320020/index.html">Reception campaign 2017: Useful links and materials for future bachelors, masters and graduate students of ITMO University</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>