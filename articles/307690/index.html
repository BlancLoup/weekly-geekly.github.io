<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Routing in the CleverStyle Framework</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Many aspects of the CleverStyle Framework have an alternative to most other frameworks, the implementation of the same things. 

 This article describ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Routing in the CleverStyle Framework</h1><div class="post__text post__text-html js-mediator-article">  Many aspects of the CleverStyle Framework have an alternative to most other frameworks, the implementation of the same things. <br><br>  This article describes in some detail the device of the work of routing, examples of use, as well as examples of how to intervene in this mechanism, or, if desired, completely replace it with your own. <br><br><h3>  Main difference </h3><br>  The main difference between routing and implementations in popular frameworks like Symfony, Laravel or Yii is declarative instead of imperative. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      This means that instead of specifying routes in a certain format and matching a route to a specific class, method or closure, we just describe the structure of the routes, and this structure is enough to understand what code will be executed depending on the route. <br><br>  Such an approach of conventions instead of configurations is convenient in the sense that it requires less effort while writing code, and does not require viewing the configuration in order to understand what code will be called when opening a certain page, since this is evident from the agreement adopted in the framework. <br><a name="habracut"></a><br><h3>  Routing Basics </h3><br>  Any URL in the framework view is broken into several parts.  At the very beginning, before any processing, the request parameters ( <code>?</code> And everything after it) are deleted from the page path. <br><br>  Next, we get the general format of the following path ( <code>|</code> used to divide the choice from several options, optional independent components of the path are grouped in <code>[]</code> ), the example is divided into several lines for convenience, before processing the path is divided into slashes and converted into an array of parts of the original path : <br><br><pre> <code class="hljs json">[language/] [admin/|api/|cli/] [Module_name [/path [/sub_path [/id1 [/another_subpath [/id2] ] ] ] ] ]</code> </pre><br>  The number of nesting levels is unlimited. <br><br>  First check the language prefix.  It does not participate in routing (and may be absent), but if it does, it affects which language will be used on the page.  The format depends on the languages ‚Äã‚Äãused and their number, it could be simple ( <code>en</code> , <code>ru</code> ), or take into account the region ( <code>en_gb</code> , <code>ru_ua</code> ). <br><br>  The language is followed by an optional part defining the type of page.  This can be an administration page ( <code>$Request-&gt;admin_path === true</code> ), a request to the API ( <code>$Request-&gt;api_path === true</code> ), a request to the CLI interface ( <code>$Request-&gt;cli_path === true</code> ), or a regular user page unless explicitly stated. <br><br>  Next, the module that will process the page is determined.  Subsequently, this module is available as <code>$Request-&gt;current_module</code> . <br><br>  It is worth noting that the name of the module can be localized, for example, if the <code>My_blog</code> module has the pair <code>"My_blog" : " "</code> in translation <code>"My_blog" : " "</code> , then you can use <code>_</code> as the module name, while all the same <code>$Request-&gt;current_module === 'My_blog'</code> . <br><br>  The rest of the array elements after the module falls into <code>$Request-&gt;route</code> , which can be used by modules, for example, for custom routing. <br><br>  Before proceeding to the next steps, 2 more arrays are filled. <br><br>  <code>$Request-&gt;route_ids</code> contains elements from <code>$Request-&gt;route</code> , which are integers (it is assumed that they are identifiers), <code>$Request-&gt;route_path</code> contains all <code>$Request-&gt;route</code> elements except integers, and is used as a route inside the module. <br><br><h3>  How to get into the routing in the early stages </h3><br>  The developer has at his disposal a number of events that allow him to intervene at these stages and change the behavior at his own discretion. <br><br>  The <code>System/Request/routing_replace/before</code> event is triggered immediately before determining the page language and allows you to somehow modify the source path as a string, the lowest level manipulations can be performed in this place. <br><br>  The <code>System/Request/routing_replace/after</code> event fires after the formation of <code>$Request-&gt;route_ids</code> and <code>$Request-&gt;route_path</code> , allowing you to correct important parameters after they have been defined by the system. <br><br>  An example of adding support for UUIDs as an alternative to standard integer identifiers: <br><br><pre> <code class="php hljs">Event::instance()-&gt;on( <span class="hljs-string"><span class="hljs-string">'System/Request/routing_replace/after'</span></span>, <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">($data)</span></span></span><span class="hljs-function"> </span></span>{ $route_path = []; $route_ids = []; <span class="hljs-keyword"><span class="hljs-keyword">foreach</span></span> ($data[<span class="hljs-string"><span class="hljs-string">'route'</span></span>] <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> $item) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (preg_match(<span class="hljs-string"><span class="hljs-string">'/([af\d]{8}(?:-[af\d]{4}){3}-[af\d]{12}?)/i'</span></span>, $item)) { $route_ids[] = $item; } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { $route_path[] = $item; } } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ($route_ids) { $data[<span class="hljs-string"><span class="hljs-string">'route_path'</span></span>] = $route_path; $data[<span class="hljs-string"><span class="hljs-string">'route_ids'</span></span>] = $route_ids; } } );</code> </pre> <br><h3>  Route structure </h3><br>  The route structure is a tree JSON, in which the key of each child level is a continuation of the parent, some final nodes may be empty if the neighboring ones have a deeper structure. <br><br>  An example of the current API structure of a system module: <br><br><pre> <code class="javascript hljs">{ <span class="hljs-string"><span class="hljs-string">"admin"</span></span> : { <span class="hljs-string"><span class="hljs-string">"about_server"</span></span> : [], <span class="hljs-string"><span class="hljs-string">"blocks"</span></span> : [], <span class="hljs-string"><span class="hljs-string">"databases"</span></span> : [], <span class="hljs-string"><span class="hljs-string">"groups"</span></span> : [ <span class="hljs-string"><span class="hljs-string">"_"</span></span>, <span class="hljs-string"><span class="hljs-string">"permissions"</span></span> ], <span class="hljs-string"><span class="hljs-string">"languages"</span></span> : [], <span class="hljs-string"><span class="hljs-string">"mail"</span></span> : [], <span class="hljs-string"><span class="hljs-string">"modules"</span></span> : [], <span class="hljs-string"><span class="hljs-string">"optimization"</span></span> : [], <span class="hljs-string"><span class="hljs-string">"permissions"</span></span> : [ <span class="hljs-string"><span class="hljs-string">"_"</span></span>, <span class="hljs-string"><span class="hljs-string">"for_item"</span></span> ], <span class="hljs-string"><span class="hljs-string">"security"</span></span> : [], <span class="hljs-string"><span class="hljs-string">"site_info"</span></span> : [], <span class="hljs-string"><span class="hljs-string">"storages"</span></span> : [], <span class="hljs-string"><span class="hljs-string">"system"</span></span> : [], <span class="hljs-string"><span class="hljs-string">"themes"</span></span> : [], <span class="hljs-string"><span class="hljs-string">"upload"</span></span> : [], <span class="hljs-string"><span class="hljs-string">"users"</span></span> : [ <span class="hljs-string"><span class="hljs-string">"_"</span></span>, <span class="hljs-string"><span class="hljs-string">"general"</span></span>, <span class="hljs-string"><span class="hljs-string">"groups"</span></span>, <span class="hljs-string"><span class="hljs-string">"permissions"</span></span> ] }, <span class="hljs-string"><span class="hljs-string">"blank"</span></span> : [], <span class="hljs-string"><span class="hljs-string">"languages"</span></span> : [], <span class="hljs-string"><span class="hljs-string">"profile"</span></span> : [], <span class="hljs-string"><span class="hljs-string">"profiles"</span></span> : [], <span class="hljs-string"><span class="hljs-string">"timezones"</span></span> : [] }</code> </pre> <br>  Examples of (real) queries that fit this structure: <br><br><pre> <code class="hljs pgsql"><span class="hljs-keyword"><span class="hljs-keyword">GET</span></span> api/<span class="hljs-keyword"><span class="hljs-keyword">System</span></span>/blank <span class="hljs-keyword"><span class="hljs-keyword">GET</span></span> api/<span class="hljs-keyword"><span class="hljs-keyword">System</span></span>/<span class="hljs-keyword"><span class="hljs-keyword">admin</span></span>/about_server SEARCH_OPTIONS api/<span class="hljs-keyword"><span class="hljs-keyword">System</span></span>/<span class="hljs-keyword"><span class="hljs-keyword">admin</span></span>/users <span class="hljs-keyword"><span class="hljs-keyword">SEARCH</span></span> api/<span class="hljs-keyword"><span class="hljs-keyword">System</span></span>/<span class="hljs-keyword"><span class="hljs-keyword">admin</span></span>/users PATCH api/<span class="hljs-keyword"><span class="hljs-keyword">System</span></span>/<span class="hljs-keyword"><span class="hljs-keyword">admin</span></span>/users/<span class="hljs-number"><span class="hljs-number">42</span></span> <span class="hljs-keyword"><span class="hljs-keyword">GET</span></span> api/<span class="hljs-keyword"><span class="hljs-keyword">System</span></span>/<span class="hljs-keyword"><span class="hljs-keyword">admin</span></span>/users/<span class="hljs-number"><span class="hljs-number">42</span></span>/<span class="hljs-keyword"><span class="hljs-keyword">groups</span></span> PUT api/<span class="hljs-keyword"><span class="hljs-keyword">System</span></span>/<span class="hljs-keyword"><span class="hljs-keyword">admin</span></span>/users/<span class="hljs-number"><span class="hljs-number">42</span></span>/permissions</code> </pre><br><h3>  Getting the final route </h3><br>  Getting a route out of the page path is only the first of two steps.  The second stage takes into account the configuration of the current module and adjusts the final route accordingly. <br><br>  What is it for?  Suppose a user opens the <code>/Blogs</code> page, and the route structure is configured as follows ( <code>modules/Blogs/index.json</code> ): <br><br><pre> <code class="javascript hljs">[ <span class="hljs-string"><span class="hljs-string">"latest_posts"</span></span>, <span class="hljs-string"><span class="hljs-string">"section"</span></span>, <span class="hljs-string"><span class="hljs-string">"post"</span></span>, <span class="hljs-string"><span class="hljs-string">"tag"</span></span>, <span class="hljs-string"><span class="hljs-string">"new_post"</span></span>, <span class="hljs-string"><span class="hljs-string">"edit_post"</span></span>, <span class="hljs-string"><span class="hljs-string">"drafts"</span></span>, <span class="hljs-string"><span class="hljs-string">"atom.xml"</span></span> ]</code> </pre> <br>  In this case, <code>$Request-&gt;route_path === []</code> , but <code>$App-&gt;controller_path === ['index', 'latest_posts']</code> . <br><br>  <code>index</code> will be here regardless of the module and configuration, but the <code>latest_posts</code> depends on the configuration.  The fact is that if the page is not an API and not a CLI request, then if you specify an incomplete route, the framework will select the first key from the configuration at each level until it reaches the end deep into the structure.  That is, <code>Blogs</code> similar to <code>Blogs/latest_posts</code> . <br><br>  For API and CLI requests, there is a difference in this sense - omitting parts of the route in this way is prohibited and allowed only if the structure uses <code>_</code> as the first element at the appropriate level. <br><br>  For example, for an API, we can have the following structure ( <code>modules/Module_name/api/index.json</code> ): <br><br><pre> <code class="javascript hljs">{ <span class="hljs-string"><span class="hljs-string">"_"</span></span> : [] <span class="hljs-string"><span class="hljs-string">"comments"</span></span> : [] }</code> </pre> <br>  In this case, <code>api/Module_name</code> similar to <code>api/Module_name/_</code> .  This allows you to create an API with beautiful methods (remember that we have identifiers in a separate array): <br><br><pre> <code class="hljs pgsql"><span class="hljs-keyword"><span class="hljs-keyword">GET</span></span> api/Module_name <span class="hljs-keyword"><span class="hljs-keyword">GET</span></span> api/Module_name/<span class="hljs-number"><span class="hljs-number">42</span></span> POST api/Module_name PUT api/Module_name/<span class="hljs-number"><span class="hljs-number">42</span></span> <span class="hljs-keyword"><span class="hljs-keyword">DELETE</span></span> api/Module_name/<span class="hljs-number"><span class="hljs-number">42</span></span> <span class="hljs-keyword"><span class="hljs-keyword">GET</span></span> api/Module_name/<span class="hljs-number"><span class="hljs-number">42</span></span>/comments <span class="hljs-keyword"><span class="hljs-keyword">GET</span></span> api/Module_name/<span class="hljs-number"><span class="hljs-number">42</span></span>/comments/<span class="hljs-number"><span class="hljs-number">13</span></span> POST api/Module_name/<span class="hljs-number"><span class="hljs-number">42</span></span>/comments PUT api/Module_name/<span class="hljs-number"><span class="hljs-number">42</span></span>/comments/<span class="hljs-number"><span class="hljs-number">13</span></span> <span class="hljs-keyword"><span class="hljs-keyword">DELETE</span></span> api/Module_name/<span class="hljs-number"><span class="hljs-number">42</span></span>/comments/<span class="hljs-number"><span class="hljs-number">13</span></span></code> </pre><br><h3>  Location of files with route structure </h3><br>  The modules in the CleverStyle Framework store all of their contents inside the module folder (as opposed to frameworks, where all views are in one folder, all controllers are in another, all models are in third, all routes are in one file, and so on) for ease of maintenance. <br><br>  Depending on the type of request, different configs are used in JSON format: <br><br><ul><li>  for normal <code>modules/Module_name/index.json</code> </li><li>  for <code>modules/Module_name/admin/index.json</code> </li><li>  for API <code>modules/Module_name/api/index.json</code> </li><li>  for CLI <code>modules/Module_name/cli/index.json</code> </li></ul><br>  Route handlers are in the same folders. <br><br><h3>  Types of routing </h3><br>  There are two types of routing in the CleverStyle Framework: file-based (used extensively earlier) and controller-based (more used now). <br><br>  Take the <code>Blogs/latest_posts</code> page from the example above and the final route is <code>['index', 'latest_posts']</code> . <br><br>  In the case of file-based routing, the following files will be mounted in the specified order: <br><br><pre> <code class="hljs pgsql">modules/Blogs/<span class="hljs-keyword"><span class="hljs-keyword">index</span></span>.php modules/Blogs/latest_posts.php</code> </pre><br>  If controller-based routing is used, then the <code>cs\modules\Blogs\Controller</code> class ( <code>modules/Blogs/Controller.php</code> file) must exist with the following public static methods: <br><br><pre> <code class="hljs ruby">cs\modules\Blogs\Controller::index($Request, $Response) : mixed cs\modules\Blogs\Controller::latest_posts($Request, $Response) : mixed</code> </pre><br>  It is important that any file / method other than the last can be omitted, and this will not lead to an error. <br><br>  Now let's take a more complex example, the <code>GET api/Module_name/items/42/comments</code> request. <br><br>  Firstly, for API and CLI requests, besides the path, the HTTP method is also important. <br>  Secondly, the sub-folder <code>api</code> will be used here. <br><br>  In the case of file-based routing, the following files will be mounted in the specified order: <br><br><pre> <code class="hljs pgsql">modules/Module_name/api/<span class="hljs-keyword"><span class="hljs-keyword">index</span></span>.php modules/Module_name/api/<span class="hljs-keyword"><span class="hljs-keyword">index</span></span>.<span class="hljs-keyword"><span class="hljs-keyword">get</span></span>.php modules/Module_name/api/items.php modules/Module_name/api/items.<span class="hljs-keyword"><span class="hljs-keyword">get</span></span>.php modules/Module_name/api/items/comments.php modules/Module_name/api/items/comments.<span class="hljs-keyword"><span class="hljs-keyword">get</span></span>.php</code> </pre><br>  If controller-based routing is used, then the class <code>cs\modules\Blogs\api\Controller</code> ( <code>modules/Blogs/api/Controller.php</code> file <code>modules/Blogs/api/Controller.php</code> must exist with the following public static methods: <br><br><pre> <code class="hljs tex">cs<span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">modules</span></span></span></span><span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Blogs</span></span></span></span><span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">api</span></span></span></span><span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Controller</span></span></span></span>::index(<span class="hljs-formula"><span class="hljs-formula">$Request, $</span></span>Response) : mixed cs<span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">modules</span></span></span></span><span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Blogs</span></span></span></span><span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">api</span></span></span></span><span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Controller</span></span></span></span>::index_get(<span class="hljs-formula"><span class="hljs-formula">$Request, $</span></span>Response) : mixed cs<span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">modules</span></span></span></span><span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Blogs</span></span></span></span><span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">api</span></span></span></span><span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Controller</span></span></span></span>::items(<span class="hljs-formula"><span class="hljs-formula">$Request, $</span></span>Response) : mixed cs<span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">modules</span></span></span></span><span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Blogs</span></span></span></span><span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">api</span></span></span></span><span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Controller</span></span></span></span>::items_get(<span class="hljs-formula"><span class="hljs-formula">$Request, $</span></span>Response) : mixed cs<span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">modules</span></span></span></span><span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Blogs</span></span></span></span><span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">api</span></span></span></span><span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Controller</span></span></span></span>::items_comments(<span class="hljs-formula"><span class="hljs-formula">$Request, $</span></span>Response) : mixed cs<span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">modules</span></span></span></span><span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Blogs</span></span></span></span><span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">api</span></span></span></span><span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Controller</span></span></span></span>::items_comments_get(<span class="hljs-formula"><span class="hljs-formula">$Request, $</span></span>Response) : mixed</code> </pre><br>  In this case, at least one of the last two files / controllers must exist. <br><br>  As you can see, for API and CLI requests, an explicit separation of request processing code with different HTTP methods is used, while for ordinary pages and administration pages this is not taken into account. <br><br><h3>  Arguments in controllers and return value </h3><br>  <code>$Request</code> and <code>$Response</code> are nothing but instances of <code>cs\Request</code> and <code>cs\Response</code> . <br><br>  The return value in simple cases is sufficient to set the content.  Under the hood for API requests, the return value will be passed to <code>cs\Page::json()</code> , and for other requests to <code>cs\Page::content()</code> . <br><br><pre> <code class="php hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">items_comments_get</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> []; } <span class="hljs-comment"><span class="hljs-comment">//   public static function items_comments_get () { Page::instance-&gt;json([]); }</span></span></code> </pre> <br><h3>  Non-existent HTTP method handlers </h3><br>  It may happen that there is no HTTP handler method that the user requests, in this case there are several scenarios. <br><br>  API: if neither <code>cs\modules\Blogs\api\Controller::items_comments()</code> nor <code>cs\modules\Blogs\api\Controller::items_comments_get()</code> (or similar files) are <code>cs\modules\Blogs\api\Controller::items_comments_get()</code> , then: <br><br><ul><li>  first, the existence of an <code>OPTIONS</code> method handler will be checked, if it exists, it decides what to do with it <br><br></li><li>  if there is no <code>OPTIONS</code> method handler, then the automatically generated list of existing methods will be sent in the <code>Allow</code> header (if the called method was different from <code>OPTIONS</code> , then the status code will be changed to <code>501 Not Implemented</code> ) </li></ul><br>  CLI: Similar to the API, but instead of <code>OPTIONS</code> <code>CLI</code> is a special method, and instead of the <code>Allow</code> header, the available methods will be displayed in the console (if the called method was different from the <code>CLI</code> , then the output status will be changed to <code>245</code> ( <code>501 % 256</code> )). <br><br><h3>  Using your own routing system </h3><br>  If for some reason you don‚Äôt like the routing device in the framework, in each separate module you can create only the <code>index.php</code> file and connect the router to taste. <br><br>  Since <code>index.php</code> does not require controllers and structure in <code>index.json</code> , you will <code>index.json</code> most of the routing system. <br><br><h3>  Access rights </h3><br>  Permissions are checked for each route level.  Permissions in the framework have two key parameters: a group and a label. <br><br>  The name of the module with an optional prefix for administration pages and API is used as a group when checking access permissions to the page; the route path is used as a label (without taking into account the <code>index</code> prefix). <br><br>  For example, for the <code>api/Module_name/items/comments</code> page, the user rights for permissions will be checked (with a space of <code>group label</code> ): <br><br><pre> <code class="hljs pgsql">api/Module_name <span class="hljs-keyword"><span class="hljs-keyword">index</span></span> api/Module_name items api/Module_name items/comments</code> </pre><br>  If at some level the user does not have access, the processing will end with a <code>403 Forbidden</code> error, while the handlers of the previous levels will not be executed, since the access rights are determined at the stage of final formation of the route, before the handlers are launched. <br><br><h3>  At last </h3><br>  The implementation of query processing in the CleverStyle Framework is quite powerful and flexible, while being declarative. <br><br>  The article describes the key stages of processing requests from the point of view of the routing system and its interest for the developer, but in fact, if you delve into the nuances, there is still something to learn. <br><br>  I hope this guide is enough to not get lost.  Now it should be clear why, in order to determine which code was called in response to a particular request, you do not even need to look into the configuration.  It is enough to determine the type of routing used by the presence of <code>Controller.php</code> in the target folder and open the corresponding file. <br><br>  The current version of the framework at the time of writing of article 5.29, in newer versions are subject to change, follow the release notes. <br><br>  ¬ª <a href="https://github.com/nazar-pc/CleverStyle-Framework">GitHub repository</a> <br>  ¬ª <a href="https://github.com/nazar-pc/CleverStyle-Framework/tree/master/docs">Framework documentation</a> <br><br>  Constructive comments are usually welcome. </div><p>Source: <a href="https://habr.com/ru/post/307690/">https://habr.com/ru/post/307690/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../307672/index.html">Procedural generation of levels for puzzle games</a></li>
<li><a href="../307674/index.html">New user of your product - how to help him?</a></li>
<li><a href="../307680/index.html">Tim Cook's long game at Apple</a></li>
<li><a href="../307686/index.html">Refinement of Squid log parser for correct viewing of resources visited by HTTPS</a></li>
<li><a href="../307688/index.html">How different are sales directors and founders of IT companies?</a></li>
<li><a href="../307692/index.html">Creating a WebView application based on AWS ApiGateway and AWS Lambda</a></li>
<li><a href="../307694/index.html">Progressive loading of a web application using code sharing</a></li>
<li><a href="../307696/index.html">Juniper Hardware Architecture</a></li>
<li><a href="../307698/index.html">In the wake of "spammer" or Oracle DB + UTL_SMTP + SSL / TLS</a></li>
<li><a href="../307700/index.html">The digest of interesting materials for the mobile # 166 developer (on August 8-14)</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>