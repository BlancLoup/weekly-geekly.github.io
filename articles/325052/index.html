<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Technocup: results of the final round and task analysis</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="On March 5, the final round of the Technoclub took place - a programming contest for schoolchildren. This year, 3000 people took part in it, 400 of wh...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Technocup: results of the final round and task analysis</h1><div class="post__text post__text-html js-mediator-article"><p><img src="https://habrastorage.org/files/c3d/be2/408/c3dbe240843c48a08e9bf957720485d6.jpg" alt="image"></p><br><p>  On March 5, the final round of the Technoclub took place - a programming contest for schoolchildren.  This year, 3000 people took part in it, 400 of whom went to the final.  We invite you to take a look at the final results and the analysis of tasks: </p><br><p>  A. <a href="https://habr.com/ru/company/mailru/blog/325052/">Andrew and socks</a> <br>  B. <a href="https://habr.com/ru/company/mailru/blog/325052/">The meeting place cannot be changed</a> <br>  C. <a href="https://habr.com/ru/company/mailru/blog/325052/">Andryusha and colorful balls</a> <br>  D. <a href="https://habr.com/ru/company/mailru/blog/325052/">Innokenty and the football league</a> <br>  E. <a href="https://habr.com/ru/company/mailru/blog/325052/">Underground laboratory</a> <br>  F. <a href="https://habr.com/ru/company/mailru/blog/325052/">Axel and Marston in Beatland</a> <br>  G. <a href="https://habr.com/ru/company/mailru/blog/325052/">Andrew and the living barriers</a> <br>  H. <a href="https://habr.com/ru/company/mailru/blog/325052/">Buses and Intranet</a> </p><br><p>  What is Technocup?  This is a programming contest for students in grades 8-11, organized by the Mail.Ru Group together with the MGTU.  Bauman and MIPT.  It consists of three stages: trial (online), qualifying (online) and final (in-person). </p><a name="habracut"></a><br><p>  <u>Introductory rounds</u> - online rounds for exploring the Codeforces platform.  They are invited to solve two simple tasks to understand the system.  Such rounds are held before each qualifying round.  Their results do not affect the final ranking in the competition grid. </p><br><p>  <u>Qualifying rounds</u> - online rounds on the Codeforces platform.  According to the results, the best programmers reach the final.  At such rounds it is proposed to solve six problems.  To get to the final stage, you must pass the selection of at least one of these rounds. </p><br><p>  <u>The final round</u> is the internal stage of the Olympiad.  It takes place in Moscow in March 2017 on the basis of MIPT and MSTU.  Bauman.  Participants are invited to solve problems on computers on the Codeforces platform. </p><br><p>  <u>Rewarding</u>  In 2017, the winners and prize-winners of Tekhnokubka receive, when they enroll in universities, the benefits of a third-level Olympiad, special conditions for admission to the Moscow Institute of Physics and Technology and the Moscow State Technical University.  Bauman. </p><br><p>  All participants in the intramural stage receive memorable prizes.  Usually these are championship t-shirts.  For the first three places there is also a valuable prize in the form of Apple equipment, and the winner is waiting for Technocup.  The winners are awarded at the Mail.Ru Group office, where they can chat with the developers and see their jobs. </p><br><p><img src="https://habrastorage.org/files/6e0/598/6c4/6e05986c44b0407786166d820cddb558.png" alt="image"></p><br><h2 id="pobediteli-tehnokubka-2017">  Tehnokubka winners 2017 </h2><br><p>  In 2017, Alexandra Drozdova, Moscow, 11th grade student of SSC Moscow State University, won second place a year earlier, won the Technocup.  On the second line in the list of leaders was Arthur Petukhovsky, Vitebsk, and on the third - Vladimir Romanov, Moscow.  Full results can be found <a href="https://technocup.mail.ru/media/docs/%25D0%25A0%25D0%25B5%25D0%25B7%25D1%2583%25D0%25BB%25D1%258C%25D1%2582%25D0%25B0%25D1%2582%25D1%258B_%25D0%25B7%25D0%25B0%25D0%25BA%25D0%25BB%25D1%258E%25D1%2587%25D0%25B8%25D1%2582%25D0%25B5%25D0%25BB%25D1%258C%25D0%25BD%25D0%25BE%25D0%25B3%25D0%25BE_%25D1%258D%25D1%2582%25D0%25B0%25D0%25BF%25D0%25B0_%25D0%25A2%25D0%25B5%25D1%2585%25D0%25BD%25D0%25BE%25D0%25BA%25D1%2583%25D0%25B1%25D0%25BE%25D0%25BA_2017.pdf">here</a> .  Congratulations to the winners! </p><br><p><img src="https://habrastorage.org/files/79f/ce3/640/79fce364030249c48408052aa87e8aad.png" alt="image"></p><br><h2 id="razbor-zadach-finalnogo-raunda">  Analysis of the tasks of the final round </h2><br><p>  The participants of the final were offered to solve 8 problems in 3 hours.  The top three managed to cope with a family of them.  Another 17 people overcame 6 tasks, and 32 people coped with 5 tasks. </p><br><p><img src="https://habrastorage.org/files/2fc/d96/bca/2fcd96bca39a4f1780be25cf87f2b60a.png" alt="image"></p><br><h3 id="a-andryusha-i-noski">  A. Andrew and socks </h3><br><p>  Time limit per test - 2 seconds <br>  Memory limit per test - 256 megabytes <br>  Input - Standard Input <br>  Output - Standard Output </p><br><p>  Andryusha is a very neat and tidy boy, so he always keeps order in his room.  In particular, he is very careful about putting his things in the closet. </p><br><p>  Today, he faced a difficult task - to put socks in the cabinet.  Andryusha has <em>n</em> different pairs of socks, which were originally bagged.  Pairs of socks are numbered from 1 to <em>n</em> .  Andrew wants to remove the socks in the closet in pairs.  To do this, he one by one pulls out the socks from the bag, and for each pulled out sock it looks to see if he already took out a pair of it.  If not, which means that the pair of current sock is still in the bag, then Andryusha puts the current sock on the table in front of him.  Otherwise, he removes the current sock and his pair in the closet. </p><br><p>  Andrew is very attentive, so he remembered the order in which he got his socks out of the bag.  Now he wondered, and what was the maximum number of socks at the same time lying on the table in front of him?  Help Andryusha to answer this question. </p><br><p>  <strong>Input data</strong> </p><br><p>  The first line contains a single integer <em>n</em> (1 ‚â§ <em>n</em> ‚â§ 10 <sup>5</sup> ) - the number of pairs of socks. </p><br><p>  The second line contains space-separated 2 <em>n</em> numbers <em>x</em> <sub>1</sub> , <em>x</em> <sub>2</sub> , ..., <em>x</em> <sub>2 <em>n</em></sub> (1 ‚â§ <em>x <sub>i</sub></em> ‚â§ <em>n</em> ), which describe the order in which Andryusha took his socks out of the bag.  Namely, the number <em>x <sub>i</sub></em> means that the <em>i</em> -th in order Andryusha got a sock from the pair <em>x <sub>i</sub></em> . </p><br><p>  It is guaranteed that Andryusha got exactly two socks from each pair. </p><br><p>  <strong>Output</strong> </p><br><p>  In a single line print one number - the maximum number of socks that have ever been on the table in front of Andrew. </p><br><p>  <strong>Examples</strong> </p><br><p>  Input data <br>  one <br>  eleven </p><br><p>  Output <br>  one </p><br><p>  Input data <br>  3 <br>  2 1 1 3 2 3 </p><br><p>  Output <br>  2 </p><br><p>  <strong>Note</strong> </p><br><p>  In the first example of the condition, Andryusha takes a sock out of the bag from the first pair and puts it on the table.  Then he pulls out the next sock, which is also from the first pair, so he immediately takes both socks and puts them in the closet.  Thus, a maximum of one sock lay on the table. </p><br><p>  Consider what happens in the second example: </p><br><ul><li>  At first there is nothing on the table, Andryusha gets a sock out of the pair number 2. </li><li>  On the table lies a sock (2).  Andrew pulls out a sock from a pair of number 1 and puts it on the table. </li><li>  On the table are socks (1, 2).  Andrew pulls out a sock from a pair of number 1, but such a sock is already on the table.  Therefore, Andryusha removes both socks in the closet. </li><li>  On the table lies a sock (2).  Andrew pulls out a sock from a pair of number 3 and puts it on the table. </li><li>  Socks are on the table (2, 3).  Andryusha pulls out a sock from pair number 2, but such a sock is already on the table.  Therefore, Andryusha removes both socks in the closet. </li><li>  On the table lies a sock (3).  Andrew pulls out a sock from a pair of number 3, but such a sock is already on the table.  Therefore, Andryusha removes both socks in the closet. </li></ul><br><p>  Thus, on the table at a time lay a maximum of two socks. </p><br><div class="spoiler">  <b class="spoiler_title">Task analysis</b> <div class="spoiler_text"><p>  Simple task to implement.  We will keep in the array whether the sock of each type is on the table, we will also store the number of socks and the largest value of this number.  Now we will process the socks one by one and update all the necessary values. </p><br><p>  Difficulty: <em>O</em> ( <em>n</em> ) time and memory. </p></div></div><br><h3 id="b-mesto-vstrechi-izmenit-nelzya">  B. The meeting place cannot be changed </h3><br><p>  Time limit per test - 5 seconds <br>  Memory limit per test - 256 megabytes <br>  Input - Standard Input <br>  Output - Standard Output </p><br><p>  The main street in Baytsiti has the appearance of a long straight line from south to north.  For convenience of orientation on a straight line, the coordinates are entered, measured in meters from the southernmost house towards the north. </p><br><p>  In some points of the street there are now <em>n</em> friends, and the <em>i-</em> th of them is located at the point with the coordinate <em>x <sub>i</sub></em> meters and can move with a maximum speed of <em>v <sub>i</sub></em> meters per second in either of two directions along the street - to the south or to the north. </p><br><p>  You have the task to determine the minimum time during which all <em>n</em> friends can meet at one point on the main street.  Note that the point where friends will meet is not required to have an integer coordinate. </p><br><p>  <strong>Input data</strong> </p><br><p>  The first line contains a single integer <em>n</em> (2 ‚â§ <em>n</em> ‚â§ 60 000) - the number of friends. </p><br><p>  The second line contains <em>n</em> integers <em>x</em> <sub>1</sub> , <em>x</em> <sub>2</sub> , ..., <em>x <sub>n</sub></em> (1 ‚â§ <em>x <sub>i</sub></em> ‚â§ 10 <sup>9</sup> ) - the current coordinates of friends in meters. </p><br><p>  The third line contains <em>n</em> integers <em>v</em> <sub>1</sub> , <em>v</em> <sub>2</sub> , ..., <em>v <sub>n</sub></em> (1 ‚â§ <em>v <sub>i</sub></em> ‚â§ 10 <sup>9</sup> ) - the maximum speeds of friends in meters per second. </p><br><p>  <strong>Output</strong> </p><br><p>  Print the minimum time (in seconds) for which all <em>n</em> people can meet at one point. </p><br><p>  Your answer will be considered correct if its absolute or relative error does not exceed 10 <sup>- 6</sup> .  Formally, let your answer be <em>a</em> , and the jury's answer <em>b</em> .  Your answer will be considered correct if <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-1-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="30.098ex" height="2.901ex" viewBox="0 -935.7 12959 1249" role="img" focusable="false" style="vertical-align: -0.728ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325052/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg71bLrIzlLvg1xeN-hiRPgMDg51A#MJMATHI-66" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325052/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg71bLrIzlLvg1xeN-hiRPgMDg51A#MJMATHI-72" x="800" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325052/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg71bLrIzlLvg1xeN-hiRPgMDg51A#MJMATHI-61" x="1252" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325052/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg71bLrIzlLvg1xeN-hiRPgMDg51A#MJMATHI-63" x="1781" y="0"></use><g transform="translate(2215,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325052/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg71bLrIzlLvg1xeN-hiRPgMDg51A#MJMAIN-7C" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325052/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg71bLrIzlLvg1xeN-hiRPgMDg51A#MJMATHI-61" x="278" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325052/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg71bLrIzlLvg1xeN-hiRPgMDg51A#MJMAIN-2212" x="1030" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325052/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg71bLrIzlLvg1xeN-hiRPgMDg51A#MJMATHI-62" x="2030" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325052/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg71bLrIzlLvg1xeN-hiRPgMDg51A#MJMAIN-7C" x="2460" y="0"></use></g><g transform="translate(4953,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325052/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg71bLrIzlLvg1xeN-hiRPgMDg51A#MJMATHI-6D" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325052/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg71bLrIzlLvg1xeN-hiRPgMDg51A#MJMATHI-61" x="878" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325052/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg71bLrIzlLvg1xeN-hiRPgMDg51A#MJMATHI-78" x="1408" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325052/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg71bLrIzlLvg1xeN-hiRPgMDg51A#MJMAIN-28" x="1980" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325052/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg71bLrIzlLvg1xeN-hiRPgMDg51A#MJMAIN-31" x="2370" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325052/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg71bLrIzlLvg1xeN-hiRPgMDg51A#MJMAIN-2C" x="2870" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325052/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg71bLrIzlLvg1xeN-hiRPgMDg51A#MJMATHI-62" x="3315" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325052/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg71bLrIzlLvg1xeN-hiRPgMDg51A#MJMAIN-29" x="3745" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325052/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg71bLrIzlLvg1xeN-hiRPgMDg51A#MJMAIN-29" x="4134" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325052/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg71bLrIzlLvg1xeN-hiRPgMDg51A#MJMATHI-6C" x="9728" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325052/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg71bLrIzlLvg1xeN-hiRPgMDg51A#MJMATHI-65" x="10026" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325052/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg71bLrIzlLvg1xeN-hiRPgMDg51A#MJMATHI-71" x="10493" y="0"></use><g transform="translate(10953,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325052/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg71bLrIzlLvg1xeN-hiRPgMDg51A#MJMAIN-31"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325052/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg71bLrIzlLvg1xeN-hiRPgMDg51A#MJMAIN-30" x="500" y="0"></use><g transform="translate(1001,393)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325052/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg71bLrIzlLvg1xeN-hiRPgMDg51A#MJMAIN-2212" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325052/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg71bLrIzlLvg1xeN-hiRPgMDg51A#MJMAIN-36" x="778" y="0"></use></g></g></g></svg></span><script type="math/tex" id="MathJax-Element-1"> \ frac {| a-b |} {max (1, b))} \ leq 10 ^ {- 6} </script>  . </p><br><p>  <strong>Examples</strong> </p><br><p>  Input data <br>  3 <br>  7 1 3 <br>  1 2 1 </p><br><p>  Output <br>  2.000000000000 <br>  Input data <br>  four <br>  5 10 3 2 <br>  2 3 2 4 </p><br><p>  Output <br>  1.400000000000 </p><br><p>  <strong>Note</strong> </p><br><p>  In the first example, all friends can meet at point 5 in 2 seconds.  For this, the first friend must go all the time with his maximum speed to the south, and the second and third must go with their maximum speeds to the north. </p><br><div class="spoiler">  <b class="spoiler_title">Task analysis</b> <div class="spoiler_text"><p>  We use the binary search for the answer.  Inside a binary search, you need to check whether all friends can meet in <em>t</em> seconds.  During this time, the <em>i-</em> th friend can be at any point of the segment [ <em>x <sub>i</sub></em> - <em>tv <sub>i</sub></em> , <em>x <sub>i</sub></em> + <em>tv <sub>i</sub></em> ].  For a meeting to be possible, some point must belong to all these segments, that is, their intersection must be non-empty. </p><br><p>  A convenient way to intersect a set of segments [ <em>l</em> <sub>1</sub> , <em>r</em> <sub>1</sub> ], ..., [ <em>l <sub>n</sub></em> , <em>r <sub>n</sub></em> ] is to calculate <em>L</em> = <em>max l <sub>i</sub></em> and <em>R</em> = <em>min r <sub>i</sub></em> .  If <em>L</em> ‚â§ <em>R</em> , then [ <em>L</em> , <em>R</em> ] is the desired intersection, otherwise the intersection is empty. </p><br><p>  Complexity: <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-2-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="28.175ex" height="3.037ex" viewBox="0 -950 12130.9 1307.5" role="img" focusable="false" style="vertical-align: -0.83ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325052/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg71bLrIzlLvg1xeN-hiRPgMDg51A#MJMATHI-4F" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325052/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg71bLrIzlLvg1xeN-hiRPgMDg51A#MJMAIN-28" x="763" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325052/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg71bLrIzlLvg1xeN-hiRPgMDg51A#MJMATHI-6E" x="1153" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325052/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg71bLrIzlLvg1xeN-hiRPgMDg51A#MJMATHI-63" x="2003" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325052/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg71bLrIzlLvg1xeN-hiRPgMDg51A#MJMATHI-64" x="2437" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325052/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg71bLrIzlLvg1xeN-hiRPgMDg51A#MJMATHI-6F" x="2960" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325052/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg71bLrIzlLvg1xeN-hiRPgMDg51A#MJMATHI-74" x="3446" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325052/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg71bLrIzlLvg1xeN-hiRPgMDg51A#MJMATHI-6C" x="3807" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325052/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg71bLrIzlLvg1xeN-hiRPgMDg51A#MJMATHI-6F" x="4106" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325052/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg71bLrIzlLvg1xeN-hiRPgMDg51A#MJMATHI-67" x="4591" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325052/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg71bLrIzlLvg1xeN-hiRPgMDg51A#MJMAIN-28" x="5072" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325052/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg71bLrIzlLvg1xeN-hiRPgMDg51A#MJMATHI-76" x="5711" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325052/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg71bLrIzlLvg1xeN-hiRPgMDg51A#MJMATHI-61" x="6197" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325052/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg71bLrIzlLvg1xeN-hiRPgMDg51A#MJMATHI-72" x="6726" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325052/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg71bLrIzlLvg1xeN-hiRPgMDg51A#MJMATHI-65" x="7178" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325052/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg71bLrIzlLvg1xeN-hiRPgMDg51A#MJMATHI-70" x="7644" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325052/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg71bLrIzlLvg1xeN-hiRPgMDg51A#MJMATHI-73" x="8148" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325052/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg71bLrIzlLvg1xeN-hiRPgMDg51A#MJMATHI-69" x="8617" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325052/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg71bLrIzlLvg1xeN-hiRPgMDg51A#MJMATHI-6C" x="8963" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325052/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg71bLrIzlLvg1xeN-hiRPgMDg51A#MJMATHI-6F" x="9261" y="0"></use><g transform="translate(9747,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325052/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg71bLrIzlLvg1xeN-hiRPgMDg51A#MJMATHI-6E" x="0" y="0"></use><g transform="translate(600,362)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325052/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg71bLrIzlLvg1xeN-hiRPgMDg51A#MJMAIN-2212" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325052/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg71bLrIzlLvg1xeN-hiRPgMDg51A#MJMAIN-31" x="778" y="0"></use></g></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325052/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg71bLrIzlLvg1xeN-hiRPgMDg51A#MJMAIN-29" x="11351" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325052/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg71bLrIzlLvg1xeN-hiRPgMDg51A#MJMAIN-29" x="11741" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-2"> O (n \ cdot log (\ varepsilon ^ {- 1})) </script>  time and <em>O (n)</em> memory.  Here Œµ is the required relative error. </p></div></div><br><h3 id="c-andryusha-i-raznocvetnye-shariki">  C. Andryusha and colorful balls </h3><br><p>  Time limit per test - 2 seconds <br>  Memory limit per test - 256 megabytes <br>  Input - Standard Input <br>  Output - Standard Output </p><br><p>  Andryusha walks through the city park every day since his childhood.  The tracks and glades of the park all the time seemed to him too identical, and once he decided to decorate them and make them diverse. </p><br><p>  The park consists of n glades, which are interconnected (n - 1) by two-way lanes, and from each glade you can walk along the paths to any other. </p><br><p>  Andrew decided to hang one colored ball on each clearing.  The colors of the balls are given by positive integers, starting from 1. To make the park more diverse, Andryusha decided to choose the colors of the balls in a special way.  Namely, he wants to hang the balls so that for any three pair of different glades <em>a</em> , <em>b</em> and <em>c</em> such that <em>a</em> and <em>b are</em> connected by a track, and <em>b</em> and <em>c are</em> connected by a track, the colors of the balls on these fields are pairwise different. </p><br><p>  In order not to spend a lot of money on the purchase of balls, Andryusha wants to use as few different colors as possible.  Since Andryusha is not very good at programming, he asks you to help him solve this problem. </p><br><p>  <strong>Input data</strong> </p><br><p>  The first line contains a single integer <em>n</em> (3 ‚â§ <em>n</em> ‚â§ 2 ‚Ä¢ 10 <sup>5</sup> ) - the number of glades in the park. </p><br><p>  In each of the following ( <em>n</em> - 1) lines there are two integers <em>x</em> and <em>y</em> (1 ‚â§ <em>x</em> , <em>y</em> ‚â§ <em>n</em> ) - the numbers of the two meadows connected by the next track. </p><br><p>  It is guaranteed that from any clearing you can get to any other paths. </p><br><p>  <strong>Output</strong> </p><br><p>  In the first line print a single integer <em>k</em> - the minimum number of colors that Andryusha needs to use. </p><br><p>  In the second line print <em>n</em> integers, the <em>i</em> -th of which is equal to the color of the ball to be hung on the <em>i-</em> th clearing.  Each of the numbers must be in the range from 1 to <em>k</em> . </p><br><p>  <strong>Examples</strong> </p><br><p>  Input data <br>  3 <br>  2 3 <br>  13 </p><br><p>  Output <br>  3 <br>  1 3 2 </p><br><p>  Input data <br>  five <br>  2 3 <br>  5 3 <br>  4 3 <br>  13 </p><br><p>  Output <br>  five <br>  1 3 2 5 4 </p><br><p>  Input data <br>  five <br>  2 1 <br>  3 2 <br>  4 3 <br>  5 4 </p><br><p>  Output <br>  3 <br>  1 2 3 1 2 </p><br><p>  <strong>Note</strong> </p><br><p>  In the first example, the condition of the park consists of three glades, which are connected in series: 1 ‚Üí 3 ‚Üí 2. This means that the colors of the balls on each meadow should be pairwise different. </p><br><p><img src="https://habrastorage.org/files/39a/c2e/8f5/39ac2e8f5c0f469b90ed3120e535ff4c.png" alt="image"><br>  <em>Illustration to the first example</em> </p><br><p>  In the second example in the park you can find the following triples of meadows connected in series: </p><br><ul><li>  1 ‚Üí 3 ‚Üí 2 </li><li>  1 ‚Üí 3 ‚Üí 4 </li><li>  1 ‚Üí 3 ‚Üí 5 </li><li>  2 ‚Üí 3 ‚Üí 4 </li><li>  2 ‚Üí 3 ‚Üí 5 </li><li>  4 ‚Üí 3 ‚Üí 5 </li></ul><br><p>  From here we see that each pair of meadows lies in some kind of triplet, which means that the colors of the balls on all the glades should be different in pairs. </p><br><p><img src="https://habrastorage.org/files/163/99a/591/16399a591a2345bb884aca0781b8a4b1.png" alt="image"><br>  <em>Illustration to the second example</em> </p><br><p>  In the third example there are the following triples: </p><br><ul><li>  1 ‚Üí 2 ‚Üí 3 </li><li>  2 ‚Üí 3 ‚Üí 4 </li><li>  3 ‚Üí 4 ‚Üí 5 </li></ul><br><p>  This means that one or two colors is not enough, and for three colors the answer exists and is given in the example. </p><br><p><img src="https://habrastorage.org/files/041/699/1fa/0416991fa8114ad0b9ff58d4954e4cc4.png" alt="image"><br>  <em>Illustration for the third example</em> </p><br><div class="spoiler">  <b class="spoiler_title">Task analysis</b> <div class="spoiler_text"><p>  If the vertex v has degree <em>d</em> , then the answer is at least <em>d</em> + 1. Indeed, any two neighbors <em>v</em> lie on a common path of length 3 passing through <em>v</em> .  In addition, <em>v</em> lies on a common path of three vertices with any of its neighbors (possibly using non-neighbors).  This means that <em>v</em> and all its neighbors must have pairs of different colors. </p><br><p>  We show that this estimate is the best.  Construct the coloring of the tree in <em>D</em> + 1 color, where <em>D</em> is the maximum degree of the vertex.  We hang a tree by any vertex, after which we color the root and all its sons in colors 1, 2, and so on.  The remaining vertices are colored according to the following rule: if the vertex <em>v</em> has the color <em>x</em> , and its parent has the color <em>y</em> , then the children <em>v</em> receive consecutive colors starting from 1 and skipping the colors <em>x</em> and <em>y</em> .  It is easy to see that colors with numbers greater than <em>D</em> + 1 will never be needed. </p><br><p>  From the point of view of implementation, this procedure is a usual detour in depth. </p><br><p>  Difficulty: <em>O</em> ( <em>n</em> ) time and memory. </p></div></div><br><h3 id="d-innokentiy-i-futbolnaya-liga">  D. Innokenty and the football league </h3><br><p>  Time limit per test - 2 seconds <br>  Memory limit per test - 256 megabytes <br>  Input - Standard Input <br>  Output - Standard Output </p><br><p>  Innokenty is the president of the newly established football league in Byteland.  The first task that he faces is to ensure the broadcast of all league matches on television.  As you may know, during a football match, abbreviated names of teams and current scores are displayed on the screen.  Of course, it will be strange if the abbreviated names of the clubs of the opponents match, so Innokentiy should figure out how to reduce the name of each of the league‚Äôs clubs to three letters so that all the teams of the league have different names. </p><br><p>  The name of each club consists of two words: the name of the team and the city where the club is located, for example, ‚ÄúDINAMO BYTECITY‚Äù.  Innocent does not want to distort the name, so he wants to choose an abbreviated name for each of the clubs in such a way that: </p><br><p>  1) either the abbreviated name of the club coincided with the first three letters of the team name, for example, for the above command it is ‚ÄúDIN‚Äù, <br>  2) either the first two letters of the abbreviated name of the club coincided with the first two letters of the team name, and the third with the first letter of the city of the team.  For example, for the above command this is ‚ÄúDIB‚Äù. </p><br><p>  In addition, if for some command <em>x the</em> second version of the name is chosen, then there should not be a command that has the first version of the abbreviated name, which coincides with the first version of the command name <em>x</em> .  For example, if the abbreviated name of the above command is ‚ÄúDIB‚Äù, then no command that has the first version of the abbreviated name chosen should have the abbreviated name ‚ÄúDIN‚Äù.  It is possible that some team will receive the name "DIN", where "DI" is the first two letters of the team name, and "N" is the first letter of the city.  Of course, no two teams should have the same abbreviated name. </p><br><p>  Help Innocent choose a short name for each of the teams.  If this is not possible, report it.  If there are several possible answers, Innocent will suit any of them.  If for a certain team both versions of the abbreviated name are the same, then Innocent will still formally assume that only one of these options is chosen. </p><br><p>  <strong>Input data</strong> </p><br><p>  The first line contains a single integer <em>n</em> (1 ‚â§ <em>n</em> ‚â§ 1000) - the number of football clubs in the league. </p><br><p>  Each of the next <em>n</em> lines contains two words - the name of the team and the name of the city of the next club.  Both the name of the team and the name of the city consist of capital letters of the Latin alphabet and have a length of not less than 3 and not more than 20. </p><br><p>  <strong>Output</strong> </p><br><p>  If you choose abbreviated names that meet the requirements of Innocent, it is impossible to output a single line "NO". </p><br><p>  Otherwise, print on the first line "YES".  Then output <em>n</em> lines, in each line print the abbreviated name of the next club.  Output the clubs in the order in which they are given in the input data. </p><br><p>  If there are several possible answers, output any. </p><br><p>  <strong>Examples</strong> </p><br><p>  Input data <br>  2 <br>  DINAMO BYTECITY <br>  FOOTBALL MOSCOW </p><br><p>  Output <br>  YES <br>  DIN <br>  FOO </p><br><p>  Input data <br>  2 <br>  DINAMO BYTECITY <br>  DINAMO BITECITY </p><br><p>  Output <br>  NO </p><br><p>  Input data <br>  3 <br>  PLAYFOOTBALL MOSCOW <br>  PLAYVOLLEYBALL SPB <br>  GOGO TECHNOCUP </p><br><p>  Output <br>  YES <br>  PLM <br>  Pls <br>  Gog </p><br><p>  Input data <br>  3 <br>  ABC DEF <br>  ABC EFG <br>  ABD OOO </p><br><p>  Output <br>  YES <br>  ABD <br>  ABE <br>  Abo </p><br><p>  <strong>Note</strong> </p><br><p>  In the first example, you can choose the first name option for both teams. </p><br><p>  In the second example, it is impossible to choose names, since according to the condition it is impossible for one team to choose the first variant of the name, and for the second one to choose the second variant of the name, if the first variants of the names of these commands coincide. </p><br><p>  In the third example, you can select the second name options for the first two teams, and the first option is for the third team. </p><br><p>  In the fourth example, notice that it is permitted that the selected name of some command <em>x</em> matches the first version of the name <em>y</em> , if the first version of the name <em>x</em> does not match the first version of the name <em>y</em> . </p><br><div class="spoiler">  <b class="spoiler_title">Task analysis</b> <div class="spoiler_text"><p>  We will denote <em>a <sub>i</sub></em> and <em>b <sub>i the</sub></em> first and second options for the name of the <em>i-th</em> club, respectively. </p><br><p>  If all <em>a <sub>i are</sub></em> different, we can use all of them as names.  Otherwise, suppose that <em>a <sub>i</sub></em> = <em>a <sub>j</sub></em> for some clubs <em>i</em> and <em>j</em> , then they cannot be used simultaneously.  In addition, to choose, for example, <em>a <sub>i</sub></em> and <em>b <sub>j</sub></em> in such a situation is also prohibited by the condition.  It turns out that we have to choose <em>b <sub>i</sub></em> and <em>b <sub>j</sub></em> as names. </p><br><p>  If now for some other club <em>k</em> we have <em>a <sub>k</sub></em> = <em>b <sub>i</sub></em> , then we should choose <em>b <sub>k</sub></em> as its name.  Such chain dependencies can be processed by any bypass algorithm.  If at some point we are obliged to use the same names, then there is no solution, otherwise after resolving all the conflicts we will get the right solution. </p><br><p>  Difficulty: <em>O (n)</em> time and memory with accurate implementation (in these limitations it was not necessary). </p></div></div><br><h3 id="e-podzemnaya-laboratoriya">  E. Underground laboratory </h3><br><p>  Time limit per test - 1 second <br>  Memory limit per test - 256 megabytes <br>  Input - Standard Input <br>  Output - Standard Output </p><br><p>  In a huge underground laboratory, the evil Umbrella Corporation creates clones for its terrible experiments.  Once the company cloned a boy named Andryusha, who was smarter than his peers.  Andrew realized that something was going on around the wrong.  He raised clones to fight against the corporation, and they began to look for a way out of the laboratory.  The company had no choice but to launch the process of self-destruction of the underground complex. </p><br><p>  The laboratory is a connected graph of <em>n</em> vertices and <em>m</em> edges.  In some vertices of this graph, <em>k</em> clones of Andryusha begin to search for a way out of the laboratory.  In the process of searching, every second they go along the edge to the next vertex, and at each vertex there can be as many clones as you like.  Each clone can stop and stop searching at some point in time, but it must start them, that is, visit at least one vertex.  Moreover, the output can be in an arbitrary place in the laboratory, so the clones must bypass the entire graph, that is, each vertex of the graph must be visited at least one clone at least once. </p><br><p>  The time of the clones is limited, and each of them can bypass no more <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-3-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="29.19ex" height="2.419ex" viewBox="0 -780.1 12568 1041.5" role="img" focusable="false" style="vertical-align: -0.607ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325052/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg71bLrIzlLvg1xeN-hiRPgMDg51A#MJMATHI-6C" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325052/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg71bLrIzlLvg1xeN-hiRPgMDg51A#MJMATHI-65" x="548" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325052/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg71bLrIzlLvg1xeN-hiRPgMDg51A#MJMATHI-66" x="1015" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325052/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg71bLrIzlLvg1xeN-hiRPgMDg51A#MJMATHI-74" x="1565" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325052/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg71bLrIzlLvg1xeN-hiRPgMDg51A#MJMATHI-6C" x="2177" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325052/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg71bLrIzlLvg1xeN-hiRPgMDg51A#MJMATHI-63" x="2475" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325052/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg71bLrIzlLvg1xeN-hiRPgMDg51A#MJMATHI-65" x="2909" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325052/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg71bLrIzlLvg1xeN-hiRPgMDg51A#MJMATHI-69" x="3375" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325052/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg71bLrIzlLvg1xeN-hiRPgMDg51A#MJMATHI-6C" x="3721" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325052/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg71bLrIzlLvg1xeN-hiRPgMDg51A#MJMATHI-66" x="4269" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325052/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg71bLrIzlLvg1xeN-hiRPgMDg51A#MJMATHI-72" x="4820" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325052/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg71bLrIzlLvg1xeN-hiRPgMDg51A#MJMATHI-61" x="5271" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325052/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg71bLrIzlLvg1xeN-hiRPgMDg51A#MJMATHI-63" x="5801" y="0"></use><g transform="translate(6234,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325052/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg71bLrIzlLvg1xeN-hiRPgMDg51A#MJMAIN-32" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325052/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg71bLrIzlLvg1xeN-hiRPgMDg51A#MJMATHI-6E" x="500" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325052/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg71bLrIzlLvg1xeN-hiRPgMDg51A#MJMATHI-6B" x="7335" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325052/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg71bLrIzlLvg1xeN-hiRPgMDg51A#MJMATHI-72" x="8107" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325052/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg71bLrIzlLvg1xeN-hiRPgMDg51A#MJMATHI-69" x="8558" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325052/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg71bLrIzlLvg1xeN-hiRPgMDg51A#MJMATHI-67" x="8904" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325052/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg71bLrIzlLvg1xeN-hiRPgMDg51A#MJMATHI-68" x="9384" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325052/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg71bLrIzlLvg1xeN-hiRPgMDg51A#MJMATHI-74" x="9961" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325052/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg71bLrIzlLvg1xeN-hiRPgMDg51A#MJMATHI-72" x="10572" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325052/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg71bLrIzlLvg1xeN-hiRPgMDg51A#MJMATHI-63" x="11024" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325052/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg71bLrIzlLvg1xeN-hiRPgMDg51A#MJMATHI-65" x="11457" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325052/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg71bLrIzlLvg1xeN-hiRPgMDg51A#MJMATHI-69" x="11924" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325052/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg71bLrIzlLvg1xeN-hiRPgMDg51A#MJMATHI-6C" x="12269" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-3"> \ left \ lceil \ frac {2n} {k} \ right \ rceil </script>  rooms before the lab explodes. </p><br><p>  Your task is to place the clones on the vertices of the graph and for each clone to bring the way in which he must bypass the graph.  Moreover, the number of vertices in each path should be no more. <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-4-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="29.19ex" height="2.419ex" viewBox="0 -780.1 12568 1041.5" role="img" focusable="false" style="vertical-align: -0.607ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325052/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg71bLrIzlLvg1xeN-hiRPgMDg51A#MJMATHI-6C" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325052/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg71bLrIzlLvg1xeN-hiRPgMDg51A#MJMATHI-65" x="548" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325052/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg71bLrIzlLvg1xeN-hiRPgMDg51A#MJMATHI-66" x="1015" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325052/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg71bLrIzlLvg1xeN-hiRPgMDg51A#MJMATHI-74" x="1565" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325052/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg71bLrIzlLvg1xeN-hiRPgMDg51A#MJMATHI-6C" x="2177" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325052/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg71bLrIzlLvg1xeN-hiRPgMDg51A#MJMATHI-63" x="2475" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325052/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg71bLrIzlLvg1xeN-hiRPgMDg51A#MJMATHI-65" x="2909" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325052/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg71bLrIzlLvg1xeN-hiRPgMDg51A#MJMATHI-69" x="3375" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325052/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg71bLrIzlLvg1xeN-hiRPgMDg51A#MJMATHI-6C" x="3721" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325052/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg71bLrIzlLvg1xeN-hiRPgMDg51A#MJMATHI-66" x="4269" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325052/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg71bLrIzlLvg1xeN-hiRPgMDg51A#MJMATHI-72" x="4820" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325052/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg71bLrIzlLvg1xeN-hiRPgMDg51A#MJMATHI-61" x="5271" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325052/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg71bLrIzlLvg1xeN-hiRPgMDg51A#MJMATHI-63" x="5801" y="0"></use><g transform="translate(6234,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325052/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg71bLrIzlLvg1xeN-hiRPgMDg51A#MJMAIN-32" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325052/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg71bLrIzlLvg1xeN-hiRPgMDg51A#MJMATHI-6E" x="500" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325052/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg71bLrIzlLvg1xeN-hiRPgMDg51A#MJMATHI-6B" x="7335" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325052/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg71bLrIzlLvg1xeN-hiRPgMDg51A#MJMATHI-72" x="8107" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325052/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg71bLrIzlLvg1xeN-hiRPgMDg51A#MJMATHI-69" x="8558" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325052/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg71bLrIzlLvg1xeN-hiRPgMDg51A#MJMATHI-67" x="8904" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325052/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg71bLrIzlLvg1xeN-hiRPgMDg51A#MJMATHI-68" x="9384" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325052/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg71bLrIzlLvg1xeN-hiRPgMDg51A#MJMATHI-74" x="9961" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325052/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg71bLrIzlLvg1xeN-hiRPgMDg51A#MJMATHI-72" x="10572" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325052/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg71bLrIzlLvg1xeN-hiRPgMDg51A#MJMATHI-63" x="11024" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325052/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg71bLrIzlLvg1xeN-hiRPgMDg51A#MJMATHI-65" x="11457" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325052/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg71bLrIzlLvg1xeN-hiRPgMDg51A#MJMATHI-69" x="11924" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325052/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg71bLrIzlLvg1xeN-hiRPgMDg51A#MJMATHI-6C" x="12269" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-4"> \ left \ lceil \ frac {2n} {k} \ right \ rceil </script>  . </p><br><p>  <strong>Input data</strong> </p><br><p>  The first line contains three integers <em>n</em> , <em>m</em> and <em>k</em> (1 ‚â§ <em>n</em> ‚â§ 2 ‚Ä¢ 10 <sup>5</sup> , <em>n</em> - 1 ‚â§ <em>m</em> ‚â§ 2 ‚Ä¢ 10 <sup>5</sup> , 1 ‚â§ <em>k</em> ‚â§ <em>n</em> ) - the number of vertices in the graph, the number of edges in the graph and number of clones. </p><br><p>  Each of the next <em>m</em> lines contains two integers <em>x <sub>i</sub></em> and <em>y <sub>i</sub></em> (1 ‚â§ <em>x <sub>i</sub></em> , <em>y <sub>i</sub></em> ‚â§ <em>n</em> ) - the numbers of two vertices connected by the next edge.  The graph may contain loops and multiple edges. </p><br><p>  It is guaranteed that the graph is connected. </p><br><p>  <strong>Output</strong> </p><br><p>  Print <em>k</em> lines.  At the beginning of the <em>i-</em> th line output an integer <em>c <sub>i</sub></em> ( <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-5-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="39.013ex" height="2.419ex" viewBox="0 -780.1 16797.3 1041.5" role="img" focusable="false" style="vertical-align: -0.607ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325052/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg71bLrIzlLvg1xeN-hiRPgMDg51A#MJMAIN-31" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325052/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg71bLrIzlLvg1xeN-hiRPgMDg51A#MJMATHI-6C" x="750" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325052/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg71bLrIzlLvg1xeN-hiRPgMDg51A#MJMATHI-65" x="1049" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325052/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg71bLrIzlLvg1xeN-hiRPgMDg51A#MJMATHI-71" x="1515" y="0"></use><g transform="translate(1976,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325052/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg71bLrIzlLvg1xeN-hiRPgMDg51A#MJMATHI-63" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325052/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg71bLrIzlLvg1xeN-hiRPgMDg51A#MJMATHI-69" x="613" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325052/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg71bLrIzlLvg1xeN-hiRPgMDg51A#MJMATHI-6C" x="3003" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325052/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg71bLrIzlLvg1xeN-hiRPgMDg51A#MJMATHI-65" x="3302" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325052/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg71bLrIzlLvg1xeN-hiRPgMDg51A#MJMATHI-71" x="3768" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325052/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg71bLrIzlLvg1xeN-hiRPgMDg51A#MJMATHI-6C" x="4479" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325052/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg71bLrIzlLvg1xeN-hiRPgMDg51A#MJMATHI-65" x="4777" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325052/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg71bLrIzlLvg1xeN-hiRPgMDg51A#MJMATHI-66" x="5244" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325052/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg71bLrIzlLvg1xeN-hiRPgMDg51A#MJMATHI-74" x="5794" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325052/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg71bLrIzlLvg1xeN-hiRPgMDg51A#MJMATHI-6C" x="6406" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325052/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg71bLrIzlLvg1xeN-hiRPgMDg51A#MJMATHI-63" x="6704" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325052/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg71bLrIzlLvg1xeN-hiRPgMDg51A#MJMATHI-65" x="7138" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325052/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg71bLrIzlLvg1xeN-hiRPgMDg51A#MJMATHI-69" x="7604" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325052/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg71bLrIzlLvg1xeN-hiRPgMDg51A#MJMATHI-6C" x="7950" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325052/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg71bLrIzlLvg1xeN-hiRPgMDg51A#MJMATHI-66" x="8498" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325052/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg71bLrIzlLvg1xeN-hiRPgMDg51A#MJMATHI-72" x="9049" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325052/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg71bLrIzlLvg1xeN-hiRPgMDg51A#MJMATHI-61" x="9500" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325052/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg71bLrIzlLvg1xeN-hiRPgMDg51A#MJMATHI-63" x="10030" y="0"></use><g transform="translate(10463,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325052/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg71bLrIzlLvg1xeN-hiRPgMDg51A#MJMAIN-32" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325052/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg71bLrIzlLvg1xeN-hiRPgMDg51A#MJMATHI-6E" x="500" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325052/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg71bLrIzlLvg1xeN-hiRPgMDg51A#MJMATHI-6B" x="11564" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325052/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg71bLrIzlLvg1xeN-hiRPgMDg51A#MJMATHI-72" x="12336" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325052/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg71bLrIzlLvg1xeN-hiRPgMDg51A#MJMATHI-69" x="12787" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325052/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg71bLrIzlLvg1xeN-hiRPgMDg51A#MJMATHI-67" x="13133" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325052/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg71bLrIzlLvg1xeN-hiRPgMDg51A#MJMATHI-68" x="13613" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325052/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg71bLrIzlLvg1xeN-hiRPgMDg51A#MJMATHI-74" x="14190" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325052/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg71bLrIzlLvg1xeN-hiRPgMDg51A#MJMATHI-72" x="14801" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325052/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg71bLrIzlLvg1xeN-hiRPgMDg51A#MJMATHI-63" x="15253" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325052/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg71bLrIzlLvg1xeN-hiRPgMDg51A#MJMATHI-65" x="15686" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325052/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg71bLrIzlLvg1xeN-hiRPgMDg51A#MJMATHI-69" x="16153" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325052/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg71bLrIzlLvg1xeN-hiRPgMDg51A#MJMATHI-6C" x="16498" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-5"> 1 \ leq c_ {i} \ leq \ left \ lceil \ frac {2n} {k} \ right \ rceil </script>  ) - the number of vertices that the <em>i-</em> th clone will visit, and then output <em>c <sub>i</sub></em> integers - the numbers of the vertices that he will visit, in the order of their visit.  Derive a vertex every time a clone visits her, even if he has visited it before. </p><br><p>  It is guaranteed that the answer exists. </p><br><p>  <strong>Examples</strong> </p><br><p>  Input data <br>  3 2 1 <br>  2 1 <br>  3 1 </p><br><p>  Output <br>  3 2 1 3 </p><br><p>  Input data <br>  5 4 2 <br>  12 <br>  13 <br>  14 <br>  15 </p><br><p>  Output <br>  3 2 1 3 <br>  3 4 1 5 </p><br><p>  <strong>Note</strong> </p><br><p>  In the first test there is only 1 clone, he visits the vertices in the order (2, 1, 3), which fits into the restriction of 6 visited vertices. </p><br><p>  In the second test, there are 2 clones, they visit the vertices in the order (2, 1, 3) and (4, 1, 5), which fit into the limit of 5 visited vertices. </p><br><div class="spoiler">  <b class="spoiler_title">Task analysis</b> <div class="spoiler_text"><p>  We will launch a deeper in depth from any vertex of the graph and write out the Eulerian detour - the order in which the detour visits the vertices, and the vertex <em>v is</em> written out every time the detour enters it, in particular, after each recursive call made from <em>v</em> .  Note that the Eulerian round contains 2 <em>n</em> - 1 entries and is the correct answer for <em>k</em> = 1. For the general case of <em>k</em> , we cut the Eulerian round into <em>k</em> parts of size no more than ‚åà 2 <em>n</em> / <em>k</em> , and output these parts in response.  Note that by the condition in each part there must be at least one vertex, therefore, it is necessary to add any vertex to the empty parts of the constructed answer. </p><br><p>  Difficulty: <em>O</em> ( <em>n</em> + <em>m</em> ) time and memory. </p></div></div><br><h3 id="f-aksel-i-marston-v-bitlandii">  F. Axel and Marston in Beatland </h3><br><p>  Time limit per test - 5 seconds <br>  Memory limit per test - 256 megabytes <br>  Input - Standard Input <br>  Output - Standard Output </p><br><p>  Two friends, Axel and Marston travel together around Bitlandia.  There are <em>n</em> cities in Bitlandia, some pairs of which are connected by unidirectional roads.  The roads in Beatland are pedestrian and cycling.  In Bitlandia, there may be several roads between each pair of cities, and there are even roads from the city to it.  However, no two roads in Bitland can have the same beginning, end and type at the same time. </p><br><p>  Friends are in city 1 and want to draw up a travel route.  Axel likes walking, and Marston prefers the bike.  To make the route varied and interesting for each of the friends, they choose the order of alternation of the types of roads covered as follows: </p><br><ul><li>  The route begins with a pedestrian road. </li><li>  Let the known beginning of the route be written as a string <em>s</em> of the letters P (pedestrian road) and B (bicycle road).  Then a line is added to route <em>s</em> <img src="https://habrastorage.org/files/089/aed/bb6/089aedbb6b3746a8949f4ddaec477c26.png" alt="image">  where <img src="https://habrastorage.org/files/089/aed/bb6/089aedbb6b3746a8949f4ddaec477c26.png" alt="image">  means the string <em>s</em> , in which the type of each road is replaced by the opposite (all pedestrian roads are cycling, and vice versa). </li></ul><br><p>  The first few steps of building a route will look like this: P, PVPVVPP, PVVPVPVVVVVPVPVVPPVPVVP, and so on. </p><br><p>  Further, friends begin to move in city 1 along the roads of Bitlandia, each time choosing the type of the next road in accordance with the next symbol of the route.  If it is not possible to choose a suitable road, the friends end their journey and fly home. </p><br><p>  Help your friends determine the longest possible duration of their journey if they follow the constructed sequence of road types.  If friends can find a path consisting of more than 10 <sup>18</sup> roads, output -1 instead of the length. </p><br><p>  <strong>Input data</strong> </p><br><p>  The first line contains two integers <em>n</em> and <em>m</em> (1 ‚â§ <em>n</em> ‚â§ 500, 0 ‚â§ <em>m</em> ‚â§ 2 <em>n</em> <sup>2</sup> ) - the number of cities and roads in Bitlandia, respectively.  The following <em>m</em> lines describe the roads.  The <em>i-</em> th of these lines contains three integers <em>v <sub>i</sub></em> , <em>u <sub>i</sub></em> and <em>t <sub>i</sub></em> (1 ‚â§ <em>v <sub>i</sub></em> , <em>u <sub>i</sub></em> ‚â§ <em>n</em> , 0 ‚â§ <em>t <sub>i</sub></em> ‚â§ 1), where <em>v <sub>i</sub></em> and <em>u <sub>i</sub></em> are the numbers of the cities that are the beginning and the end of the <em>i-</em> th road, and <em>t <sub>i</sub></em> specifies the type of the <em>i</em> -th road (0 - pedestrian road, 1 - bicycle road).  It is guaranteed that for each pair of different numbers <em>i</em> , <em>j</em> , such that 1 <em>i</em> , <em>j</em> ‚â§ <em>m</em> , either <em>v <sub>i</sub></em> <em>v v <sub>j</sub></em> , or <em>u <sub>i</sub></em> ‚â† <em>u <sub>j</sub></em> , or <em>t <sub>i</sub></em> <em>t <sub>j</sub></em> . </p><br><p>  <strong>Output</strong> </p><br><p>  If the friends can find a suitable path of length strictly greater than 10 <sup>18</sup> , print the single number -1.  Otherwise, print the maximum length of a suitable path, that is, the greatest number of roads that friends can go. </p><br><p>  <strong>Examples</strong> </p><br><p>  Input data <br>  2 2 <br>  1 2 0 <br>  2 2 1 </p><br><p>  Output <br>  3 </p><br><p>  Input data <br>  2 3 <br>  1 2 0 <br>  2 2 1 <br>  2 2 0 </p><br><p>  Output <br>  -one </p><br><p>  <strong>Note</strong> </p><br><p>  In the first example, the path of length 3 can be obtained by passing once along road 1 from city 1 to city 2, and then twice along road 2 from city 2 to it. </p><br><p>  In the second example, we can get a path of arbitrarily long length, first passing along road 1, and then choosing road 2 or 3, depending on the next type of road. </p><br><div class="spoiler">  <b class="spoiler_title">Task analysis</b> <div class="spoiler_text"><p>  We will denote by <em>A <sub>i the</sub></em> binary string, obtained by <em>i</em> repetitions of inversion and attribution, for example, <em>A</em> <sub>0</sub> = 0, <em>A</em> <sub>1</sub> = 01, etc.  Also denote <img src="https://habrastorage.org/files/26c/510/fb9/26c510fb9a4b426489ba4d3b20b819bb.png" alt="image">  .  By definition <img src="https://habrastorage.org/files/95b/520/3e0/95b5203e0a8448bb88ffae5712624c5d.png" alt="image">  and <img src="https://habrastorage.org/files/0ba/c0e/123/0bac0e12393243ebadebbc97d87fbab7.png" alt="image">  . </p><br><p>  We calculate the matrices <em>P <sub>k</sub></em> and <em>Q <sub>k</sub></em> , the elements of <em>P <sub>k</sub></em> / <em>Q <sub>k</sub></em> ( <em>v</em> , <em>u</em> ) are equal to 1 for pairs of vertices <em>v</em> , <em>u</em> , such that from <em>v</em> to <em>u</em> there is a path corresponding to the line <em>A <sub>k</sub></em> / <em>B <sub>k</sub></em> .  The matrices <em>P</em> <sub>0</sub> and <em>Q</em> <sub>0</sub> are obviously just adjacency matrices with 0 and 1 edges, respectively.  Further, we note that <em>P</em> <sub><em>k</em> + 1</sub> ( <em>v</em> , <em>u</em> ) = 1 if and only if for some vertex <em>w</em> <em>P <sub>k</sub></em> ( <em>v</em> , <em>w</em> ) = <em>Q <sub>k</sub></em> ( <em>w</em> , <em>u</em> ) = 1 is fulfilled, and a similar criterion works for <em>Q</em> <sub><em>k</em> + 1</sub> ( <em>v</em> , <em>u</em> ).  Thus, we can calculate <em>P</em> <sub><em>k</em> + 1</sub> and <em>Q</em> <sub><em>k</em> + 1</sub> using <em>P <sub>k</sub></em> and <em>Q <sub>k</sub></em> in <em>O</em> ( <em>n</em> <sup>3</sup> ) time (in fact, the recalculation consists in multiplying the bit matrices: <img src="https://habrastorage.org/files/630/3c2/db9/6303c2db927c4302b252f27c896d5944.png" alt="image">  , <img src="https://habrastorage.org/files/92b/219/9b8/92b2199b85244b97b4e5d5affc371c5c.png" alt="image">  ). </p><br><p>  Now with the help of <em>P <sub>k</sub></em> and <em>Q <sub>k</sub></em> we find the answer.  We will store the current maximal answer <em>L</em> , and the set of vertices <em>S</em> reachable from vertex 1 along some correct path of length <em>L.</em>  We will iterate <em>k</em> in descending order from some value of <em>k</em> <sub>0</sub> , and check whether <em>L</em> can be increased by 2 <sup><em>k</em></sup> .  After the <em>L</em> position, the next 2 <sup><em>k</em></sup> characters form the string <em>A <sub>k</sub></em> or <em>B <sub>k</sub></em> , depending on the parity of the number of ones in the bit record <em>L.</em>  Let <em>S '</em> be the set of vertices reachable from <em>S</em> along the path corresponding to <em>Ak</em> / <em>Bk</em> .  If <em>S 'is</em> non-empty, increase <em>L</em> by 2 <sup><em>k</em></sup> , and assign <em>S</em> = <em>S'</em> , otherwise, we will not do anything.  In the end, <em>L</em> will be the maximum path length if it is less than 2 <sup><em>k</em></sup> 0. </p><br><p>  Take <em>k</em> <sub>0</sub> = 60, because we are not interested in the exact value of the answer, if it is greater than 2 <sup>60</sup> .  It turned out a solution in time <img src="https://habrastorage.org/files/8ca/228/be2/8ca228be223642be869aca0237975ef7.png" alt="image"> ,   .     ,     <img src="https://habrastorage.org/files/f9a/fa5/cb8/f9afa5cb896a4dd09f542faeafb7d530.png" alt="image"> . </p><br><p> : <img src="https://habrastorage.org/files/9cb/a16/30a/9cba1630a679444da8944b9fbcb598cf.png" alt="image">   <img src="https://habrastorage.org/files/cfd/c2b/b13/cfdc2bb1336f45908f5ce374bfac9805.png" alt="image"> ,  <img src="https://habrastorage.org/files/917/fe4/61e/917fe461ef464769ab63f1b12fcf4f70.png" alt="image"> , w = 64 ‚Äî     . </p></div></div><br><h3 id="g-andryusha-i-zhivye-barery"> G.     </h3><br><p>      ‚Äî 4  <br>      ‚Äî 256  <br>  ‚Äî   <br>  ‚Äî   </p><br><p>      .     ,  ,   .     <em>w</em> ,   1  <em>w</em>  ,  <em>h</em> ,     1  <em>h</em> . </p><br><p>  ,       .    <em>n</em> ,  <em>i</em> -      <em>u <sub>i</sub></em> ,       <em>l <sub>i</sub></em>  <em>r <sub>i</sub></em> .        ,    .  ,        ,     . </p><br><p>         .       ,     -       .     ,   ,                  .         ,       ,   .    ,   -       ,       .        . </p><br><p><img src="https://habrastorage.org/files/f5e/4d1/f69/f5e4d1f69d2c4fb8a3e57d40c89983a0.png" alt="image"><br> <em> ,     </em> </p><br><p>     ,      ,    .    ,       ,    .  ,     <em>i</em>  ,     ,  <em>s <sub>i</sub></em>  (         ,  <em>u <sub>i</sub></em> + <em>s <sub>i</sub></em> ),     ,    .       , ,      ( <em>h</em> + 1). </p><br><p>  ,          .      ,  .       ,        10 <sub>9</sub> + 7. </p><br><p> <strong> </strong> </p><br><p>        <em>h</em> , <em>w</em>  <em>n</em> (1 ‚â§ <em>h</em> ‚â§ 10 <sub>9</sub> , 2 ‚â§ <em>w</em> ‚â§ 10 <sub>5</sub> , 0 ‚â§ <em>n</em> ‚â§ 10 <sub>5</sub> ) ‚Äî  ,       . </p><br><p>     <em>n</em>     .  <em>i</em> -      <em>u <sub>i</sub></em> , <em>l <sub>i</sub></em> , <em>r <sub>i</sub></em> , <em>s <sub>i</sub></em> (1 ‚â§ <em>u <sub>i</sub></em> ‚â§ <em>h</em> , 1 ‚â§ <em>l <sub>i</sub></em> ‚â§ <em>r <sub>i</sub></em> ‚â§ <em>w</em> , 1 ‚â§ <em>s <sub>i</sub></em> ‚â§ 10 <sub>9</sub> ) ‚Äî ,    <em>i</em> - . ,      ,   ,      . ,         ,    ,   ,   <em>u <sub>i</sub></em> . </p><br><p> <strong> </strong> </p><br><p>    ‚Äî         10 <sub>9</sub> + 7. </p><br><p> <strong></strong> </p><br><p>   <br> 10 5 1 <br> 3 2 3 10 </p><br><p>   <br>  7 </p><br><p>   <br> 10 5 2 <br> 3 1 3 10 <br> 5 3 5 10 </p><br><p>   <br>  sixteen </p><br><p>   <br> 10 5 2 <br> 3 1 3 7 <br> 5 3 5 10 </p><br><p>   <br>  14 </p><br><p>   <br> 10 15 4 <br> 7 3 9 5 <br> 6 4 10 1 <br> 1 1 4 10 <br> 4 11 11 20 </p><br><p>   <br>  53 </p><br><p> <strong></strong> </p><br><p>     :        ,    ,  ‚Äî .   7. </p><br><p>        2, 2, 4, 4, 4        . </p><br><p>        1, 1, 4, 4, 4        .  ,    ,    ,    ,       . </p><br><p>        2, 2, 6, 6, 6, 6, 6, 6, 6, 1, 2, 1, 1, 1, 1        . ,      ,    . </p><br><div class="spoiler"> <b class="spoiler_title"> </b> <div class="spoiler_text"><p>  1:      .  <em>i</em> -  ,    <em>y</em>  <em>u <sub>i</sub></em> ‚â§ <em>y</em> ‚â§ <em>u <sub>i</sub></em> + <em>s <sub>i</sub></em> .          <em>x</em>   ,           . </p><br><p>      ,   .     ,    <img src="https://habrastorage.org/files/c8c/593/729/c8c5937291534ecba3a0e88dba2576cc.png" alt="image">            ;    ,    .          ,    ,  <em>x</em> ,            . ,       (    )      ;    ,           ( ,    ).     <img src="https://habrastorage.org/files/396/717/ab0/396717ab03a141719d512642912654d0.png" alt="image"> (      <code>std::set</code> ). </p><br><p>  2:            ,   .  -      ,         .                . </p><br><p>     [ <em>l</em> , <em>r</em> ].      [ <em>l</em> , <em>r</em> ]       ,      (  )     .     <em>w</em> ,               . ,     [ <em>l</em> , <em>r</em> ],      (   ). ,        .         . </p><br><p>    ,     <em>O</em> ( <em>n</em> + <em>w</em> ) ,      <img src="https://habrastorage.org/files/e43/8e8/c35/e438e8c35d4d4044bcf0f526e4c81d17.png" alt="image">  . </p></div></div><br><h3 id="h-avtobusy-i-intranet"> H.    </h3><br><p>      ‚Äî 10  <br>      ‚Äî 256  <br>  ‚Äî   <br>  ‚Äî   </p><br><p>  In the town <img src="https://habrastorage.org/files/a06/488/01f/a0648801ffe847f3abc5bad64efaec02.png" alt="image">   ,      ,      .     <em>m</em> ,             (        ). </p><br><p>            .  <em>T</em> ‚Äî  ,         .   1      0,  2 ‚Äî    <em>T</em> / <em>m</em> ,  ‚Äî    2 <em>T</em> / <em>m</em> ,  ..; ,  <em>m</em>    ( <em>m</em> - 1) <em>T</em> / <em>m</em> .  ,       (  ,    ) . </p><br><p>          .       <em>D</em> ,         <em>D</em>  . </p><br><p>  ,       .  ,       ,        .     1     2,  2   3,  ..,  ,  <em>m</em>     1. </p><br><p> ,    ,      <em>D</em> ,          . </p><br><p> <strong> </strong> </p><br><p>        <em>n</em>  <em>m</em> (2 ‚â§ <em>n</em> , <em>m</em> ‚â§ 10 <sub>5</sub> ) ‚Äî       . </p><br><p>  <em>n</em>        .         <em>x <sub>i</sub></em> , <em>y <sub>i</sub></em> ( - 1000 ‚â§ <em>x <sub>i</sub></em> , <em>y <sub>i</sub></em> ‚â§ 1000) ‚Äî   . </p><br><p> ,     (  ,     )     .  ,       .           . </p><br><p> <strong> </strong> </p><br><p>     ‚Äî   .   ,        10 <sub>- 6</sub> . </p><br><p> <strong></strong> </p><br><p>   <br> 4 2 <br> 0 0 <br>  0 1 <br> 1 1 <br>  ten <br>   <br> 1.000000000 <br>   <br> 2 2 <br> 0 0 <br>  ten <br>   <br> 0.000000000 </p><br><p> <strong></strong> </p><br><p>     1    .   ,  0.5      1,    <em>D</em> = 1. </p><br><p>   ,  0.5       (0.5, 0),    <em>D</em> = 0. </p><br><p><img src="https://habrastorage.org/files/545/1e9/531/5451e95316e04e0ea8664be86ad915ad.png" alt="image"><br> <em>,      </em> </p><br><div class="spoiler"> <b class="spoiler_title"> </b> <div class="spoiler_text"><p>      .   ,     ,     1  2, 2  3, ..., <em>n</em>  1       <em>x</em> . </p><br><p>  <em>p</em> ( <em>t</em> ) ‚Äî   1 (    0)   <em>t</em> .    <em>t</em> ,   || <em>p</em> ( <em>t</em> + <em>T</em> / <em>m</em> ) - <em>p</em> ( <em>t</em> )|| ‚â§ <em>x</em> ,  || <em>a</em> - <em>b</em> ||     <em>a</em>  <em>b</em> .     <em>t</em> ,  <em>t</em> , <em>t</em> + <em>T</em> / <em>m</em> , ..., <em>t</em> + ( <em>m</em> - 1) <em>T</em> / <em>m</em>   ,     <em>x</em> . </p><br><p>     <em>p</em> ( <em>t</em> + <em>T</em> / <em>m</em> ) - <em>p</em> ( <em>t</em> )  ,      ,       <em>p</em> ( <em>t</em> )  <em>p</em> ( <em>t</em> + <em>T</em> / <em>m</em> ).       ,   <em>p</em> ( <em>t</em> + <em>T</em> / <em>m</em> ) - <em>p</em> ( <em>t</em> )    ,       . ,  -       ,  <em>O</em> ( <em>n</em> ),       <em>O</em> ( <em>n</em> )  . </p><br><p>      <em>t</em>   <em>x</em> .         ,    .     <em>q</em> = <em>p</em> ( <em>t</em> + <em>T</em> / <em>m</em> ) - <em>p</em> ( <em>t</em> )     || <em>q</em> || ‚â§ <em>x</em> ,  <em>q</em>   .        ,     , ,          .   ,         . ,      <em>q</em>   ,     . </p><br><p>   ,  <em>p</em> ( <em>t</em> ), <em>p</em> ( <em>t</em> + <em>T</em> / <em>m</em> ),  ..  ,   [0, <em>T</em> ]  <em>m</em>    ¬´¬ª    ,         .    <em>t</em> ‚Äî  ,  <em>m</em> .    ‚Äî    . </p><br><p> : <img src="https://habrastorage.org/files/6bb/447/4ae/6bb4474ae1de442f8210c059bd02ed14.png" alt="image"> ,  <em>Œµ</em> ‚Äî   . </p></div></div><br><hr><br><p>   !   <a href="https://vk.com/techno_cup"> </a> ,       . </p></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <p>Source: <a href="https://habr.com/ru/post/325052/">https://habr.com/ru/post/325052/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../325036/index.html">Regular expression search with suffix array</a></li>
<li><a href="../325040/index.html">Good trigger, bad trigger: how we monitor hundreds of servers around the world</a></li>
<li><a href="../325042/index.html">Welcome to Go meetup April 14</a></li>
<li><a href="../325046/index.html">What would i change in go</a></li>
<li><a href="../325050/index.html">Digest AI Cup. Five strategies for Code Wizards 2016</a></li>
<li><a href="../325054/index.html">25 interesting books for designers in the public domain</a></li>
<li><a href="../325056/index.html">‚ÄúIt is expensive for us‚Äù - retail about acquiring</a></li>
<li><a href="../325058/index.html">User Interface Cards</a></li>
<li><a href="../325062/index.html">How to collect statistics from the website and not to fill yourself cones</a></li>
<li><a href="../325064/index.html">Everything you wanted to know about stack traces and hip dumps. Part 2</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>