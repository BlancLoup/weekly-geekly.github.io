<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Extending the possibilities of StyleCop</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="StyleCop - a static analyzer of C # code for matching style - was officially presented to the public in early 2008. By IT standards, this is quite a l...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Extending the possibilities of StyleCop</h1><div class="post__text post__text-html js-mediator-article"><img align="left" src="https://habrastorage.org/storage/habraeffect/4b/ca/4bcae227094d1b5a0968fe3e0e233dde.png"><br>  <a href="http://stylecop.codeplex.com/">StyleCop</a> - a static analyzer of C # code for matching style - was officially presented to the public in early 2008.  By IT standards, this is quite a long time, but for some reason this useful tool has not yet received wide popularity (at least the one it deserves). <br><br>  Below I will try to analyze the reasons, as well as talk about the new plugin for StyleCop. <br><a name="habracut"></a><br><hr><br><br><h2>  Why StyleCop is not very popular? </h2><br>  In addition to developers who are not worried about the coding style at all (hereinafter, only C # language will be discussed), many are frightened by too many errors with the default settings.  In my opinion, this is strange - if you care about the coding style, then it is quite natural to check all the settings, deciding for yourself which ones are suitable for adhering to the chosen style. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      But here the question arises - what is generally understood as a coding style?  Is this some kind of uniform style for everyone who writes in C #?  Or is each team free to choose it at their discretion? <br><br>  It seems to me that the very idea of ‚Äã‚Äãthe existence of "uniform" rules is utopian.  In general, there are some trends that more and more developers are sticking with over time.  However, the language is developing, new constructions are being added (and, therefore, there are more and more ways to use them), and a new wave of discussions and disputes begins. <br><br>  Nevertheless, Jason Allor - the creator and main ideological inspirer of StyleCop - takes the position that the rules of style should be the same for all.  As a result, these rules constitute the very ‚Äúdefault settings‚Äù that often stop those who would like to use StyleCop. <br><br>  I would not like to provoke controversy about specific rules - in the end, the styleCop style offered is used by some teams at Microsoft (which means it has a certain ‚Äúconfidence factor‚Äù).  However, my personal experience shows that the principle of ‚Äúlocal style‚Äù works most often - i.e.  Your style is accepted in a team, in a department, or in the whole organization, and then strictly adhered to. <br><br><blockquote>  Here I will note that if your agreements are concluded only in verbal agreements - you can assume that you do not have any agreements.  Forced verification (for example, as one of the build steps on a build server) is the only guarantee of compliance.  It is here that such tools as StyleCop and show themselves in all its glory. </blockquote><br><br><h2>  How can I fix the situation? </h2><br>  Fortunately, StyleCop has a fairly developed system of plug-ins, which allows to significantly expand its functionality (even the set of original rules is technically designed as a separate plug-in).  But there are not so many plug-ins to StyleCop.  And most of those that can be found are a few scattered rules and look abandoned. <br><br>  It seems to me that StyleCop would be more useful if it was positioned not as a tool for observing a certain style, but would become a kind of ‚Äúdesigner‚Äù with which it would be possible to control the observance of the style that your team needs. <br><br><h2>  StyleCop + </h2><br>  Approximately with such thoughts a year ago I started writing <a href="http://stylecopplus.codeplex.com/">StyleCop +</a> - another plugin for StyleCop.  His main idea was and remains unchanged - without imposing specific rules, to provide a wide range of possible checks, allowing you to customize your own style. <br><br>  The plugin was slowly written in free time and gradually acquired new features.  As a result, I decided to share my work and began publishing it on CodePlex.  Positive feedback has shown that the work was not done in vain. <br><br>  Below I would like to briefly describe the main features of StyleCop +.  If you already use StyleCop - they may seem interesting to you, but if not - perhaps they were not enough for you, or maybe they will inspire you to write your own extensions. <br><br><h3>  Advanced naming rules </h3><br>  The history of the emergence of these rules is fairly simple: in our team, we adopted the <b>m_field</b> style for class fields (when the names of private fields begin with different prefixes, in particular, <b>m_</b> ).  StyleCop, on the other hand, only supports <b>this.field-</b> style (when private fields do not have prefixes, but any reference to the fields or methods of the class must be followed by the mandatory <b>this</b> to distinguish fields from, for example, method arguments).  Moreover, StyleCop also contains a rule prohibiting the use of underscores in names in general. <br><br>  Again, I do not dare to say which style is better.  But the reality is that different styles already exist (even in .NET BCL, you can observe groups of classes written by different teams at different times - and with different naming styles).  And if so - then the tool for style compliance is simply obliged to take into account all this diversity. <br><br>  Thus, the rules appeared in StyleCop + that allow you to configure almost any object naming system.  Functionally, they completely cover the main <b>Naming Rules</b> ( <b>SA13xx</b> ), so the latter can be simply turned off: <br><br><img src="https://habrastorage.org/storage/habraeffect/f2/f6/f2f668b0de595a4c16bf9c472117c44f.png"><br><br>  The way of configuring these rules is in many ways similar to the similar settings in ReSharper - you have access to a wide range of entities, for each of which you can set your own naming patterns. <br><br><img src="https://habrastorage.org/storage/habraeffect/df/20/df2033d4beeb79b28ea5ca78aa67927b.png"><br><br>  For example, the following rule says that the name must either begin with the prefix <b>m_</b> , followed by the name in <i>camelStyle</i> ( <b>m_rulesMap</b> ), or be fully recorded in <i>PascalStyle</i> ( <b>RulesMap</b> ). <br><br><img src="https://habrastorage.org/storage/habraeffect/a0/27/a027c743867004722e1088bbbb831bb4.png"><br><br>  As can be seen from the picture, a number of macros describing the most common capitalization styles can be used in naming templates. <br><br>  There are also quite a lot of entities, some of which are specifically highlighted separately.  For example, someone may not want to rename the standard WinForms event handlers (such as <b>buttonStart_Click</b> ) - which means they may need their own rules, not the ones used for normal methods.  Or, someone may <b>specifically</b> call methods that are unit tests (for example, <b>Setting_Null_Throws_Exception</b> ).  And the need to have different rules for the names of classes or fields, depending on access modifiers, is completely obvious. <br><br>  Since capitalization is checked in the names, it is impossible to do without specifying your own list of abbreviations (here they are any combinations of capital letters that should be allowed as a separate word).  Also, an option has recently appeared that allows you to ensure that the names of some derived classes end up with the name of the base class (for example, it is common for <b>Attribute</b> , <b>Exception</b> , <b>Stream</b> , etc., but someone may want to add their own exceptions). <br><br><h3>  More Custom Rules </h3><br>  Like other plugins, StyleCop + contains various additional rules for checking style.  There are not many of them yet, but those that exist are quite flexible in configuration (thanks to the active users who suggested many interesting ideas). <br><br>  A separate interface was created for these rules, which allows you to edit settings more friendly (unlike the traditional interface on the <b>Rules</b> tab, the settings here are not limited to checkboxes with Boolean values ‚Äã‚Äãand refer to the rule itself). <br><br><img src="https://habrastorage.org/storage/habraeffect/f0/fb/f0fb2d44c2b92f02d689f74780d7567b.png"><br><br><h3>  Extended Original Rules </h3><br>  This is an experimental feature where StyleCop + contains rules that ‚Äúparasitize‚Äù on the original StyleCop rules.  For example, the useful rule <b>SA1509: OpeningCurlyBracketsMustNotBePrecededByBlankLine</b> also prohibits "embedded" blocks of code. <br><br><pre><code class="hljs coffeescript"><span class="hljs-regexp"><span class="hljs-regexp">//</span></span> some statements ... { int a; <span class="hljs-regexp"><span class="hljs-regexp">//</span></span> declaration <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> local variables required to set value <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> f1 ... <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.f1 = ...; } { int a; <span class="hljs-regexp"><span class="hljs-regexp">//</span></span> declaration <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> local variables required to set value <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> f2 ... <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.f2 = ...; }</code> </pre> <br><br>  Its ‚Äúparasite rule‚Äù - <b>SP1509</b> - contains a setting that allows you to allow such writing.  The key point is that this rule does not contain its own code duplicating the original check.  Instead, the ‚Äúparasitic rule‚Äù runs the original code from StyleCop, but imposes its own limitations on the result (in the example above, it will not give an error if it is caused by ‚Äúembedded‚Äù code blocks). <br><br><h2>  Instead of conclusion </h2><br>  If you are not using StyleCop yet, be sure to try it, it should be your must-have tool! <br>  If you do not have enough functionality - write extensions or look for existing ones! <br><br>  As for StyleCop +, it continues to evolve.  Download, use, ask questions on CodePlex.  And if it so happens that it is he who will induce at least one developer to start using StyleCop - we can assume that this project has fulfilled its mission by 100%! <br><br>  Good luck! <br><br><h6>  ____________________ </h6><ul><li>  <a href="http://stylecop.codeplex.com/">http://stylecop.codeplex.com</a> - StyleCop on CodePlex </li><li>  <a href="http://stylecopplus.codeplex.com/">http://stylecopplus.codeplex.com</a> - StyleCop + on CodePlex </li><li>  <a href="http://blogs.msdn.com/b/sourceanalysis">http://blogs.msdn.com/b/sourceanalysis</a> - Microsoft StyleCop blog </li><li>  <a href="http://devjitsu.com/blog">http://devjitsu.com/blog</a> - Jason Allor Blog </li></ul></div><p>Source: <a href="https://habr.com/ru/post/111847/">https://habr.com/ru/post/111847/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../111839/index.html">Ariel</a></li>
<li><a href="../111841/index.html">Fighting spam by law</a></li>
<li><a href="../111844/index.html">Where should the incoming call arrow be directed to in a spherical interface in a vacuum?</a></li>
<li><a href="../111845/index.html">Bluetooth watches and Maemo</a></li>
<li><a href="../111846/index.html">Work with progress dialogs</a></li>
<li><a href="../111849/index.html">Prices for roaming in Russia will continue to decrease</a></li>
<li><a href="../111851/index.html">Sony Ericsson Xperia Arc video review</a></li>
<li><a href="../111852/index.html">Another way to use exotic fonts on a webpage</a></li>
<li><a href="../111853/index.html">Want to earn hemorrhoids on your head - contact Liqpay</a></li>
<li><a href="../111854/index.html">Each student - in the dictionary Lingvo</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>