<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Recommended systems: SVD on perl</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In the previous series, we discussed what a singular value decomposition (SVD) is and formulated a singular value model with basic predictors. Last ti...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Recommended systems: SVD on perl</h1><div class="post__text post__text-html js-mediator-article">  In the previous series, we discussed what a singular value decomposition (SVD) is and formulated a singular value model with basic predictors.  <a href="http://habrahabr.ru/company/surfingbird/blog/140555/">Last time,</a> we have already brought the matter to specific update formulas.  Today I will demonstrate a very simple implementation of a very simple model, we will apply it to the already familiar rating matrix, and then we will discuss what the results are. <br><img src="https://habrastorage.org/storage2/bab/76e/f5d/bab76ef5d6fd3eae54b4ad995c551f16.jpg"><br><br><a name="habracut"></a>  So, SVD on Perl.  Ready script that can be run as <pre><code class="bash hljs">./svd.pl _ dataset.csv</code> </pre>  can be downloaded <a href="http://logic.pdmi.ras.ru/~sergey/surfingbird/svd.pl">from here</a> .  I will now just give him the part that does the actual training. <br><br><pre> <code class="perl hljs"><span class="hljs-comment"><span class="hljs-comment">#  SVD: ,    while (abs($old_rmse - $rmse) &gt; 0.00001 ) { $old_rmse = $rmse; $rmse = 0; foreach my $u ( keys %l ) { foreach my $v ( keys %{$l{$u}} ) { #   $err = $l{$u}{$v} - ($mu + $b_u[$u] + $b_v[$v] + dot($u_f[$u], $v_f[$v]) ); #    $rmse += $err * $err; #      ... $mu += $eta * $err; $b_u[$u] += $eta * ($err - $lambda2 * $b_u[$u]); $b_v[$v] += $eta * ($err - $lambda2 * $b_v[$v]); # ...    for (my $f=0; $f &lt; $features; ++$f) { $u_f[$u][$f] += $eta * ($err * $v_f[$v][$f] - $lambda2 * $u_f[$u][$f]); $v_f[$v][$f] += $eta * ($err * $u_f[$u][$f] - $lambda2 * $v_f[$v][$f]); } } } ++$iter_no; #   ,   RMSE $rmse = sqrt($rmse / $total); print "Iteration $iter_no:\tRMSE=" . $rmse . "\n"; #  RMSE  ,     if ($rmse &gt; $old_rmse - $threshold) { $eta = $eta * 0.66; $threshold = $threshold * 0.5; } }</span></span></code> </pre><br>  As you can see, absolutely nothing terrible - you just need to start the process of updating the scales and continue it until convergence.  The convergence is determined by the RMSE (root mean squared error) - root-mean-square error, i.e.  the root of the sum of squares of errors divided by the number of test cases.  We implement a <i>stochastic</i> gradient descent: after each test case, we immediately change the parameters, and do not collect error statistics for the entire database. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      When RMSE ceases to improve noticeably, we decrease the speed of learning;  With this approach, sooner or later the process should converge (ie, the RMSE should stop changing).  What is Œª here, we will discuss next time, today it will be zero in our examples. <br><br>  Now let's apply what we did to the rating matrix, which we considered in <a href="http://habrahabr.ru/company/surfingbird/blog/139518/">one of the first texts</a> . <br><img src="https://habrastorage.org/storage2/adb/dbc/b85/adbdbcb85e0cd9ca59065d7425788b6d.png" alt="image"><br>  In a suitable format, you can download it <a href="">here</a> (order is preserved).  After running our script on this dataset, we‚Äôll get something like the following. <br><blockquote><pre>  Read 5 users and 5 urls.
 Iteration 1: RMSE = 1.92845291697284
 Iteration 2: RMSE = 1.28481736445124
 Iteration 3: RMSE = 1.14159530044051
 ...
 Iteration 808: RMSE = 0.0580161117835789
 Iteration 809: RMSE = 0.0580061123741253
        mu: 2.54559533638261
 User base: 0.7271 0.1626 0.7139 1.9097 -0.9677	
 Item base: 0.8450 0.6593 0.2731 0.7328 0.0354	
 User features
   user 0: -0.5087 -0.8326	
   user 1: 1.0220 1.2826	
   user 2: -0.9509 0.2792	
   user 3: 0.1031 -0.4814	
   user 4: 0.6095 0.0557	
 Item features:
   Item 0: -0.8368 0.2511	
   item 1: 1.1101 0.4120	
   item 2: -0.4159 -0.4073	
   item 3: -0.3130 -0.9115	
   item 4: 0.6408 1.2205 </pre></blockquote>  What have we got as a result?  Approximately what we expected.  Users received basic predictors in accordance with their kindness: Petrovich turned out to be an evil spectator, and the rest, on the contrary, were kind, especially Zhannochka.  Films received basic predictors in accordance with ‚Äúoverall quality‚Äù (expressed, of course, through evaluations). <br><br>  But the most interesting thing is that we got a reasonable decomposition of the remaining user preferences into two factors.  An example, of course, is a toy one, and in dataset it was originally laid down that films are divided into films ‚Äúabout pigs‚Äù and ‚Äúabout tractors‚Äù;  Some users are more fond of powerful technology, and some - pork hryashik. <br><br>  Indeed, it is clear that the first factor is how much the film is ‚Äúabout tractors‚Äù, and the second factor is how much it is ‚Äúabout pigs‚Äù;  specific values ‚Äã‚Äãdo not have a deep meaning, only their relationship is important. <br><br>  By the way, I didn‚Äôt specifically customized dataset, and in this case there was a funny case with signs: SVD taught negative values ‚Äã‚Äãof ‚Äúabout tractors‚Äù factors for two users who like tractors, Vasya and Valerik.  But at the same time, SVD has taught negative values ‚Äã‚Äãfor the ‚Äúabout tractors‚Äù factors in films that are really about tractors - a minus to a minus will give a plus.  And just 1.0220 Peter, on the contrary, means that he is not at all interested in tractors compared to piglets ... <br><br>  We can now predict the value of Vasya‚Äôs rating for ‚ÄúTractor drivers‚Äù as <br><pre>  2.5456 + 0.7271 + 0.8450 + (-0.5087) * (- 0.8368) + (-0.8326) * 0.2511 = 4.3343143. </pre><br>  Well, it was really possible to assume that Vasya would like Tractorists. <br><br>  Next time we will talk about overfitting and regularization - what it is, why it is needed and how to implement it in SVD. </div><p>Source: <a href="https://habr.com/ru/post/141959/">https://habr.com/ru/post/141959/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../141954/index.html">Why I left Google Zurich</a></li>
<li><a href="../141955/index.html">Does MegaFon offer DDoS protection?</a></li>
<li><a href="../141956/index.html">On June 28, 2011, Microsoft released updated versions of Arial, Tahoma and Verdana fonts.</a></li>
<li><a href="../141957/index.html">Yandex.Search for a site allows you to refine the search results</a></li>
<li><a href="../141958/index.html">Plastic electronics will change the design of familiar things.</a></li>
<li><a href="../141960/index.html">Performance Measurement Play Framework 2.0</a></li>
<li><a href="../141961/index.html">DeepClone javascript tweet</a></li>
<li><a href="../141963/index.html">Botnet on Mac: details</a></li>
<li><a href="../141964/index.html">Use Resque in Rails</a></li>
<li><a href="../141965/index.html">AntiDDoS service from the cloud operator Cloud4Y - you relax, not your sites</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>